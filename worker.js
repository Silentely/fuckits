// --- FUCKIT.SH Cloudflare Worker ---

// This is the content of your main.sh installer script.
// It will be served when a user makes a GET request.
function b64_to_utf8(str) {
  try {
    // This is a more robust way to decode base64 to UTF-8
    const binaryString = atob(str);
    const len = binaryString.length;
    const bytes = new Uint8Array(len);
    for (let i = 0; i < len; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }
    return new TextDecoder().decode(bytes);
  } catch (e) {
    console.error("Failed to decode base64 string:", e);
    return ""; // Return empty string on failure
  }
}

const INSTALLER_SCRIPT = b64_to_utf8(`IyEvYmluL2Jhc2gKIwojIGZ1Y2tpdHMgLSDlronoo4XohJrmnKzlkozkuLTml7bmiafooYzlmagKIwojIC0tLSDmjqjojZDnmoTlronlhajkvb/nlKjmlrnlvI8gLS0tCiMKIyAxLiDkuIvovb06CiMgICAgY3VybCAtbyBmdWNraXRzIGh0dHBzOi8vZnVja2l0cy4yNTUwMDU1Mi54eXoKIwojIDIuIOajgOafpeWGheWuuToKIyAgICBsZXNzIGZ1Y2tpdHMKIwojIDMuIOWuieijhei/kOihjDoKIyAgICBiYXNoIGZ1Y2tpdHMKIwojIDQuIOS4tOaXtui/kOihjDoKIyAgICBiYXNoIGZ1Y2tpdHMgInlvdXIgcHJvbXB0IgojCgpzZXQgLWV1byBwaXBlZmFpbAoKIyAtLS0g6Ziy5q2iIHJlYWRvbmx5IOWPmOmHj+mHjeWkjeWumuS5iSAtLS0KIyDmraTlrojljavlhYHorrjohJrmnKzooqvlpJrmrKEgc291cmNl77yI5L6L5aaC5Zyo5rWL6K+V5Lit77yJCmlmIFtbIC16ICIke0ZVQ0tJVFNfQ09OU1RBTlRTX0RFRklORUQ6LX0iIF1dOyB0aGVuCiAgICAjIOagh+iusOW4uOmHj+W3suWumuS5ie+8iGV4cG9ydCDkvb/lrZAgc2hlbGwg5Y+v6KeB77yJCiAgICBleHBvcnQgRlVDS0lUU19DT05TVEFOVFNfREVGSU5FRD0xCgojIC0tLSDpopzoibLlrprkuYkgLS0tCnJlYWRvbmx5IENfUkVTRVQ9J1wwMzNbMG0nCnJlYWRvbmx5IENfUkVEX0JPTEQ9J1wwMzNbMTszMW0nCnJlYWRvbmx5IENfUkVEPSdcMDMzWzA7MzFtJwpyZWFkb25seSBDX0dSRUVOPSdcMDMzWzA7MzJtJwpyZWFkb25seSBDX1lFTExPVz0nXDAzM1swOzMzbScKcmVhZG9ubHkgQ19DWUFOPSdcMDMzWzA7MzZtJwpyZWFkb25seSBDX0JPTEQ9J1wwMzNbMW0nCnJlYWRvbmx5IENfRElNPSdcMDMzWzJtJwoKIyAtLS0gRlVDSyEgLS0tCnJlYWRvbmx5IEZVQ0s9IiR7Q19SRURfQk9MRH1GVUNLISR7Q19SRVNFVH0iCnJlYWRvbmx5IEZDS049IiR7Q19SRUR9RipDS0lORyR7Q19SRVNFVH0iCgpyZWFkb25seSBGVUNLSVRTX0xPQ0FMRT0iZW4iCgoKIyAtLS0g6YWN572uIC0tLQppZiBbIC16ICIke0hPTUU6LX0iIF07IHRoZW4KICAgIGVjaG8gLWUgIlwwMzNbMTszMW1GVUNLIVwwMzNbMG0gXDAzM1swOzMxbVlvdXIgSE9NRSB2YXJpYWJsZSBpc24ndCBzZXQuIEkgZG9uJ3Qga25vdyB3aGVyZSB0byBpbnN0YWxsIHRoaXMgc2hpdC4gU2V0IGl0IHlvdXJzZWxmIChlLmcuLCBleHBvcnQgSE9NRT0vcm9vdCkuXDAzM1swbSIgPiYyCiAgICBleGl0IDEKZmkKcmVhZG9ubHkgSU5TVEFMTF9ESVI9IiRIT01FLy5mdWNrIgpyZWFkb25seSBNQUlOX1NIPSIkSU5TVEFMTF9ESVIvbWFpbi5zaCIKcmVhZG9ubHkgQ09ORklHX0ZJTEU9IiRJTlNUQUxMX0RJUi9jb25maWcuc2giCgpmaSAgIyByZWFkb25seSDluLjph4/lrojljavnu5PmnZ8KCgojIC0tLSDmoLjlv4PpgLvovpHvvIjltYzlhaXkuLrlrZfnrKbkuLLvvIktLS0KcmVhZCAtciAtZCAnJyBDT1JFX0xPR0lDIDw8J0VPRicgfHwgdHJ1ZQoKIyAtLS0gZnVja2l0cyDmoLjlv4PpgLvovpHlvIDlp4sgLS0tCgojIC0tLSDpopzoibLlrprkuYkgLS0tCiMg5LuF5Zyo5bCa5pyq5a6a5LmJ5pe25a6a5LmJ6aKc6Imy77yI55So5LqO5Li05pe25qih5byP77yJCmlmIFsgLXogIiR7Q19SRVNFVDotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgQ19SRVNFVD0nXDAzM1swbScKICAgIHJlYWRvbmx5IENfUkVEX0JPTEQ9J1wwMzNbMTszMW0nCiAgICByZWFkb25seSBDX1JFRD0nXDAzM1swOzMxbScKICAgIHJlYWRvbmx5IENfR1JFRU49J1wwMzNbMDszMm0nCiAgICByZWFkb25seSBDX1lFTExPVz0nXDAzM1swOzMzbScKICAgIHJlYWRvbmx5IENfQ1lBTj0nXDAzM1swOzM2bScKICAgIHJlYWRvbmx5IENfQk9MRD0nXDAzM1sxbScKICAgIHJlYWRvbmx5IENfRElNPSdcMDMzWzJtJwoKICAgICMgLS0tIEZVQ0shIC0tLQogICAgcmVhZG9ubHkgRlVDSz0iJHtDX1JFRF9CT0xEfUZVQ0shJHtDX1JFU0VUfSIKICAgIHJlYWRvbmx5IEZDS049IiR7Q19SRUR9RipDS0lORyR7Q19SRVNFVH0iCmZpCgppZiBbIC16ICIke0lOU1RBTExfRElSK3h9IiBdIHx8IFsgLXogIiR7TUFJTl9TSCt4fSIgXSB8fCBbIC16ICIke0NPTkZJR19GSUxFK3h9IiBdOyB0aGVuCiAgICBpZiBbIC16ICIke0hPTUU6LX0iIF07IHRoZW4KICAgICAgICByZWFkb25seSBJTlNUQUxMX0RJUj0iL3RtcC8uZnVjayIKICAgICAgICByZWFkb25seSBNQUlOX1NIPSIvdG1wLy5mdWNrL21haW4uc2giCiAgICAgICAgcmVhZG9ubHkgQ09ORklHX0ZJTEU9Ii90bXAvLmZ1Y2svY29uZmlnLnNoIgogICAgZWxzZQogICAgICAgIHJlYWRvbmx5IElOU1RBTExfRElSPSIkSE9NRS8uZnVjayIKICAgICAgICByZWFkb25seSBNQUlOX1NIPSIkSU5TVEFMTF9ESVIvbWFpbi5zaCIKICAgICAgICByZWFkb25seSBDT05GSUdfRklMRT0iJElOU1RBTExfRElSL2NvbmZpZy5zaCIKICAgIGZpCmZpCgojIE5vdGU6IENvbmZpZyBsb2FkaW5nIGlzIGRvbmUgQUZURVIgdmFsaWRhdGlvbiBmdW5jdGlvbnMgYXJlIGRlZmluZWQgKHNlZSBiZWxvdykKCmlmIFsgLXogIiR7REVGQVVMVF9BUElfRU5EUE9JTlQreH0iIF07IHRoZW4KICAgIHJlYWRvbmx5IERFRkFVTFRfQVBJX0VORFBPSU5UPSJodHRwczovL2Z1Y2tpdHMuMjU1MDA1NTIueHl6LyIKZmkKCiMgLS0tIOWuieWFqOmFjee9rumqjOivgSAtLS0KIyBWYWxpZGF0ZXMgY29uZmlnIGZpbGUgY29udGVudCBiZWZvcmUgc291cmNpbmcgdG8gcHJldmVudCBjb2RlIGluamVjdGlvbgojIEFyZ3VtZW50czogJDEgLSBmaWxlIHBhdGggdG8gdmFsaWRhdGUKIyBSZXR1cm5zOiAwIGlmIHNhZmUsIDEgaWYgdW5zYWZlIG9yIGVycm9yCl9mdWNrX3ZhbGlkYXRlX2NvbmZpZ19maWxlKCkgewogICAgbG9jYWwgZmlsZT0iJDEiCgogICAgIyBGaWxlIG11c3QgZXhpc3QgYW5kIGJlIHJlYWRhYmxlCiAgICBpZiBbICEgLWYgIiRmaWxlIiBdIHx8IFsgISAtciAiJGZpbGUiIF07IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIENoZWNrIGZpbGUgcGVybWlzc2lvbnMgLSBzaG91bGQgYmUgb3duZWQgYnkgY3VycmVudCB1c2VyCiAgICBpZiBbICIkKHN0YXQgLWMgJyV1JyAiJGZpbGUiIDI+L2Rldi9udWxsIHx8IHN0YXQgLWYgJyV1JyAiJGZpbGUiIDI+L2Rldi9udWxsKSIgIT0gIiQoaWQgLXUpIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1Db25maWcgZmlsZSBub3Qgb3duZWQgYnkgY3VycmVudCB1c2VyLCByZWZ1c2luZyB0byBzb3VyY2UuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbGluZV9udW09MAogICAgbG9jYWwgbGluZQoKICAgICMgUHJlLWRlZmluZSByZWdleCBwYXR0ZXJucyBhcyB2YXJpYWJsZXMgKHpzaCBjb21wYXRpYmlsaXR5OiBhdm9pZHMgc3BlY2lhbCBjaGFyYWN0ZXIgcGFyc2luZyBpc3N1ZXMpCiAgICBsb2NhbCByZV9jbWRfc3ViPSdcJFwoJwogICAgbG9jYWwgcmVfYmFja3RpY2s9J2AnCiAgICBsb2NhbCByZV9hcml0aD0nXCRcKFwoJwogICAgbG9jYWwgcmVfc2VtaT0nOycKICAgIGxvY2FsIHJlX2FuZD0nJiYnCiAgICBsb2NhbCByZV9vcj0nXHxcfCcKICAgIGxvY2FsIHJlX3BpcGU9J1x8JwogICAgbG9jYWwgcmVfZ3Q9Jz4nCiAgICBsb2NhbCByZV9sdD0nPCcKICAgIGxvY2FsIHJlX2FtcD0nJicKICAgIGxvY2FsIHJlX2VzYz0nXFxcJCcKCiAgICB3aGlsZSBJRlM9IHJlYWQgLXIgbGluZSB8fCBbIC1uICIkbGluZSIgXTsgZG8KICAgICAgICBsaW5lX251bT0kKChsaW5lX251bSArIDEpKQoKICAgICAgICAjIFNraXAgZW1wdHkgbGluZXMKICAgICAgICBpZiBbIC16ICIkbGluZSIgXSB8fCBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSokIF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyBTa2lwIGNvbW1lbnQgbGluZXMgKCMgYXQgc3RhcnQsIG9wdGlvbmFsbHkgd2l0aCBsZWFkaW5nIHdoaXRlc3BhY2UpCiAgICAgICAgaWYgW1sgIiRsaW5lIiA9fiBeW1s6c3BhY2U6XV0qIyBdXTsgdGhlbgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZpCgogICAgICAgICMgQ2hlY2sgZm9yIGRhbmdlcm91cyBzaGVsbCBtZXRhY2hhcmFjdGVycyBhbmQgY29tbWFuZCBzdWJzdGl0dXRpb24KICAgICAgICAjIFJlamVjdDogJCgpLCBgYCwgJCgoKSwgOywgJiYsIHx8LCB8IChwaXBlKSwgPiwgPCwgJiwgbmV3bGluZSBlc2NhcGVzCiAgICAgICAgaWYgW1sgIiRsaW5lIiA9fiAkcmVfY21kX3N1YiBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfYmFja3RpY2sgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2FyaXRoIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9zZW1pIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hbmQgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX29yIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9waXBlIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9ndCBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfbHQgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2FtcCBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfZXNjIF1dOyB0aGVuCiAgICAgICAgICAgIF9mdWNrX2RlYnVnICJDb25maWcgdmFsaWRhdGlvbiBmYWlsZWQgYXQgbGluZSAkbGluZV9udW06IGRhbmdlcm91cyBtZXRhY2hhcmFjdGVyIGRldGVjdGVkIgogICAgICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfVVuc2FmZSBjb25maWcgZmlsZTogZGFuZ2Vyb3VzIHNoZWxsIG1ldGFjaGFyYWN0ZXIgYXQgbGluZSAkbGluZV9udW0ke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICBmaQoKICAgICAgICAjIE9ubHkgYWxsb3c6IGV4cG9ydCBGVUNLXyo9Li4uIG9yIEZVQ0tfKj0uLi4gKHdpdGggb3B0aW9uYWwgd2hpdGVzcGFjZSkKICAgICAgICAjIEFsc28gYWxsb3c6IGV4cG9ydCBGVUNLSVRTX0xPQ0FMRT0uLi4KICAgICAgICBpZiBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSooZXhwb3J0W1s6c3BhY2U6XV0rKT8oRlVDS19bQS1aX10rfEZVQ0tJVFNfTE9DQUxFKT0gXV07IHRoZW4KICAgICAgICAgICAgY29udGludWUKICAgICAgICBmaQoKICAgICAgICAjIFJlamVjdCBhbnl0aGluZyBlbHNlCiAgICAgICAgX2Z1Y2tfZGVidWcgIkNvbmZpZyB2YWxpZGF0aW9uIGZhaWxlZCBhdCBsaW5lICRsaW5lX251bTogdW5yZWNvZ25pemVkIHBhdHRlcm4iCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1VbnNhZmUgY29uZmlnIGZpbGU6IHVucmVjb2duaXplZCBwYXR0ZXJuIGF0IGxpbmUgJGxpbmVfbnVtJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGRvbmUgPCAiJGZpbGUiCgogICAgcmV0dXJuIDAKfQoKIyBTYWZlbHkgc291cmNlIGEgY29uZmlnIGZpbGUgYWZ0ZXIgdmFsaWRhdGlvbgojIEFyZ3VtZW50czogJDEgLSBmaWxlIHBhdGggdG8gc291cmNlCiMgUmV0dXJuczogMCBpZiBzb3VyY2VkIHN1Y2Nlc3NmdWxseSwgMSBpZiB2YWxpZGF0aW9uIGZhaWxlZCBvciBmaWxlIGRvZXNuJ3QgZXhpc3QKX2Z1Y2tfc2FmZV9zb3VyY2VfY29uZmlnKCkgewogICAgbG9jYWwgZmlsZT0iJDEiCgogICAgaWYgWyAhIC1mICIkZmlsZSIgXTsgdGhlbgogICAgICAgIHJldHVybiAwICAjIE5vIGZpbGUgaXMgZmluZQogICAgZmkKCiAgICBpZiBfZnVja192YWxpZGF0ZV9jb25maWdfZmlsZSAiJGZpbGUiOyB0aGVuCiAgICAgICAgIyBzaGVsbGNoZWNrIGRpc2FibGU9U0MxMDkwCiAgICAgICAgc291cmNlICIkZmlsZSIKICAgICAgICByZXR1cm4gJD8KICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfUNvbmZpZyBmaWxlIHZhbGlkYXRpb24gZmFpbGVkLCBza2lwcGluZzogJGZpbGUke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyAtLS0g5Yqg6L2955So5oi36YWN572u77yI5bim6aqM6K+B77yJLS0tCiMgTm93IHRoYXQgdmFsaWRhdGlvbiBmdW5jdGlvbnMgYXJlIGRlZmluZWQsIHNhZmVseSBsb2FkIHRoZSBjb25maWcKX2Z1Y2tfc2FmZV9zb3VyY2VfY29uZmlnICIkQ09ORklHX0ZJTEUiCgojIC0tLSBBdWRpdCBMb2dnaW5nIC0tLQojIExvZ3MgY29tbWFuZCBleGVjdXRpb24gdG8gYXVkaXQgbG9nIGZpbGUKIyBBcmd1bWVudHM6ICQxIC0gZXZlbnQgKGUuZy4sICJFWEVDIiwgIkJMT0NLIiwgIkFCT1JUIiksICQyIC0gY29tbWFuZCwgJDMgLSBleGl0IGNvZGUgKG9wdGlvbmFsKQpfZnVja19hdWRpdF9sb2coKSB7CiAgICAjIENoZWNrIGlmIGF1ZGl0IGxvZ2dpbmcgaXMgZW5hYmxlZAogICAgaWYgWyAiJHtGVUNLX0FVRElUX0xPRzotZmFsc2V9IiAhPSAidHJ1ZSIgXTsgdGhlbgogICAgICAgIHJldHVybiAwCiAgICBmaQogICAgCiAgICBsb2NhbCBldmVudD0iJDEiCiAgICBsb2NhbCBjb21tYW5kPSIkMiIKICAgIGxvY2FsIGV4aXRfY29kZT0iJHszOi0tfSIKICAgIGxvY2FsIHRpbWVzdGFtcAogICAgdGltZXN0YW1wPSQoZGF0ZSAtdSAnKyVZLSVtLSVkICVIOiVNOiVTIFVUQycgMj4vZGV2L251bGwgfHwgZGF0ZSAnKyVZLSVtLSVkICVIOiVNOiVTJykKICAgIGxvY2FsIGxvZ19maWxlPSIke0ZVQ0tfQVVESVRfTE9HX0ZJTEU6LSRJTlNUQUxMX0RJUi8uYXVkaXQubG9nfSIKICAgIAogICAgIyBFbnN1cmUgbG9nIGRpcmVjdG9yeSBleGlzdHMKICAgIG1rZGlyIC1wICIkKGRpcm5hbWUgIiRsb2dfZmlsZSIpIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICAKICAgICMgU2FuaXRpemUgY29tbWFuZCBmb3IgbG9nZ2luZyAobm9ybWFsaXplIG5ld2xpbmVzLCBlc2NhcGUgZGVsaW1pdGVyLCBsaW1pdCBsZW5ndGgpCiAgICBsb2NhbCBzYW5pdGl6ZWRfY21kCiAgICBsb2NhbCByYXdfbGVuPSR7I2NvbW1hbmR9CiAgICBzYW5pdGl6ZWRfY21kPSQocHJpbnRmICclcycgIiRjb21tYW5kIiB8IHRyICdcclxuJyAnICAnIHwgc2VkICdzL3wvXFx8L2cnIHwgaGVhZCAtYyAyMDApCiAgICBpZiBbICIkcmF3X2xlbiIgLWd0IDIwMCBdOyB0aGVuCiAgICAgICAgc2FuaXRpemVkX2NtZD0iJHtzYW5pdGl6ZWRfY21kfS4uLiIKICAgIGZpCiAgICAKICAgICMgV3JpdGUgdG8gbG9nIGZpbGUgKGZvcm1hdDogdGltZXN0YW1wfHVzZXJ8ZXZlbnR8ZXhpdF9jb2RlfGNvbW1hbmQpCiAgICBwcmludGYgJyVzfCVzfCVzfCVzfCVzXG4nICIke3RpbWVzdGFtcH0iICIke1VTRVI6LXVua25vd259IiAiJHtldmVudH0iICIke2V4aXRfY29kZX0iICIke3Nhbml0aXplZF9jbWR9IiA+PiAiJGxvZ19maWxlIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICAKICAgICMgU2VjdXJlIHRoZSBsb2cgZmlsZQogICAgY2htb2QgNjAwICIkbG9nX2ZpbGUiIDI+L2Rldi9udWxsIHx8IHRydWUKfQoKIyBIZWxwZXIgdG8gZmluZCB0aGUgdXNlcidzIHNoZWxsIHByb2ZpbGUgZmlsZQpfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKCkgewogICAgaWYgWyAtbiAiJHtTSEVMTDotfSIgXSAmJiBlY2hvICIkU0hFTEwiIHwgZ3JlcCAtcSAienNoIjsgdGhlbgogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtbiAiJHtTSEVMTDotfSIgXSAmJiBlY2hvICIkU0hFTEwiIHwgZ3JlcCAtcSAiYmFzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uYmFzaHJjIgogICAgZWxpZiBbIC1mICIkSE9NRS8ucHJvZmlsZSIgXTsgdGhlbgogICAgICAgICMgRmFsbGJhY2sgZm9yIHNoLCBrc2gsIGV0Yy4KICAgICAgICBlY2hvICIkSE9NRS8ucHJvZmlsZSIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnpzaHJjIiBdOyB0aGVuCiAgICAgICAgIyBGYWxsYmFjayBpZiBTSEVMTCB2YXIgaXNuJ3Qgc2V0CiAgICAgICAgZWNobyAiJEhPTUUvLnpzaHJjIgogICAgZWxpZiBbIC1mICIkSE9NRS8uYmFzaHJjIiBdOyB0aGVuCiAgICAgICAgIyBGYWxsYmFjayBpZiBTSEVMTCB2YXIgaXNuJ3Qgc2V0CiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsc2UKICAgICAgICBlY2hvICJ1bmtub3duX3Byb2ZpbGUiCiAgICBmaQp9CgojIC0tLSDns7vnu5/kv6Hmga/mlLbpm4YgLS0tCiMgQ2FjaGUgZmlsZSBmb3Igc3RhdGljIHN5c3RlbSBpbmZvcm1hdGlvbiAocGVyc2lzdGVkIGFjcm9zcyBydW5zKQojIE9ubHkgZGVmaW5lIGlmIG5vdCBhbHJlYWR5IHNldCAocHJldmVudHMgcmVhZC1vbmx5IHZhcmlhYmxlIGVycm9ycykKaWYgWyAteiAiJHtGVUNLX1NZU0lORk9fQ0FDSEVfRklMRTotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEU9IiRJTlNUQUxMX0RJUi8uc3lzaW5mby5jYWNoZSIKZmkKIyBDYWNoZSBzdGF0ZSB0cmFja2luZyB2YXJpYWJsZXMKX0ZVQ0tfU1RBVElDX0NBQ0hFX0xPQURFRD0wCl9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWT0wCgojIExvYWRzIHN0YXRpYyBzeXN0ZW0gaW5mb3JtYXRpb24gZnJvbSBjYWNoZSBmaWxlCiMgR2xvYmFsczogX0ZVQ0tfU1RBVElDX0NBQ0hFX0xPQURFRCwgRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUKX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUoKSB7CiAgICAjIFJldHVybiBlYXJseSBpZiBjYWNoZSBpcyBhbHJlYWR5IGxvYWRlZAogICAgaWYgWyAiJHtfRlVDS19TVEFUSUNfQ0FDSEVfTE9BREVEOi0wfSIgLWVxIDEgXTsgdGhlbgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIF9GVUNLX1NUQVRJQ19DQUNIRV9MT0FERUQ9MQoKICAgICMgU291cmNlIGNhY2hlIGZpbGUgaWYgaXQgZXhpc3RzCiAgICBpZiBbIC1mICIkRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUiIF07IHRoZW4KICAgICAgICAjIHNoZWxsY2hlY2sgZGlzYWJsZT1TQzEwOTAKICAgICAgICBzb3VyY2UgIiRGVUNLX1NZU0lORk9fQ0FDSEVfRklMRSIgfHwgdHJ1ZQogICAgZmkKfQoKIyBNYXJrcyBzdGF0aWMgY2FjaGUgYXMgZGlydHkgKG5lZWRzIHRvIGJlIHBlcnNpc3RlZCkKIyBHbG9iYWxzOiBfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFkKX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkoKSB7CiAgICBfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFk9MQp9CgojIFBlcnNpc3RzIHN0YXRpYyBzeXN0ZW0gaW5mb3JtYXRpb24gdG8gY2FjaGUgZmlsZQojIEdsb2JhbHM6IF9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWSwgRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUKIyBSZXR1cm5zOiAwIG9uIHN1Y2Nlc3MsIDEgb24gZmFpbHVyZQpfZnVja19wZXJzaXN0X3N0YXRpY19jYWNoZSgpIHsKICAgICMgT25seSBwZXJzaXN0IGlmIGNhY2hlIGlzIGRpcnR5CiAgICBpZiBbICIke19GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWTotMH0iIC1uZSAxIF07IHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICAjIEVuc3VyZSBjYWNoZSBkaXJlY3RvcnkgZXhpc3RzCiAgICBsb2NhbCBjYWNoZV9kaXIKICAgIGNhY2hlX2Rpcj0kKGRpcm5hbWUgIiRGVUNLX1NZU0lORk9fQ0FDSEVfRklMRSIpCiAgICBpZiAhIG1rZGlyIC1wICIkY2FjaGVfZGlyIiAyPi9kZXYvbnVsbDsgdGhlbgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgICMgQ3JlYXRlIHRlbXBvcmFyeSBmaWxlIGZvciBhdG9taWMgd3JpdGUKICAgIGxvY2FsIHRtcF9maWxlCiAgICB0bXBfZmlsZT0kKG1rdGVtcCkgfHwgcmV0dXJuIDEKCiAgICAjIFdyaXRlIGNhY2hlZCB2YXJpYWJsZXMgdG8gdGVtcG9yYXJ5IGZpbGUKICAgIHsKICAgICAgICBwcmludGYgJ19GVUNLX0NBQ0hFRF9ESVNUUk89JXFcXG4nICIke19GVUNLX0NBQ0hFRF9ESVNUUk86LX0iCiAgICAgICAgcHJpbnRmICdfRlVDS19DQUNIRURfS0VSTkVMPSVxXFxuJyAiJHtfRlVDS19DQUNIRURfS0VSTkVMOi19IgogICAgICAgIHByaW50ZiAnX0ZVQ0tfQ0FDSEVEX0FSQ0g9JXFcXG4nICIke19GVUNLX0NBQ0hFRF9BUkNIOi19IgogICAgICAgIHByaW50ZiAnX0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSPSVxXFxuJyAiJHtfRlVDS19DQUNIRURfUEtHX01BTkFHRVI6LX0iCiAgICB9ID4gIiR0bXBfZmlsZSIKCiAgICAjIEF0b21pYyBtb3ZlIHRvIGZpbmFsIGxvY2F0aW9uCiAgICBpZiBtdiAiJHRtcF9maWxlIiAiJEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFIiAyPi9kZXYvbnVsbDsgdGhlbgogICAgICAgIF9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWT0wCiAgICAgICAgcmV0dXJuIDAKICAgIGVsc2UKICAgICAgICAjIENsZWFuIHVwIHRlbXBvcmFyeSBmaWxlIG9uIGZhaWx1cmUKICAgICAgICBybSAtZiAiJHRtcF9maWxlIgogICAgICAgIHJldHVybiAxCiAgICBmaQp9CgojIERldGVjdHMgdGhlIGRpc3RyaWJ1dGlvbi9PUyBmYW1pbHkgd2l0aCBjYWNoaW5nIHN1cHBvcnQKIyBPdXRwdXRzOiBEaXN0cmlidXRpb24gc3RyaW5nIChlLmcuLCAiRGViaWFuLWJhc2VkIDEyLjA0IChVYnVudHUgMjQuMDQgTFRTKSIpCl9mdWNrX2RldGVjdF9kaXN0cm8oKSB7CiAgICBfZnVja19sb2FkX3N0YXRpY19jYWNoZQoKICAgICMgUmV0dXJuIGNhY2hlZCB2YWx1ZSBpZiBhdmFpbGFibGUKICAgIGlmIFsgLW4gIiR7X0ZVQ0tfQ0FDSEVEX0RJU1RSTzotfSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRfRlVDS19DQUNIRURfRElTVFJPIgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGxvY2FsIGtlcm5lbF9uYW1lIGRpc3RybyBpZCB2ZXJzaW9uIHByZXR0eSBmYW1pbHkKICAgIGtlcm5lbF9uYW1lPSQodW5hbWUgLXMgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGRpc3Rybz0idW5rbm93biIKCiAgICAjIG1hY09TIGRldGVjdGlvbgogICAgaWYgWyAiJGtlcm5lbF9uYW1lIiA9ICJEYXJ3aW4iIF07IHRoZW4KICAgICAgICBsb2NhbCBwcm9kdWN0IHZlcnNpb24KICAgICAgICBwcm9kdWN0PSQoc3dfdmVycyAtcHJvZHVjdE5hbWUgMj4vZGV2L251bGwgfHwgcHJpbnRmICdtYWNPUycpCiAgICAgICAgcHJvZHVjdD0kKHByaW50ZiAnJXMnICIkcHJvZHVjdCIgfCB0ciAtZCAnXHJcbicpCiAgICAgICAgdmVyc2lvbj0kKHN3X3ZlcnMgLXByb2R1Y3RWZXJzaW9uIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICAgICAgdmVyc2lvbj0kKHByaW50ZiAnJXMnICIkdmVyc2lvbiIgfCB0ciAtZCAnXHJcbicpCiAgICAgICAgZGlzdHJvPSIkcHJvZHVjdCAkdmVyc2lvbiIKICAgICMgTGludXggZGV0ZWN0aW9uIHVzaW5nIC9ldGMvb3MtcmVsZWFzZQogICAgZWxpZiBbIC1yIC9ldGMvb3MtcmVsZWFzZSBdOyB0aGVuCiAgICAgICAgaWQ9JChncmVwIC1FICdeSUQ9JyAvZXRjL29zLXJlbGVhc2UgfCBoZWFkIC1uMSB8IGN1dCAtZD0gLWYyIHwgdHIgLWQgJyInIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCiAgICAgICAgdmVyc2lvbj0kKGdyZXAgLUUgJ15WRVJTSU9OX0lEPScgL2V0Yy9vcy1yZWxlYXNlIHwgaGVhZCAtbjEgfCBjdXQgLWQ9IC1mMiB8IHRyIC1kICciJykKICAgICAgICBwcmV0dHk9JChncmVwIC1FICdeUFJFVFRZX05BTUU9JyAvZXRjL29zLXJlbGVhc2UgfCBoZWFkIC1uMSB8IGN1dCAtZD0gLWYyLSB8IHRyIC1kICciJykKCiAgICAgICAgIyBEZXRlcm1pbmUgT1MgZmFtaWx5IGZvciBiZXR0ZXIgY2F0ZWdvcml6YXRpb24KICAgICAgICBmYW1pbHk9IiIKICAgICAgICBjYXNlICIkaWQiIGluCiAgICAgICAgICAgIHVidW50dXxkZWJpYW4pCiAgICAgICAgICAgICAgICBmYW1pbHk9IkRlYmlhbi1iYXNlZCIKICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgIGNlbnRvc3xyaGVsfHJvY2t5fGFsbWFsaW51eHxmZWRvcmEpCiAgICAgICAgICAgICAgICBmYW1pbHk9IlJIRUwtYmFzZWQiCiAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBhcmNofG1hbmphcm98ZW5kZWF2b3Vyb3MpCiAgICAgICAgICAgICAgICBmYW1pbHk9IkFyY2gtYmFzZWQiCiAgICAgICAgICAgICAgICA7OwogICAgICAgIGVzYWMKCiAgICAgICAgIyBGb3JtYXQgZGlzdHJpYnV0aW9uIHN0cmluZyB3aXRoIGZhbWlseSBhbmQgdmVyc2lvbgogICAgICAgIGlmIFsgLW4gIiRmYW1pbHkiIF07IHRoZW4KICAgICAgICAgICAgZGlzdHJvPSIkZmFtaWx5ICR7dmVyc2lvbjotfSIKICAgICAgICAgICAgaWYgWyAtbiAiJHByZXR0eSIgXTsgdGhlbgogICAgICAgICAgICAgICAgZGlzdHJvPSIkZGlzdHJvICgke3ByZXR0eX0pIgogICAgICAgICAgICBmaQogICAgICAgIGVsc2UKICAgICAgICAgICAgZGlzdHJvPSIke3ByZXR0eTotTGludXggJHZlcnNpb259IgogICAgICAgIGZpCiAgICBlbHNlCiAgICAgICAgZGlzdHJvPSIka2VybmVsX25hbWUiCiAgICBmaQoKICAgICMgQ2FjaGUgYW5kIHJldHVybiByZXN1bHQKICAgIF9GVUNLX0NBQ0hFRF9ESVNUUk89IiRkaXN0cm8iCiAgICBfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eQogICAgcHJpbnRmICclc1xuJyAiJGRpc3RybyIKfQoKIyBHZXRzIGtlcm5lbCB2ZXJzaW9uIGluZm9ybWF0aW9uIHdpdGggY2FjaGluZwojIE91dHB1dHM6IEtlcm5lbCB2ZXJzaW9uIHN0cmluZyAoZS5nLiwgIkxpbnV4IDYuOC4wLTMxLWdlbmVyaWMiKQpfZnVja19nZXRfa2VybmVsX3ZlcnNpb24oKSB7CiAgICBfZnVja19sb2FkX3N0YXRpY19jYWNoZQoKICAgICMgUmV0dXJuIGNhY2hlZCB2YWx1ZSBpZiBhdmFpbGFibGUKICAgIGlmIFsgLW4gIiR7X0ZVQ0tfQ0FDSEVEX0tFUk5FTDotfSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRfRlVDS19DQUNIRURfS0VSTkVMIgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGxvY2FsIGtlcm5lbAogICAga2VybmVsPSQodW5hbWUgLXNyIDI+L2Rldi9udWxsIHx8IHVuYW1lIC1zIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBrZXJuZWw9JChwcmludGYgJyVzJyAiJGtlcm5lbCIgfCB0ciAtZCAnXHJcbicpCgogICAgIyBDYWNoZSBhbmQgcmV0dXJuIHJlc3VsdAogICAgX0ZVQ0tfQ0FDSEVEX0tFUk5FTD0iJGtlcm5lbCIKICAgIF9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5CiAgICBwcmludGYgJyVzXG4nICIka2VybmVsIgp9CgojIEdldHMgc3lzdGVtIGFyY2hpdGVjdHVyZSB3aXRoIGNhY2hpbmcKIyBPdXRwdXRzOiBBcmNoaXRlY3R1cmUgc3RyaW5nIChlLmcuLCAieDg2XzY0IiwgImFybTY0IikKX2Z1Y2tfZ2V0X2FyY2hpdGVjdHVyZSgpIHsKICAgIF9mdWNrX2xvYWRfc3RhdGljX2NhY2hlCgogICAgIyBSZXR1cm4gY2FjaGVkIHZhbHVlIGlmIGF2YWlsYWJsZQogICAgaWYgWyAtbiAiJHtfRlVDS19DQUNIRURfQVJDSDotfSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRfRlVDS19DQUNIRURfQVJDSCIKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBsb2NhbCBhcmNoCiAgICBhcmNoPSQodW5hbWUgLW0gMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGFyY2g9JChwcmludGYgJyVzJyAiJGFyY2giIHwgdHIgLWQgJ1xyXG4nKQoKICAgICMgQ2FjaGUgYW5kIHJldHVybiByZXN1bHQKICAgIF9GVUNLX0NBQ0hFRF9BUkNIPSIkYXJjaCIKICAgIF9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5CiAgICBwcmludGYgJyVzXG4nICIkYXJjaCIKfQoKIyBDb2xsZWN0cyB1c2VyIGluZm9ybWF0aW9uIGluY2x1ZGluZyBwZXJtaXNzaW9ucwojIE91dHB1dHM6IFVzZXIgaW5mbyBzdHJpbmcgKGUuZy4sICJVc2VyPWpvaG4gdWlkPTEwMDAgbGV2ZWw9c3Vkb2VyIEdyb3Vwcz1qb2huIGFkbSBzdWRvIikKX2Z1Y2tfY29sbGVjdF91c2VyX2luZm8oKSB7CiAgICBsb2NhbCBjdXJyZW50X3VzZXIgdWlkIGdyb3VwcyBsZXZlbAogICAgY3VycmVudF91c2VyPSIke1VTRVI6LX0iCgogICAgIyBGYWxsYmFjayBpZiBVU0VSIGlzIG5vdCBzZXQKICAgIGlmIFsgLXogIiRjdXJyZW50X3VzZXIiIF07IHRoZW4KICAgICAgICBjdXJyZW50X3VzZXI9JCh3aG9hbWkgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGZpCgogICAgIyBHZXQgVUlEIGFuZCBncm91cHMgaWYgaWQgY29tbWFuZCBpcyBhdmFpbGFibGUKICAgIHVpZD0idW5rbm93biIKICAgIGdyb3Vwcz0idW5rbm93biIKICAgIGlmIGNvbW1hbmQgLXYgaWQgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgdWlkPSQoaWQgLXUgIiRjdXJyZW50X3VzZXIiIDI+L2Rldi9udWxsIHx8IGlkIC11IDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICAgICAgZ3JvdXBzPSQoaWQgLUduICIkY3VycmVudF91c2VyIiAyPi9kZXYvbnVsbCB8fCBpZCAtR24gMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGZpCgogICAgIyBEZXRlcm1pbmUgcGVybWlzc2lvbiBsZXZlbAogICAgbGV2ZWw9InVzZXIiCiAgICBpZiBbICIkdWlkIiA9ICIwIiBdOyB0aGVuCiAgICAgICAgbGV2ZWw9InJvb3QiCiAgICBlbGlmIHByaW50ZiAnJXMnICIkZ3JvdXBzIiB8IGdyZXAgLUVxICcoXnxbWzpzcGFjZTpdXSkoc3Vkb3x3aGVlbHxhZG1pbikoW1s6c3BhY2U6XV18JCknOyB0aGVuCiAgICAgICAgbGV2ZWw9InN1ZG9lciIKICAgIGZpCgogICAgcHJpbnRmICdVc2VyPSVzIHVpZD0lcyBsZXZlbD0lcyBHcm91cHM9JXMnICIkY3VycmVudF91c2VyIiAiJHVpZCIgIiRsZXZlbCIgIiRncm91cHMiCn0KCiMgQ29sbGVjdHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmb3IgY29tbW9uIGRldmVsb3BtZW50IHRvb2xzCiMgT3V0cHV0czogVG9vbCB2ZXJzaW9ucyBzdHJpbmcgKGUuZy4sICJnaXQ6Z2l0IHZlcnNpb24gMi4zNC4xOyBkb2NrZXI6RG9ja2VyIHZlcnNpb24gMjQuMC42OyAuLi4iKQpfZnVja19jb2xsZWN0X3Rvb2xfdmVyc2lvbnMoKSB7CiAgICBsb2NhbCB0b29scyB0b29sIHZlcnNpb24gcmVzdWx0CiAgICB0b29scz0iZ2l0IGRvY2tlciBucG0ga3ViZWN0bCBjdXJsIHdnZXQiCiAgICByZXN1bHQ9IiIKCiAgICBmb3IgdG9vbCBpbiAkdG9vbHM7IGRvCiAgICAgICAgdmVyc2lvbj0ibm90LWluc3RhbGxlZCIKCiAgICAgICAgaWYgY29tbWFuZCAtdiAiJHRvb2wiID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgICAgICBjYXNlICIkdG9vbCIgaW4KICAgICAgICAgICAgICAgIGdpdHxkb2NrZXJ8Y3VybHx3Z2V0KQogICAgICAgICAgICAgICAgICAgIHZlcnNpb249JCgiJHRvb2wiIC0tdmVyc2lvbiAyPi9kZXYvbnVsbCB8IGhlYWQgLW4xKQogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICBucG0pCiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbj0kKCIkdG9vbCIgLS12ZXJzaW9uIDI+L2Rldi9udWxsIHwgaGVhZCAtbjEpCiAgICAgICAgICAgICAgICAgICAgWyAtbiAiJHZlcnNpb24iIF0gJiYgdmVyc2lvbj0ibnBtICR2ZXJzaW9uIgogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICBrdWJlY3RsKQogICAgICAgICAgICAgICAgICAgIHZlcnNpb249JCgiJHRvb2wiIHZlcnNpb24gLS1jbGllbnQgLS1zaG9ydCAyPi9kZXYvbnVsbCB8IGhlYWQgLW4xKQogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgIGVzYWMKICAgICAgICBmaQoKICAgICAgICAjIENsZWFuIHVwIHZlcnNpb24gc3RyaW5nCiAgICAgICAgdmVyc2lvbj0kKHByaW50ZiAnJXMnICIke3ZlcnNpb246LXVua25vd259IiB8IHRyICdcclxuJyAnICAnIHwgdHIgLXMgJyAnIHwgc2VkIC1lICdzL14gKi8vJyAtZSAncy8gKiQvLycpCiAgICAgICAgWyAteiAiJHZlcnNpb24iIF0gJiYgdmVyc2lvbj0idW5rbm93biIKCiAgICAgICAgcmVzdWx0PSIkcmVzdWx0JHRvb2w6JHZlcnNpb247ICIKICAgIGRvbmUKCiAgICAjIFJlbW92ZSB0cmFpbGluZyBzZW1pY29sb24gYW5kIHNwYWNlCiAgICByZXN1bHQ9IiR7cmVzdWx0JTsgfSIKICAgIHByaW50ZiAnJXMnICIkcmVzdWx0Igp9CgojIERldGVjdHMgdGhlIHBhY2thZ2UgbWFuYWdlciB3aXRoIGNhY2hpbmcgc3VwcG9ydAojIE91dHB1dHM6IFBhY2thZ2UgbWFuYWdlciBuYW1lIChhcHQsIHl1bSwgZG5mLCBwYWNtYW4sIHp5cHBlciwgYnJldywgdW5rbm93bikKX2Z1Y2tfZGV0ZWN0X3BrZ19tYW5hZ2VyKCkgewogICAgX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUKCiAgICAjIFJldHVybiBjYWNoZWQgdmFsdWUgaWYgYXZhaWxhYmxlCiAgICBpZiBbIC1uICIke19GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUjotfSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRfRlVDS19DQUNIRURfUEtHX01BTkFHRVIiCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgbG9jYWwgbWFuYWdlcj0idW5rbm93biIKCiAgICAjIERldGVjdCBwYWNrYWdlIG1hbmFnZXIgaW4gb3JkZXIgb2YgcHJlZmVyZW5jZQogICAgaWYgY29tbWFuZCAtdiBhcHQtZ2V0ICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9ImFwdCIKICAgIGVsaWYgY29tbWFuZCAtdiB5dW0gJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0ieXVtIgogICAgZWxpZiBjb21tYW5kIC12IGRuZiAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJkbmYiCiAgICBlbGlmIGNvbW1hbmQgLXYgcGFjbWFuICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9InBhY21hbiIKICAgIGVsaWYgY29tbWFuZCAtdiB6eXBwZXIgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0ienlwcGVyIgogICAgZWxpZiBjb21tYW5kIC12IGJyZXcgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0iYnJldyIKICAgIGZpCgogICAgIyBDYWNoZSBhbmQgcmV0dXJuIHJlc3VsdAogICAgX0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSPSIkbWFuYWdlciIKICAgIF9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5CiAgICBwcmludGYgJyVzXG4nICIkbWFuYWdlciIKfQoKIyBDb2xsZWN0cyBzaW1wbGlmaWVkIHN5c3RlbSBpbmZvcm1hdGlvbiBhcyBhIHN0cnVjdHVyZWQgc3RyaW5nCiMgT3V0cHV0czogU3lzdGVtIGluZm8gc3RyaW5nIGZvciBBSSBwcm9jZXNzaW5nCl9mdWNrX2NvbGxlY3Rfc3lzaW5mb19zdHJpbmcoKSB7CiAgICBsb2NhbCBvc190eXBlIGtlcm5lbF9uYW1lIHBrZ19tYW5hZ2VyIHN1bW1hcnkKCiAgICAjIERldGVjdCBvcGVyYXRpbmcgc3lzdGVtIHR5cGUKICAgIGtlcm5lbF9uYW1lPSQodW5hbWUgLXMgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKCiAgICBjYXNlICIka2VybmVsX25hbWUiIGluCiAgICAgICAgRGFyd2luKQogICAgICAgICAgICBvc190eXBlPSJtYWNPUyIKICAgICAgICAgICAgcGtnX21hbmFnZXI9ImJyZXciCiAgICAgICAgICAgIDs7CiAgICAgICAgTGludXgpCiAgICAgICAgICAgIGlmIFsgLXIgL2V0Yy9vcy1yZWxlYXNlIF07IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGlkCiAgICAgICAgICAgICAgICBpZD0kKGdyZXAgLUUgJ15JRD0nIC9ldGMvb3MtcmVsZWFzZSB8IGhlYWQgLW4xIHwgY3V0IC1kPSAtZjIgfCB0ciAtZCAnIicgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKICAgICAgICAgICAgICAgIGNhc2UgIiRpZCIgaW4KICAgICAgICAgICAgICAgICAgICB1YnVudHV8ZGViaWFuKQogICAgICAgICAgICAgICAgICAgICAgICBvc190eXBlPSJEZWJpYW4iCiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJhcHQiCiAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgY2VudG9zfHJoZWx8cm9ja3l8YWxtYWxpbnV4fGZlZG9yYSkKICAgICAgICAgICAgICAgICAgICAgICAgb3NfdHlwZT0iUkhFTCIKICAgICAgICAgICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9Inl1bSIKICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICAgICBhcmNofG1hbmphcm8pCiAgICAgICAgICAgICAgICAgICAgICAgIG9zX3R5cGU9IkFyY2giCiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJwYWNtYW4iCiAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgKikKICAgICAgICAgICAgICAgICAgICAgICAgb3NfdHlwZT0iTGludXgiCiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ1bmtub3duIgogICAgICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgZXNhYwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBvc190eXBlPSJMaW51eCIKICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ1bmtub3duIgogICAgICAgICAgICBmaQogICAgICAgICAgICA7OwogICAgICAgIE1JTkdXKnxNU1lTKnxDWUdXSU4qKQogICAgICAgICAgICBvc190eXBlPSJXaW5kb3dzIgogICAgICAgICAgICBwa2dfbWFuYWdlcj0idW5rbm93biIKICAgICAgICAgICAgOzsKICAgICAgICAqKQogICAgICAgICAgICBvc190eXBlPSIka2VybmVsX25hbWUiCiAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ1bmtub3duIgogICAgICAgICAgICA7OwogICAgZXNhYwoKICAgICMgRm9ybWF0IGFzIHNpbXBsZSBzdHJ1Y3R1cmVkIHN0cmluZwogICAgcHJpbnRmIC12IHN1bW1hcnkgJ09TPSVzOyBQa2dNZ3I9JXMnICIkb3NfdHlwZSIgIiRwa2dfbWFuYWdlciIKICAgIHByaW50ZiAnJXNcbicgIiRzdW1tYXJ5Igp9CgojIEVzY2FwZXMgYSBzdHJpbmcgZm9yIHVzZSBpbiBhIEpTT04gcGF5bG9hZApfZnVja19qc29uX2VzY2FwZSgpIHsKICAgIGxvY2FsIGlucHV0PSIkMSIKICAgICMgVXNlIHByaW50ZiB0byBwcm9wZXJseSBoYW5kbGUgY29udHJvbCBjaGFyYWN0ZXJzCiAgICBwcmludGYgJyVzJyAiJGlucHV0IiB8IHNlZCAtZSAnCiAgICAgICAgIyBGaXJzdCBlc2NhcGUgYmFja3NsYXNoZXMgKG11c3QgYmUgZmlyc3QpCiAgICAgICAgcy9cXC9cXFxcL2cKICAgICAgICAjIEVzY2FwZSBkb3VibGUgcXVvdGVzCiAgICAgICAgcy8iL1xcIi9nCiAgICAgICAgIyBFc2NhcGUgY29udHJvbCBjaGFyYWN0ZXJzIChBU0NJSSAwLTMxKQogICAgICAgIHMvXHgwMC9cXHUwMDAwL2cKICAgICAgICBzL1x4MDEvXFx1MDAwMS9nCiAgICAgICAgcy9ceDAyL1xcdTAwMDIvZwogICAgICAgIHMvXHgwMy9cXHUwMDAzL2cKICAgICAgICBzL1x4MDQvXFx1MDAwNC9nCiAgICAgICAgcy9ceDA1L1xcdTAwMDUvZwogICAgICAgIHMvXHgwNi9cXHUwMDA2L2cKICAgICAgICBzL1x4MDcvXFx1MDAwNy9nCiAgICAgICAgcy9ceDA4L1xcYi9nCiAgICAgICAgcy9ceDA5L1xcdC9nCiAgICAgICAgcy9ceDBBL1xcbi9nCiAgICAgICAgcy9ceDBCL1xcdTAwMEIvZwogICAgICAgIHMvXHgwQy9cXGYvZwogICAgICAgIHMvXHgwRC9cXHIvZwogICAgICAgIHMvXHgwRS9cXHUwMDBFL2cKICAgICAgICBzL1x4MEYvXFx1MDAwRi9nCiAgICAgICAgcy9ceDEwL1xcdTAwMTAvZwogICAgICAgIHMvXHgxMS9cXHUwMDExL2cKICAgICAgICBzL1x4MTIvXFx1MDAxMi9nCiAgICAgICAgcy9ceDEzL1xcdTAwMTMvZwogICAgICAgIHMvXHgxNC9cXHUwMDE0L2cKICAgICAgICBzL1x4MTUvXFx1MDAxNS9nCiAgICAgICAgcy9ceDE2L1xcdTAwMTYvZwogICAgICAgIHMvXHgxNy9cXHUwMDE3L2cKICAgICAgICBzL1x4MTgvXFx1MDAxOC9nCiAgICAgICAgcy9ceDE5L1xcdTAwMTkvZwogICAgICAgIHMvXHgxQS9cXHUwMDFBL2cKICAgICAgICBzL1x4MUIvXFx1MDAxQi9nCiAgICAgICAgcy9ceDFDL1xcdTAwMUMvZwogICAgICAgIHMvXHgxRC9cXHUwMDFEL2cKICAgICAgICBzL1x4MUUvXFx1MDAxRS9nCiAgICAgICAgcy9ceDFGL1xcdTAwMUYvZwogICAgJwp9CgpfZnVja19zaG91bGRfdXNlX2xvY2FsX2FwaSgpIHsKICAgIGlmIFsgLW4gIiR7RlVDS19PUEVOQUlfQVBJX0tFWTotfSIgXTsgdGhlbgogICAgICAgIHJldHVybiAwCiAgICBmaQogICAgcmV0dXJuIDEKfQoKX2Z1Y2tfbG9jYWxfc3lzdGVtX3Byb21wdCgpIHsKICAgIGxvY2FsIHN5c2luZm89IiQxIgogICAgaWYgWyAiJEZVQ0tJVFNfTE9DQUxFIiA9ICJ6aCIgXTsgdGhlbgogICAgICAgIHByaW50ZiAn5L2g5piv5LiA5Liq5LiT5Lia55qEIHNoZWxsIOWRveS7pOeUn+aIkOWZqOOAgueUqOaIt+S8mueUqOiHqueEtuivreiogOaPj+i/sOS7luS7rOaDs+imgeWujOaIkOeahOS7u+WKoeOAguS9oOeahOS7u+WKoeaYr+eUn+aIkOebtOaOpeWPr+aJp+ihjOeahCBzaGVsbCDlkb3ku6TmnaXlrozmiJDnlKjmiLfnmoTnm67moIfjgIIKCumHjeimgeinhOWIme+8mgoxLiDnlKjmiLfovpPlhaXmmK/oh6rnhLbor63oqIDmj4/ov7DmhI/lm77vvIzkuI3mmK/lkb3ku6Tlj4LmlbDjgILkvovlpoIi5YiX5Ye655uu5b2VIuaEj+aAneaYr+aJp+ihjCBscyDlkb3ku6TvvIzogIzkuI3mmK8gbHMgIuWIl+WHuuebruW9lSIKMi4g55Sf5oiQ55u05o6l5Y+v5omn6KGM55qE5ZG95Luk77yM5LiN6KaB55Sf5oiQ5bim5Y+C5pWw5Yik5pat55qE6ISa5pys5qih5p2/77yI5aaCIGlmIFsgJCMgLWVxIDAgXe+8iQozLiDlr7nkuo7nroDljZXku7vliqHnm7TmjqXov5Tlm57ljZXmnaHlkb3ku6TvvIzlpI3mnYLku7vliqHlj6/ku6XmmK/lpJrooYzohJrmnKwKNC4g5LiN6KaB5o+Q5L6b5Lu75L2V6Kej6YeK44CB5rOo6YeK44CBbWFya2Rvd24g5qC85byP77yI5q+U5aaCIGBgYGJhc2jvvInmiJYgc2hlYmFuZ++8iOS+i+WmgiAjIS9iaW4vYmFzaO+8iQoK56S65L6L77yaCi0g55So5oi36K+0IuWIl+WHuuebruW9lSIg4oaSIOi+k+WHujogbHMKLSDnlKjmiLfor7Qi5pi+56S66K+m57uG5paH5Lu25YiX6KGoIiDihpIg6L6T5Ye6OiBscyAtbGEKLSDnlKjmiLfor7Qi5p+l5om+5aSn5LqOMTBNQueahOaWh+S7tiIg4oaSIOi+k+WHujogZmluZCAuIC10eXBlIGYgLXNpemUgKzEwTQoK55So5oi355qE57O757uf5L+h5oGv5piv77yaJXMnICIkc3lzaW5mbyIKICAgIGVsc2UKICAgICAgICBwcmludGYgJ1lvdSBhcmUgYW4gZXhwZXJ0IHNoZWxsIGNvbW1hbmQgZ2VuZXJhdG9yLiBVc2VycyBkZXNjcmliZSB0YXNrcyBpbiBuYXR1cmFsIGxhbmd1YWdlLiBZb3VyIHRhc2sgaXMgdG8gZ2VuZXJhdGUgZGlyZWN0bHkgZXhlY3V0YWJsZSBzaGVsbCBjb21tYW5kcyB0byBhY2NvbXBsaXNoIHRoZWlyIGdvYWxzLgoKSW1wb3J0YW50IHJ1bGVzOgoxLiBVc2VyIGlucHV0IGlzIG5hdHVyYWwgbGFuZ3VhZ2UgaW50ZW50LCBOT1QgY29tbWFuZCBhcmd1bWVudHMuIEZvciBleGFtcGxlLCAibGlzdCBkaXJlY3RvcnkiIG1lYW5zIHJ1biBscywgbm90IGxzICJsaXN0IGRpcmVjdG9yeSIKMi4gR2VuZXJhdGUgZGlyZWN0bHkgZXhlY3V0YWJsZSBjb21tYW5kcywgbm90IHNjcmlwdCB0ZW1wbGF0ZXMgd2l0aCBwYXJhbWV0ZXIgaGFuZGxpbmcgKGxpa2UgaWYgWyAkIyAtZXEgMCBdKQozLiBGb3Igc2ltcGxlIHRhc2tzIHJldHVybiBzaW5nbGUgY29tbWFuZHMsIGNvbXBsZXggdGFza3MgY2FuIGJlIG11bHRpLWxpbmUgc2NyaXB0cwo0LiBEbyBub3QgcHJvdmlkZSBhbnkgZXhwbGFuYXRpb24sIGNvbW1lbnRzLCBtYXJrZG93biBmb3JtYXR0aW5nIChsaWtlIGBgYGJhc2gpLCBvciBhIHNoZWJhbmcgKGUuZy4sICMhL2Jpbi9iYXNoKQoKRXhhbXBsZXM6Ci0gVXNlciBzYXlzICJsaXN0IGRpcmVjdG9yeSIg4oaSIE91dHB1dDogbHMKLSBVc2VyIHNheXMgInNob3cgZGV0YWlsZWQgZmlsZSBsaXN0IiDihpIgT3V0cHV0OiBscyAtbGEKLSBVc2VyIHNheXMgImZpbmQgZmlsZXMgbGFyZ2VyIHRoYW4gMTBNQiIg4oaSIE91dHB1dDogZmluZCAuIC10eXBlIGYgLXNpemUgKzEwTQoKVGhlIHVzZXInIiciJ3Mgc3lzdGVtIGluZm8gaXM6ICVzJyAiJHN5c2luZm8iCiAgICBmaQp9CgpfZnVja19leHRyYWN0X2NvbW1hbmRfZnJvbV9qc29uKCkgewogICAgbG9jYWwganNvbl9maWxlPSIkMSIKICAgIGlmIGNvbW1hbmQgLXYgcHl0aG9uMyA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICBweXRob24zIC0gIiRqc29uX2ZpbGUiIDw8J1BZJwppbXBvcnQganNvbiwgc3lzCnBhdGggPSBzeXMuYXJndlsxXQp3aXRoIG9wZW4ocGF0aCwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOgogICAgZGF0YSA9IGpzb24ubG9hZChmKQpjaG9pY2VzID0gZGF0YS5nZXQoJ2Nob2ljZXMnKSBvciBbXQppZiBub3QgY2hvaWNlczoKICAgIHN5cy5leGl0KDEpCm1lc3NhZ2UgPSBjaG9pY2VzWzBdLmdldCgnbWVzc2FnZScpIG9yIHt9CmNvbnRlbnQgPSAobWVzc2FnZS5nZXQoJ2NvbnRlbnQnKSBvciAnJykuc3RyaXAoKQppZiBub3QgY29udGVudDoKICAgIHN5cy5leGl0KDEpCnByaW50KGNvbnRlbnQpClBZCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIGlmIGNvbW1hbmQgLXYgbm9kZSA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICBub2RlIC0gIiRqc29uX2ZpbGUiIDw8J0pTJwpjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7CmNvbnN0IHBhdGggPSBwcm9jZXNzLmFyZ3ZbMV07CmNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYXRoLCAndXRmOCcpKTsKY29uc3QgY2hvaWNlID0gKGRhdGEuY2hvaWNlcyAmJiBkYXRhLmNob2ljZXNbMF0pIHx8IHt9Owpjb25zdCBtZXNzYWdlID0gY2hvaWNlLm1lc3NhZ2UgfHwge307CmNvbnN0IGNvbnRlbnQgPSAobWVzc2FnZS5jb250ZW50IHx8ICcnKS50cmltKCk7CmlmICghY29udGVudCkgewogIHByb2Nlc3MuZXhpdCgxKTsKfQpjb25zb2xlLmxvZyhjb250ZW50KTsKSlMKICAgICAgICByZXR1cm4KICAgIGZpCgogICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1DYW5ub3QgcGFyc2UgQUkgcmVzcG9uc2UgYmVjYXVzZSBuZWl0aGVyIHB5dGhvbjMgbm9yIG5vZGUgaXMgYXZhaWxhYmxlLiR7Q19SRVNFVH0iID4mMgogICAgZWNobyAtZSAiJHtDX1lFTExPV31QbGVhc2UgaW5zdGFsbCBweXRob24zIG9yIG5vZGUgdG8gdXNlIGxvY2FsIEFQSSBtb2RlLiR7Q19SRVNFVH0iID4mMgogICAgcmV0dXJuIDEKfQoKX2Z1Y2tfcmVxdWVzdF9sb2NhbF9tb2RlbCgpIHsKICAgIGxvY2FsIHByb21wdD0iJDEiCiAgICBsb2NhbCBzeXNpbmZvPSIkMiIKICAgIGxvY2FsIGN1cmxfdGltZW91dD0iJDMiCgogICAgbG9jYWwgYXBpX2tleT0iJHtGVUNLX09QRU5BSV9BUElfS0VZOi19IgogICAgaWYgWyAteiAiJGFwaV9rZXkiIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfUxvY2FsIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQuIFNldCBGVUNLX09QRU5BSV9BUElfS0VZIGluIH4vLmZ1Y2svY29uZmlnLnNoLiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIG1vZGVsPSIke0ZVQ0tfT1BFTkFJX01PREVMOi1ncHQtNS1uYW5vfSIKICAgIGxvY2FsIGFwaV9iYXNlPSIke0ZVQ0tfT1BFTkFJX0FQSV9CQVNFOi1odHRwczovL2FwaS5vcGVuYWkuY29tL3YxfSIKICAgIGFwaV9iYXNlPSR7YXBpX2Jhc2UlL30KICAgIGxvY2FsIGFwaV91cmw9IiRhcGlfYmFzZS9jaGF0L2NvbXBsZXRpb25zIgoKICAgIF9mdWNrX2RlYnVnICJsb2NhbCBhcGkgYmFzZT0kYXBpX2Jhc2UiCiAgICBfZnVja19kZWJ1ZyAibG9jYWwgbW9kZWw9JG1vZGVsIgoKICAgIGxvY2FsIHN5c3RlbV9wcm9tcHQKICAgIHN5c3RlbV9wcm9tcHQ9JChfZnVja19sb2NhbF9zeXN0ZW1fcHJvbXB0ICIkc3lzaW5mbyIpCgogICAgbG9jYWwgZXNjYXBlZF9wcm9tcHQgZXNjYXBlZF9zeXN0ZW0KICAgIGVzY2FwZWRfcHJvbXB0PSQoX2Z1Y2tfanNvbl9lc2NhcGUgIiRwcm9tcHQiKQogICAgZXNjYXBlZF9zeXN0ZW09JChfZnVja19qc29uX2VzY2FwZSAiJHN5c3RlbV9wcm9tcHQiKQogICAgbG9jYWwgcGF5bG9hZAogICAgcGF5bG9hZD0kKHByaW50ZiAneyAibW9kZWwiOiAiJXMiLCAibWVzc2FnZXMiOiBbIHsicm9sZSI6InN5c3RlbSIsImNvbnRlbnQiOiIlcyJ9LCB7InJvbGUiOiJ1c2VyIiwiY29udGVudCI6IiVzIn0gXSwgIm1heF90b2tlbnMiOiAxMDI0LCAidGVtcGVyYXR1cmUiOiAwLjIgfScgXAogICAgICAgICIkbW9kZWwiICIkZXNjYXBlZF9zeXN0ZW0iICIkZXNjYXBlZF9wcm9tcHQiKQoKICAgIGxvY2FsIHRtcF9qc29uCiAgICB0bXBfanNvbj0kKG1rdGVtcCkgfHwgcmV0dXJuIDEKCiAgICBpZiAhIGN1cmwgLWZzUyAtLW1heC10aW1lICIkY3VybF90aW1lb3V0IiAiJGFwaV91cmwiIFwKICAgICAgICAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiBcCiAgICAgICAgLUggIkF1dGhvcml6YXRpb246IEJlYXJlciAkYXBpX2tleSIgXAogICAgICAgIC1kICIkcGF5bG9hZCIgPiAiJHRtcF9qc29uIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9TG9jYWwgQVBJIHJlcXVlc3QgZmFpbGVkLiR7Q19SRVNFVH0iID4mMgogICAgICAgIGNhdCAiJHRtcF9qc29uIiA+JjIKICAgICAgICBybSAtZiAiJHRtcF9qc29uIgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIGNvbW1hbmRfb3V0cHV0CiAgICBpZiAhIGNvbW1hbmRfb3V0cHV0PSQoX2Z1Y2tfZXh0cmFjdF9jb21tYW5kX2Zyb21fanNvbiAiJHRtcF9qc29uIik7IHRoZW4KICAgICAgICBybSAtZiAiJHRtcF9qc29uIgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9VW5hYmxlIHRvIHBhcnNlIGxvY2FsIG1vZGVsIHJlc3BvbnNlLiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIHJtIC1mICIkdG1wX2pzb24iCiAgICBwcmludGYgJyVzXG4nICIkY29tbWFuZF9vdXRwdXQiCn0KCl9mdWNrX3JlcXVlc3Rfd29ya2VyX21vZGVsKCkgewogICAgbG9jYWwgcHJvbXB0PSIkMSIKICAgIGxvY2FsIHN5c2luZm89IiQyIgogICAgbG9jYWwgY3VybF90aW1lb3V0PSIkMyIKICAgIGxvY2FsIHNwaW5uZXJfbGFiZWw9IiR7NDotfSIKCiAgICBsb2NhbCBhZG1pbl9rZXk9IiR7RlVDS19BRE1JTl9LRVk6LX0iCiAgICBsb2NhbCBhZG1pbl9zZWdtZW50PSIiCiAgICBpZiBbIC1uICIkYWRtaW5fa2V5IiBdOyB0aGVuCiAgICAgICAgYWRtaW5fc2VnbWVudD0kKHByaW50ZiAnLCAiYWRtaW5LZXkiOiAiJXMiJyAiJCggX2Z1Y2tfanNvbl9lc2NhcGUgIiRhZG1pbl9rZXkiICkiKQogICAgZmkKCiAgICBsb2NhbCBwYXlsb2FkCiAgICBwYXlsb2FkPSQocHJpbnRmICd7ICJzeXNpbmZvIjogIiVzIiwgInByb21wdCI6ICIlcyIlcyB9JyBcCiAgICAgICAgIiQoIF9mdWNrX2pzb25fZXNjYXBlICIkc3lzaW5mbyIgKSIgXAogICAgICAgICIkKCBfZnVja19qc29uX2VzY2FwZSAiJHByb21wdCIgKSIgXAogICAgICAgICIkYWRtaW5fc2VnbWVudCIpCgogICAgbG9jYWwgYXBpX3VybD0iJHtGVUNLX0FQSV9FTkRQT0lOVDotJERFRkFVTFRfQVBJX0VORFBPSU5UfSIKCiAgICBfZnVja19kZWJ1ZyAiQVBJIFVSTDogJGFwaV91cmwiCiAgICBfZnVja19kZWJ1ZyAiUGF5bG9hZDogJHBheWxvYWQiCiAgICBfZnVja19kZWJ1ZyAiVGltZW91dDogJGN1cmxfdGltZW91dCIKCiAgICBsb2NhbCB0bXBfcmVzcG9uc2UgdG1wX3N0YXR1cwogICAgdG1wX3Jlc3BvbnNlPSQobWt0ZW1wKQogICAgdG1wX3N0YXR1cz0kKG1rdGVtcCkKCiAgICAoCiAgICAgICAgY3VybCAtc1MgLS1tYXgtdGltZSAiJGN1cmxfdGltZW91dCIgLVggUE9TVCAiJGFwaV91cmwiIFwKICAgICAgICAgICAgLUggIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiIgXAogICAgICAgICAgICAtZCAiJHBheWxvYWQiIC1vICIkdG1wX3Jlc3BvbnNlIiAtdyAiJXtodHRwX2NvZGV9IiA+ICIkdG1wX3N0YXR1cyIKICAgICkgJgogICAgbG9jYWwgcGlkPSQhCgogICAgaWYgWyAtdCAyIF07IHRoZW4KICAgICAgICBfZnVja19zcGlubmVyICIkcGlkIiAiJHNwaW5uZXJfbGFiZWwiID4mMgogICAgZmkKCiAgICBsb2NhbCBjdXJsX2V4aXQ9MAogICAgaWYgISB3YWl0ICIkcGlkIjsgdGhlbgogICAgICAgIGN1cmxfZXhpdD0kPwogICAgZmkKCiAgICBsb2NhbCBodHRwX3N0YXR1cz0iIgogICAgaWYgWyAtZiAiJHRtcF9zdGF0dXMiIF07IHRoZW4KICAgICAgICBodHRwX3N0YXR1cz0kKHRyIC1kICdcclxuJyA8ICIkdG1wX3N0YXR1cyIpCiAgICAgICAgcm0gLWYgIiR0bXBfc3RhdHVzIgogICAgZmkKCiAgICBsb2NhbCByZXNwb25zZT0iIgogICAgaWYgWyAtZiAiJHRtcF9yZXNwb25zZSIgXTsgdGhlbgogICAgICAgIHJlc3BvbnNlPSQoY2F0ICIkdG1wX3Jlc3BvbnNlIikKICAgICAgICBybSAtZiAiJHRtcF9yZXNwb25zZSIKICAgIGZpCgogICAgaWYgWyAkY3VybF9leGl0IC1uZSAwIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfUZhaWxlZCB0byByZWFjaCB0aGUgc2hhcmVkIFdvcmtlci4ke0NfUkVTRVR9IiA+JjIKICAgICAgICBpZiBbIC1uICIkcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICAgICAgZWNobyAtZSAiJHtDX0RJTX0kcmVzcG9uc2Uke0NfUkVTRVR9IiA+JjIKICAgICAgICBmaQogICAgICAgIHJldHVybiAkY3VybF9leGl0CiAgICBmaQoKICAgIGlmIFsgLXogIiRodHRwX3N0YXR1cyIgXTsgdGhlbgogICAgICAgIGh0dHBfc3RhdHVzPTAKICAgIGZpCgogICAgaWYgWyAiJGh0dHBfc3RhdHVzIiAtZXEgNDI5IF0gJiYgcHJpbnRmICclcycgIiRyZXNwb25zZSIgfCBncmVwIC1xICdERU1PX0xJTUlUX0VYQ0VFREVEJzsgdGhlbgogICAgICAgIGxvY2FsIGxpbWl0CiAgICAgICAgbGltaXQ9JChwcmludGYgJyVzJyAiJHJlc3BvbnNlIiB8IHNlZCAtbiAncy8uKiJsaW1pdCI6W1s6c3BhY2U6XV0qXChbMC05XVwrXCkuKi9cMS9wJyB8IGhlYWQgLW4xKQogICAgICAgIGxvY2FsIHJlbWFpbmluZwogICAgICAgIHJlbWFpbmluZz0kKHByaW50ZiAnJXMnICIkcmVzcG9uc2UiIHwgc2VkIC1uICdzLy4qInJlbWFpbmluZyI6W1s6c3BhY2U6XV0qXChbMC05XVwrXCkuKi9cMS9wJyB8IGhlYWQgLW4xKQogICAgICAgIFsgLXogIiRsaW1pdCIgXSAmJiBsaW1pdD0xMAogICAgICAgIF9mdWNrX25vdGlmeV9kZW1vX2xpbWl0ICIkbGltaXQiICIkcmVtYWluaW5nIgogICAgICAgIHJldHVybiAyCiAgICBmaQoKICAgIGlmIFsgIiRodHRwX3N0YXR1cyIgLWdlIDQwMCBdIHx8IFsgLXogIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9U2hhcmVkIFdvcmtlciByZXR1cm5lZCBIVFRQICRodHRwX3N0YXR1cy4ke0NfUkVTRVR9IiA+JjIKICAgICAgICBpZiBbIC1uICIkcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICAgICAgZWNobyAtZSAiJHtDX0RJTX0kcmVzcG9uc2Uke0NfUkVTRVR9IiA+JjIKICAgICAgICBmaQogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIHByaW50ZiAnJXNcbicgIiRyZXNwb25zZSIKfQoKX2Z1Y2tfbm90aWZ5X2RlbW9fbGltaXQoKSB7CiAgICBsb2NhbCBkYWlseV9saW1pdD0iJHsxOi0xMH0iCiAgICBsb2NhbCByZW1haW5pbmc9IiR7MjotMH0iCgogICAgZWNobyAtZSAiJEZVQ0sgJHtDX1lFTExPV31TaGFyZWQgZGVtbyBxdW90YSBleGhhdXN0ZWQgKCR7ZGFpbHlfbGltaXR9IGNhbGxzIHBlciBkYXkpLiR7Q19SRVNFVH0iID4mMgogICAgY2FzZSAiJHJlbWFpbmluZyIgaW4KICAgICAgICAnJ3wqWyEwLTldKikgOzsKICAgICAgICAqKQogICAgICAgICAgICBpZiBbICIkcmVtYWluaW5nIiAtZ3QgMCBdOyB0aGVuCiAgICAgICAgICAgICAgICBlY2hvIC1lICIke0NfRElNfSRyZW1haW5pbmcgY2FsbHMgbGVmdCBmb3IgdG9kYXkuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgIGZpCiAgICAgICAgICAgIDs7CiAgICBlc2FjCgogICAgX2Z1Y2tfZW5zdXJlX2NvbmZpZ19leGlzdHMKICAgIF9mdWNrX3NlY3VyZV9jb25maWdfZmlsZQoKICAgIGVjaG8gLWUgIiR7Q19DWUFOfVN3aXRjaCB0byB5b3VyIG93biBrZXk6JHtDX1JFU0VUfSBydW4gJHtDX0dSRUVOfWZ1Y2sgY29uZmlnJHtDX1JFU0VUfSBhbmQgc2V0ICR7Q19CT0xEfUZVQ0tfT1BFTkFJX0FQSV9LRVkke0NfUkVTRVR9IChwbHVzIG9wdGlvbmFsICR7Q19CT0xEfUZVQ0tfT1BFTkFJX01PREVMJHtDX1JFU0VUfS8ke0NfQk9MRH1GVUNLX09QRU5BSV9BUElfQkFTRSR7Q19SRVNFVH0pLiIgPiYyCiAgICBlY2hvIC1lICIke0NfQ1lBTn1UcnVzdGVkIG1haW50YWluZXIgb3ZlcnJpZGU6JHtDX1JFU0VUfSBzZXQgJHtDX0JPTER9RlVDS19BRE1JTl9LRVkke0NfUkVTRVR9IGlmIHlvdSB3ZXJlIGlzc3VlZCB0aGUgd29ya2VyJ3MgQURNSU5fQUNDRVNTX0tFWSB0byBieXBhc3MgdGhlIHNoYXJlZCBxdW90YS4iID4mMgogICAgZWNobyAtZSAiJHtDX0NZQU59Q29uZmlnIHBhdGg6JHtDX1JFU0VUfSAke0NfR1JFRU59JENPTkZJR19GSUxFJHtDX1JFU0VUfSIgPiYyCiAgICBpZiBbIC1uICIke0VESVRPUjotfSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d9SGludDoke0NfUkVTRVR9ICR7RURJVE9SfSBcIiRDT05GSUdfRklMRVwiIiA+JjIKICAgIGZpCiAgICBlY2hvIC1lICIke0NfRElNfVNlY3VyaXR5OiR7Q19SRVNFVH0gdGhlIGZpbGUgcGVybWlzc2lvbnMgYXJlIGxvY2tlZCB0byA2MDAgc28gdGhlIGtleSBzdGF5cyBsb2NhbC4iID4mMgp9CgojIFNpbXBsZSBoZWxwZXIgdG8gcGFyc2UgYm9vbGVhbi1saWtlIHZhbHVlcwpfZnVja190cnV0aHkoKSB7CiAgICBsb2NhbCB2YWx1ZT0iJHsxOi19IgogICAgbG9jYWwgbm9ybWFsaXplZAogICAgbm9ybWFsaXplZD0kKHByaW50ZiAnJXMnICIkdmFsdWUiIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCiAgICBjYXNlICIkbm9ybWFsaXplZCIgaW4KICAgICAgICAxfHRydWV8eWVzfHl8b24pCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIDs7CiAgICAgICAgKikKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICAgICAgOzsKICAgIGVzYWMKfQoKIyBEZWJ1ZyBoZWxwZXIKX2Z1Y2tfZGVidWcoKSB7CiAgICBpZiBfZnVja190cnV0aHkgIiR7RlVDS19ERUJVRzotMH0iOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX0RJTX1bZGVidWddICQqJHtDX1JFU0VUfSIgPiYyCiAgICBmaQp9CgojIFNwaW5uZXIgYW5pbWF0aW9uCl9mdWNrX3NwaW5uZXIoKSB7CiAgICBsb2NhbCBwaWQ9JDEKICAgIGxvY2FsIHByZWZpeD0iJHsyOi19IgogICAgbG9jYWwgZGVsYXk9MC4xCiAgICBsb2NhbCAtYSBmcmFtZXM9KCJ8IiAiLyIgIi0iICJcXCIpCiAgICBsb2NhbCBmcmFtZV9jb3VudD0keyNmcmFtZXNbQF19CiAgICBsb2NhbCBmcmFtZV9pZHg9MAogICAgbG9jYWwgaGFzX3ByZWZpeD0wCiAgICBpZiBbIC1uICIkcHJlZml4IiBdOyB0aGVuCiAgICAgICAgaGFzX3ByZWZpeD0xCiAgICBmaQogICAgCiAgICB0cHV0IGNpdmlzIDI+L2Rldi9udWxsIHx8IHByaW50ZiAiXDAzM1s/MjVsIgoKICAgIHdoaWxlIGtpbGwgLTAgIiRwaWQiIDI+L2Rldi9udWxsOyBkbwogICAgICAgIGlmIFsgIiRoYXNfcHJlZml4IiAtZXEgMSBdOyB0aGVuCiAgICAgICAgICAgIHByaW50ZiAiXHIlcyVzIiAiJHByZWZpeCIgIiR7ZnJhbWVzWyRmcmFtZV9pZHhdfSIKICAgICAgICBlbHNlCiAgICAgICAgICAgIHByaW50ZiAiICVzICIgIiR7ZnJhbWVzWyRmcmFtZV9pZHhdfSIKICAgICAgICAgICAgcHJpbnRmICJcYlxiXGIiCiAgICAgICAgZmkKICAgICAgICBmcmFtZV9pZHg9JCgoIChmcmFtZV9pZHggKyAxKSAlIGZyYW1lX2NvdW50ICkpCiAgICAgICAgc2xlZXAgIiRkZWxheSIKICAgIGRvbmUKCiAgICBpZiBbICIkaGFzX3ByZWZpeCIgLWVxIDEgXTsgdGhlbgogICAgICAgIHByaW50ZiAiXHIlcyIgIiRwcmVmaXgiCiAgICAgICAgdHB1dCBlbCAyPi9kZXYvbnVsbCB8fCBwcmludGYgIlwwMzNbSyIKICAgIGVsc2UKICAgICAgICBwcmludGYgIiAgIFxiXGJcYiIKICAgIGZpCiAgICAKICAgIHRwdXQgY25vcm0gMj4vZGV2L251bGwgfHwgcHJpbnRmICJcMDMzWz8yNWgiCn0KCiMgRGV0ZWN0cyBwb3RlbnRpYWxseSBkYW5nZXJvdXMgY29tbWFuZHMgYW5kIHByaW50cyBhIHdhcm5pbmcKIyAtLS0g5a6J5YWo5qOA5rWL5byV5pOO77yI56ys5LqM6Zi25q6177yJLS0tCgojIEJsb2NrLWxldmVsIHNlY3VyaXR5IHJ1bGVzIChoaWdoZXN0IHNldmVyaXR5IC0gZXhlY3V0aW9uIGRlbmllZCkKIyBGb3JtYXQ6ICdwYXR0ZXJufHx8cmVhc29uJwojIE5vdGU6IE5vdCB1c2luZyAncmVhZG9ubHknIHRvIGVuc3VyZSBjb21wYXRpYmlsaXR5IHdpdGggZnVuY3Rpb24tc2NvcGVkIHNvdXJjaW5nCmlmIFsgLXogIiR7X0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVMreH0iIF0gfHwgW1sgJHsjX0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVNbQF19IC1lcSAwIF1dIDI+L2Rldi9udWxsOyB0aGVuCiAgICBfRlVDS19TRUNVUklUWV9CTE9DS19SVUxFUz0oCiAgICAgICAgJyhefFs7JnxbOnNwYWNlOl1dKXJtW1s6c3BhY2U6XV0rLXJmW1s6c3BhY2U6XV0rLyhbWzpzcGFjZTpdXXwkKXx8fFJlY3Vyc2l2ZSBkZWxldGUgdGFyZ2V0aW5nIHJvb3QgZmlsZXN5c3RlbScKICAgICAgICAncm1bWzpzcGFjZTpdXSstcmZbWzpzcGFjZTpdXSsvXCp8fHxSZWN1cnNpdmUgZGVsZXRlIHVzaW5nIC8qIHVuZGVyIHJvb3QnCiAgICAgICAgJ3JtW1s6c3BhY2U6XV0rLXJmW1s6c3BhY2U6XV0rLS1uby1wcmVzZXJ2ZS1yb290fHx8cm0gLS1uby1wcmVzZXJ2ZS1yb290IGFnYWluc3QgLycKICAgICAgICAncm1bWzpzcGFjZTpdXSstcmZbWzpzcGFjZTpdXStcLlwqfHx8UmVjdXJzaXZlIGRlbGV0ZSB0YXJnZXRpbmcgaGlkZGVuL3N5c3RlbSBmaWxlcycKICAgICAgICAnXGJkZFxiW14jXG5dKlxiKG9mfGlmKT0vZGV2L3x8fFJhdyBkaXNrIHdyaXRlIHZpYSBkZCB0YXJnZXRpbmcgL2RldiBkZXZpY2VzJwogICAgICAgICdcYm1rZnMoXC5cdyspP1xifHx8RmlsZXN5c3RlbSBmb3JtYXQgY29tbWFuZCBkZXRlY3RlZCcKICAgICAgICAnXGJmZGlza1xifFxicGFydGVkXGJ8XGJmb3JtYXRcYnxcYndpcGVmc1xifFxic2hyZWRcYnx8fFBhcnRpdGlvbiBvciBkaXNrIHdpcGUgY29tbWFuZCBkZXRlY3RlZCcKICAgICAgICAnOlwoXClbWzpzcGFjZTpdXSpce1tbOnNwYWNlOl1dKjpbWzpzcGFjZTpdXSpcfFtbOnNwYWNlOl1dKjpbWzpzcGFjZTpdXSomW1s6c3BhY2U6XV0qXH1bWzpzcGFjZTpdXSo7W1s6c3BhY2U6XV0qOnx8fEZvcmsgYm9tYiBmdW5jdGlvbiBkZXRlY3RlZCcKICAgICkKZmkKCiMgQ2hhbGxlbmdlLWxldmVsIHNlY3VyaXR5IHJ1bGVzIChyZXF1aXJlcyBleHBsaWNpdCB1c2VyIGNvbmZpcm1hdGlvbikKIyBGb3JtYXQ6ICdwYXR0ZXJufHx8cmVhc29uJwojIE5vdGU6IE5vdCB1c2luZyAncmVhZG9ubHknIHRvIGVuc3VyZSBjb21wYXRpYmlsaXR5IHdpdGggZnVuY3Rpb24tc2NvcGVkIHNvdXJjaW5nCmlmIFsgLXogIiR7X0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1JVTEVTK3h9IiBdIHx8IFtbICR7I19GVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9SVUxFU1tAXX0gLWVxIDAgXV0gMj4vZGV2L251bGw7IHRoZW4KICAgIF9GVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9SVUxFUz0oCiAgICAgICAgJ2N1cmxbXnxdKlx8XHMqKGJhc2h8c2gpfHx8UmVtb3RlIHNjcmlwdCBleGVjdXRpb24gdmlhIGN1cmwgcGlwZWxpbmUnCiAgICAgICAgJ3dnZXRbXnxdKlx8XHMqKGJhc2h8c2gpfHx8UmVtb3RlIHNjcmlwdCBleGVjdXRpb24gdmlhIHdnZXQgcGlwZWxpbmUnCiAgICAgICAgJ1xic291cmNlXHMraHR0cHM/Oi8vfHx8U291cmNpbmcgYSByZW1vdGUgZmlsZSBvdmVyIEhUVFAoUyknCiAgICAgICAgJ1xiZXZhbFxifFxiZXhlY1xifHx8RXhwbGljaXQgZXZhbC9leGVjIHVzYWdlJwogICAgICAgICdcJFwoW14pXSpcKXx8fENvbW1hbmQgc3Vic3RpdHV0aW9uIHVzaW5nICQoKScKICAgICAgICAnYFteYF0qYHx8fENvbW1hbmQgc3Vic3RpdHV0aW9uIHVzaW5nIGJhY2t0aWNrcycKICAgICAgICAnXGIoc2h8YmFzaHxlbnYpXHMrLWNcYnx8fE5lc3RlZCBzaGVsbCBpbnZvY2F0aW9uIHRocm91Z2ggLWMnCiAgICAgICAgJ1xicHl0aG9uWzAtOS5dKlxzKy1jXGJ8fHxJbmxpbmUgaW50ZXJwcmV0ZXIgZXhlY3V0aW9uIHZpYSAtYycKICAgICAgICAnKF58WzsmfFs6c3BhY2U6XV0pKGNwfG12fHJtfGNobW9kfGNob3dufHNlZHx0ZWV8Y2F0KVteOyZ8XSovKGV0Y3xib290fHN5c3xwcm9jfGRldilcYnx8fE9wZXJhdGlvbiB0b3VjaGVzIGNyaXRpY2FsIHN5c3RlbSBwYXRocycKICAgICAgICAnXGJwZXJsXHMrLWVcYnx8fElubGluZSBQZXJsIGV4ZWN1dGlvbiB2aWEgLWUnCiAgICAgICAgJ1xicnVieVxzKy1lXGJ8fHxJbmxpbmUgUnVieSBleGVjdXRpb24gdmlhIC1lJwogICAgICAgICdcYm5vZGVccystZVxifHx8SW5saW5lIE5vZGUuanMgZXhlY3V0aW9uIHZpYSAtZScKICAgICAgICAnXGJwaHBccystclxifHx8SW5saW5lIFBIUCBleGVjdXRpb24gdmlhIC1yJwogICAgICAgICdiYXNlNjRbXnxdKlx8XHMqKGJhc2h8c2h8ZXZhbCl8fHxCYXNlNjQgZW5jb2RlZCBjb21tYW5kIGV4ZWN1dGlvbicKICAgICAgICAnXGJ4YXJnc1xiLiooLUl8LWl8e30pLipcYihzaHxiYXNofHJtfGNobW9kKVxifHx8Q29tbWFuZCBleGVjdXRpb24gdmlhIHhhcmdzJwogICAgICAgICdcYmZpbmRcYltefDtdKi1leGVjXGJ8fHxDb21tYW5kIGV4ZWN1dGlvbiB2aWEgZmluZCAtZXhlYycKICAgICAgICAnXGIoYXdrfGdhd2t8bmF3a3xtYXdrKVxiW158O10qc3lzdGVtXHMqXCh8fHxJbmRpcmVjdCBjb21tYW5kIGV4ZWN1dGlvbiB2aWEgYXdrIHN5c3RlbSgpJwogICAgICAgICdcYnByaW50ZlxiLipcXFxceFswLTlhLWZBLUZdfHx8UG90ZW50aWFsIGhleC1lbmNvZGVkIGNvbW1hbmQgaW5qZWN0aW9uJwogICAgICAgICdcJFx7W159XSojXH18fHxQYXJhbWV0ZXIgZXhwYW5zaW9uIHRoYXQgbWF5IGFsdGVyIGNvbW1hbmQnCiAgICAgICAgJ2VjaG9ccytbXnxdKlx8XHMqKGJhc2h8c2h8ZXZhbCl8fHxFY2hvIHBpcGVsaW5lIHRvIHNoZWxsIGV4ZWN1dGlvbicKICAgICkKZmkKCiMgV2Fybi1sZXZlbCBzZWN1cml0eSBydWxlcyAod2FybmluZyBvbmx5LCB1c2VyIGNhbiBwcm9jZWVkKQojIEZvcm1hdDogJ3BhdHRlcm58fHxyZWFzb24nCiMgTm90ZTogTm90IHVzaW5nICdyZWFkb25seScgdG8gZW5zdXJlIGNvbXBhdGliaWxpdHkgd2l0aCBmdW5jdGlvbi1zY29wZWQgc291cmNpbmcKaWYgWyAteiAiJHtfRlVDS19TRUNVUklUWV9XQVJOX1JVTEVTK3h9IiBdIHx8IFtbICR7I19GVUNLX1NFQ1VSSVRZX1dBUk5fUlVMRVNbQF19IC1lcSAwIF1dIDI+L2Rldi9udWxsOyB0aGVuCiAgICBfRlVDS19TRUNVUklUWV9XQVJOX1JVTEVTPSgKICAgICAgICAnc3Vkb1tbOnNwYWNlOl1dK1teOyZ8XSpybVtbOnNwYWNlOl1dKy1yZnx8fHN1ZG8gcm0gLXJmIGRldGVjdGVkJwogICAgICAgICdybVtbOnNwYWNlOl1dKy1yZlxifHx8UmVjdXJzaXZlIGRlbGV0ZSByZXF1ZXN0IGRldGVjdGVkJwogICAgICAgICdjaG1vZFtbOnNwYWNlOl1dKy4qNzc3XGJ8fHxXb3JsZC13cml0YWJsZSBwZXJtaXNzaW9uIGNoYW5nZSBkZXRlY3RlZCcKICAgICAgICAnPltbOnNwYWNlOl1dKi8oZXRjLyhwYXNzd2R8c2hhZG93fHN1ZG9lcnMpfGRldi9zZFthLXpdKyl8fHxPdXRwdXQgcmVkaXJlY3Rpb24gaW50byBzZW5zaXRpdmUgc3lzdGVtIGZpbGVzJwogICAgKQpmaQoKIyBHZXRzIHRoZSBjdXJyZW50IHNlY3VyaXR5IG1vZGUgZnJvbSBjb25maWd1cmF0aW9uCiMgT3V0cHV0czogInN0cmljdCIsICJiYWxhbmNlZCIsIG9yICJvZmYiCl9mdWNrX3NlY3VyaXR5X21vZGUoKSB7CiAgICBsb2NhbCBtb2RlPSIke0ZVQ0tfU0VDVVJJVFlfTU9ERTotYmFsYW5jZWR9IgogICAgbW9kZT0kKHByaW50ZiAnJXMnICIkbW9kZSIgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKCiAgICBjYXNlICIkbW9kZSIgaW4KICAgICAgICBzdHJpY3QpIHByaW50ZiAnc3RyaWN0XG4nIDs7CiAgICAgICAgb2ZmfGRpc2FibGVkfG5vbmUpIHByaW50ZiAnb2ZmXG4nIDs7CiAgICAgICAgYmFsYW5jZWR8ZGVmYXVsdHwiIikgcHJpbnRmICdiYWxhbmNlZFxuJyA7OwogICAgICAgICopIHByaW50ZiAnYmFsYW5jZWRcbicgOzsKICAgIGVzYWMKfQoKIyBHZXRzIHRoZSBkZWZhdWx0IGNoYWxsZW5nZSB0ZXh0IGZvciBzZWN1cml0eSBjb25maXJtYXRpb25zCiMgT3V0cHV0czogRGVmYXVsdCBjaGFsbGVuZ2UgcGhyYXNlCl9mdWNrX3NlY3VyaXR5X2RlZmF1bHRfY2hhbGxlbmdlX3RleHQoKSB7CiAgICBwcmludGYgJ0kgYWNjZXB0IHRoZSByaXNrJwp9CgojIENoZWNrcyBpZiBhIGNvbW1hbmQgbWF0Y2hlcyB0aGUgc2VjdXJpdHkgd2hpdGVsaXN0CiMgQXJndW1lbnRzOiAkMSAtIGNvbW1hbmQgdG8gY2hlY2sKIyBSZXR1cm5zOiAwIGlmIHdoaXRlbGlzdGVkLCAxIG90aGVyd2lzZQpfZnVja19zZWN1cml0eV9pc193aGl0ZWxpc3RlZCgpIHsKICAgIGxvY2FsIGNvbW1hbmQ9IiQxIgogICAgbG9jYWwgd2hpdGVsaXN0PSIke0ZVQ0tfU0VDVVJJVFlfV0hJVEVMSVNUOi19IgoKICAgIGlmIFsgLXogIiR3aGl0ZWxpc3QiIF07IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBsb2NhbCBub3JtYWxpemVkIGVudHJ5CiAgICBub3JtYWxpemVkPSQocHJpbnRmICclcycgIiR3aGl0ZWxpc3QiIHwgdHIgJywnICdcbicpCgogICAgd2hpbGUgSUZTPSByZWFkIC1yIGVudHJ5OyBkbwogICAgICAgIGVudHJ5PSQocHJpbnRmICclcycgIiRlbnRyeSIgfCBzZWQgLWUgJ3MvXltbOnNwYWNlOl1dKi8vJyAtZSAncy9bWzpzcGFjZTpdXSokLy8nKQogICAgICAgIFsgLXogIiRlbnRyeSIgXSAmJiBjb250aW51ZQoKICAgICAgICBpZiBwcmludGYgJyVzJyAiJGNvbW1hbmQiIHwgZ3JlcCAtRnEgIiRlbnRyeSI7IHRoZW4KICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICBmaQogICAgZG9uZSA8PDwgIiRub3JtYWxpemVkIgoKICAgIHJldHVybiAxCn0KCiMgQ29udmVydHMgc2VjdXJpdHkgbGV2ZWwgdG8gbnVtZXJpYyB2YWx1ZSBmb3IgY29tcGFyaXNvbgojIEFyZ3VtZW50czogJDEgLSBzZWN1cml0eSBsZXZlbCAoYmxvY2svY2hhbGxlbmdlL3dhcm4vb2spCiMgT3V0cHV0czogTnVtZXJpYyB2YWx1ZSAoMy8yLzEvMCkKX2Z1Y2tfc2VjdXJpdHlfbGV2ZWxfdmFsdWUoKSB7CiAgICBjYXNlICIkMSIgaW4KICAgICAgICBibG9jaykgcHJpbnRmICczXG4nIDs7CiAgICAgICAgY2hhbGxlbmdlKSBwcmludGYgJzJcbicgOzsKICAgICAgICB3YXJuKSBwcmludGYgJzFcbicgOzsKICAgICAgICAqKSBwcmludGYgJzBcbicgOzsKICAgIGVzYWMKfQoKIyBQcm9tb3RlcyBzZWN1cml0eSBsZXZlbCBpZiBjYW5kaWRhdGUgaXMgbW9yZSBzZXZlcmUKIyBBcmd1bWVudHM6ICQxIC0gY3VycmVudCBsZXZlbCwgJDIgLSBjYW5kaWRhdGUgbGV2ZWwKIyBPdXRwdXRzOiBUaGUgbW9yZSBzZXZlcmUgbGV2ZWwKX2Z1Y2tfc2VjdXJpdHlfcHJvbW90ZSgpIHsKICAgIGxvY2FsIGN1cnJlbnQ9IiQxIgogICAgbG9jYWwgY2FuZGlkYXRlPSIkMiIKICAgIGxvY2FsIGN1cnJlbnRfdmFsIGNhbmRpZGF0ZV92YWwKCiAgICBjdXJyZW50X3ZhbD0kKF9mdWNrX3NlY3VyaXR5X2xldmVsX3ZhbHVlICIkY3VycmVudCIpCiAgICBjYW5kaWRhdGVfdmFsPSQoX2Z1Y2tfc2VjdXJpdHlfbGV2ZWxfdmFsdWUgIiRjYW5kaWRhdGUiKQoKICAgIGlmIFsgIiRjYW5kaWRhdGVfdmFsIiAtZ3QgIiRjdXJyZW50X3ZhbCIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRjYW5kaWRhdGUiCiAgICBlbHNlCiAgICAgICAgcHJpbnRmICclc1xuJyAiJGN1cnJlbnQiCiAgICBmaQp9CgojIEFwcGxpZXMgc2VjdXJpdHkgbW9kZSBhZGp1c3RtZW50cyB0byBzZXZlcml0eSBsZXZlbAojIEFyZ3VtZW50czogJDEgLSBtb2RlIChzdHJpY3QvYmFsYW5jZWQvb2ZmKSwgJDIgLSBzZXZlcml0eSBsZXZlbAojIE91dHB1dHM6IEFkanVzdGVkIHNldmVyaXR5IGxldmVsCl9mdWNrX3NlY3VyaXR5X2FwcGx5X21vZGUoKSB7CiAgICBsb2NhbCBtb2RlPSIkMSIKICAgIGxvY2FsIHNldmVyaXR5PSIkMiIKCiAgICBjYXNlICIkbW9kZSIgaW4KICAgICAgICBzdHJpY3QpCiAgICAgICAgICAgIGNhc2UgIiRzZXZlcml0eSIgaW4KICAgICAgICAgICAgICAgIHdhcm4pIHNldmVyaXR5PSJjaGFsbGVuZ2UiIDs7CiAgICAgICAgICAgICAgICBjaGFsbGVuZ2UpIHNldmVyaXR5PSJibG9jayIgOzsKICAgICAgICAgICAgZXNhYwogICAgICAgICAgICA7OwogICAgZXNhYwoKICAgIHByaW50ZiAnJXNcbicgIiRzZXZlcml0eSIKfQoKIyBNYXRjaGVzIGNvbW1hbmQgYWdhaW5zdCBhIHNlY3VyaXR5IHJ1bGUgdGFibGUKIyBBcmd1bWVudHM6ICQxIC0gY29tbWFuZCwgJDIgLSBydWxlIHRhYmxlIG5hbWUKIyBPdXRwdXRzOiBSZWFzb24gc3RyaW5nIGlmIG1hdGNoZWQKIyBSZXR1cm5zOiAwIGlmIG1hdGNoZWQsIDEgb3RoZXJ3aXNlCl9mdWNrX3NlY3VyaXR5X21hdGNoX3J1bGUoKSB7CiAgICBsb2NhbCBjb21tYW5kPSIkMSIKICAgIGxvY2FsIHRhYmxlPSIkMiIKICAgIGxvY2FsIC1hIHJ1bGVzPSgpCgogICAgIyBTRUNVUklUWSBOT1RFOiBUaGlzIGV2YWwgaXMgU0FGRSBiZWNhdXNlOgogICAgIyAtICR0YWJsZSBvbmx5IHJlY2VpdmVzIGhhcmRjb2RlZCBpbnRlcm5hbCBhcnJheSBuYW1lcyBmcm9tIGNhbGxlcnMgd2l0aGluIHRoaXMgc2NyaXB0CiAgICAjIC0gVmFsaWQgdmFsdWVzOiBfRlVDS19TRUNVUklUWV9CTE9DS19SVUxFUywgX0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1JVTEVTLCBfRlVDS19TRUNVUklUWV9XQVJOX1JVTEVTCiAgICAjIC0gTm8gdXNlciBpbnB1dCBjYW4gcmVhY2ggdGhpcyB2YXJpYWJsZTsgaXQncyBwdXJlbHkgZm9yIGR5bmFtaWMgYXJyYXkgbmFtZSByZXNvbHV0aW9uCiAgICAjIC0gVGhpcyBwYXR0ZXJuIGlzIGEgc3RhbmRhcmQgQmFzaCBpZGlvbSBmb3IgaW5kaXJlY3QgYXJyYXkgYWNjZXNzIChCYXNoIDMueCBjb21wYXRpYmxlKQogICAgZXZhbCAicnVsZXM9KFwiXCR7JHt0YWJsZX1bQF19XCIpIgoKICAgIGxvY2FsIHJ1bGUgcGF0dGVybiByZWFzb24KICAgIGZvciBydWxlIGluICIke3J1bGVzW0BdfSI7IGRvCiAgICAgICAgcGF0dGVybj0ke3J1bGUlJXx8fCp9CiAgICAgICAgcmVhc29uPSR7cnVsZSMqfHx8fQogICAgICAgIFsgLXogIiRwYXR0ZXJuIiBdICYmIGNvbnRpbnVlCgogICAgICAgIGlmIHByaW50ZiAnJXMnICIkY29tbWFuZCIgfCBncmVwIC1FaXEgLS0gIiRwYXR0ZXJuIjsgdGhlbgogICAgICAgICAgICBwcmludGYgJyVzXG4nICIkcmVhc29uIgogICAgICAgICAgICByZXR1cm4gMAogICAgICAgIGZpCiAgICBkb25lCgogICAgcmV0dXJuIDEKfQoKIyBEaXNwbGF5cyB3YXJuaW5nIG1lc3NhZ2UgZm9yIHBvdGVudGlhbGx5IGRhbmdlcm91cyBjb21tYW5kcwojIEFyZ3VtZW50czogJDEgLSByZWFzb24gZm9yIHdhcm5pbmcKX2Z1Y2tfc2VjdXJpdHlfd2Fybl9tZXNzYWdlKCkgewogICAgbG9jYWwgcmVhc29uPSIkMSIKICAgIGVjaG8gLWUgIiR7Q19SRURfQk9MRH3imqDvuI8gIFNFQ1VSSVRZIFdBUk5JTkc6JHtDX1JFU0VUfSAke3JlYXNvbn0iID4mMgogICAgZWNobyAtZSAiJHtDX1lFTExPV31SZXZpZXcgdGhlIGNvbW1hbmQgbWFudWFsbHkgb3IgYWRkIGEgd2hpdGVsaXN0IGVudHJ5IGlmIHlvdSBmdWxseSB0cnVzdCBpdC4ke0NfUkVTRVR9IiA+JjIKfQoKIyBEaXNwbGF5cyBibG9jayBtZXNzYWdlIGZvciBwcm9oaWJpdGVkIGNvbW1hbmRzCiMgQXJndW1lbnRzOiAkMSAtIHJlYXNvbiBmb3IgYmxvY2tpbmcKX2Z1Y2tfc2VjdXJpdHlfYmxvY2tfbWVzc2FnZSgpIHsKICAgIGxvY2FsIHJlYXNvbj0iJDEiCiAgICBlY2hvIC1lICIke0NfUkVEX0JPTER94puUIFNFQ1VSSVRZIEJMT0NLOiR7Q19SRVNFVH0gJHtyZWFzb259IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19SRUR9RXhlY3V0aW9uIGRlbmllZC4gQWRqdXN0IEZVQ0tfU0VDVVJJVFlfTU9ERSBvciB3aGl0ZWxpc3QgdGhlIGNvbW1hbmQgaWYgYWJzb2x1dGVseSBuZWNlc3NhcnkuJHtDX1JFU0VUfSIgPiYyCn0KCiMgRGlzcGxheXMgY2hhbGxlbmdlIG1lc3NhZ2UgZm9yIGhpZ2gtcmlzayBjb21tYW5kcwojIEFyZ3VtZW50czogJDEgLSByZWFzb24gZm9yIGNoYWxsZW5nZSwgJDIgLSByZXF1aXJlZCBwaHJhc2UKX2Z1Y2tfc2VjdXJpdHlfY2hhbGxlbmdlX21lc3NhZ2UoKSB7CiAgICBsb2NhbCByZWFzb249IiQxIgogICAgbG9jYWwgcGhyYXNlPSIkMiIKICAgIGVjaG8gLWUgIiR7Q19SRURfQk9MRH3imqDvuI8gIFNFQ1VSSVRZIENIQUxMRU5HRToke0NfUkVTRVR9ICR7cmVhc29ufSIgPiYyCiAgICBlY2hvIC1lICIke0NfQ1lBTn1UeXBlIHRoZSBmb2xsb3dpbmcgcGhyYXNlIHRvIGNvbnRpbnVlOiR7Q19SRVNFVH0iID4mMgogICAgZWNobyAtZSAiJHtDX0JPTER9JHtwaHJhc2V9JHtDX1JFU0VUfSIgPiYyCn0KCiMgUHJvbXB0cyB1c2VyIHRvIGVudGVyIHRoZSByZXF1aXJlZCBwaHJhc2UgZm9yIHNlY3VyaXR5IGNoYWxsZW5nZQojIEFyZ3VtZW50czogJDEgLSByZXF1aXJlZCBwaHJhc2UKIyBSZXR1cm5zOiAwIGlmIHBocmFzZSBtYXRjaGVzLCAxIG90aGVyd2lzZQpfZnVja19zZWN1cml0eV9wcm9tcHRfcGhyYXNlKCkgewogICAgbG9jYWwgcGhyYXNlPSIkMSIKICAgIGxvY2FsIGlucHV0PSIiCgogICAgcHJpbnRmICIlYj4gJWIiICIkQ19CT0xEIiAiJENfUkVTRVQiID4mMgoKICAgIGlmIFsgLXIgL2Rldi90dHkgXTsgdGhlbgogICAgICAgIGlmICEgSUZTPSByZWFkIC1yIGlucHV0IDwgL2Rldi90dHk7IHRoZW4KICAgICAgICAgICAgcHJpbnRmICJcbiIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKICAgIGVsc2UKICAgICAgICBpZiAhIElGUz0gcmVhZCAtciBpbnB1dDsgdGhlbgogICAgICAgICAgICBwcmludGYgIlxuIiA+JjIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICBmaQogICAgZmkKCiAgICBwcmludGYgIlxuIiA+JjIKICAgIFsgIiRpbnB1dCIgPSAiJHBocmFzZSIgXQp9CgojIEhhbmRsZXMgc2VjdXJpdHkgZGVjaXNpb24gYmFzZWQgb24gc2V2ZXJpdHkgbGV2ZWwKIyBBcmd1bWVudHM6ICQxIC0gc2V2ZXJpdHkgbGV2ZWwsICQyIC0gcmVhc29uLCAkMyAtIGNvbW1hbmQKIyBSZXR1cm5zOiAwIHRvIGFsbG93IGV4ZWN1dGlvbiwgMSB0byBkZW55Cl9mdWNrX3NlY3VyaXR5X2hhbmRsZV9kZWNpc2lvbigpIHsKICAgIGxvY2FsIHNldmVyaXR5PSIkMSIKICAgIGxvY2FsIHJlYXNvbj0iJDIiCiAgICBsb2NhbCBjb21tYW5kPSIkMyIKCiAgICBjYXNlICIkc2V2ZXJpdHkiIGluCiAgICAgICAgIiJ8b2t8b2ZmKQogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgICAgIHdhcm4pCiAgICAgICAgICAgIF9mdWNrX3NlY3VyaXR5X3dhcm5fbWVzc2FnZSAiJHtyZWFzb246LVBvdGVudGlhbGx5IGRhbmdlcm91cyBjb21tYW5kIGRldGVjdGVkfSIKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgOzsKICAgICAgICBjaGFsbGVuZ2UpCiAgICAgICAgICAgIGxvY2FsIHBocmFzZT0iJHtGVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9URVhUOi0kKF9mdWNrX3NlY3VyaXR5X2RlZmF1bHRfY2hhbGxlbmdlX3RleHQpfSIKICAgICAgICAgICAgX2Z1Y2tfc2VjdXJpdHlfY2hhbGxlbmdlX21lc3NhZ2UgIiR7cmVhc29uOi1IaWdoLXJpc2sgY29tbWFuZCBkZXRlY3RlZH0iICIkcGhyYXNlIgoKICAgICAgICAgICAgaWYgX2Z1Y2tfc2VjdXJpdHlfcHJvbXB0X3BocmFzZSAiJHBocmFzZSI7IHRoZW4KICAgICAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19HUkVFTn1TZWN1cml0eSBjaGFsbGVuZ2UgYWNrbm93bGVkZ2VkLiR7Q19SRVNFVH0iID4mMgogICAgICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgZmkKCiAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19SRUR9U2VjdXJpdHkgY2hhbGxlbmdlIGZhaWxlZC4gQ29tbWFuZCBhYm9ydGVkLiR7Q19SRVNFVH0iID4mMgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgICAgICA7OwogICAgICAgIGJsb2NrKQogICAgICAgICAgICBfZnVja19hdWRpdF9sb2cgIkJMT0NLIiAiJGNvbW1hbmQiCiAgICAgICAgICAgIF9mdWNrX3NlY3VyaXR5X2Jsb2NrX21lc3NhZ2UgIiR7cmVhc29uOi1Db21tYW5kIGJsb2NrZWQgYnkgcG9saWN5fSIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICAgICAgOzsKICAgICAgICAqKQogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgZXNhYwp9CgojIEV2YWx1YXRlcyBjb21tYW5kIHNlY3VyaXR5IGFuZCByZXR1cm5zIHNldmVyaXR5IGxldmVsIHdpdGggcmVhc29uCiMgQXJndW1lbnRzOiAkMSAtIGNvbW1hbmQgdG8gZXZhbHVhdGUKIyBPdXRwdXRzOiAic2V2ZXJpdHl8cmVhc29uIiBzdHJpbmcKIyBSZXR1cm5zOiAwIGFsd2F5cyAocmVzdWx0IGlzIGluIG91dHB1dCkKX2Z1Y2tfc2VjdXJpdHlfZXZhbHVhdGVfY29tbWFuZCgpIHsKICAgIGxvY2FsIGNvbW1hbmQ9IiQxIgogICAgbG9jYWwgbW9kZSBzZXZlcml0eSByZWFzb24gbWF0Y2ggcHJvbW90ZWQgc3RydWN0dXJhbF9yZWFzb24KCiAgICBtb2RlPSQoX2Z1Y2tfc2VjdXJpdHlfbW9kZSkKCiAgICAjIFNlY3VyaXR5IGVuZ2luZSBkaXNhYmxlZAogICAgaWYgWyAiJG1vZGUiID0gIm9mZiIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnb2ZmfFNlY3VyaXR5IGVuZ2luZSBkaXNhYmxlZFxuJwogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgICMgQ2hlY2sgd2hpdGVsaXN0CiAgICBpZiBfZnVja19zZWN1cml0eV9pc193aGl0ZWxpc3RlZCAiJGNvbW1hbmQiOyB0aGVuCiAgICAgICAgcHJpbnRmICdva3xDb21tYW5kIG1hdGNoZWQgd2hpdGVsaXN0XG4nCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgc2V2ZXJpdHk9Im9rIgogICAgcmVhc29uPSIiCiAgICBtYXRjaD0iIgoKICAgICMgQ2hlY2sgYmxvY2sgcnVsZXMgKGhpZ2hlc3QgcHJpb3JpdHkpCiAgICBpZiBtYXRjaD0kKF9mdWNrX3NlY3VyaXR5X21hdGNoX3J1bGUgIiRjb21tYW5kIiAiX0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJibG9jayIKICAgICAgICByZWFzb249IiRtYXRjaCIKICAgIGZpCgogICAgIyBDaGVjayBjaGFsbGVuZ2UgcnVsZXMgKG1lZGl1bSBwcmlvcml0eSkKICAgIGlmIFsgIiRzZXZlcml0eSIgIT0gImJsb2NrIiBdICYmIG1hdGNoPSQoX2Z1Y2tfc2VjdXJpdHlfbWF0Y2hfcnVsZSAiJGNvbW1hbmQiICJfRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJjaGFsbGVuZ2UiCiAgICAgICAgcmVhc29uPSIkbWF0Y2giCiAgICBmaQoKICAgICMgQ2hlY2sgd2FybiBydWxlcyAobG93IHByaW9yaXR5KQogICAgaWYgWyAiJHNldmVyaXR5IiA9ICJvayIgXSAmJiBtYXRjaD0kKF9mdWNrX3NlY3VyaXR5X21hdGNoX3J1bGUgIiRjb21tYW5kIiAiX0ZVQ0tfU0VDVVJJVFlfV0FSTl9SVUxFUyIpOyB0aGVuCiAgICAgICAgc2V2ZXJpdHk9Indhcm4iCiAgICAgICAgcmVhc29uPSIkbWF0Y2giCiAgICBmaQoKICAgICMgQ2hlY2sgZm9yIGNvbW1hbmQgY2hhaW5pbmcvcGlwaW5nIChzdHJ1Y3R1cmFsIGFuYWx5c2lzKQogICAgaWYgcHJpbnRmICclcycgIiRjb21tYW5kIiB8IGdyZXAgLUVpcSAnKCYmfFx8XHx8O3xcfCknOyB0aGVuCiAgICAgICAgc3RydWN0dXJhbF9yZWFzb249IkNvbW1hbmQgY2hhaW5pbmcgb3IgcGlwaW5nIGRldGVjdGVkIgogICAgICAgIHByb21vdGVkPSQoX2Z1Y2tfc2VjdXJpdHlfcHJvbW90ZSAiJHNldmVyaXR5IiAid2FybiIpCgogICAgICAgIGlmIFsgIiRwcm9tb3RlZCIgIT0gIiRzZXZlcml0eSIgXTsgdGhlbgogICAgICAgICAgICBzZXZlcml0eT0iJHByb21vdGVkIgogICAgICAgICAgICByZWFzb249IiRzdHJ1Y3R1cmFsX3JlYXNvbiIKICAgICAgICBlbGlmIFsgLXogIiRyZWFzb24iIF07IHRoZW4KICAgICAgICAgICAgcmVhc29uPSIkc3RydWN0dXJhbF9yZWFzb24iCiAgICAgICAgZmkKICAgIGZpCgogICAgIyBBcHBseSBzZWN1cml0eSBtb2RlIGFkanVzdG1lbnRzCiAgICBzZXZlcml0eT0kKF9mdWNrX3NlY3VyaXR5X2FwcGx5X21vZGUgIiRtb2RlIiAiJHNldmVyaXR5IikKCiAgICBwcmludGYgJyVzfCVzXG4nICIkc2V2ZXJpdHkiICIke3JlYXNvbjotU2FmZSBleGVjdXRpb259Igp9CgojIExlZ2FjeSBmdW5jdGlvbiBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eQojIEFyZ3VtZW50czogJDEgLSBjb21tYW5kIHRvIGNoZWNrCiMgT3V0cHV0czogInNldmVyaXR5fHJlYXNvbiIgc3RyaW5nCl9mdWNrX2RldGVjdF9kYW5nZXJvdXNfY29tbWFuZCgpIHsKICAgIF9mdWNrX3NlY3VyaXR5X2V2YWx1YXRlX2NvbW1hbmQgIiQxIgp9CgoKIyBFbnN1cmUgYSBjb25maWcgZmlsZSBleGlzdHMgdG8gaGVscCB1c2VycyB0d2VhayB0aGUgYmVoYXZpb3VyCl9mdWNrX3NlY3VyZV9jb25maWdfZmlsZSgpIHsKICAgIGlmIFsgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNobW9kIDYwMCAiJENPTkZJR19GSUxFIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICBmaQp9CgpfZnVja19hcHBlbmRfY29uZmlnX2hpbnQoKSB7CiAgICBsb2NhbCBrZXk9IiQxIgogICAgbG9jYWwgY29tbWVudD0iJDIiCiAgICBsb2NhbCBzYW1wbGU9IiQzIgogICAgbG9jYWwgcXVvdGVkPSIkezQ6LTF9IgogICAgWyAtZiAiJENPTkZJR19GSUxFIiBdIHx8IHJldHVybgogICAgaWYgZ3JlcCAtRXEgIl5cXHMqIz9cXHMqZXhwb3J0XFxzKyRrZXkiICIkQ09ORklHX0ZJTEUiOyB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIGxvY2FsIGFzc2lnbm1lbnQKICAgIGlmIFsgIiRxdW90ZWQiID0gIjEiIF07IHRoZW4KICAgICAgICBhc3NpZ25tZW50PSIjIGV4cG9ydCAka2V5PVwiJHNhbXBsZVwiIgogICAgZWxzZQogICAgICAgIGFzc2lnbm1lbnQ9IiMgZXhwb3J0ICRrZXk9JHNhbXBsZSIKICAgIGZpCgogICAgewogICAgICAgIHByaW50ZiAnXG4nCiAgICAgICAgcHJpbnRmICcjICVzXG4nICIkY29tbWVudCIKICAgICAgICBwcmludGYgJyVzXG4nICIkYXNzaWdubWVudCIKICAgIH0gPj4gIiRDT05GSUdfRklMRSIKfQoKX2Z1Y2tfc2VlZF9jb25maWdfcGxhY2Vob2xkZXJzKCkgewogICAgWyAtZiAiJENPTkZJR19GSUxFIiBdIHx8IHJldHVybgogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX09QRU5BSV9BUElfS0VZIiAiTG9jYWwgT3BlbkFJLWNvbXBhdGlibGUgQVBJIGtleSAocmVjb21tZW5kZWQpIiAnc2stLi4uJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FETUlOX0tFWSIgIk9wdGlvbmFsOiBhZG1pbiBieXBhc3Mga2V5IGZvciB0cnVzdGVkIG1haW50YWluZXJzIiAnYWRtLS4uLicKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19PUEVOQUlfTU9ERUwiICJPcHRpb25hbDogb3ZlcnJpZGUgbW9kZWwgd2hlbiB1c2luZyB5b3VyIG93biBrZXkiICdncHQtNG8tbWluaScKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19PUEVOQUlfQVBJX0JBU0UiICJPcHRpb25hbDogb3ZlcnJpZGUgQVBJIGJhc2UiICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FMSUFTIiAiQWRkIGFuIGV4dHJhIGFsaWFzIGJlc2lkZXMgdGhlIGRlZmF1bHQgJ2Z1Y2snIiAncGxzJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FVVE9fRVhFQyIgIlNraXAgY29uZmlybWF0aW9uIHByb21wdHMgKHVzZSB3aXRoIGNhdXRpb24hKSIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfVElNRU9VVCIgIk92ZXJyaWRlIGN1cmwgdGltZW91dCAoc2Vjb25kcykiICczMCcgMAogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0RFQlVHIiAiRW5hYmxlIHZlcmJvc2UgZGVidWcgbG9ncyIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTIiAiRGlzYWJsZSB0aGUgYnVpbHQtaW4gJ2Z1Y2snIGFsaWFzIiAnZmFsc2UnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9NT0RFIiAiU2VjdXJpdHkgZW5naW5lIG1vZGU6IHN0cmljdHxiYWxhbmNlZHxvZmYiICdiYWxhbmNlZCcKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9XSElURUxJU1QiICJDb21tYS9uZXdsaW5lIHNlcGFyYXRlZCBjb21tYW5kIHBhdHRlcm5zIHRvIGJ5cGFzcyBzZWN1cml0eSBjaGVja3MiICcnCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1RFWFQiICJQaHJhc2UgcmVxdWlyZWQgZm9yIGhpZ2gtcmlzayBjb21tYW5kIGNvbmZpcm1hdGlvbiIgJ0kgYWNjZXB0IHRoZSByaXNrJwp9CgpfZnVja19lbnN1cmVfY29uZmlnX2V4aXN0cygpIHsKICAgIGlmIFsgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIF9mdWNrX3NlZWRfY29uZmlnX3BsYWNlaG9sZGVycwogICAgICAgIF9mdWNrX3NlY3VyZV9jb25maWdfZmlsZQogICAgICAgIHJldHVybgogICAgZmkKCiAgICBta2RpciAtcCAiJChkaXJuYW1lICIkQ09ORklHX0ZJTEUiKSIKICAgIGNhdCA8PCdDRkcnID4gIiRDT05GSUdfRklMRSIKIyBmdWNraXRzIGNvbmZpZ3VyYXRpb24KIyBUb2dnbGUgdGhlIGV4cG9ydHMgYmVsb3cgdG8gY3VzdG9taXNlIHlvdXIgZXhwZXJpZW5jZS4KCiMgQ3VzdG9tIEFQSSBlbmRwb2ludCB0aGF0IHBvaW50cyB0byB5b3VyIHNlbGYtaG9zdGVkIHdvcmtlcgojIGV4cG9ydCBGVUNLX0FQSV9FTkRQT0lOVD0iaHR0cHM6Ly95b3VyLWRvbWFpbi53b3JrZXJzLmRldi8iCgojIExvY2FsIE9wZW5BSS1jb21wYXRpYmxlIEFQSSBrZXkgKHJlY29tbWVuZGVkKQojIGV4cG9ydCBGVUNLX09QRU5BSV9BUElfS0VZPSJzay0uLi4iCgojIE9wdGlvbmFsOiBhZG1pbiBieXBhc3Mga2V5IGZvciB0cnVzdGVkIG1haW50YWluZXJzCiMgZXhwb3J0IEZVQ0tfQURNSU5fS0VZPSJhZG0tLi4uIgoKIyBPcHRpb25hbDogb3ZlcnJpZGUgbW9kZWwvYmFzZSB3aGVuIHVzaW5nIHlvdXIgb3duIGtleQojIGV4cG9ydCBGVUNLX09QRU5BSV9NT0RFTD0iZ3B0LTRvLW1pbmkiCiMgZXhwb3J0IEZVQ0tfT1BFTkFJX0FQSV9CQVNFPSJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxIgoKIyBBZGQgYW4gZXh0cmEgYWxpYXMgYmVzaWRlcyB0aGUgZGVmYXVsdCAnZnVjaycKIyBleHBvcnQgRlVDS19BTElBUz0icGxzIgoKIyBTa2lwIGNvbmZpcm1hdGlvbiBwcm9tcHRzICh1c2Ugd2l0aCBjYXV0aW9uISkKIyBleHBvcnQgRlVDS19BVVRPX0VYRUM9ZmFsc2UKCiMgT3ZlcnJpZGUgY3VybCB0aW1lb3V0IChzZWNvbmRzKQojIGV4cG9ydCBGVUNLX1RJTUVPVVQ9MzAKCiMgRW5hYmxlIHZlcmJvc2UgZGVidWcgbG9ncwojIGV4cG9ydCBGVUNLX0RFQlVHPWZhbHNlCgojIERpc2FibGUgdGhlIGJ1aWx0LWluICdmdWNrJyBhbGlhcwojIGV4cG9ydCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUz1mYWxzZQoKIyAtLS0gU2VjdXJpdHkgU2V0dGluZ3MgLS0tCiMgU2VjdXJpdHkgbW9kZTogc3RyaWN0LCBiYWxhbmNlZCAoZGVmYXVsdCksIG9yIG9mZgojIGV4cG9ydCBGVUNLX1NFQ1VSSVRZX01PREU9ImJhbGFuY2VkIgoKIyBXaGl0ZWxpc3QgdHJ1c3RlZCBjb21tYW5kIHBhdHRlcm5zIChjb21tYS1zZXBhcmF0ZWQpCiMgZXhwb3J0IEZVQ0tfU0VDVVJJVFlfV0hJVEVMSVNUPSJkb2NrZXIgcm0gLWYscm0gLXJmIC90bXAvc2FmZS1kaXIiCgojIC0tLSBBdWRpdCBMb2dnaW5nIC0tLQojIEVuYWJsZSBhdWRpdCBsb2dnaW5nIG9mIGFsbCBleGVjdXRlZCBjb21tYW5kcwojIGV4cG9ydCBGVUNLX0FVRElUX0xPRz10cnVlCgojIEN1c3RvbSBhdWRpdCBsb2cgZmlsZSBwYXRoIChkZWZhdWx0OiB+Ly5mdWNrLy5hdWRpdC5sb2cpCiMgZXhwb3J0IEZVQ0tfQVVESVRfTE9HX0ZJTEU9IiRIT01FLy5mdWNrLy5hdWRpdC5sb2ciCkNGRwoKICAgIF9mdWNrX3NlZWRfY29uZmlnX3BsYWNlaG9sZGVycwogICAgX2Z1Y2tfc2VjdXJlX2NvbmZpZ19maWxlCn0KCl9mdWNrX3Nob3dfY29uZmlnX2hlbHAoKSB7CiAgICBfZnVja19lbnN1cmVfY29uZmlnX2V4aXN0cwogICAgZWNobyAtZSAiJHtDX1lFTExPV31Db25maWd1cmF0aW9uIGZpbGU6JHtDX1JFU0VUfSAke0NfQ1lBTn0kQ09ORklHX0ZJTEUke0NfUkVTRVR9IgogICAgaWYgWyAtbiAiJHtFRElUT1I6LX0iIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfUVkaXQgd2l0aDoke0NfUkVTRVR9ICR7Q19DWUFOfSR7RURJVE9SfSBcIiRDT05GSUdfRklMRVwiJHtDX1JFU0VUfSIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfU9wZW4gdGhpcyBmaWxlIGluIHlvdXIgZmF2b3VyaXRlIGVkaXRvciB0byBjdXN0b21pc2UgZnVja2l0cy4ke0NfUkVTRVR9IgogICAgZmkKICAgIGVjaG8gLWUgIiR7Q19DWUFOfUF2YWlsYWJsZSB0b2dnbGVzOiR7Q19SRVNFVH0gRlVDS19BUElfRU5EUE9JTlQsIEZVQ0tfT1BFTkFJX0FQSV9LRVksIEZVQ0tfQURNSU5fS0VZLCBGVUNLX09QRU5BSV9NT0RFTCwgRlVDS19PUEVOQUlfQVBJX0JBU0UsIEZVQ0tfQUxJQVMsIEZVQ0tfQVVUT19FWEVDLCBGVUNLX1RJTUVPVVQsIEZVQ0tfREVCVUcsIEZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTIgogICAgZWNobyAtZSAiJHtDX0RJTX1Qcm8gdGlwOiR7Q19SRVNFVH0gd2UgbG9jayAke0NPTkZJR19GSUxFfSB0byBjaG1vZCA2MDAgc28geW91ciBBUEkga2V5IHN0YXlzIGxvY2FsLiIKfQoKIyBVbmluc3RhbGxzIHRoZSBzY3JpcHQKX3VuaW5zdGFsbF9zY3JpcHQoKSB7CiAgICBlY2hvIC1lICIkRlVDSyAke0NfWUVMTE9XfVNvIHlvdSdyZSBraWNraW5nIG1lIG91dD8gRmluZS4ke0NfUkVTRVR9IgoKICAgICMgRmluZCB0aGUgcHJvZmlsZSBmaWxlCiAgICBsb2NhbCBwcm9maWxlX2ZpbGUKICAgIHByb2ZpbGVfZmlsZT0kKF9pbnN0YWxsZXJfZGV0ZWN0X3Byb2ZpbGUpCiAgICBsb2NhbCBzb3VyY2VfbGluZT0ic291cmNlICRNQUlOX1NIIgoKICAgIGlmIFsgIiRwcm9maWxlX2ZpbGUiICE9ICJ1bmtub3duX3Byb2ZpbGUiIF0gJiYgWyAtZiAiJHByb2ZpbGVfZmlsZSIgXTsgdGhlbgogICAgICAgIGlmIGdyZXAgLXFGICIkc291cmNlX2xpbmUiICIkcHJvZmlsZV9maWxlIjsgdGhlbgogICAgICAgICAgICAjIFVzZSBzZWQgdG8gcmVtb3ZlIHRoZSBsaW5lcy4gQ3JlYXRlIGEgYmFja3VwLgogICAgICAgICAgICBpZiBzZWQgLS12ZXJzaW9uID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgICAgICAgICAgIyBHTlUgc2VkIChMaW51eCkKICAgICAgICAgICAgICAgIHNlZCAtaS5iYWsgIlx8JHNvdXJjZV9saW5lXHxkIiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICAgICAgICAgIHNlZCAtaS5iYWsgIlx8IyBBZGRlZCBieSBmdWNraXRzIGluc3RhbGxlclx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICMgQlNEL21hY09TIHNlZCByZXF1aXJlcyBhcmd1bWVudCBsZXR0ZXIgYWZ0ZXIgLWkKICAgICAgICAgICAgICAgIHNlZCAtaS5iYWsgIiIgLWUgIlx8JHNvdXJjZV9saW5lXHxkIiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICAgICAgICAgIHNlZCAtaS5iYWsgIiIgLWUgIlx8IyBBZGRlZCBieSBmdWNraXRzIGluc3RhbGxlclx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgIGZpCiAgICAgICAgZmkKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfUNvdWxkIG5vdCBmaW5kIGEgc2hlbGwgcHJvZmlsZSBmaWxlIHRvIG1vZGlmeS4gWW91ciBwcm9ibGVtIG5vdy4ke0NfUkVTRVR9IgogICAgZmkKCiAgICBpZiBbIC1kICIkSU5TVEFMTF9ESVIiIF07IHRoZW4KICAgICAgICBybSAtcmYgIiRJTlNUQUxMX0RJUiIKICAgIGZpCgogICAgZWNobyAtZSAiJEZVQ0sgJHtDX0dSRUVOfUknbSBnb25lLiBEb24ndCBjb21lIGNyeWluZyBiYWNrLiR7Q19SRVNFVH0iCiAgICBlY2hvIC1lICIke0NfQ1lBTn1Ob3cgcmVzdGFydCB5b3VyIGRhbW4gc2hlbGwuJHtDX1JFU0VUfSIKfQoKIyBUaGUgbWFpbiBmdW5jdGlvbiB0aGF0IGNvbnRhY3RzIHRoZSBBUEkKIyBUYWtlcyA+MCBhcmd1bWVudHMgYXMgdGhlIHByb21wdApfZnVja19leGVjdXRlX3Byb21wdCgpIHsKICAgICMgSWYgdGhlIHVzZXIgdHlwZXMgKm9ubHkqICJmdWNrIHVuaW5zdGFsbCIKICAgIGlmIFsgIiQxIiA9ICJ1bmluc3RhbGwiIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfdW5pbnN0YWxsX3NjcmlwdAogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgICMgSWYgdGhlIHVzZXIgdHlwZXMgImZ1Y2sgY29uZmlnIgogICAgaWYgWyAiJDEiID0gImNvbmZpZyIgXSAmJiBbICIkIyIgLWVxIDEgXTsgdGhlbgogICAgICAgIF9mdWNrX3Nob3dfY29uZmlnX2hlbHAKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBpZiAhIGNvbW1hbmQgLXYgY3VybCAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfSdmdWNrJyBjb21tYW5kIG5lZWRzICdjdXJsJy4gUGxlYXNlIGluc3RhbGwgaXQuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgaWYgWyAiJCMiIC1lcSAwIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfVlvdSBmb3Jnb3QgdG8gYXNrIG1lIHdoYXQgdG8gZG8uJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgcHJvbXB0PSIkKiIKICAgIGxvY2FsIGF1dG9fbW9kZT0iJHtGVUNLX0FVVE9fRVhFQzotMH0iCiAgICBsb2NhbCBjdXJsX3RpbWVvdXQ9IiR7RlVDS19USU1FT1VUOi0zMH0iCiAgICBsb2NhbCBzeXNpbmZvX3N0cmluZwogICAgc3lzaW5mb19zdHJpbmc9JChfZnVja19jb2xsZWN0X3N5c2luZm9fc3RyaW5nKQoKICAgIGxvY2FsIHJlc3BvbnNlPSIiCiAgICBsb2NhbCBleGl0X2NvZGU9MAogICAgaWYgX2Z1Y2tfc2hvdWxkX3VzZV9sb2NhbF9hcGk7IHRoZW4KICAgICAgICBlY2hvIC1uZSAiJHtDX1lFTExPV31Vc2luZyB5b3VyIGxvY2FsIEFQSSBrZXkuLi4ke0NfUkVTRVR9ICIKICAgICAgICByZXNwb25zZT0kKF9mdWNrX3JlcXVlc3RfbG9jYWxfbW9kZWwgIiRwcm9tcHQiICIkc3lzaW5mb19zdHJpbmciICIkY3VybF90aW1lb3V0IikKICAgICAgICBleGl0X2NvZGU9JD8KICAgIGVsc2UKICAgICAgICBsb2NhbCBzcGlubmVyX2xhYmVsPSJUaGlua2luZy4uLiAiCiAgICAgICAgcHJpbnRmICclcycgIiRzcGlubmVyX2xhYmVsIgogICAgICAgIHJlc3BvbnNlPSQoX2Z1Y2tfcmVxdWVzdF93b3JrZXJfbW9kZWwgIiRwcm9tcHQiICIkc3lzaW5mb19zdHJpbmciICIkY3VybF90aW1lb3V0IiAiJHNwaW5uZXJfbGFiZWwiKQogICAgICAgIGV4aXRfY29kZT0kPwogICAgZmkKCiAgICBlY2hvICIiCgogICAgaWYgWyAkZXhpdF9jb2RlIC1uZSAwIF0gfHwgWyAteiAiJHJlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgcmV0dXJuICRleGl0X2NvZGUKICAgIGZpCgogICAgZWNobyAtZSAiJHtDX0NZQU59SGVyZSBpcyB3aGF0IEkgY2FtZSB1cCB3aXRoOiR7Q19SRVNFVH0iCiAgICBlY2hvIC1lICIke0NfRElNfS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0ke0NfUkVTRVR9IgogICAgcHJpbnRmICclc1xuJyAiJHJlc3BvbnNlIgogICAgZWNobyAtZSAiJHtDX0RJTX0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJHtDX1JFU0VUfSIKCiAgICAjIFNlY3VyaXR5IGNoZWNrIGZvciBkYW5nZXJvdXMgY29tbWFuZHMKICAgIGxvY2FsIHNlY3VyaXR5X3Jlc3VsdCBzZWN1cml0eV9sZXZlbCBzZWN1cml0eV9yZWFzb24KICAgIHNlY3VyaXR5X3Jlc3VsdD0kKF9mdWNrX2RldGVjdF9kYW5nZXJvdXNfY29tbWFuZCAiJHJlc3BvbnNlIikKICAgIHNlY3VyaXR5X2xldmVsPSR7c2VjdXJpdHlfcmVzdWx0JSV8Kn0KICAgIHNlY3VyaXR5X3JlYXNvbj0ke3NlY3VyaXR5X3Jlc3VsdCMqfH0KCiAgICAjIEhhbmRsZSBzZWN1cml0eSBkZWNpc2lvbiBiYXNlZCBvbiBzZXZlcml0eQogICAgaWYgISBfZnVja19zZWN1cml0eV9oYW5kbGVfZGVjaXNpb24gIiRzZWN1cml0eV9sZXZlbCIgIiRzZWN1cml0eV9yZWFzb24iICIkcmVzcG9uc2UiOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1JFRH3inYwgQ29tbWFuZCBhYm9ydGVkIGR1ZSB0byBzZWN1cml0eSBwb2xpY3kuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgc2hvdWxkX2V4ZWM9ZmFsc2UKCiAgICBpZiBfZnVja190cnV0aHkgIiRhdXRvX21vZGUiOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33imqEgQXV0by1leGVjIGVuYWJsZWQuIFJ1bm5pbmcuLi4ke0NfUkVTRVR9IgogICAgICAgIHNob3VsZF9leGVjPXRydWUKICAgIGVsc2UKICAgICAgICAjIEludGVyYWN0aXZlIGNvbmZpcm1hdGlvbgogICAgICAgIHdoaWxlIHRydWU7IGRvCiAgICAgICAgICAgIHByaW50ZiAiJHtDX0JPTER9RXhlY3V0ZT8gW1kvbl0gJHtDX1JFU0VUfSIKICAgICAgICAgICAgbG9jYWwgY29uZmlybWF0aW9uIG5vcm1hbGl6ZWQKICAgICAgICAgICAgaWYgWyAtciAvZGV2L3R0eSBdOyB0aGVuCiAgICAgICAgICAgICAgICBJRlM9IHJlYWQgLXIgY29uZmlybWF0aW9uIDwgL2Rldi90dHkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgIyBGYWxsYmFjayBmb3Igbm8gVFRZCiAgICAgICAgICAgICAgICBJRlM9IHJlYWQgLXIgY29uZmlybWF0aW9uCiAgICAgICAgICAgIGZpCgogICAgICAgICAgICBjb25maXJtYXRpb249JChwcmludGYgJyVzJyAiJHtjb25maXJtYXRpb246LX0iIHwgdHIgLWQgJyBcdFxyJykKICAgICAgICAgICAgbm9ybWFsaXplZD0kKHByaW50ZiAnJXMnICIkY29uZmlybWF0aW9uIiB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQoKICAgICAgICAgICAgY2FzZSAiJG5vcm1hbGl6ZWQiIGluCiAgICAgICAgICAgICAgICAiInwieSJ8InllcyIpCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2V4ZWM9dHJ1ZQogICAgICAgICAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19HUkVFTn3inIUgRXhlY3V0aW5nLi4uJHtDX1JFU0VUfSIKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAibiJ8Im5vIikKICAgICAgICAgICAgICAgICAgICBzaG91bGRfZXhlYz1mYWxzZQogICAgICAgICAgICAgICAgICAgIF9mdWNrX2F1ZGl0X2xvZyAiQUJPUlQiICIkcmVzcG9uc2UiCiAgICAgICAgICAgICAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33inYwgQWJvcnRlZC4ke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAqKQogICAgICAgICAgICAgICAgICAgICMgTG9vcCBhZ2FpbgogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgIGVzYWMKICAgICAgICBkb25lCiAgICBmaQoKICAgIGlmIFsgIiRzaG91bGRfZXhlYyIgPSAidHJ1ZSIgXTsgdGhlbgogICAgICAgICMgU0VDVVJJVFkgTk9URTogZXZhbCDmiafooYwgQUkg55Sf5oiQ5ZG95Luk55qE5a6J5YWo5o6q5pa96K+05piOCiAgICAgICAgIyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAgICMKICAgICAgICAjIOeOsOacieS/neaKpOWxgu+8mgogICAgICAgICMgMS4g5pyN5Yqh56uv5riF5rSXIChzYW5pdGl6ZUNvbW1hbmQpOiDmj5Dlj5bku6PnoIHlnZfjgIHnp7vpmaQgbWFya2Rvd24gZmVuY2VzL3NoZWJhbmcv5rOo6YeK6KGMCiAgICAgICAgIyAyLiDmnKzlnLDlronlhajlvJXmk446IDIxIOadoeato+WImeinhOWImSAoOCBibG9jayArIDkgY2hhbGxlbmdlICsgNCB3YXJuKSDmiavmj4/ljbHpmanmqKHlvI8KICAgICAgICAjIDMuIEJsb2NrIOe6p+WRveS7pCAocm0gLXJmIC8sIGZvcmsgYm9tYnMg562JKSDlnKjmraTkuYvliY3lt7Looqvmi5Lnu50KICAgICAgICAjIDQuIENoYWxsZW5nZSDnuqflkb3ku6TpnIDopoHnlKjmiLfovpPlhaXnoa7orqTnn63or60KICAgICAgICAjIDUuIOeUqOaIt+ehruiupOaPkOekujog6Zmk6Z2eIEZVQ0tfQVVUT19FWEVDPXRydWXvvIzlkKbliJnpnIDmiYvliqjmibnlh4YKICAgICAgICAjCiAgICAgICAgIyDimqDvuI8g5bey55+l6ZmQ5Yi277yI5q2j5YiZ5byV5pOO5peg5rOV5a6M5YWo6KaG55uW77yJ77yaCiAgICAgICAgIyAtIOWkjeadguWRveS7pOmTvjog5bWM5aWX55qEICYmIC8gfHwgLyB8IOWPr+iDvee7lei/h+WNleS4gOaooeW8j+WMuemFjQogICAgICAgICMgLSDlkb3ku6Tmm7/mjaI6ICQoLi4uKSDlkowgYC4uLmAg5YaF55qE5bWM5aWX5ZG95Luk6Zq+5Lul6Z2Z5oCB5YiG5p6QCiAgICAgICAgIyAtIOWPmOmHj+WxleW8gDog6Ze05o6l5omn6KGMICjlpoIgJGNtZCkg5peg5rOV5Zyo5omn6KGM5YmN56Gu5a6a5YaF5a65CiAgICAgICAgIyAtIOe8lueggee7lei/hzogYmFzZTY0L2hleCDnvJbnoIHnmoQgcGF5bG9hZCDlj6/og73pgIPpgLjmo4DmtYsKICAgICAgICAjCiAgICAgICAgIyDorr7orqHnkIblv7U6IOWuieWFqOW8leaTjuaYryLlh4/pgJ/luKYi6ICM6Z2eIumYsuW8ueWimSLvvIzmnIDnu4jlronlhajkvp3otZbnlKjmiLflrqHmn6UKICAgICAgICAjIFRoZSAkcmVzcG9uc2UgdmFyaWFibGUgaGFzIGFscmVhZHkgcGFzc2VkIF9mdWNrX3NlY3VyaXR5X2hhbmRsZV9kZWNpc2lvbigpIGFib3ZlCiAgICAgICAgZXZhbCAiJHJlc3BvbnNlIgogICAgICAgIGxvY2FsIGV4aXRfY29kZT0kPwogICAgICAgIAogICAgICAgICMgTG9nIGNvbW1hbmQgZXhlY3V0aW9uCiAgICAgICAgX2Z1Y2tfYXVkaXRfbG9nICJFWEVDIiAiJHJlc3BvbnNlIiAiJGV4aXRfY29kZSIKICAgICAgICAKICAgICAgICBpZiBbICRleGl0X2NvZGUgLW5lIDAgXTsgdGhlbgogICAgICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfUNvbW1hbmQgZmFpbGVkIHdpdGggZXhpdCBjb2RlICRleGl0X2NvZGUuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZmkKICAgICAgICByZXR1cm4gJGV4aXRfY29kZQogICAgZWxzZQogICAgICAgICMgVGhlICdBYm9ydGVkLicgbWVzc2FnZSBpcyBub3cgcHJpbnRlZCB3aXRoaW4gdGhlIGxvb3AsCiAgICAgICAgIyBzbyB3ZSBqdXN0IHJldHVybiAxIGhlcmUgaWYgc2hvdWxkX2V4ZWMgaXMgZmFsc2UuCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCn0KCiMgRGVmaW5lIHRoZSBhbGlhcyBmb3IgaW50ZXJhY3RpdmUgdXNlIChzdXBwb3J0cyBjdXN0b20gYWxpYXNlcykKX2Z1Y2tfZGVmaW5lX2FsaWFzZXMoKSB7CiAgICBsb2NhbCBkZWZhdWx0X2FsaWFzPSJmdWNrIgoKICAgIGlmICEgX2Z1Y2tfdHJ1dGh5ICIke0ZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTOi0wfSI7IHRoZW4KICAgICAgICBhbGlhcyAiJGRlZmF1bHRfYWxpYXMiPSdfZnVja19leGVjdXRlX3Byb21wdCcKICAgIGZpCgogICAgaWYgWyAtbiAiJHtGVUNLX0FMSUFTOi19IiBdICYmIFsgIiRGVUNLX0FMSUFTIiAhPSAiJGRlZmF1bHRfYWxpYXMiIF07IHRoZW4KICAgICAgICBhbGlhcyAiJEZVQ0tfQUxJQVMiPSdfZnVja19leGVjdXRlX3Byb21wdCcKICAgIGZpCn0KCl9mdWNrX2RlZmluZV9hbGlhc2VzCgojIC0tLSDmoLjlv4PpgLvovpHnu5PmnZ8gLS0tCkVPRgoKIyAtLS0g5qC45b+D6YC76L6RIEhlcmVkb2Mg57uT5p2fIC0tLQoKIyBIZWxwZXIgdG8gbWF0ZXJpYWxpemUgdGhlIGVtYmVkZGVkIGNvcmUgbG9naWMgaW50byBhIGZpbGUgKHVzZWQgZm9yIGluc3RhbGwvdGVtcCBleGVjdXRpb24pCl9mdWNrX3dyaXRlX2NvcmUoKSB7CiAgICBsb2NhbCB0YXJnZXQ9IiQxIgogICAgcHJpbnRmICclc1xuJyAiJENPUkVfTE9HSUMiID4gIiR0YXJnZXQiCn0KCiMgSGVscGVyIHRvIHNvdXJjZSB0aGUgY29yZSBsb2dpYyBpbnRvIHRoZSBjdXJyZW50IHNoZWxsCl9mdWNrX3NvdXJjZV9jb3JlKCkgewogICBsb2NhbCB0bXBfY29yZQogICB0bXBfY29yZT0kKG1rdGVtcCkKICAgX2Z1Y2tfd3JpdGVfY29yZSAiJHRtcF9jb3JlIgogICAjIHNoZWxsY2hlY2sgZGlzYWJsZT1TQzEwOTAKICAgc291cmNlICIkdG1wX2NvcmUiCiAgIHJtIC1mICIkdG1wX2NvcmUiCn0KCgojIC0tLSDlronoo4Xlmajlh73mlbDvvIjnlLHlpJblsYLohJrmnKzov5DooYzvvIktLS0KCiMgSGVscGVyIHRvIGZpbmQgdGhlIHVzZXIncyBzaGVsbCBwcm9maWxlIGZpbGUKX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSgpIHsKICAgIGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgInpzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uenNocmMiCiAgICBlbGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgImJhc2giOyB0aGVuCiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnByb2ZpbGUiIF07IHRoZW4KICAgICAgICAjIEZhbGxiYWNrIGZvciBzaCwga3NoLCBldGMuCiAgICAgICAgZWNobyAiJEhPTUUvLnByb2ZpbGUiCiAgICBlbGlmIFsgLWYgIiRIT01FLy56c2hyYyIgXTsgdGhlbgogICAgICAgICMgRmFsbGJhY2sgaWYgU0hFTEwgdmFyIGlzbid0IHNldAogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLmJhc2hyYyIgXTsgdGhlbgogICAgICAgICMgRmFsbGJhY2sgaWYgU0hFTEwgdmFyIGlzbid0IHNldAogICAgICAgIGVjaG8gIiRIT01FLy5iYXNocmMiCiAgICBlbHNlCiAgICAgICAgZWNobyAidW5rbm93bl9wcm9maWxlIgogICAgZmkKfQoKIyBNYWluIGluc3RhbGxhdGlvbiBmdW5jdGlvbgpfaW5zdGFsbGVyX3NlY3VyZV9jb25maWdfZmlsZSgpIHsKICAgICAgICBpZiBbIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBjaG1vZCA2MDAgIiRDT05GSUdfRklMRSIgMj4vZGV2L251bGwgfHwgdHJ1ZQogICAgZmkKfQoKX2luc3RhbGxfc2NyaXB0KCkgewogICAgZWNobyAtZSAiJEZDS04gJHtDX0JPTER9QWxyaWdodCwgbGV0J3MgZ2V0IHRoaXMgc2hpdCBpbnN0YWxsZWQuLi4ke0NfUkVTRVR9IgogICAgbWtkaXIgLXAgIiRJTlNUQUxMX0RJUiIKICAgIAogICAgIyBXcml0ZSB0aGUgZW1iZWRkZWQgY29yZSBsb2dpYyB0byB0aGUgbWFpbi5zaCBmaWxlCiAgICBfZnVja193cml0ZV9jb3JlICIkTUFJTl9TSCIKCiAgICBpZiBbICQ/IC1uZSAwIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfUNhbid0IHdyaXRlIHRvIHRoZSBmaWxlLiBDaGVjayB5b3VyIGRhbW4gcGVybWlzc2lvbnMuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgIyBNYWtlIG1haW4uc2ggZXhlY3V0YWJsZQogICAgY2htb2QgK3ggIiRNQUlOX1NIIgoKICAgICMgQ3JlYXRlIGEgZGVmYXVsdCBjb25maWcgZmlsZSBpZiBpdCBkb2Vzbid0IGV4aXN0CiAgICBpZiBbICEgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNhdCA8PCdDRkcnID4gIiRDT05GSUdfRklMRSIKIyBmdWNraXRzIGNvbmZpZ3VyYXRpb24KIyBUb2dnbGUgdGhlIGV4cG9ydHMgYmVsb3cgdG8gY3VzdG9taXNlIHlvdXIgZXhwZXJpZW5jZS4KCiMgQ3VzdG9tIEFQSSBlbmRwb2ludCB0aGF0IHBvaW50cyB0byB5b3VyIHNlbGYtaG9zdGVkIHdvcmtlcgojIGV4cG9ydCBGVUNLX0FQSV9FTkRQT0lOVD0iaHR0cHM6Ly95b3VyLWRvbWFpbi53b3JrZXJzLmRldi8iCgojIExvY2FsIE9wZW5BSS1jb21wYXRpYmxlIEFQSSBrZXkgKHJlY29tbWVuZGVkKQojIGV4cG9ydCBGVUNLX09QRU5BSV9BUElfS0VZPSJzay0uLi4iCgojIE9wdGlvbmFsOiBvdmVycmlkZSBtb2RlbC9iYXNlIHdoZW4gdXNpbmcgeW91ciBvd24ga2V5CiMgZXhwb3J0IEZVQ0tfT1BFTkFJX01PREVMPSJncHQtNG8tbWluaSIKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0JBU0U9Imh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEiCgojIEFkZCBhbiBleHRyYSBhbGlhcyBiZXNpZGVzIHRoZSBkZWZhdWx0ICdmdWNrJwojIGV4cG9ydCBGVUNLX0FMSUFTPSJwbHMiCgojIFNraXAgY29uZmlybWF0aW9uIHByb21wdHMgKHVzZSB3aXRoIGNhdXRpb24hKQojIGV4cG9ydCBGVUNLX0FVVE9fRVhFQz1mYWxzZQoKIyBPdmVycmlkZSBjdXJsIHRpbWVvdXQgKHNlY29uZHMpCiMgZXhwb3J0IEZVQ0tfVElNRU9VVD0zMAoKIyBFbmFibGUgdmVyYm9zZSBkZWJ1ZyBsb2dzCiMgZXhwb3J0IEZVQ0tfREVCVUc9ZmFsc2UKCiMgRGlzYWJsZSB0aGUgYnVpbHQtaW4gJ2Z1Y2snIGFsaWFzCiMgZXhwb3J0IEZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTPWZhbHNlCkNGRwogICAgICAgIF9pbnN0YWxsZXJfc2VjdXJlX2NvbmZpZ19maWxlCiAgICBmaQoKICAgICMgQWRkIHNvdXJjZSBsaW5lIHRvIHNoZWxsIHByb2ZpbGUKICAgIGxvY2FsIHByb2ZpbGVfZmlsZQogICAgcHJvZmlsZV9maWxlPSQoX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSkKICAgIAogICAgaWYgWyAiJHByb2ZpbGVfZmlsZSIgPSAidW5rbm93bl9wcm9maWxlIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1JIGNhbid0IGZpbmQgLmJhc2hyYywgLnpzaHJjLCBvciAucHJvZmlsZS4gWW91J3JlIG9uIHlvdXIgb3duLiR7Q19SRVNFVH0iID4mMgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d9TWFudWFsbHkgYWRkIHRoaXMgbGluZSB0byB3aGF0ZXZlciBzdGFydHVwIGZpbGUgeW91IHVzZToke0NfUkVTRVR9IiA+JjIKICAgICAgICBlY2hvIC1lICJcbiAgJHtDX0NZQU59c291cmNlICRNQUlOX1NIJHtDX1JFU0VUfVxuIiA+JjIKICAgICAgICByZXR1cm4KICAgIGZpCiAgICAKICAgIGxvY2FsIHNvdXJjZV9saW5lPSJzb3VyY2UgJE1BSU5fU0giCiAgICBpZiAhIGdyZXAgLXFGICIkc291cmNlX2xpbmUiICIkcHJvZmlsZV9maWxlIjsgdGhlbgogICAgICAgICMgRW5zdXJlIHRoZSBmaWxlIGVuZHMgd2l0aCBhIG5ld2xpbmUgYmVmb3JlIHdlIGFkZCBvdXIgbGluZXMKICAgICAgICBpZiBbIC1uICIkKHRhaWwgLWMxICIkcHJvZmlsZV9maWxlIikiIF07IHRoZW4KICAgICAgICAgICAgZWNobyAiIiA+PiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICBmaQogICAgICAgIGVjaG8gIiMgQWRkZWQgYnkgZnVja2l0cyBpbnN0YWxsZXIiID4+ICIkcHJvZmlsZV9maWxlIgogICAgICAgIGVjaG8gIiRzb3VyY2VfbGluZSIgPj4gIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX0dSRUVOfUl0J3MgaW5zdGFsbGVkLiBOb3cgZ2V0IHRvIHdvcmsuJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfVJlc3RhcnQgeW91ciBzaGVsbCwgb3IgcnVuICR7Q19CT0xEfXNvdXJjZSAkcHJvZmlsZV9maWxlJHtDX1lFTExPV30gdG8gc3RhcnQuJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICJcbiR7Q19CT0xEfS0tLSBIT1cgVE8gVVNFIC0tLSR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiSnVzdCB0eXBlICR7Q19SRURfQk9MRH1mdWNrJHtDX1JFU0VUfSBmb2xsb3dlZCBieSB3aGF0IHlvdSB3YW50IHRvIGRvLiIKICAgICAgICBlY2hvIC1lICJFeGFtcGxlczoiCiAgICAgICAgZWNobyAtZSAiICAke0NfQ1lBTn1mdWNrIGluc3RhbGwgZ2l0JHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19DWUFOfWZ1Y2sgdW5pbnN0YWxsIGdpdCR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiICAke0NfQ1lBTn1mdWNrIGZpbmQgYWxsIGZpbGVzIGxhcmdlciB0aGFuIDEwTUIgaW4gdGhlIGN1cnJlbnQgZGlyZWN0b3J5JHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19SRURfQk9MRH1mdWNrIHVuaW5zdGFsbCR7Q19SRVNFVH0gJHtDX0dSRUVOfSMgVW5pbnN0YWxscyAke0NfUkVTRVR9JHtDX1JFRH1mdWNrJHtDX1JFU0VUfSR7Q19HUkVFTn0gaXRzZWxmJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19SRURfQk9MRH1mdWNrIGNvbmZpZyR7Q19SRVNFVH0gJHtDX0dSRUVOfSMgU2hvdyBjb25maWd1cmF0aW9uIGhlbHAke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIlxuJHtDX1lFTExPV31SZW1lbWJlciB0byByZXN0YXJ0IHlvdXIgc2hlbGwgdG8gYmVnaW4hJHtDX1JFU0VUfSIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfWUVMTE9XfUl0J3MgYWxyZWFkeSBpbnN0YWxsZWQsIGdlbml1cy4gSnVzdCB1cGRhdGVkIHRoZSBzY3JpcHQgZm9yIHlvdS4ke0NfUkVTRVR9IgogICAgZmkKfQoKCiMgLS0tIOiEmuacrOS4u+WFpeWPoyAtLS0KCiMgSWYgYmVpbmcgc291cmNlZCBmb3IgdGVzdGluZywgbG9hZCBjb3JlIGxvZ2ljIGFuZCBza2lwIGVudHJ5cG9pbnQKaWYgWyAtbiAiJHtCQVRTX1RFU1RfRElSTkFNRTotfSIgXSB8fCBbIC1uICIke0JBVFNfVEVTVF9GSUxFTkFNRTotfSIgXTsgdGhlbgogICAgIyBMb2FkIGNvcmUgbG9naWMgZnVuY3Rpb25zIGZvciB0ZXN0aW5nCiAgICBfZnVja19zb3VyY2VfY29yZQogICAgcmV0dXJuIDAKZmkKCiMgSWYgYXJndW1lbnRzIGFyZSBwYXNzZWQgKGUuZy4sICJiYXNoIC1zIC4uLiIpCmlmIFsgIiQjIiAtZ3QgMCBdOyB0aGVuCiAgICBpZiBbICIkMSIgPSAiaW5zdGFsbCIgXSAmJiBbICIkIyIgLWVxIDEgXTsgdGhlbgogICAgICAgIF9pbnN0YWxsX3NjcmlwdAogICAgICAgIGV4aXQgMAogICAgZmkKCiAgICBfZnVja19zb3VyY2VfY29yZQogICAgX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQgIiRAIgplbHNlCiAgICBfaW5zdGFsbF9zY3JpcHQKZmkK`);
const INSTALLER_SCRIPT_ZH = b64_to_utf8(`IyEvYmluL2Jhc2gKIwojIOi/meaYryBmdWNraXRzIOeahOWuieijheWSjOS4tOaXtui/kOihjOiEmuacrAojIOasoui/juS9v+eUqAojCiMgLS0tIOWuieWFqOS9v+eUqOaWueazlSAtLS0KIwojIDEuIOS4i+i9vToKIyAgICBjdXJsIC1vIGZ1Y2tpdHMgaHR0cHM6Ly9mdWNraXRzLjI1NTAwNTUyLnh5ei96aAojCiMgMi4g5p+l55yL5Luj56CBOgojICAgIGxlc3MgZnVja2l0cwojCiMgMy4g6L+Q6KGMICjlronoo4UpOgojICAgIGJhc2ggZnVja2l0cwojCiMgNC4g6L+Q6KGMICjkuLTml7bkvb/nlKgpOgojICAgIGJhc2ggZnVja2l0cyAi5L2g55qE5ZG95LukIgojCgpzZXQgLWV1byBwaXBlZmFpbAoKIyAtLS0g6Ziy5q2iIHJlYWRvbmx5IOWPmOmHj+mHjeWkjeWumuS5iSAtLS0KIyDmraTlrojljavlhYHorrjohJrmnKzooqvlpJrmrKEgc291cmNl77yI5L6L5aaC5Zyo5rWL6K+V5Lit77yJCmlmIFtbIC16ICIke0ZVQ0tJVFNfWkhfQ09OU1RBTlRTX0RFRklORUQ6LX0iIF1dOyB0aGVuCiAgICAjIOagh+iusOW4uOmHj+W3suWumuS5ie+8iGV4cG9ydCDkvb/lrZAgc2hlbGwg5Y+v6KeB77yJCiAgICBleHBvcnQgRlVDS0lUU19aSF9DT05TVEFOVFNfREVGSU5FRD0xCgojIC0tLSDpopzoibLlrprkuYkgLS0tCnJlYWRvbmx5IENfUkVTRVQ9J1wwMzNbMG0nCnJlYWRvbmx5IENfUkVEX0JPTEQ9J1wwMzNbMTszMW0nCnJlYWRvbmx5IENfUkVEPSdcMDMzWzA7MzFtJwpyZWFkb25seSBDX0dSRUVOPSdcMDMzWzA7MzJtJwpyZWFkb25seSBDX1lFTExPVz0nXDAzM1swOzMzbScKcmVhZG9ubHkgQ19DWUFOPSdcMDMzWzA7MzZtJwpyZWFkb25seSBDX0JPTEQ9J1wwMzNbMW0nCnJlYWRvbmx5IENfRElNPSdcMDMzWzJtJwoKcmVhZG9ubHkgRlVDS0lUU19MT0NBTEU9InpoIgoKIyAtLS0g5o+Q56S656ymIC0tLQpyZWFkb25seSBGVUNLPSIke0NfUkVEX0JPTER9WyFdJHtDX1JFU0VUfSIKcmVhZG9ubHkgRkNLTj0iJHtDX1JFRH1b5o+Q56S6XSR7Q19SRVNFVH0iCgoKIyAtLS0g6YWN572uIC0tLQppZiBbIC16ICIke0hPTUU6LX0iIF07IHRoZW4KICAgIGVjaG8gLWUgIlwwMzNbMTszMW3plJnor68hXDAzM1swbSBcMDMzWzA7MzFt5oKo55qEIEhPTUUg546v5aKD5Y+Y6YeP5pyq6K6+572u77yM5peg5rOV56Gu5a6a5a6J6KOF5L2N572u77yM6K+35YWI6K6+572u6K+l5Y+Y6YeP44CCICjkvovlpoI6IGV4cG9ydCBIT01FPS9yb290KVwwMzNbMG0iID4mMgogICAgZXhpdCAxCmZpCnJlYWRvbmx5IElOU1RBTExfRElSPSIkSE9NRS8uZnVjayIKcmVhZG9ubHkgTUFJTl9TSD0iJElOU1RBTExfRElSL21haW4uc2giCnJlYWRvbmx5IENPTkZJR19GSUxFPSIkSU5TVEFMTF9ESVIvY29uZmlnLnNoIgoKZmkgICMgcmVhZG9ubHkg5bi46YeP5a6I5Y2r57uT5p2fCgojIC0tLSDmoLjlv4PpgLvovpEgKOWhnui/m+S4gOS4quWtl+espuS4sumHjCkgLS0tCnJlYWQgLXIgLWQgJycgQ09SRV9MT0dJQyA8PCdFT0YnIHx8IHRydWUKCiMgLS0tIGZ1Y2tpdHMg5qC45b+D6YC76L6R5byA5aeLIC0tLQoKIyAtLS0g6K+t6KiA6K6+572uIC0tLQojIOS4reaWh+eJiOiEmuacrO+8jOW8uuWItuiuvue9ruivreiogOeOr+WigwppZiBbIC16ICIke0ZVQ0tJVFNfTE9DQUxFOi19IiBdOyB0aGVuCiAgICByZWFkb25seSBGVUNLSVRTX0xPQ0FMRT0iemgiCmZpCgojIC0tLSDpopzoibLlrprkuYkgLS0tCiMg5Y+q5pyJ5Zyo5rKh5a6a5LmJ6L+H6aKc6Imy55qE5oOF5Ya15LiL5omN5a6a5LmJICjkuLTml7bmqKHlvI/nlKgpCmlmIFsgLXogIiR7Q19SRVNFVDotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgQ19SRVNFVD0nXDAzM1swbScKICAgIHJlYWRvbmx5IENfUkVEX0JPTEQ9J1wwMzNbMTszMW0nCiAgICByZWFkb25seSBDX1JFRD0nXDAzM1swOzMxbScKICAgIHJlYWRvbmx5IENfR1JFRU49J1wwMzNbMDszMm0nCiAgICByZWFkb25seSBDX1lFTExPVz0nXDAzM1swOzMzbScKICAgIHJlYWRvbmx5IENfQ1lBTj0nXDAzM1swOzM2bScKICAgIHJlYWRvbmx5IENfQk9MRD0nXDAzM1sxbScKICAgIHJlYWRvbmx5IENfRElNPSdcMDMzWzJtJwoKICAgICMgLS0tIOaPkOekuuespiAtLS0KICAgIHJlYWRvbmx5IEZVQ0s9IiR7Q19SRURfQk9MRH1bIV0ke0NfUkVTRVR9IgogICAgcmVhZG9ubHkgRkNLTj0iJHtDX1JFRH1b5o+Q56S6XSR7Q19SRVNFVH0iCgpmaQoKaWYgWyAteiAiJHtJTlNUQUxMX0RJUit4fSIgXSB8fCBbIC16ICIke01BSU5fU0greH0iIF0gfHwgWyAteiAiJHtDT05GSUdfRklMRSt4fSIgXTsgdGhlbgogICAgaWYgWyAteiAiJHtIT01FOi19IiBdOyB0aGVuCiAgICAgICAgcmVhZG9ubHkgSU5TVEFMTF9ESVI9Ii90bXAvLmZ1Y2siCiAgICAgICAgcmVhZG9ubHkgTUFJTl9TSD0iL3RtcC8uZnVjay9tYWluLnNoIgogICAgICAgIHJlYWRvbmx5IENPTkZJR19GSUxFPSIvdG1wLy5mdWNrL2NvbmZpZy5zaCIKICAgIGVsc2UKICAgICAgICByZWFkb25seSBJTlNUQUxMX0RJUj0iJEhPTUUvLmZ1Y2siCiAgICAgICAgcmVhZG9ubHkgTUFJTl9TSD0iJElOU1RBTExfRElSL21haW4uc2giCiAgICAgICAgcmVhZG9ubHkgQ09ORklHX0ZJTEU9IiRJTlNUQUxMX0RJUi9jb25maWcuc2giCiAgICBmaQpmaQoKIyDms6jmhI/vvJrphY3nva7mlofku7bliqDovb3lnKjpqozor4Hlh73mlbDlrprkuYnkuYvlkI7ov5vooYzvvIjop4HkuIvmlrnvvIkKCiMgLS0tIOWuieWFqOmFjee9rumqjOivgSAtLS0KIyDlnKggc291cmNlIOmFjee9ruaWh+S7tuWJjemqjOivgeWFtuWGheWuue+8jOmYsuatouS7o+eggeazqOWFpQojIOWPguaVsO+8miQxIC0g6KaB6aqM6K+B55qE5paH5Lu26Lev5b6ECiMg6L+U5Zue77yaMCDlpoLmnpzlronlhajvvIwxIOWmguaenOS4jeWuieWFqOaIluWHuumUmQpfZnVja192YWxpZGF0ZV9jb25maWdfZmlsZSgpIHsKICAgIGxvY2FsIGZpbGU9IiQxIgoKICAgICMg5paH5Lu25b+F6aG75a2Y5Zyo5LiU5Y+v6K+7CiAgICBpZiBbICEgLWYgIiRmaWxlIiBdIHx8IFsgISAtciAiJGZpbGUiIF07IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIOajgOafpeaWh+S7tuadg+mZkCAtIOW/hemhu+eUseW9k+WJjeeUqOaIt+aLpeaciQogICAgaWYgWyAiJChzdGF0IC1jICcldScgIiRmaWxlIiAyPi9kZXYvbnVsbCB8fCBzdGF0IC1mICcldScgIiRmaWxlIiAyPi9kZXYvbnVsbCkiICE9ICIkKGlkIC11KSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5bGe5LqO5b2T5YmN55So5oi377yM5ouS57ud5Yqg6L2944CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbGluZV9udW09MAogICAgbG9jYWwgbGluZQoKICAgICMg6aKE5a6a5LmJ5q2j5YiZ6KGo6L6+5byP5Y+Y6YeP77yIenNoIOWFvOWuueaAp++8muWPmOmHj+W9ouW8j+mBv+WFjeeJueauiuWtl+espuino+aekOmXrumimO+8iQogICAgbG9jYWwgcmVfY21kX3N1Yj0nXCRcKCcKICAgIGxvY2FsIHJlX2JhY2t0aWNrPSdgJwogICAgbG9jYWwgcmVfYXJpdGg9J1wkXChcKCcKICAgIGxvY2FsIHJlX3NlbWk9JzsnCiAgICBsb2NhbCByZV9hbmQ9JyYmJwogICAgbG9jYWwgcmVfb3I9J1x8XHwnCiAgICBsb2NhbCByZV9waXBlPSdcfCcKICAgIGxvY2FsIHJlX2d0PSc+JwogICAgbG9jYWwgcmVfbHQ9JzwnCiAgICBsb2NhbCByZV9hbXA9JyYnCiAgICBsb2NhbCByZV9lc2M9J1xcXCQnCgogICAgd2hpbGUgSUZTPSByZWFkIC1yIGxpbmUgfHwgWyAtbiAiJGxpbmUiIF07IGRvCiAgICAgICAgbGluZV9udW09JCgobGluZV9udW0gKyAxKSkKCiAgICAgICAgIyDot7Pov4fnqbrooYwKICAgICAgICBpZiBbIC16ICIkbGluZSIgXSB8fCBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSokIF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyDot7Pov4fms6jph4rooYzvvIjku6UgIyDlvIDlpLTvvIzlj6/mnInliY3lr7znqbrnmb3vvIkKICAgICAgICBpZiBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSojIF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyDmo4Dmn6XljbHpmannmoQgc2hlbGwg5YWD5a2X56ym5ZKM5ZG95Luk5pu/5o2iCiAgICAgICAgIyDmi5Lnu53vvJokKCksIGBgLCAkKCgpLCA7LCAmJiwgfHwsIHwgKOeuoemBkyksID4sIDwsICYsIOaNouihjOi9rOS5iQogICAgICAgIGlmIFtbICIkbGluZSIgPX4gJHJlX2NtZF9zdWIgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2JhY2t0aWNrIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hcml0aCBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfc2VtaSBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfYW5kIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9vciBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfcGlwZSBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfZ3QgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2x0IF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hbXAgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2VzYyBdXTsgdGhlbgogICAgICAgICAgICBfZnVja19kZWJ1ZyAi6YWN572u6aqM6K+B5aSx6LSl77yM56ysICRsaW5lX251bSDooYzvvJrmo4DmtYvliLDljbHpmanlhYPlrZfnrKYiCiAgICAgICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5a6J5YWo77ya56ysICRsaW5lX251bSDooYzljIXlkKvljbHpmannmoQgc2hlbGwg5YWD5a2X56ymJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKCiAgICAgICAgIyDlj6rlhYHorrjvvJpleHBvcnQgRlVDS18qPS4uLiDmiJYgRlVDS18qPS4uLu+8iOWPr+acieWJjeWvvOepuueZve+8iQogICAgICAgICMg5Lmf5YWB6K6477yaZXhwb3J0IEZVQ0tJVFNfTE9DQUxFPS4uLgogICAgICAgIGlmIFtbICIkbGluZSIgPX4gXltbOnNwYWNlOl1dKihleHBvcnRbWzpzcGFjZTpdXSspPyhGVUNLX1tBLVpfXSt8RlVDS0lUU19MT0NBTEUpPSBdXTsgdGhlbgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZpCgogICAgICAgICMg5ouS57ud5YW25LuW5Lu75L2V5YaF5a65CiAgICAgICAgX2Z1Y2tfZGVidWcgIumFjee9rumqjOivgeWksei0pe+8jOesrCAkbGluZV9udW0g6KGM77ya5peg5rOV6K+G5Yir55qE5qih5byPIgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5a6J5YWo77ya56ysICRsaW5lX251bSDooYzljIXlkKvml6Dms5Xor4bliKvnmoTlhoXlrrkke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZG9uZSA8ICIkZmlsZSIKCiAgICByZXR1cm4gMAp9CgojIOmqjOivgeWQjuWuieWFqOWcsOWKoOi9vemFjee9ruaWh+S7tgojIOWPguaVsO+8miQxIC0g6KaB5Yqg6L2955qE5paH5Lu26Lev5b6ECiMg6L+U5Zue77yaMCDlpoLmnpzmiJDlip/liqDovb3vvIwxIOWmguaenOmqjOivgeWksei0peaIluaWh+S7tuS4jeWtmOWcqApfZnVja19zYWZlX3NvdXJjZV9jb25maWcoKSB7CiAgICBsb2NhbCBmaWxlPSIkMSIKCiAgICBpZiBbICEgLWYgIiRmaWxlIiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAgICMg5rKh5pyJ5paH5Lu25Lmf5rKh5YWz57O7CiAgICBmaQoKICAgIGlmIF9mdWNrX3ZhbGlkYXRlX2NvbmZpZ19maWxlICIkZmlsZSI7IHRoZW4KICAgICAgICAjIHNoZWxsY2hlY2sgZGlzYWJsZT1TQzEwOTAKICAgICAgICBzb3VyY2UgIiRmaWxlIgogICAgICAgIHJldHVybiAkPwogICAgZWxzZQogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d96YWN572u5paH5Lu26aqM6K+B5aSx6LSl77yM5bey6Lez6L+H5Yqg6L2977yaJGZpbGUke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyAtLS0g5Yqg6L2955So5oi36YWN572u77yI5bim6aqM6K+B77yJLS0tCiMg6aqM6K+B5Ye95pWw5bey5a6a5LmJ77yM546w5Zyo5Y+v5Lul5a6J5YWo5Zyw5Yqg6L296YWN572uCl9mdWNrX3NhZmVfc291cmNlX2NvbmZpZyAiJENPTkZJR19GSUxFIgoKIyAtLS0g5a6h6K6h5pel5b+XIC0tLQojIOiusOW9leWRveS7pOaJp+ihjOWIsOWuoeiuoeaXpeW/l+aWh+S7tgojIOWPguaVsDogJDEgLSDkuovku7bnsbvlnosgKOWmgiAiRVhFQyIsICJCTE9DSyIsICJBQk9SVCIpLCAkMiAtIOWRveS7pCwgJDMgLSDpgIDlh7rnoIHvvIjlj6/pgInvvIkKX2Z1Y2tfYXVkaXRfbG9nKCkgewogICAgIyDmo4Dmn6XmmK/lkKblkK/nlKjlrqHorqHml6Xlv5cKICAgIGlmIFsgIiR7RlVDS19BVURJVF9MT0c6LWZhbHNlfSIgIT0gInRydWUiIF07IHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZmkKICAgIAogICAgbG9jYWwgZXZlbnQ9IiQxIgogICAgbG9jYWwgY29tbWFuZD0iJDIiCiAgICBsb2NhbCBleGl0X2NvZGU9IiR7MzotLX0iCiAgICBsb2NhbCB0aW1lc3RhbXAKICAgIHRpbWVzdGFtcD0kKGRhdGUgLXUgJyslWS0lbS0lZCAlSDolTTolUyBVVEMnIDI+L2Rldi9udWxsIHx8IGRhdGUgJyslWS0lbS0lZCAlSDolTTolUycpCiAgICBsb2NhbCBsb2dfZmlsZT0iJHtGVUNLX0FVRElUX0xPR19GSUxFOi0kSU5TVEFMTF9ESVIvLmF1ZGl0LmxvZ30iCiAgICAKICAgICMg56Gu5L+d5pel5b+X55uu5b2V5a2Y5ZyoCiAgICBta2RpciAtcCAiJChkaXJuYW1lICIkbG9nX2ZpbGUiKSIgMj4vZGV2L251bGwgfHwgdHJ1ZQogICAgCiAgICAjIOa4heeQhuWRveS7pOeUqOS6juaXpeW/l+iusOW9le+8iOinhOiMg+aNouihjOOAgei9rOS5ieWIhumalOespuOAgemZkOWItumVv+W6pu+8iQogICAgbG9jYWwgc2FuaXRpemVkX2NtZAogICAgbG9jYWwgcmF3X2xlbj0keyNjb21tYW5kfQogICAgc2FuaXRpemVkX2NtZD0kKHByaW50ZiAnJXMnICIkY29tbWFuZCIgfCB0ciAnXHJcbicgJyAgJyB8IHNlZCAncy98L1xcfC9nJyB8IGhlYWQgLWMgMjAwKQogICAgaWYgWyAiJHJhd19sZW4iIC1ndCAyMDAgXTsgdGhlbgogICAgICAgIHNhbml0aXplZF9jbWQ9IiR7c2FuaXRpemVkX2NtZH0uLi4iCiAgICBmaQogICAgCiAgICAjIOWGmeWFpeaXpeW/l+aWh+S7tu+8iOagvOW8j++8muaXtumXtOaIs3znlKjmiLd85LqL5Lu2fOmAgOWHuueggXzlkb3ku6TvvIkKICAgIHByaW50ZiAnJXN8JXN8JXN8JXN8JXNcbicgIiR7dGltZXN0YW1wfSIgIiR7VVNFUjotdW5rbm93bn0iICIke2V2ZW50fSIgIiR7ZXhpdF9jb2RlfSIgIiR7c2FuaXRpemVkX2NtZH0iID4+ICIkbG9nX2ZpbGUiIDI+L2Rldi9udWxsIHx8IHRydWUKICAgIAogICAgIyDkv53miqTml6Xlv5fmlofku7YKICAgIGNobW9kIDYwMCAiJGxvZ19maWxlIiAyPi9kZXYvbnVsbCB8fCB0cnVlCn0KCmlmIFsgLXogIiR7REVGQVVMVF9BUElfRU5EUE9JTlQreH0iIF07IHRoZW4KICAgIHJlYWRvbmx5IERFRkFVTFRfQVBJX0VORFBPSU5UPSJodHRwczovL2Z1Y2tpdHMuMjU1MDA1NTIueHl6L3poIgpmaQoKIyDmib7nlKjmiLcgc2hlbGwg6YWN572u5paH5Lu255qE6L6F5Yqp5Ye95pWwCl9pbnN0YWxsZXJfZGV0ZWN0X3Byb2ZpbGUoKSB7CiAgICBpZiBbIC1uICIke1NIRUxMOi19IiBdICYmIGVjaG8gIiRTSEVMTCIgfCBncmVwIC1xICJ6c2giOyB0aGVuCiAgICAgICAgZWNobyAiJEhPTUUvLnpzaHJjIgogICAgZWxpZiBbIC1uICIke1NIRUxMOi19IiBdICYmIGVjaG8gIiRTSEVMTCIgfCBncmVwIC1xICJiYXNoIjsgdGhlbgogICAgICAgIGVjaG8gIiRIT01FLy5iYXNocmMiCiAgICBlbGlmIFsgLWYgIiRIT01FLy5wcm9maWxlIiBdOyB0aGVuCiAgICAgICAgIyDlhbzlrrkgc2gsIGtzaCDnrYkKICAgICAgICBlY2hvICIkSE9NRS8ucHJvZmlsZSIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnpzaHJjIiBdOyB0aGVuCiAgICAgICAgIyBTSEVMTCDlj5jph4/msqHorr7nva7ml7bnmoTlpIfnlKjmlrnmoYgKICAgICAgICBlY2hvICIkSE9NRS8uenNocmMiCiAgICBlbGlmIFsgLWYgIiRIT01FLy5iYXNocmMiIF07IHRoZW4KICAgICAgICAjIFNIRUxMIOWPmOmHj+ayoeiuvue9ruaXtueahOWkh+eUqOaWueahiAogICAgICAgIGVjaG8gIiRIT01FLy5iYXNocmMiCiAgICBlbHNlCiAgICAgICAgZWNobyAidW5rbm93bl9wcm9maWxlIgogICAgZmkKfQoKIyAtLS0g57O757uf5L+h5oGv5pS26ZuG5qih5Z2XIC0tLQojIOmdmeaAgeezu+e7n+S/oeaBr+e8k+WtmOaWh+S7tu+8iOi3qOi/kOihjOaMgeS5heWMlu+8iQojIOS7heWcqOacquWumuS5ieaXtuiuvue9ru+8iOmYsuatoiByZWFkLW9ubHkg5Y+Y6YeP6ZSZ6K+v77yJCmlmIFsgLXogIiR7RlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEU6LX0iIF07IHRoZW4KICAgIHJlYWRvbmx5IEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFPSIkSU5TVEFMTF9ESVIvLnN5c2luZm8uY2FjaGUiCmZpCiMg57yT5a2Y54q25oCB6Lef6Liq5Y+Y6YePCl9GVUNLX1NUQVRJQ19DQUNIRV9MT0FERUQ9MApfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFk9MAoKIyDku47nvJPlrZjmlofku7bliqDovb3pnZnmgIHns7vnu5/kv6Hmga8KIyDlhajlsYDlj5jph486IF9GVUNLX1NUQVRJQ19DQUNIRV9MT0FERUQsIEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFCl9mdWNrX2xvYWRfc3RhdGljX2NhY2hlKCkgewogICAgIyDlpoLmnpznvJPlrZjlt7LliqDovb3liJnnm7TmjqXov5Tlm54KICAgIGlmIFsgIiR7X0ZVQ0tfU1RBVElDX0NBQ0hFX0xPQURFRDotMH0iIC1lcSAxIF07IHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBfRlVDS19TVEFUSUNfQ0FDSEVfTE9BREVEPTEKCiAgICAjIOWmguaenOe8k+WtmOaWh+S7tuWtmOWcqOWImeWKoOi9vQogICAgaWYgWyAtZiAiJEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFIiBdOyB0aGVuCiAgICAgICAgIyBzaGVsbGNoZWNrIGRpc2FibGU9U0MxMDkwCiAgICAgICAgc291cmNlICIkRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUiIHx8IHRydWUKICAgIGZpCn0KCiMg5qCH6K6w6Z2Z5oCB57yT5a2Y5Li66ISP77yI6ZyA6KaB5oyB5LmF5YyW77yJCiMg5YWo5bGA5Y+Y6YePOiBfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFkKX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkoKSB7CiAgICBfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFk9MQp9CgojIOWwhumdmeaAgeezu+e7n+S/oeaBr+aMgeS5heWMluWIsOe8k+WtmOaWh+S7tgojIOWFqOWxgOWPmOmHjzogX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZLCBGVUNLX1NZU0lORk9fQ0FDSEVfRklMRQojIOi/lOWbnuWAvDog5oiQ5Yqf6L+U5ZueIDDvvIzlpLHotKXov5Tlm54gMQpfZnVja19wZXJzaXN0X3N0YXRpY19jYWNoZSgpIHsKICAgICMg5LuF5Zyo57yT5a2Y6ISP5pe25omN5oyB5LmF5YyWCiAgICBpZiBbICIke19GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWTotMH0iIC1uZSAxIF07IHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICAjIOehruS/nee8k+WtmOebruW9leWtmOWcqAogICAgbG9jYWwgY2FjaGVfZGlyCiAgICBjYWNoZV9kaXI9JChkaXJuYW1lICIkRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUiKQogICAgaWYgISBta2RpciAtcCAiJGNhY2hlX2RpciIgMj4vZGV2L251bGw7IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIOWIm+W7uuS4tOaXtuaWh+S7tui/m+ihjOWOn+WtkOWGmeWFpQogICAgbG9jYWwgdG1wX2ZpbGUKICAgIHRtcF9maWxlPSQobWt0ZW1wKSB8fCByZXR1cm4gMQoKICAgICMg5bCG57yT5a2Y5Y+Y6YeP5YaZ5YWl5Li05pe25paH5Lu2CiAgICB7CiAgICAgICAgcHJpbnRmICdfRlVDS19DQUNIRURfRElTVFJPPSVxXFxuJyAiJHtfRlVDS19DQUNIRURfRElTVFJPOi19IgogICAgICAgIHByaW50ZiAnX0ZVQ0tfQ0FDSEVEX0tFUk5FTD0lcVxcbicgIiR7X0ZVQ0tfQ0FDSEVEX0tFUk5FTDotfSIKICAgICAgICBwcmludGYgJ19GVUNLX0NBQ0hFRF9BUkNIPSVxXFxuJyAiJHtfRlVDS19DQUNIRURfQVJDSDotfSIKICAgICAgICBwcmludGYgJ19GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUj0lcVxcbicgIiR7X0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSOi19IgogICAgfSA+ICIkdG1wX2ZpbGUiCgogICAgIyDljp/lrZDnp7vliqjliLDmnIDnu4jkvY3nva4KICAgIGlmIG12ICIkdG1wX2ZpbGUiICIkRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUiIDI+L2Rldi9udWxsOyB0aGVuCiAgICAgICAgX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZPTAKICAgICAgICByZXR1cm4gMAogICAgZWxzZQogICAgICAgICMg5aSx6LSl5pe25riF55CG5Li05pe25paH5Lu2CiAgICAgICAgcm0gLWYgIiR0bXBfZmlsZSIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyDmo4DmtYvlj5HooYzniYgv57O757uf5a625peP77yI5pSv5oyB57yT5a2Y77yJCiMg6L6T5Ye6OiDlj5HooYzniYjlrZfnrKbkuLLvvIjlpoLvvJoiRGViaWFuIOezuyAxMi4wNCAoVWJ1bnR1IDI0LjA0IExUUyki77yJCl9mdWNrX2RldGVjdF9kaXN0cm8oKSB7CiAgICBfZnVja19sb2FkX3N0YXRpY19jYWNoZQoKICAgICMg5aaC5p6c5pyJ57yT5a2Y5YC85YiZ55u05o6l6L+U5ZueCiAgICBpZiBbIC1uICIke19GVUNLX0NBQ0hFRF9ESVNUUk86LX0iIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkX0ZVQ0tfQ0FDSEVEX0RJU1RSTyIKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBsb2NhbCBrZXJuZWxfbmFtZSBkaXN0cm8gaWQgdmVyc2lvbiBwcmV0dHkgZmFtaWx5CiAgICBrZXJuZWxfbmFtZT0kKHVuYW1lIC1zIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBkaXN0cm89InVua25vd24iCgogICAgIyBtYWNPUyDmo4DmtYsKICAgIGlmIFsgIiRrZXJuZWxfbmFtZSIgPSAiRGFyd2luIiBdOyB0aGVuCiAgICAgICAgbG9jYWwgcHJvZHVjdCB2ZXJzaW9uCiAgICAgICAgcHJvZHVjdD0kKHN3X3ZlcnMgLXByb2R1Y3ROYW1lIDI+L2Rldi9udWxsIHx8IHByaW50ZiAnbWFjT1MnKQogICAgICAgIHByb2R1Y3Q9JChwcmludGYgJyVzJyAiJHByb2R1Y3QiIHwgdHIgLWQgJ1xyXG4nKQogICAgICAgIHZlcnNpb249JChzd192ZXJzIC1wcm9kdWN0VmVyc2lvbiAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgICAgIHZlcnNpb249JChwcmludGYgJyVzJyAiJHZlcnNpb24iIHwgdHIgLWQgJ1xyXG4nKQogICAgICAgIGRpc3Rybz0iJHByb2R1Y3QgJHZlcnNpb24iCiAgICAjIExpbnV4IOS9v+eUqCAvZXRjL29zLXJlbGVhc2Ug5qOA5rWLCiAgICBlbGlmIFsgLXIgL2V0Yy9vcy1yZWxlYXNlIF07IHRoZW4KICAgICAgICBpZD0kKGdyZXAgLUUgJ15JRD0nIC9ldGMvb3MtcmVsZWFzZSB8IGhlYWQgLW4xIHwgY3V0IC1kPSAtZjIgfCB0ciAtZCAnIicgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKICAgICAgICB2ZXJzaW9uPSQoZ3JlcCAtRSAnXlZFUlNJT05fSUQ9JyAvZXRjL29zLXJlbGVhc2UgfCBoZWFkIC1uMSB8IGN1dCAtZD0gLWYyIHwgdHIgLWQgJyInKQogICAgICAgIHByZXR0eT0kKGdyZXAgLUUgJ15QUkVUVFlfTkFNRT0nIC9ldGMvb3MtcmVsZWFzZSB8IGhlYWQgLW4xIHwgY3V0IC1kPSAtZjItIHwgdHIgLWQgJyInKQoKICAgICAgICAjIOehruWumuezu+e7n+WutuaXj+S7peS+v+abtOWlveWcsOWIhuexuwogICAgICAgIGZhbWlseT0iIgogICAgICAgIGNhc2UgIiRpZCIgaW4KICAgICAgICAgICAgdWJ1bnR1fGRlYmlhbikKICAgICAgICAgICAgICAgIGZhbWlseT0iRGViaWFuIOezuyIKICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgIGNlbnRvc3xyaGVsfHJvY2t5fGFsbWFsaW51eHxmZWRvcmEpCiAgICAgICAgICAgICAgICBmYW1pbHk9IlJIRUwg57O7IgogICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgYXJjaHxtYW5qYXJvfGVuZGVhdm91cm9zKQogICAgICAgICAgICAgICAgZmFtaWx5PSJBcmNoIOezuyIKICAgICAgICAgICAgICAgIDs7CiAgICAgICAgZXNhYwoKICAgICAgICAjIOagvOW8j+WMluWPkeihjOeJiOWtl+espuS4su+8jOWMheWQq+WutuaXj+WSjOeJiOacrOS/oeaBrwogICAgICAgIGlmIFsgLW4gIiRmYW1pbHkiIF07IHRoZW4KICAgICAgICAgICAgZGlzdHJvPSIkZmFtaWx5ICR7dmVyc2lvbjotfSIKICAgICAgICAgICAgaWYgWyAtbiAiJHByZXR0eSIgXTsgdGhlbgogICAgICAgICAgICAgICAgZGlzdHJvPSIkZGlzdHJvICgke3ByZXR0eX0pIgogICAgICAgICAgICBmaQogICAgICAgIGVsc2UKICAgICAgICAgICAgZGlzdHJvPSIke3ByZXR0eTotTGludXggJHZlcnNpb259IgogICAgICAgIGZpCiAgICBlbHNlCiAgICAgICAgZGlzdHJvPSIka2VybmVsX25hbWUiCiAgICBmaQoKICAgICMg57yT5a2Y5bm26L+U5Zue57uT5p6cCiAgICBfRlVDS19DQUNIRURfRElTVFJPPSIkZGlzdHJvIgogICAgX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkKICAgIHByaW50ZiAnJXNcbicgIiRkaXN0cm8iCn0KCiMg6I635Y+W5YaF5qC454mI5pys5L+h5oGv77yI5pSv5oyB57yT5a2Y77yJCiMg6L6T5Ye6OiDlhoXmoLjniYjmnKzlrZfnrKbkuLLvvIjlpoLvvJoiTGludXggNi44LjAtMzEtZ2VuZXJpYyLvvIkKX2Z1Y2tfZ2V0X2tlcm5lbF92ZXJzaW9uKCkgewogICAgX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUKCiAgICAjIOWmguaenOaciee8k+WtmOWAvOWImeebtOaOpei/lOWbngogICAgaWYgWyAtbiAiJHtfRlVDS19DQUNIRURfS0VSTkVMOi19IiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJF9GVUNLX0NBQ0hFRF9LRVJORUwiCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgbG9jYWwga2VybmVsCiAgICBrZXJuZWw9JCh1bmFtZSAtc3IgMj4vZGV2L251bGwgfHwgdW5hbWUgLXMgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGtlcm5lbD0kKHByaW50ZiAnJXMnICIka2VybmVsIiB8IHRyIC1kICdcclxuJykKCiAgICAjIOe8k+WtmOW5tui/lOWbnue7k+aenAogICAgX0ZVQ0tfQ0FDSEVEX0tFUk5FTD0iJGtlcm5lbCIKICAgIF9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5CiAgICBwcmludGYgJyVzXG4nICIka2VybmVsIgp9CgojIOiOt+WPluezu+e7n+aetuaehO+8iOaUr+aMgee8k+WtmO+8iQojIOi+k+WHujog5p625p6E5a2X56ym5Liy77yI5aaC77yaIng4Nl82NCIsICJhcm02NCLvvIkKX2Z1Y2tfZ2V0X2FyY2hpdGVjdHVyZSgpIHsKICAgIF9mdWNrX2xvYWRfc3RhdGljX2NhY2hlCgogICAgIyDlpoLmnpzmnInnvJPlrZjlgLzliJnnm7TmjqXov5Tlm54KICAgIGlmIFsgLW4gIiR7X0ZVQ0tfQ0FDSEVEX0FSQ0g6LX0iIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkX0ZVQ0tfQ0FDSEVEX0FSQ0giCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgbG9jYWwgYXJjaAogICAgYXJjaD0kKHVuYW1lIC1tIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBhcmNoPSQocHJpbnRmICclcycgIiRhcmNoIiB8IHRyIC1kICdcclxuJykKCiAgICAjIOe8k+WtmOW5tui/lOWbnue7k+aenAogICAgX0ZVQ0tfQ0FDSEVEX0FSQ0g9IiRhcmNoIgogICAgX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkKICAgIHByaW50ZiAnJXNcbicgIiRhcmNoIgp9CgojIOaUtumbhueUqOaIt+S/oeaBr+WMheaLrOadg+mZkOe6p+WIqwojIOi+k+WHujog55So5oi35L+h5oGv5a2X56ym5Liy77yI5aaC77yaIlVzZXI9am9obiB1aWQ9MTAwMCBsZXZlbD1zdWRvZXIgR3JvdXBzPWpvaG4gYWRtIHN1ZG8i77yJCl9mdWNrX2NvbGxlY3RfdXNlcl9pbmZvKCkgewogICAgbG9jYWwgY3VycmVudF91c2VyIHVpZCBncm91cHMgbGV2ZWwKICAgIGN1cnJlbnRfdXNlcj0iJHtVU0VSOi19IgoKICAgICMg5aaC5p6cIFVTRVIg5pyq6K6+572u5YiZ5L2/55So5aSH55So5pa55rOVCiAgICBpZiBbIC16ICIkY3VycmVudF91c2VyIiBdOyB0aGVuCiAgICAgICAgY3VycmVudF91c2VyPSQod2hvYW1pIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBmaQoKICAgICMg5aaC5p6cIGlkIOWRveS7pOWPr+eUqOWImeiOt+WPliBVSUQg5ZKM55So5oi357uECiAgICB1aWQ9InVua25vd24iCiAgICBncm91cHM9InVua25vd24iCiAgICBpZiBjb21tYW5kIC12IGlkID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgIHVpZD0kKGlkIC11ICIkY3VycmVudF91c2VyIiAyPi9kZXYvbnVsbCB8fCBpZCAtdSAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgICAgIGdyb3Vwcz0kKGlkIC1HbiAiJGN1cnJlbnRfdXNlciIgMj4vZGV2L251bGwgfHwgaWQgLUduIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBmaQoKICAgICMg56Gu5a6a5p2D6ZmQ57qn5YirCiAgICBsZXZlbD0idXNlciIKICAgIGlmIFsgIiR1aWQiID0gIjAiIF07IHRoZW4KICAgICAgICBsZXZlbD0icm9vdCIKICAgIGVsaWYgcHJpbnRmICclcycgIiRncm91cHMiIHwgZ3JlcCAtRXEgJyhefFtbOnNwYWNlOl1dKShzdWRvfHdoZWVsfGFkbWluKShbWzpzcGFjZTpdXXwkKSc7IHRoZW4KICAgICAgICBsZXZlbD0ic3Vkb2VyIgogICAgZmkKCiAgICBwcmludGYgJ1VzZXI9JXMgdWlkPSVzIGxldmVsPSVzIEdyb3Vwcz0lcycgIiRjdXJyZW50X3VzZXIiICIkdWlkIiAiJGxldmVsIiAiJGdyb3VwcyIKfQoKIyDmlLbpm4bluLjnlKjlvIDlj5Hlt6XlhbfnmoTniYjmnKzkv6Hmga8KIyDovpPlh7o6IOW3peWFt+eJiOacrOWtl+espuS4su+8iOWmgu+8miJnaXQ6Z2l0IHZlcnNpb24gMi4zNC4xOyBkb2NrZXI6RG9ja2VyIHZlcnNpb24gMjQuMC42OyAuLi4i77yJCl9mdWNrX2NvbGxlY3RfdG9vbF92ZXJzaW9ucygpIHsKICAgIGxvY2FsIHRvb2xzIHRvb2wgdmVyc2lvbiByZXN1bHQKICAgIHRvb2xzPSJnaXQgZG9ja2VyIG5wbSBrdWJlY3RsIGN1cmwgd2dldCIKICAgIHJlc3VsdD0iIgoKICAgIGZvciB0b29sIGluICR0b29sczsgZG8KICAgICAgICB2ZXJzaW9uPSJub3QtaW5zdGFsbGVkIgoKICAgICAgICBpZiBjb21tYW5kIC12ICIkdG9vbCIgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgICAgIGNhc2UgIiR0b29sIiBpbgogICAgICAgICAgICAgICAgZ2l0fGRvY2tlcnxjdXJsfHdnZXQpCiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbj0kKCIkdG9vbCIgLS12ZXJzaW9uIDI+L2Rldi9udWxsIHwgaGVhZCAtbjEpCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgIG5wbSkKICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPSQoIiR0b29sIiAtLXZlcnNpb24gMj4vZGV2L251bGwgfCBoZWFkIC1uMSkKICAgICAgICAgICAgICAgICAgICBbIC1uICIkdmVyc2lvbiIgXSAmJiB2ZXJzaW9uPSJucG0gJHZlcnNpb24iCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgIGt1YmVjdGwpCiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbj0kKCIkdG9vbCIgdmVyc2lvbiAtLWNsaWVudCAtLXNob3J0IDI+L2Rldi9udWxsIHwgaGVhZCAtbjEpCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgZXNhYwogICAgICAgIGZpCgogICAgICAgICMg5riF55CG54mI5pys5a2X56ym5LiyCiAgICAgICAgdmVyc2lvbj0kKHByaW50ZiAnJXMnICIke3ZlcnNpb246LXVua25vd259IiB8IHRyICdcclxuJyAnICAnIHwgdHIgLXMgJyAnIHwgc2VkIC1lICdzL14gKi8vJyAtZSAncy8gKiQvLycpCiAgICAgICAgWyAteiAiJHZlcnNpb24iIF0gJiYgdmVyc2lvbj0idW5rbm93biIKCiAgICAgICAgcmVzdWx0PSIkcmVzdWx0JHRvb2w6JHZlcnNpb247ICIKICAgIGRvbmUKCiAgICAjIOenu+mZpOacq+WwvueahOWIhuWPt+WSjOepuuagvAogICAgcmVzdWx0PSIke3Jlc3VsdCU7IH0iCiAgICBwcmludGYgJyVzJyAiJHJlc3VsdCIKfQoKIyDmo4DmtYvljIXnrqHnkIblmajvvIjmlK/mjIHnvJPlrZjvvIkKIyDovpPlh7o6IOWMheeuoeeQhuWZqOWQjeensO+8iGFwdCwgeXVtLCBkbmYsIHBhY21hbiwgenlwcGVyLCBicmV3LCB1bmtub3du77yJCl9mdWNrX2RldGVjdF9wa2dfbWFuYWdlcigpIHsKICAgIF9mdWNrX2xvYWRfc3RhdGljX2NhY2hlCgogICAgIyDlpoLmnpzmnInnvJPlrZjlgLzliJnnm7TmjqXov5Tlm54KICAgIGlmIFsgLW4gIiR7X0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSOi19IiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJF9GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUiIKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBsb2NhbCBtYW5hZ2VyPSJ1bmtub3duIgoKICAgICMg5oyJ5LyY5YWI57qn5qOA5rWL5YyF566h55CG5ZmoCiAgICBpZiBjb21tYW5kIC12IGFwdC1nZXQgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0iYXB0IgogICAgZWxpZiBjb21tYW5kIC12IHl1bSAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJ5dW0iCiAgICBlbGlmIGNvbW1hbmQgLXYgZG5mICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9ImRuZiIKICAgIGVsaWYgY29tbWFuZCAtdiBwYWNtYW4gJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0icGFjbWFuIgogICAgZWxpZiBjb21tYW5kIC12IHp5cHBlciAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJ6eXBwZXIiCiAgICBlbGlmIGNvbW1hbmQgLXYgYnJldyAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJicmV3IgogICAgZmkKCiAgICAjIOe8k+WtmOW5tui/lOWbnue7k+aenAogICAgX0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSPSIkbWFuYWdlciIKICAgIF9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5CiAgICBwcmludGYgJyVzXG4nICIkbWFuYWdlciIKfQoKIyDmlLbpm4bnroDljJbnmoTns7vnu5/kv6Hmga/lubbmoLzlvI/ljJbkuLrnu5PmnoTljJblrZfnrKbkuLIKIyDovpPlh7o6IOeUqOS6jiBBSSDlpITnkIbnmoTns7vnu5/kv6Hmga/lrZfnrKbkuLIKX2Z1Y2tfY29sbGVjdF9zeXNpbmZvX3N0cmluZygpIHsKICAgIGxvY2FsIG9zX3R5cGUga2VybmVsX25hbWUgcGtnX21hbmFnZXIgc3VtbWFyeQoKICAgICMg5qOA5rWL5pON5L2c57O757uf57G75Z6LCiAgICBrZXJuZWxfbmFtZT0kKHVuYW1lIC1zIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCgogICAgY2FzZSAiJGtlcm5lbF9uYW1lIiBpbgogICAgICAgIERhcndpbikKICAgICAgICAgICAgb3NfdHlwZT0ibWFjT1MiCiAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJicmV3IgogICAgICAgICAgICA7OwogICAgICAgIExpbnV4KQogICAgICAgICAgICBpZiBbIC1yIC9ldGMvb3MtcmVsZWFzZSBdOyB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBpZAogICAgICAgICAgICAgICAgaWQ9JChncmVwIC1FICdeSUQ9JyAvZXRjL29zLXJlbGVhc2UgfCBoZWFkIC1uMSB8IGN1dCAtZD0gLWYyIHwgdHIgLWQgJyInIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCiAgICAgICAgICAgICAgICBjYXNlICIkaWQiIGluCiAgICAgICAgICAgICAgICAgICAgdWJ1bnR1fGRlYmlhbikKICAgICAgICAgICAgICAgICAgICAgICAgb3NfdHlwZT0iRGViaWFuIgogICAgICAgICAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0iYXB0IgogICAgICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgICAgIGNlbnRvc3xyaGVsfHJvY2t5fGFsbWFsaW51eHxmZWRvcmEpCiAgICAgICAgICAgICAgICAgICAgICAgIG9zX3R5cGU9IlJIRUwiCiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ5dW0iCiAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgYXJjaHxtYW5qYXJvKQogICAgICAgICAgICAgICAgICAgICAgICBvc190eXBlPSJBcmNoIgogICAgICAgICAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0icGFjbWFuIgogICAgICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgICAgICopCiAgICAgICAgICAgICAgICAgICAgICAgIG9zX3R5cGU9IkxpbnV4IgogICAgICAgICAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0idW5rbm93biIKICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgIGVzYWMKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgb3NfdHlwZT0iTGludXgiCiAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0idW5rbm93biIKICAgICAgICAgICAgZmkKICAgICAgICAgICAgOzsKICAgICAgICBNSU5HVyp8TVNZUyp8Q1lHV0lOKikKICAgICAgICAgICAgb3NfdHlwZT0iV2luZG93cyIKICAgICAgICAgICAgcGtnX21hbmFnZXI9InVua25vd24iCiAgICAgICAgICAgIDs7CiAgICAgICAgKikKICAgICAgICAgICAgb3NfdHlwZT0iJGtlcm5lbF9uYW1lIgogICAgICAgICAgICBwa2dfbWFuYWdlcj0idW5rbm93biIKICAgICAgICAgICAgOzsKICAgIGVzYWMKCiAgICAjIOagvOW8j+WMluS4uueugOWNleeahOe7k+aehOWMluWtl+espuS4sgogICAgcHJpbnRmIC12IHN1bW1hcnkgJ09TPSVzOyBQa2dNZ3I9JXMnICIkb3NfdHlwZSIgIiRwa2dfbWFuYWdlciIKICAgIHByaW50ZiAnJXNcbicgIiRzdW1tYXJ5Igp9CgpfZnVja19qc29uX2VzY2FwZSgpIHsKICAgIGxvY2FsIGlucHV0PSIkMSIKICAgICMg5L2/55SoIHByaW50ZiDmraPnoa7lpITnkIbmjqfliLblrZfnrKYKICAgIHByaW50ZiAnJXMnICIkaW5wdXQiIHwgc2VkIC1lICcKICAgICAgICAjIOmmluWFiOi9rOS5ieWPjeaWnOadoO+8iOW/hemhu+aYr+esrOS4gOS4qu+8iQogICAgICAgIHMvXFwvXFxcXC9nCiAgICAgICAgIyDovazkuYnlj4zlvJXlj7cKICAgICAgICBzLyIvXFwiL2cKICAgICAgICAjIOi9rOS5ieaOp+WItuWtl+espu+8iEFTQ0lJIDAtMzHvvIkKICAgICAgICBzL1x4MDAvXFx1MDAwMC9nCiAgICAgICAgcy9ceDAxL1xcdTAwMDEvZwogICAgICAgIHMvXHgwMi9cXHUwMDAyL2cKICAgICAgICBzL1x4MDMvXFx1MDAwMy9nCiAgICAgICAgcy9ceDA0L1xcdTAwMDQvZwogICAgICAgIHMvXHgwNS9cXHUwMDA1L2cKICAgICAgICBzL1x4MDYvXFx1MDAwNi9nCiAgICAgICAgcy9ceDA3L1xcdTAwMDcvZwogICAgICAgIHMvXHgwOC9cXGIvZwogICAgICAgIHMvXHgwOS9cXHQvZwogICAgICAgIHMvXHgwQS9cXG4vZwogICAgICAgIHMvXHgwQi9cXHUwMDBCL2cKICAgICAgICBzL1x4MEMvXFxmL2cKICAgICAgICBzL1x4MEQvXFxyL2cKICAgICAgICBzL1x4MEUvXFx1MDAwRS9nCiAgICAgICAgcy9ceDBGL1xcdTAwMEYvZwogICAgICAgIHMvXHgxMC9cXHUwMDEwL2cKICAgICAgICBzL1x4MTEvXFx1MDAxMS9nCiAgICAgICAgcy9ceDEyL1xcdTAwMTIvZwogICAgICAgIHMvXHgxMy9cXHUwMDEzL2cKICAgICAgICBzL1x4MTQvXFx1MDAxNC9nCiAgICAgICAgcy9ceDE1L1xcdTAwMTUvZwogICAgICAgIHMvXHgxNi9cXHUwMDE2L2cKICAgICAgICBzL1x4MTcvXFx1MDAxNy9nCiAgICAgICAgcy9ceDE4L1xcdTAwMTgvZwogICAgICAgIHMvXHgxOS9cXHUwMDE5L2cKICAgICAgICBzL1x4MUEvXFx1MDAxQS9nCiAgICAgICAgcy9ceDFCL1xcdTAwMUIvZwogICAgICAgIHMvXHgxQy9cXHUwMDFDL2cKICAgICAgICBzL1x4MUQvXFx1MDAxRC9nCiAgICAgICAgcy9ceDFFL1xcdTAwMUUvZwogICAgICAgIHMvXHgxRi9cXHUwMDFGL2cKICAgICcKfQoKX2Z1Y2tfc2hvdWxkX3VzZV9sb2NhbF9hcGkoKSB7CiAgICBpZiBbIC1uICIke0ZVQ0tfT1BFTkFJX0FQSV9LRVk6LX0iIF07IHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZmkKICAgIHJldHVybiAxCn0KCl9mdWNrX2xvY2FsX3N5c3RlbV9wcm9tcHQoKSB7CiAgICBsb2NhbCBzeXNpbmZvPSIkMSIKICAgIGlmIFsgIiRGVUNLSVRTX0xPQ0FMRSIgPSAiemgiIF07IHRoZW4KICAgICAgICBwcmludGYgJ+S9oOaYr+S4gOS4quS4k+S4mueahCBzaGVsbCDlkb3ku6TnlJ/miJDlmajjgILnlKjmiLfkvJrnlKjoh6rnhLbor63oqIDmj4/ov7Dku5bku6zmg7PopoHlrozmiJDnmoTku7vliqHjgILkvaDnmoTku7vliqHmmK/nlJ/miJDnm7TmjqXlj6/miafooYznmoQgc2hlbGwg5ZG95Luk5p2l5a6M5oiQ55So5oi355qE55uu5qCH44CCCgrph43opoHop4TliJnvvJoKMS4g55So5oi36L6T5YWl5piv6Ieq54S26K+t6KiA5o+P6L+w5oSP5Zu+77yM5LiN5piv5ZG95Luk5Y+C5pWw44CC5L6L5aaCIuWIl+WHuuebruW9lSLmhI/mgJ3mmK/miafooYwgbHMg5ZG95Luk77yM6ICM5LiN5pivIGxzICLliJflh7rnm67lvZUiCjIuIOeUn+aIkOebtOaOpeWPr+aJp+ihjOeahOWRveS7pO+8jOS4jeimgeeUn+aIkOW4puWPguaVsOWIpOaWreeahOiEmuacrOaooeadv++8iOWmgiBpZiBbICQjIC1lcSAwIF3vvIkKMy4g5a+55LqO566A5Y2V5Lu75Yqh55u05o6l6L+U5Zue5Y2V5p2h5ZG95Luk77yM5aSN5p2C5Lu75Yqh5Y+v5Lul5piv5aSa6KGM6ISa5pysCjQuIOS4jeimgeaPkOS+m+S7u+S9leino+mHiuOAgeazqOmHiuOAgW1hcmtkb3duIOagvOW8j++8iOavlOWmgiBgYGBiYXNo77yJ5oiWIHNoZWJhbmfvvIjkvovlpoIgIyEvYmluL2Jhc2jvvIkKCuekuuS+i++8mgotIOeUqOaIt+ivtCLliJflh7rnm67lvZUiIOKGkiDovpPlh7o6IGxzCi0g55So5oi36K+0IuaYvuekuuivpue7huaWh+S7tuWIl+ihqCIg4oaSIOi+k+WHujogbHMgLWxhCi0g55So5oi36K+0IuafpeaJvuWkp+S6jjEwTULnmoTmlofku7YiIOKGkiDovpPlh7o6IGZpbmQgLiAtdHlwZSBmIC1zaXplICsxME0KCueUqOaIt+eahOezu+e7n+S/oeaBr+aYr++8miVzJyAiJHN5c2luZm8iCiAgICBlbHNlCiAgICAgICAgcHJpbnRmICdZb3UgYXJlIGFuIGV4cGVydCBzaGVsbCBjb21tYW5kIGdlbmVyYXRvci4gVXNlcnMgZGVzY3JpYmUgdGFza3MgaW4gbmF0dXJhbCBsYW5ndWFnZS4gWW91ciB0YXNrIGlzIHRvIGdlbmVyYXRlIGRpcmVjdGx5IGV4ZWN1dGFibGUgc2hlbGwgY29tbWFuZHMgdG8gYWNjb21wbGlzaCB0aGVpciBnb2Fscy4KCkltcG9ydGFudCBydWxlczoKMS4gVXNlciBpbnB1dCBpcyBuYXR1cmFsIGxhbmd1YWdlIGludGVudCwgTk9UIGNvbW1hbmQgYXJndW1lbnRzLiBGb3IgZXhhbXBsZSwgImxpc3QgZGlyZWN0b3J5IiBtZWFucyBydW4gbHMsIG5vdCBscyAibGlzdCBkaXJlY3RvcnkiCjIuIEdlbmVyYXRlIGRpcmVjdGx5IGV4ZWN1dGFibGUgY29tbWFuZHMsIG5vdCBzY3JpcHQgdGVtcGxhdGVzIHdpdGggcGFyYW1ldGVyIGhhbmRsaW5nIChsaWtlIGlmIFsgJCMgLWVxIDAgXSkKMy4gRm9yIHNpbXBsZSB0YXNrcyByZXR1cm4gc2luZ2xlIGNvbW1hbmRzLCBjb21wbGV4IHRhc2tzIGNhbiBiZSBtdWx0aS1saW5lIHNjcmlwdHMKNC4gRG8gbm90IHByb3ZpZGUgYW55IGV4cGxhbmF0aW9uLCBjb21tZW50cywgbWFya2Rvd24gZm9ybWF0dGluZyAobGlrZSBgYGBiYXNoKSwgb3IgYSBzaGViYW5nIChlLmcuLCAjIS9iaW4vYmFzaCkKCkV4YW1wbGVzOgotIFVzZXIgc2F5cyAibGlzdCBkaXJlY3RvcnkiIOKGkiBPdXRwdXQ6IGxzCi0gVXNlciBzYXlzICJzaG93IGRldGFpbGVkIGZpbGUgbGlzdCIg4oaSIE91dHB1dDogbHMgLWxhCi0gVXNlciBzYXlzICJmaW5kIGZpbGVzIGxhcmdlciB0aGFuIDEwTUIiIOKGkiBPdXRwdXQ6IGZpbmQgLiAtdHlwZSBmIC1zaXplICsxME0KClRoZSB1c2VyJyInIidzIHN5c3RlbSBpbmZvIGlzOiAlcycgIiRzeXNpbmZvIgogICAgZmkKfQoKX2Z1Y2tfZXh0cmFjdF9jb21tYW5kX2Zyb21fanNvbigpIHsKICAgIGxvY2FsIGpzb25fZmlsZT0iJDEiCiAgICBpZiBjb21tYW5kIC12IHB5dGhvbjMgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgcHl0aG9uMyAtICIkanNvbl9maWxlIiA8PCdQWTInCmltcG9ydCBqc29uLCBzeXMKcGF0aCA9IHN5cy5hcmd2WzFdCndpdGggb3BlbihwYXRoLCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICBkYXRhID0ganNvbi5sb2FkKGYpCmNob2ljZXMgPSBkYXRhLmdldCgnY2hvaWNlcycpIG9yIFtdCmlmIG5vdCBjaG9pY2VzOgogICAgc3lzLmV4aXQoMSkKbWVzc2FnZSA9IGNob2ljZXNbMF0uZ2V0KCdtZXNzYWdlJykgb3Ige30KY29udGVudCA9IChtZXNzYWdlLmdldCgnY29udGVudCcpIG9yICcnKS5zdHJpcCgpCmlmIG5vdCBjb250ZW50OgogICAgc3lzLmV4aXQoMSkKcHJpbnQoY29udGVudCkKUFkyCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIGlmIGNvbW1hbmQgLXYgbm9kZSA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICBub2RlIC0gIiRqc29uX2ZpbGUiIDw8J0pTMicKY29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwpjb25zdCBwYXRoID0gcHJvY2Vzcy5hcmd2WzFdOwpjb25zdCBkYXRhID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGF0aCwgJ3V0ZjgnKSk7CmNvbnN0IGNob2ljZSA9IChkYXRhLmNob2ljZXMgJiYgZGF0YS5jaG9pY2VzWzBdKSB8fCB7fTsKY29uc3QgbWVzc2FnZSA9IGNob2ljZS5tZXNzYWdlIHx8IHt9Owpjb25zdCBjb250ZW50ID0gKG1lc3NhZ2UuY29udGVudCB8fCAnJykudHJpbSgpOwppZiAoIWNvbnRlbnQpIHsKICBwcm9jZXNzLmV4aXQoMSk7Cn0KY29uc29sZS5sb2coY29udGVudCk7CkpTMgogICAgICAgIHJldHVybgogICAgZmkKCiAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeaXoOazleino+aekOaooeWei+i/lOWbnueahOaVsOaNru+8jOivt+WuieijhSBweXRob24zIOaIliBub2Rl44CCJHtDX1JFU0VUfSIgPiYyCiAgICByZXR1cm4gMQp9CgpfZnVja19yZXF1ZXN0X2xvY2FsX21vZGVsKCkgewogICAgbG9jYWwgcHJvbXB0PSIkMSIKICAgIGxvY2FsIHN5c2luZm89IiQyIgogICAgbG9jYWwgY3VybF90aW1lb3V0PSIkMyIKCiAgICBsb2NhbCBhcGlfa2V5PSIke0ZVQ0tfT1BFTkFJX0FQSV9LRVk6LX0iCiAgICBpZiBbIC16ICIkYXBpX2tleSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR95pyq6YWN572u5pys5ZywIEFQSSBLZXnvvIzor7flnKggfi8uZnVjay9jb25maWcuc2gg5Lit6K6+572uIEZVQ0tfT1BFTkFJX0FQSV9LRVnjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBsb2NhbCBtb2RlbD0iJHtGVUNLX09QRU5BSV9NT0RFTDotZ3B0LTUtbmFub30iCiAgICBsb2NhbCBhcGlfYmFzZT0iJHtGVUNLX09QRU5BSV9BUElfQkFTRTotaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MX0iCiAgICBhcGlfYmFzZT0ke2FwaV9iYXNlJS99CiAgICBsb2NhbCBhcGlfdXJsPSIkYXBpX2Jhc2UvY2hhdC9jb21wbGV0aW9ucyIKCiAgICBfZnVja19kZWJ1ZyAi5pys5ZywIEFQSSDln7rlnYA6ICRhcGlfYmFzZSIKICAgIF9mdWNrX2RlYnVnICLmnKzlnLDmqKHlnos6ICRtb2RlbCIKCiAgICBsb2NhbCBzeXN0ZW1fcHJvbXB0CiAgICBzeXN0ZW1fcHJvbXB0PSQoX2Z1Y2tfbG9jYWxfc3lzdGVtX3Byb21wdCAiJHN5c2luZm8iKQoKICAgIGxvY2FsIHBheWxvYWQKICAgIHBheWxvYWQ9JChwcmludGYgJ3sgIm1vZGVsIjogIiVzIiwgIm1lc3NhZ2VzIjogWyB7InJvbGUiOiJzeXN0ZW0iLCJjb250ZW50IjoiJXMifSwgeyJyb2xlIjoidXNlciIsImNvbnRlbnQiOiIlcyJ9IF0sICJtYXhfdG9rZW5zIjogMTAyNCwgInRlbXBlcmF0dXJlIjogMC4yIH0nIFwKICAgICAgICAiJG1vZGVsIiAiJChfZnVja19qc29uX2VzY2FwZSAiJHN5c3RlbV9wcm9tcHQiKSIgIiQoX2Z1Y2tfanNvbl9lc2NhcGUgIiRwcm9tcHQiKSIpCgogICAgbG9jYWwgdG1wX2pzb24KICAgIHRtcF9qc29uPSQobWt0ZW1wKSB8fCByZXR1cm4gMQoKICAgIGlmICEgY3VybCAtZnNTIC0tbWF4LXRpbWUgIiRjdXJsX3RpbWVvdXQiICIkYXBpX3VybCIgXAogICAgICAgIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIFwKICAgICAgICAtSCAiQXV0aG9yaXphdGlvbjogQmVhcmVyICRhcGlfa2V5IiBcCiAgICAgICAgLWQgIiRwYXlsb2FkIiA+ICIkdG1wX2pzb24iOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH3mnKzlnLAgQVBJIOivt+axguWksei0peOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIGNhdCAiJHRtcF9qc29uIiA+JjIKICAgICAgICBybSAtZiAiJHRtcF9qc29uIgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIGNvbW1hbmRfb3V0cHV0CiAgICBpZiAhIGNvbW1hbmRfb3V0cHV0PSQoX2Z1Y2tfZXh0cmFjdF9jb21tYW5kX2Zyb21fanNvbiAiJHRtcF9qc29uIik7IHRoZW4KICAgICAgICBybSAtZiAiJHRtcF9qc29uIgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR95peg5rOV6Kej5p6Q5qih5Z6L6L+U5Zue5YaF5a6544CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgcm0gLWYgIiR0bXBfanNvbiIKICAgIHByaW50ZiAnJXNcbicgIiRjb21tYW5kX291dHB1dCIKfQoKX2Z1Y2tfcmVxdWVzdF93b3JrZXJfbW9kZWwoKSB7CiAgICBsb2NhbCBwcm9tcHQ9IiQxIgogICAgbG9jYWwgc3lzaW5mbz0iJDIiCiAgICBsb2NhbCBjdXJsX3RpbWVvdXQ9IiQzIgogICAgbG9jYWwgc3Bpbm5lcl9sYWJlbD0iJHs0Oi19IgoKICAgIGxvY2FsIGFkbWluX2tleT0iJHtGVUNLX0FETUlOX0tFWTotfSIKICAgIGxvY2FsIGFkbWluX3NlZ21lbnQ9IiIKICAgIGlmIFsgLW4gIiRhZG1pbl9rZXkiIF07IHRoZW4KICAgICAgICBhZG1pbl9zZWdtZW50PSQocHJpbnRmICcsICJhZG1pbktleSI6ICIlcyInICIkKCBfZnVja19qc29uX2VzY2FwZSAiJGFkbWluX2tleSIgKSIpCiAgICBmaQoKICAgIGxvY2FsIHBheWxvYWQKICAgIHBheWxvYWQ9JChwcmludGYgJ3sgInN5c2luZm8iOiAiJXMiLCAicHJvbXB0IjogIiVzIiVzIH0nIFwKICAgICAgICAiJCggX2Z1Y2tfanNvbl9lc2NhcGUgIiRzeXNpbmZvIiApIiBcCiAgICAgICAgIiQoIF9mdWNrX2pzb25fZXNjYXBlICIkcHJvbXB0IiApIiBcCiAgICAgICAgIiRhZG1pbl9zZWdtZW50IikKCiAgICBsb2NhbCBhcGlfdXJsPSIke0ZVQ0tfQVBJX0VORFBPSU5UOi0kREVGQVVMVF9BUElfRU5EUE9JTlR9IgoKICAgIF9mdWNrX2RlYnVnICJBUEkgVVJMOiAkYXBpX3VybCIKICAgIF9mdWNrX2RlYnVnICJQYXlsb2FkOiAkcGF5bG9hZCIKICAgIF9mdWNrX2RlYnVnICJUaW1lb3V0OiAkY3VybF90aW1lb3V0IgoKICAgIGxvY2FsIHRtcF9yZXNwb25zZSB0bXBfc3RhdHVzCiAgICB0bXBfcmVzcG9uc2U9JChta3RlbXApCiAgICB0bXBfc3RhdHVzPSQobWt0ZW1wKQoKICAgICgKICAgICAgICBjdXJsIC1zUyAtLW1heC10aW1lICIkY3VybF90aW1lb3V0IiAtWCBQT1NUICIkYXBpX3VybCIgXAogICAgICAgICAgICAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiBcCiAgICAgICAgICAgIC1kICIkcGF5bG9hZCIgLW8gIiR0bXBfcmVzcG9uc2UiIC13ICIle2h0dHBfY29kZX0iID4gIiR0bXBfc3RhdHVzIgogICAgKSAmCiAgICBsb2NhbCBwaWQ9JCEKCiAgICBpZiBbIC10IDIgXTsgdGhlbgogICAgICAgIF9mdWNrX3NwaW5uZXIgIiRwaWQiICIkc3Bpbm5lcl9sYWJlbCIgPiYyCiAgICBmaQoKICAgIGxvY2FsIGN1cmxfZXhpdD0wCiAgICBpZiAhIHdhaXQgIiRwaWQiOyB0aGVuCiAgICAgICAgY3VybF9leGl0PSQ/CiAgICBmaQoKICAgIGxvY2FsIGh0dHBfc3RhdHVzPSIiCiAgICBpZiBbIC1mICIkdG1wX3N0YXR1cyIgXTsgdGhlbgogICAgICAgIGh0dHBfc3RhdHVzPSQodHIgLWQgJ1xyXG4nIDwgIiR0bXBfc3RhdHVzIikKICAgICAgICBybSAtZiAiJHRtcF9zdGF0dXMiCiAgICBmaQoKICAgIGxvY2FsIHJlc3BvbnNlPSIiCiAgICBpZiBbIC1mICIkdG1wX3Jlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgcmVzcG9uc2U9JChjYXQgIiR0bXBfcmVzcG9uc2UiKQogICAgICAgIHJtIC1mICIkdG1wX3Jlc3BvbnNlIgogICAgZmkKCiAgICBpZiBbICRjdXJsX2V4aXQgLW5lIDAgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR95peg5rOV6L+e5o6l5Yiw5YWx5LqrIFdvcmtlcuOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIGlmIFsgLW4gIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgICAgICBlY2hvIC1lICIke0NfRElNfSRyZXNwb25zZSR7Q19SRVNFVH0iID4mMgogICAgICAgIGZpCiAgICAgICAgcmV0dXJuICRjdXJsX2V4aXQKICAgIGZpCgogICAgaWYgWyAteiAiJGh0dHBfc3RhdHVzIiBdOyB0aGVuCiAgICAgICAgaHR0cF9zdGF0dXM9MAogICAgZmkKCiAgICBpZiBbICIkaHR0cF9zdGF0dXMiIC1lcSA0MjkgXSAmJiBwcmludGYgJyVzJyAiJHJlc3BvbnNlIiB8IGdyZXAgLXEgJ0RFTU9fTElNSVRfRVhDRUVERUQnOyB0aGVuCiAgICAgICAgbG9jYWwgbGltaXQKICAgICAgICBsaW1pdD0kKHByaW50ZiAnJXMnICIkcmVzcG9uc2UiIHwgc2VkIC1uICdzLy4qImxpbWl0IjpbWzpzcGFjZTpdXSpcKFswLTldXCtcKS4qL1wxL3AnIHwgaGVhZCAtbjEpCiAgICAgICAgbG9jYWwgcmVtYWluaW5nCiAgICAgICAgcmVtYWluaW5nPSQocHJpbnRmICclcycgIiRyZXNwb25zZSIgfCBzZWQgLW4gJ3MvLioicmVtYWluaW5nIjpbWzpzcGFjZTpdXSpcKFswLTldXCtcKS4qL1wxL3AnIHwgaGVhZCAtbjEpCiAgICAgICAgWyAteiAiJGxpbWl0IiBdICYmIGxpbWl0PTEwCiAgICAgICAgX2Z1Y2tfbm90aWZ5X2RlbW9fbGltaXQgIiRsaW1pdCIgIiRyZW1haW5pbmciCiAgICAgICAgcmV0dXJuIDIKICAgIGZpCgogICAgaWYgWyAiJGh0dHBfc3RhdHVzIiAtZ2UgNDAwIF0gfHwgWyAteiAiJHJlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH3lhbHkuqsgV29ya2VyIOi/lOWbniBIVFRQICRodHRwX3N0YXR1c+OAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIGlmIFsgLW4gIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgICAgICBlY2hvIC1lICIke0NfRElNfSRyZXNwb25zZSR7Q19SRVNFVH0iID4mMgogICAgICAgIGZpCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgcHJpbnRmICclc1xuJyAiJHJlc3BvbnNlIgp9CgpfZnVja19ub3RpZnlfZGVtb19saW1pdCgpIHsKICAgIGxvY2FsIGRhaWx5X2xpbWl0PSIkezE6LTEwfSIKICAgIGxvY2FsIHJlbWFpbmluZz0iJHsyOi0wfSIKCiAgICBlY2hvIC1lICIkRlVDSyAke0NfWUVMTE9XfeWFseS6q+S9k+mqjOmineW6puW3sueUqOWFie+8iOavj+WkqeacgOWkmiAke2RhaWx5X2xpbWl0fSDmrKHvvInjgIIke0NfUkVTRVR9IiA+JjIKICAgIGNhc2UgIiRyZW1haW5pbmciIGluCiAgICAgICAgJyd8KlshMC05XSopIDs7CiAgICAgICAgKikKICAgICAgICAgICAgaWYgWyAiJHJlbWFpbmluZyIgLWd0IDAgXTsgdGhlbgogICAgICAgICAgICAgICAgZWNobyAtZSAiJHtDX0RJTX3ku4rml6XliankvZnpop3luqbvvJokcmVtYWluaW5nIOasoeOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgICAgICBmaQogICAgICAgICAgICA7OwogICAgZXNhYwoKICAgIF9mdWNrX2Vuc3VyZV9jb25maWdfZXhpc3RzCiAgICBfZnVja19zZWN1cmVfY29uZmlnX2ZpbGUKCiAgICBlY2hvIC1lICIke0NfQ1lBTn3op6PlhrPmlrnmoYjvvJoke0NfUkVTRVR96L+Q6KGMICR7Q19HUkVFTn1mdWNrIGNvbmZpZyR7Q19SRVNFVH3vvIzlnKggJHtDX0dSRUVOfSRDT05GSUdfRklMRSR7Q19SRVNFVH0g5Lit6K6+572uICR7Q19CT0xEfUZVQ0tfT1BFTkFJX0FQSV9LRVkke0NfUkVTRVR977yM5b+F6KaB5pe25ZCM5pe26YWN572uICR7Q19CT0xEfUZVQ0tfT1BFTkFJX01PREVMJHtDX1JFU0VUfS8ke0NfQk9MRH1GVUNLX09QRU5BSV9BUElfQkFTRSR7Q19SRVNFVH3jgIIiID4mMgogICAgZWNobyAtZSAiJHtDX0NZQU596Iul5L2g5oyB5pyJ566h55CG5ZGY5YWN6aKd5a+G6ZKl77yaJHtDX1JFU0VUfeWQjOagt+WcqOivpeaWh+S7tuS4remFjee9riAke0NfQk9MRH1GVUNLX0FETUlOX0tFWSR7Q19SRVNFVH3vvIjpnIDkuI4gV29ya2VyIOS+p+eahCBBRE1JTl9BQ0NFU1NfS0VZIOWMuemFje+8ieWNs+WPr+i3s+i/h+WFseS6q+mineW6pumZkOWItuOAgiIgPiYyCiAgICBpZiBbIC1uICIke0VESVRPUjotfSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d95o+Q56S677yaJHtDX1JFU0VUfSR7RURJVE9SfSBcIiRDT05GSUdfRklMRVwiIiA+JjIKICAgIGZpCiAgICBlY2hvIC1lICIke0NfRElNfeWuieWFqOaPkOekuu+8mumFjee9ruaWh+S7tuiHquWKqCBjaG1vZCA2MDDvvIzku4XpmZDlvZPliY3nlKjmiLfor7vlj5bjgIIke0NfUkVTRVR9IiA+JjIKfQoKCiMg5Yik5pat5piv5ZCm5Li6IHRydWUveWVzL29uIOetiQpfZnVja190cnV0aHkoKSB7CiAgICBsb2NhbCB2YWx1ZT0iJHsxOi19IgogICAgbG9jYWwgbm9ybWFsaXplZAogICAgbm9ybWFsaXplZD0kKHByaW50ZiAnJXMnICIkdmFsdWUiIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCiAgICBjYXNlICIkbm9ybWFsaXplZCIgaW4KICAgICAgICAxfHRydWV8eWVzfHl8b2585pivfOW8gHznnJ8pCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIDs7CiAgICAgICAgKikKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICAgICAgOzsKICAgIGVzYWMKfQoKIyDosIPor5Xml6Xlv5cKX2Z1Y2tfZGVidWcoKSB7CiAgICBpZiBfZnVja190cnV0aHkgIiR7RlVDS19ERUJVRzotMH0iOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX0RJTX1b6LCD6K+VXSAkKiR7Q19SRVNFVH0iID4mMgogICAgZmkKfQoKIyBTcGlubmVyIOWKqOeUuwpfZnVja19zcGlubmVyKCkgewogICAgbG9jYWwgcGlkPSQxCiAgICBsb2NhbCBwcmVmaXg9IiR7MjotfSIKICAgIGxvY2FsIGRlbGF5PTAuMQogICAgbG9jYWwgLWEgZnJhbWVzPSgifCIgIi8iICItIiAiXFwiKQogICAgbG9jYWwgZnJhbWVfY291bnQ9JHsjZnJhbWVzW0BdfQogICAgbG9jYWwgZnJhbWVfaWR4PTAKICAgIGxvY2FsIGhhc19wcmVmaXg9MAogICAgaWYgWyAtbiAiJHByZWZpeCIgXTsgdGhlbgogICAgICAgIGhhc19wcmVmaXg9MQogICAgZmkKICAgIAogICAgIyDpmpDol4/lhYnmoIcKICAgIHRwdXQgY2l2aXMgMj4vZGV2L251bGwgfHwgcHJpbnRmICJcMDMzWz8yNWwiCgogICAgd2hpbGUga2lsbCAtMCAiJHBpZCIgMj4vZGV2L251bGw7IGRvCiAgICAgICAgaWYgWyAiJGhhc19wcmVmaXgiIC1lcSAxIF07IHRoZW4KICAgICAgICAgICAgcHJpbnRmICJcciVzJXMiICIkcHJlZml4IiAiJHtmcmFtZXNbJGZyYW1lX2lkeF19IgogICAgICAgIGVsc2UKICAgICAgICAgICAgcHJpbnRmICIgJXMgIiAiJHtmcmFtZXNbJGZyYW1lX2lkeF19IgogICAgICAgICAgICBwcmludGYgIlxiXGJcYiIKICAgICAgICBmaQogICAgICAgIGZyYW1lX2lkeD0kKCggKGZyYW1lX2lkeCArIDEpICUgZnJhbWVfY291bnQgKSkKICAgICAgICBzbGVlcCAiJGRlbGF5IgogICAgZG9uZQoKICAgIGlmIFsgIiRoYXNfcHJlZml4IiAtZXEgMSBdOyB0aGVuCiAgICAgICAgcHJpbnRmICJcciVzIiAiJHByZWZpeCIKICAgICAgICB0cHV0IGVsIDI+L2Rldi9udWxsIHx8IHByaW50ZiAiXDAzM1tLIgogICAgZWxzZQogICAgICAgIHByaW50ZiAiICAgXGJcYlxiIgogICAgZmkKICAgIAogICAgIyDmgaLlpI3lhYnmoIcKICAgIHRwdXQgY25vcm0gMj4vZGV2L251bGwgfHwgcHJpbnRmICJcMDMzWz8yNWgiCn0KCiMgLS0tIOWuieWFqOajgOa1i+W8leaTjiAoUGhhc2UgMikgLS0tCgojIOmYu+atoue6p+WuieWFqOinhOWIme+8iOacgOmrmOS4pemHjeaApyAtIOaLkue7neaJp+ihjO+8iQojIOagvOW8j++8mifmqKHlvI98fHzljp/lm6AnCmlmIFsgLXogIiR7X0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVM6LX0iIF07IHRoZW4KICAgIHJlYWRvbmx5IC1hIF9GVUNLX1NFQ1VSSVRZX0JMT0NLX1JVTEVTPSgKICAgICAgICAnKF58WzsmfFs6c3BhY2U6XV0pcm1bWzpzcGFjZTpdXSstcmZbWzpzcGFjZTpdXSsvKFtbOnNwYWNlOl1dfCQpfHx85qOA5rWL5YiwIHJtIC1yZiAv77yM5Lya55u05o6l5Yig6Zmk5qC555uu5b2VJwogICAgICAgICdybVtbOnNwYWNlOl1dKy1yZltbOnNwYWNlOl1dKy9cKnx8fOajgOa1i+WIsCBybSAtcmYgLyrvvIzlj6/og73muIXnqbrmoLnnm67lvZUnCiAgICAgICAgJ3JtW1s6c3BhY2U6XV0rLXJmW1s6c3BhY2U6XV0rLS1uby1wcmVzZXJ2ZS1yb290fHx85qOA5rWL5YiwIC0tbm8tcHJlc2VydmUtcm9vdO+8jOmjjumZqeaegemrmCcKICAgICAgICAncm1bWzpzcGFjZTpdXSstcmZbWzpzcGFjZTpdXStcLlwqfHx85qOA5rWL5YiwIHJtIC1yZiAuKu+8jOWPr+iDveWIoOmZpOWFqOmDqOmakOiXj+aWh+S7ticKICAgICAgICAnXGJkZFxiW14jXG5dKlxiKG9mfGlmKT0vZGV2L3x8fOajgOa1i+WIsCBkZCDmraPlnKjlhpnlhaUgL2RldiDorr7lpIcnCiAgICAgICAgJ1xibWtmcyhcLlx3Kyk/XGJ8fHzmo4DmtYvliLAgbWtmcy/moLzlvI/ljJbmk43kvZwnCiAgICAgICAgJ1xiZmRpc2tcYnxcYnBhcnRlZFxifFxiZm9ybWF0XGJ8XGJ3aXBlZnNcYnxcYnNocmVkXGJ8fHzmo4DmtYvliLDliIbljLrmiJbno4Hnm5jmk6bpmaTlkb3ku6QnCiAgICAgICAgJzpcKFwpXHMqe1xzKjpccypcfFxzKjo7XHMqfVxzKjs/XHMqOnx8fOajgOa1i+WIsCBGb3JrIOeCuOW8ueaooeW8jycKICAgICkKZmkKCiMg5oyR5oiY57qn5a6J5YWo6KeE5YiZ77yI6ZyA6KaB5piO56Gu55So5oi356Gu6K6k77yJCiMg5qC85byP77yaJ+aooeW8j3x8fOWOn+WboCcKaWYgWyAteiAiJHtfRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfUlVMRVM6LX0iIF07IHRoZW4KICAgIHJlYWRvbmx5IC1hIF9GVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9SVUxFUz0oCiAgICAgICAgJ2N1cmxbXnxdKlx8XHMqKGJhc2h8c2gpfHx8Y3VybCDnrqHpgZMgYmFzaC9zaO+8jOWPr+iDvei/nOeoi+aJp+ihjOiEmuacrCcKICAgICAgICAnd2dldFtefF0qXHxccyooYmFzaHxzaCl8fHx3Z2V0IOeuoemBkyBiYXNoL3No77yM5Y+v6IO96L+c56iL5omn6KGM6ISa5pysJwogICAgICAgICdcYnNvdXJjZVxzK2h0dHBzPzovL3x8fHNvdXJjZSDov5znqIvohJrmnKwnCiAgICAgICAgJ1xiZXZhbFxifFxiZXhlY1xifHx85L2/55SoIGV2YWwvZXhlYyDliqjmgIHmiafooYwnCiAgICAgICAgJ1wkXChbXildKlwpfHx85qOA5rWL5YiwICQoLi4uKSDlkb3ku6Tmm7/mjaInCiAgICAgICAgJ2BbXmBdKmB8fHzmo4DmtYvliLDlj43lvJXlj7flkb3ku6Tmm7/mjaInCiAgICAgICAgJ1xiKHNofGJhc2h8ZW52KVxzKy1jXGJ8fHzmo4DmtYvliLAgc2gvYmFzaCAtYyDljIXoo4Xlkb3ku6QnCiAgICAgICAgJ1xicHl0aG9uWzAtOS5dKlxzKy1jXGJ8fHzmo4DmtYvliLAgcHl0aG9uIC1jIOWGheiBlOiEmuacrCcKICAgICAgICAnKF58WzsmfFs6c3BhY2U6XV0pKGNwfG12fHJtfGNobW9kfGNob3dufHNlZHx0ZWV8Y2F0KVteOyZ8XSpcYi8oZXRjfGJvb3R8c3lzfHByb2N8ZGV2KVxifHx85ZG95Luk5pON5L2c5YWz6ZSu57O757uf6Lev5b6EJwogICAgICAgICdcYnBlcmxccystZVxifHx85qOA5rWL5YiwIHBlcmwgLWUg5YaF6IGU5omn6KGMJwogICAgICAgICdcYnJ1YnlccystZVxifHx85qOA5rWL5YiwIHJ1YnkgLWUg5YaF6IGU5omn6KGMJwogICAgICAgICdcYm5vZGVccystZVxifHx85qOA5rWL5YiwIG5vZGUgLWUg5YaF6IGU5omn6KGMJwogICAgICAgICdcYnBocFxzKy1yXGJ8fHzmo4DmtYvliLAgcGhwIC1yIOWGheiBlOaJp+ihjCcKICAgICAgICAnYmFzZTY0W158XSpcfFxzKihiYXNofHNofGV2YWwpfHx85qOA5rWL5YiwIGJhc2U2NCDnvJbnoIHlkb3ku6TmiafooYwnCiAgICAgICAgJ1xieGFyZ3NcYi4qKC1JfC1pfHt9KS4qXGIoc2h8YmFzaHxybXxjaG1vZClcYnx8fOajgOa1i+WIsOmAmui/hyB4YXJncyDmiafooYzlkb3ku6QnCiAgICAgICAgJ1xiZmluZFxiW158O10qLWV4ZWNcYnx8fOajgOa1i+WIsOmAmui/hyBmaW5kIC1leGVjIOaJp+ihjOWRveS7pCcKICAgICAgICAnXGIoYXdrfGdhd2t8bmF3a3xtYXdrKVxiW158O10qc3lzdGVtXHMqXCh8fHzmo4DmtYvliLDpgJrov4cgYXdrIHN5c3RlbSgpIOmXtOaOpeaJp+ihjCcKICAgICAgICAnXGJwcmludGZcYi4qXFxcXHhbMC05YS1mQS1GXXx8fOajgOa1i+WIsOWPr+iDveeahOWNgeWFrei/m+WItue8lueggeWRveS7pOazqOWFpScKICAgICAgICAnXCRce1tefV0qI1x9fHx85qOA5rWL5Yiw5Y+v6IO95pS55Y+Y5ZG95Luk55qE5Y+C5pWw5bGV5byAJwogICAgICAgICdlY2hvXHMrW158XSpcfFxzKihiYXNofHNofGV2YWwpfHx85qOA5rWL5YiwIGVjaG8g566h6YGT5YiwIHNoZWxsIOaJp+ihjCcKICAgICkKZmkKCiMg6K2m5ZGK57qn5a6J5YWo6KeE5YiZ77yI5LuF6K2m5ZGK77yM55So5oi35Y+v57un57ut77yJCiMg5qC85byP77yaJ+aooeW8j3x8fOWOn+WboCcKaWYgWyAteiAiJHtfRlVDS19TRUNVUklUWV9XQVJOX1JVTEVTOi19IiBdOyB0aGVuCiAgICByZWFkb25seSAtYSBfRlVDS19TRUNVUklUWV9XQVJOX1JVTEVTPSgKICAgICAgICAncm1bWzpzcGFjZTpdXSstcmZcYnx8fOWPkeeOsCBybSAtcmbvvIzmiafooYzliY3or7flho3mrKHnoa7orqQnCiAgICAgICAgJ2NobW9kW1s6c3BhY2U6XV0rLio3NzdcYnx8fOajgOa1i+WIsCBjaG1vZCA3Nzcg5p2D6ZmQJwogICAgICAgICdzdWRvW1s6c3BhY2U6XV0rW147JnxdKnJtW1s6c3BhY2U6XV0rLXJmfHx8c3VkbyBybSAtcmYg6aOO6ZmpJwogICAgICAgICc+W1s6c3BhY2U6XV0qLyhldGMvKHBhc3N3ZHxzaGFkb3d8c3Vkb2Vycyl8ZGV2L3NkW2Etel0rKXx8fOmHjeWumuWQkei+k+WHuuWIsOaVj+aEn+ezu+e7n+aWh+S7ticKICAgICkKZmkKCiMg5LuO6YWN572u6I635Y+W5b2T5YmN5a6J5YWo5qih5byPCiMg6L6T5Ye677yaInN0cmljdCLjgIEiYmFsYW5jZWQiIOaIliAib2ZmIgpfZnVja19zZWN1cml0eV9tb2RlKCkgewogICAgbG9jYWwgbW9kZT0iJHtGVUNLX1NFQ1VSSVRZX01PREU6LWJhbGFuY2VkfSIKICAgIG1vZGU9JChwcmludGYgJyVzJyAiJG1vZGUiIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCgogICAgY2FzZSAiJG1vZGUiIGluCiAgICAgICAgc3RyaWN0KSBwcmludGYgJ3N0cmljdFxuJyA7OwogICAgICAgIG9mZnxkaXNhYmxlZHxub25lKSBwcmludGYgJ29mZlxuJyA7OwogICAgICAgIGJhbGFuY2VkfGRlZmF1bHR8IiIpIHByaW50ZiAnYmFsYW5jZWRcbicgOzsKICAgICAgICAqKSBwcmludGYgJ2JhbGFuY2VkXG4nIDs7CiAgICBlc2FjCn0KCiMg6I635Y+W5a6J5YWo56Gu6K6k55qE6buY6K6k5oyR5oiY5paH5pysCiMg6L6T5Ye677ya6buY6K6k5oyR5oiY55+t6K+tCl9mdWNrX3NlY3VyaXR5X2RlZmF1bHRfY2hhbGxlbmdlX3RleHQoKSB7CiAgICBwcmludGYgJ+aIkeehruiupOaJv+aLhemjjumZqScKfQoKIyDmo4Dmn6Xlkb3ku6TmmK/lkKbljLnphY3lronlhajnmb3lkI3ljZUKIyDlj4LmlbDvvJokMSAtIOimgeajgOafpeeahOWRveS7pAojIOi/lOWbnu+8mjAg5aaC5p6c5Zyo55m95ZCN5Y2V5Lit77yMMSDlkKbliJkKX2Z1Y2tfc2VjdXJpdHlfaXNfd2hpdGVsaXN0ZWQoKSB7CiAgICBsb2NhbCBjb21tYW5kPSIkMSIKICAgIGxvY2FsIHdoaXRlbGlzdD0iJHtGVUNLX1NFQ1VSSVRZX1dISVRFTElTVDotfSIKCiAgICBpZiBbIC16ICIkd2hpdGVsaXN0IiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbm9ybWFsaXplZCBlbnRyeQogICAgbm9ybWFsaXplZD0kKHByaW50ZiAnJXMnICIkd2hpdGVsaXN0IiB8IHRyICcsJyAnXG4nKQoKICAgIHdoaWxlIElGUz0gcmVhZCAtciBlbnRyeTsgZG8KICAgICAgICBlbnRyeT0kKHByaW50ZiAnJXMnICIkZW50cnkiIHwgc2VkIC1lICdzL15bWzpzcGFjZTpdXSovLycgLWUgJ3MvW1s6c3BhY2U6XV0qJC8vJykKICAgICAgICBbIC16ICIkZW50cnkiIF0gJiYgY29udGludWUKCiAgICAgICAgaWYgcHJpbnRmICclcycgIiRjb21tYW5kIiB8IGdyZXAgLUZxICIkZW50cnkiOyB0aGVuCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgZmkKICAgIGRvbmUgPDw8ICIkbm9ybWFsaXplZCIKCiAgICByZXR1cm4gMQp9CgojIOWwhuWuieWFqOe6p+WIq+i9rOaNouS4uuaVsOWAvOS7peS+v+avlOi+gwojIOWPguaVsO+8miQxIC0g5a6J5YWo57qn5Yir77yIYmxvY2svY2hhbGxlbmdlL3dhcm4vb2vvvIkKIyDovpPlh7rvvJrmlbDlgLzvvIgzLzIvMS8w77yJCl9mdWNrX3NlY3VyaXR5X2xldmVsX3ZhbHVlKCkgewogICAgY2FzZSAiJDEiIGluCiAgICAgICAgYmxvY2spIHByaW50ZiAnM1xuJyA7OwogICAgICAgIGNoYWxsZW5nZSkgcHJpbnRmICcyXG4nIDs7CiAgICAgICAgd2FybikgcHJpbnRmICcxXG4nIDs7CiAgICAgICAgKikgcHJpbnRmICcwXG4nIDs7CiAgICBlc2FjCn0KCiMg5aaC5p6c5YCZ6YCJ57qn5Yir5pu05Lil6YeN5YiZ5o+Q5Y2H5a6J5YWo57qn5YirCiMg5Y+C5pWw77yaJDEgLSDlvZPliY3nuqfliKvvvIwkMiAtIOWAmemAiee6p+WIqwojIOi+k+WHuu+8muabtOS4pemHjeeahOe6p+WIqwpfZnVja19zZWN1cml0eV9wcm9tb3RlKCkgewogICAgbG9jYWwgY3VycmVudD0iJDEiCiAgICBsb2NhbCBjYW5kaWRhdGU9IiQyIgogICAgbG9jYWwgY3VycmVudF92YWwgY2FuZGlkYXRlX3ZhbAoKICAgIGN1cnJlbnRfdmFsPSQoX2Z1Y2tfc2VjdXJpdHlfbGV2ZWxfdmFsdWUgIiRjdXJyZW50IikKICAgIGNhbmRpZGF0ZV92YWw9JChfZnVja19zZWN1cml0eV9sZXZlbF92YWx1ZSAiJGNhbmRpZGF0ZSIpCgogICAgaWYgWyAiJGNhbmRpZGF0ZV92YWwiIC1ndCAiJGN1cnJlbnRfdmFsIiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJGNhbmRpZGF0ZSIKICAgIGVsc2UKICAgICAgICBwcmludGYgJyVzXG4nICIkY3VycmVudCIKICAgIGZpCn0KCiMg5qC55o2u5a6J5YWo5qih5byP6LCD5pW05Lil6YeN5oCn57qn5YirCiMg5Y+C5pWw77yaJDEgLSDmqKHlvI/vvIhzdHJpY3QvYmFsYW5jZWQvb2Zm77yJ77yMJDIgLSDkuKXph43mgKfnuqfliKsKIyDovpPlh7rvvJrosIPmlbTlkI7nmoTkuKXph43mgKfnuqfliKsKX2Z1Y2tfc2VjdXJpdHlfYXBwbHlfbW9kZSgpIHsKICAgIGxvY2FsIG1vZGU9IiQxIgogICAgbG9jYWwgc2V2ZXJpdHk9IiQyIgoKICAgIGNhc2UgIiRtb2RlIiBpbgogICAgICAgIHN0cmljdCkKICAgICAgICAgICAgY2FzZSAiJHNldmVyaXR5IiBpbgogICAgICAgICAgICAgICAgd2Fybikgc2V2ZXJpdHk9ImNoYWxsZW5nZSIgOzsKICAgICAgICAgICAgICAgIGNoYWxsZW5nZSkgc2V2ZXJpdHk9ImJsb2NrIiA7OwogICAgICAgICAgICBlc2FjCiAgICAgICAgICAgIDs7CiAgICBlc2FjCgogICAgcHJpbnRmICclc1xuJyAiJHNldmVyaXR5Igp9CgojIOWwhuWRveS7pOS4juWuieWFqOinhOWImeihqOWMuemFjQojIOWPguaVsO+8miQxIC0g5ZG95Luk77yMJDIgLSDop4TliJnooajlkI3np7AKIyDovpPlh7rvvJrlpoLmnpzljLnphY3liJnovpPlh7rljp/lm6DlrZfnrKbkuLIKIyDov5Tlm57vvJowIOWmguaenOWMuemFje+8jDEg5ZCm5YiZCl9mdWNrX3NlY3VyaXR5X21hdGNoX3J1bGUoKSB7CiAgICBsb2NhbCBjb21tYW5kPSIkMSIKICAgIGxvY2FsIHRhYmxlPSIkMiIKICAgIGxvY2FsIC1hIHJ1bGVzPSgpCgogICAgZXZhbCAicnVsZXM9KFwiXCR7JHt0YWJsZX1bQF19XCIpIgoKICAgIGxvY2FsIHJ1bGUgcGF0dGVybiByZWFzb24KICAgIGZvciBydWxlIGluICIke3J1bGVzW0BdfSI7IGRvCiAgICAgICAgcGF0dGVybj0ke3J1bGUlJXx8fCp9CiAgICAgICAgcmVhc29uPSR7cnVsZSMqfHx8fQogICAgICAgIFsgLXogIiRwYXR0ZXJuIiBdICYmIGNvbnRpbnVlCgogICAgICAgIGlmIHByaW50ZiAnJXMnICIkY29tbWFuZCIgfCBncmVwIC1FaXEgLS0gIiRwYXR0ZXJuIjsgdGhlbgogICAgICAgICAgICBwcmludGYgJyVzXG4nICIkcmVhc29uIgogICAgICAgICAgICByZXR1cm4gMAogICAgICAgIGZpCiAgICBkb25lCgogICAgcmV0dXJuIDEKfQoKIyDmmL7npLrmvZzlnKjljbHpmanlkb3ku6TnmoTorablkYrmtojmga8KIyDlj4LmlbDvvJokMSAtIOitpuWRiuWOn+WboApfZnVja19zZWN1cml0eV93YXJuX21lc3NhZ2UoKSB7CiAgICBsb2NhbCByZWFzb249IiQxIgogICAgZWNobyAtZSAiJHtDX1JFRF9CT0xEfeKaoO+4jyAg5a6J5YWo6K2m5ZGK77yaJHtDX1JFU0VUfSR7cmVhc29ufSIgPiYyCiAgICBlY2hvIC1lICIke0NfWUVMTE9Xfeivt+S7lOe7huWuoeafpe+8jOiLpeehruiupOWPr+S/oeWPr+mFjee9riBGVUNLX1NFQ1VSSVRZX1dISVRFTElTVOOAgiR7Q19SRVNFVH0iID4mMgp9CgojIOaYvuekuuiiq+emgeatouWRveS7pOeahOmYu+atoua2iOaBrwojIOWPguaVsO+8miQxIC0g6Zi75q2i5Y6f5ZugCl9mdWNrX3NlY3VyaXR5X2Jsb2NrX21lc3NhZ2UoKSB7CiAgICBsb2NhbCByZWFzb249IiQxIgogICAgZWNobyAtZSAiJHtDX1JFRF9CT0xEfeKblCDlt7LpmLvmraLvvJoke0NfUkVTRVR9JHtyZWFzb259IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19SRUR95omn6KGM6KKr5ouS57ud77yM5Y+v6LCD5pW0IEZVQ0tfU0VDVVJJVFlfTU9ERSDmiJbliqDlhaXnmb3lkI3ljZXlkI7ph43or5XjgIIke0NfUkVTRVR9IiA+JjIKfQoKIyDmmL7npLrpq5jpo47pmanlkb3ku6TnmoTmjJHmiJjmtojmga8KIyDlj4LmlbDvvJokMSAtIOaMkeaImOWOn+WboO+8jCQyIC0g6ZyA6KaB55qE55+t6K+tCl9mdWNrX3NlY3VyaXR5X2NoYWxsZW5nZV9tZXNzYWdlKCkgewogICAgbG9jYWwgcmVhc29uPSIkMSIKICAgIGxvY2FsIHBocmFzZT0iJDIiCiAgICBlY2hvIC1lICIke0NfUkVEX0JPTER94pqg77iPICDpq5jljbHmjJHmiJjvvJoke0NfUkVTRVR9JHtyZWFzb259IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19DWUFOfeWmgumcgOe7p+e7re+8jOivt+i+k+WFpeS4i+aWueefreivre+8miR7Q19SRVNFVH0iID4mMgogICAgZWNobyAtZSAiJHtDX0JPTER9JHtwaHJhc2V9JHtDX1JFU0VUfSIgPiYyCn0KCiMg5o+Q56S655So5oi36L6T5YWl5a6J5YWo5oyR5oiY5omA6ZyA55qE55+t6K+tCiMg5Y+C5pWw77yaJDEgLSDpnIDopoHnmoTnn63or60KIyDov5Tlm57vvJowIOWmguaenOefreivreWMuemFje+8jDEg5ZCm5YiZCl9mdWNrX3NlY3VyaXR5X3Byb21wdF9waHJhc2UoKSB7CiAgICBsb2NhbCBwaHJhc2U9IiQxIgogICAgbG9jYWwgaW5wdXQ9IiIKCiAgICBwcmludGYgIiViPiAlYiIgIiRDX0JPTEQiICIkQ19SRVNFVCIgPiYyCgogICAgaWYgWyAtciAvZGV2L3R0eSBdOyB0aGVuCiAgICAgICAgaWYgISBJRlM9IHJlYWQgLXIgaW5wdXQgPCAvZGV2L3R0eTsgdGhlbgogICAgICAgICAgICBwcmludGYgIlxuIiA+JjIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICBmaQogICAgZWxzZQogICAgICAgIGlmICEgSUZTPSByZWFkIC1yIGlucHV0OyB0aGVuCiAgICAgICAgICAgIHByaW50ZiAiXG4iID4mMgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgIGZpCiAgICBmaQoKICAgIHByaW50ZiAiXG4iID4mMgogICAgWyAiJGlucHV0IiA9ICIkcGhyYXNlIiBdCn0KCiMg5qC55o2u5Lil6YeN5oCn57qn5Yir5aSE55CG5a6J5YWo5Yaz562WCiMg5Y+C5pWw77yaJDEgLSDkuKXph43mgKfnuqfliKvvvIwkMiAtIOWOn+WboO+8jCQzIC0g5ZG95LukCiMg6L+U5Zue77yaMCDlhYHorrjmiafooYzvvIwxIOaLkue7nQpfZnVja19zZWN1cml0eV9oYW5kbGVfZGVjaXNpb24oKSB7CiAgICBsb2NhbCBzZXZlcml0eT0iJDEiCiAgICBsb2NhbCByZWFzb249IiQyIgogICAgbG9jYWwgY29tbWFuZD0iJDMiCgogICAgY2FzZSAiJHNldmVyaXR5IiBpbgogICAgICAgICIifG9rfG9mZikKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgOzsKICAgICAgICB3YXJuKQogICAgICAgICAgICBfZnVja19zZWN1cml0eV93YXJuX21lc3NhZ2UgIiR7cmVhc29uOi3mo4DmtYvliLDmvZzlnKjpo47pmal9IgogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgICAgIGNoYWxsZW5nZSkKICAgICAgICAgICAgbG9jYWwgcGhyYXNlPSIke0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1RFWFQ6LSQoX2Z1Y2tfc2VjdXJpdHlfZGVmYXVsdF9jaGFsbGVuZ2VfdGV4dCl9IgogICAgICAgICAgICBfZnVja19zZWN1cml0eV9jaGFsbGVuZ2VfbWVzc2FnZSAiJHtyZWFzb246LemrmOWNseWRveS7pO+8jOivt+WGjeasoeehruiupH0iICIkcGhyYXNlIgoKICAgICAgICAgICAgaWYgX2Z1Y2tfc2VjdXJpdHlfcHJvbXB0X3BocmFzZSAiJHBocmFzZSI7IHRoZW4KICAgICAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19HUkVFTn3lt7LpgJrov4flronlhajmjJHmiJjjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIGZpCgogICAgICAgICAgICBlY2hvIC1lICIke0NfUkVEfeWuieWFqOaMkeaImOWksei0pe+8jOWRveS7pOiiq+WPlua2iOOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgICAgICA7OwogICAgICAgIGJsb2NrKQogICAgICAgICAgICBfZnVja19hdWRpdF9sb2cgIkJMT0NLIiAiJGNvbW1hbmQiCiAgICAgICAgICAgIF9mdWNrX3NlY3VyaXR5X2Jsb2NrX21lc3NhZ2UgIiR7cmVhc29uOi3lkb3ku6TooqvlronlhajnrZbnlaXpmLvmraJ9IgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgICAgICA7OwogICAgICAgICopCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIDs7CiAgICBlc2FjCn0KCiMg6K+E5Lyw5ZG95Luk5a6J5YWo5oCn5bm26L+U5Zue5Lil6YeN5oCn57qn5Yir5ZKM5Y6f5ZugCiMg5Y+C5pWw77yaJDEgLSDopoHor4TkvLDnmoTlkb3ku6QKIyDovpPlh7rvvJoi5Lil6YeN5oCnfOWOn+WboCIg5a2X56ym5LiyCiMg6L+U5Zue77ya5aeL57uI6L+U5ZueIDDvvIjnu5PmnpzlnKjovpPlh7rkuK3vvIkKX2Z1Y2tfc2VjdXJpdHlfZXZhbHVhdGVfY29tbWFuZCgpIHsKICAgIGxvY2FsIGNvbW1hbmQ9IiQxIgogICAgbG9jYWwgbW9kZSBzZXZlcml0eSByZWFzb24gbWF0Y2ggcHJvbW90ZWQgc3RydWN0dXJhbF9yZWFzb24KCiAgICBtb2RlPSQoX2Z1Y2tfc2VjdXJpdHlfbW9kZSkKCiAgICAjIOWuieWFqOW8leaTjuW3suemgeeUqAogICAgaWYgWyAiJG1vZGUiID0gIm9mZiIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnb2ZmfOWuieWFqOW8leaTjuW3suWFs+mXrVxuJwogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgICMg5qOA5p+l55m95ZCN5Y2VCiAgICBpZiBfZnVja19zZWN1cml0eV9pc193aGl0ZWxpc3RlZCAiJGNvbW1hbmQiOyB0aGVuCiAgICAgICAgcHJpbnRmICdva3zlkb3ku6Tlkb3kuK3nmb3lkI3ljZVcbicKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBzZXZlcml0eT0ib2siCiAgICByZWFzb249IiIKICAgIG1hdGNoPSIiCgogICAgIyDmo4Dmn6XpmLvmraLop4TliJnvvIjmnIDpq5jkvJjlhYjnuqfvvIkKICAgIGlmIG1hdGNoPSQoX2Z1Y2tfc2VjdXJpdHlfbWF0Y2hfcnVsZSAiJGNvbW1hbmQiICJfRlVDS19TRUNVUklUWV9CTE9DS19SVUxFUyIpOyB0aGVuCiAgICAgICAgc2V2ZXJpdHk9ImJsb2NrIgogICAgICAgIHJlYXNvbj0iJG1hdGNoIgogICAgZmkKCiAgICAjIOajgOafpeaMkeaImOinhOWIme+8iOS4reetieS8mOWFiOe6p++8iQogICAgaWYgWyAiJHNldmVyaXR5IiAhPSAiYmxvY2siIF0gJiYgbWF0Y2g9JChfZnVja19zZWN1cml0eV9tYXRjaF9ydWxlICIkY29tbWFuZCIgIl9GVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9SVUxFUyIpOyB0aGVuCiAgICAgICAgc2V2ZXJpdHk9ImNoYWxsZW5nZSIKICAgICAgICByZWFzb249IiRtYXRjaCIKICAgIGZpCgogICAgIyDmo4Dmn6XorablkYrop4TliJnvvIjkvY7kvJjlhYjnuqfvvIkKICAgIGlmIFsgIiRzZXZlcml0eSIgPSAib2siIF0gJiYgbWF0Y2g9JChfZnVja19zZWN1cml0eV9tYXRjaF9ydWxlICIkY29tbWFuZCIgIl9GVUNLX1NFQ1VSSVRZX1dBUk5fUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJ3YXJuIgogICAgICAgIHJlYXNvbj0iJG1hdGNoIgogICAgZmkKCiAgICAjIOajgOafpeWRveS7pOmTvuaOpS/nrqHpgZPvvIjnu5PmnoTliIbmnpDvvIkKICAgIGlmIHByaW50ZiAnJXMnICIkY29tbWFuZCIgfCBncmVwIC1FaXEgJygmJnxcfFx8fDt8XHwpJzsgdGhlbgogICAgICAgIHN0cnVjdHVyYWxfcmVhc29uPSLmo4DmtYvliLDlkb3ku6TliIbpmpTnrKYv566h6YGTIgogICAgICAgIHByb21vdGVkPSQoX2Z1Y2tfc2VjdXJpdHlfcHJvbW90ZSAiJHNldmVyaXR5IiAid2FybiIpCgogICAgICAgIGlmIFsgIiRwcm9tb3RlZCIgIT0gIiRzZXZlcml0eSIgXTsgdGhlbgogICAgICAgICAgICBzZXZlcml0eT0iJHByb21vdGVkIgogICAgICAgICAgICByZWFzb249IiRzdHJ1Y3R1cmFsX3JlYXNvbiIKICAgICAgICBlbGlmIFsgLXogIiRyZWFzb24iIF07IHRoZW4KICAgICAgICAgICAgcmVhc29uPSIkc3RydWN0dXJhbF9yZWFzb24iCiAgICAgICAgZmkKICAgIGZpCgogICAgIyDlupTnlKjlronlhajmqKHlvI/osIPmlbQKICAgIHNldmVyaXR5PSQoX2Z1Y2tfc2VjdXJpdHlfYXBwbHlfbW9kZSAiJG1vZGUiICIkc2V2ZXJpdHkiKQoKICAgIHByaW50ZiAnJXN8JXNcbicgIiRzZXZlcml0eSIgIiR7cmVhc29uOi3lvZPliY3lkb3ku6TmnKrlkb3kuK3lronlhajop4TliJl9Igp9CgojIOWQkeWQjuWFvOWuueeahOmBl+eVmeWHveaVsAojIOWPguaVsO+8miQxIC0g6KaB5qOA5p+l55qE5ZG95LukCiMg6L6T5Ye677yaIuS4pemHjeaAp3zljp/lm6AiIOWtl+espuS4sgpfZnVja19kZXRlY3RfZGFuZ2Vyb3VzX2NvbW1hbmQoKSB7CiAgICBfZnVja19zZWN1cml0eV9ldmFsdWF0ZV9jb21tYW5kICIkMSIKfQoKCiMg56Gu5L+d6YWN572u5paH5Lu25a2Y5ZyoCl9mdWNrX3NlY3VyZV9jb25maWdfZmlsZSgpIHsKICAgIGlmIFsgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNobW9kIDYwMCAiJENPTkZJR19GSUxFIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICBmaQp9CgpfZnVja19hcHBlbmRfY29uZmlnX2hpbnQoKSB7CiAgICBsb2NhbCBrZXk9IiQxIgogICAgbG9jYWwgY29tbWVudD0iJDIiCiAgICBsb2NhbCBzYW1wbGU9IiQzIgogICAgbG9jYWwgcXVvdGVkPSIkezQ6LTF9IgogICAgWyAtZiAiJENPTkZJR19GSUxFIiBdIHx8IHJldHVybgogICAgaWYgZ3JlcCAtRXEgIl5cXHMqIz9cXHMqZXhwb3J0XFxzKyRrZXkiICIkQ09ORklHX0ZJTEUiOyB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIGxvY2FsIGFzc2lnbm1lbnQKICAgIGlmIFsgIiRxdW90ZWQiID0gIjEiIF07IHRoZW4KICAgICAgICBhc3NpZ25tZW50PSIjIGV4cG9ydCAka2V5PVwiJHNhbXBsZVwiIgogICAgZWxzZQogICAgICAgIGFzc2lnbm1lbnQ9IiMgZXhwb3J0ICRrZXk9JHNhbXBsZSIKICAgIGZpCgogICAgewogICAgICAgIHByaW50ZiAnXG4nCiAgICAgICAgcHJpbnRmICcjICVzXG4nICIkY29tbWVudCIKICAgICAgICBwcmludGYgJyVzXG4nICIkYXNzaWdubWVudCIKICAgIH0gPj4gIiRDT05GSUdfRklMRSIKfQoKX2Z1Y2tfc2VlZF9jb25maWdfcGxhY2Vob2xkZXJzKCkgewogICAgWyAtZiAiJENPTkZJR19GSUxFIiBdIHx8IHJldHVybgogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX09QRU5BSV9BUElfS0VZIiAi5pys5ZywIE9wZW5BSSDlhbzlrrkgS2V577yI5o6o6I2Q77yJIiAnc2stLi4uJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FETUlOX0tFWSIgIueuoeeQhuWRmOWFjemineW6puWvhumSpe+8iOS7heWIhuS6q+e7meS/oeS7u+eahOS6uu+8iSIgJ2FkbS0uLi4nCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfT1BFTkFJX01PREVMIiAi6KaG55uW6buY6K6k5qih5Z6LIiAnZ3B0LTRvLW1pbmknCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfT1BFTkFJX0FQSV9CQVNFIiAi6Ieq5a6a5LmJIEFQSSDln7rlnYAiICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FMSUFTIiAi6aKd5aSW5Yir5ZCN77yI5LiN5b2x5ZON6buY6K6kIGZ1Y2vvvIkiICfov5DooYwnCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfQVVUT19FWEVDIiAi6Ieq5Yqo5omn6KGM6L+U5Zue5ZG95Luk77yI5Y2x6Zmp5pON5L2c77yJIiAnZmFsc2UnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19USU1FT1VUIiAi6K+35rGC6LaF5pe25pe26Ze077yI56eS77yJIiAnMzAnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19ERUJVRyIgIuaYr+WQpui+k+WHuuiwg+ivleS/oeaBryIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTIiAi56aB55So5YaF572uIGZ1Y2sg5Yir5ZCNIiAnZmFsc2UnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9NT0RFIiAi5a6J5YWo5byV5pOO5qih5byP77yac3RyaWN0fGJhbGFuY2VkfG9mZiIgJ2JhbGFuY2VkJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX1NFQ1VSSVRZX1dISVRFTElTVCIgIuS7pemAl+WPt+aIluaNouihjOWIhumalOeahOS/oeS7u+WRveS7pOeJh+autSIgJycKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfVEVYVCIgIumrmOWNseWRveS7pOmcgOimgei+k+WFpeeahOehruiupOefreivrSIgJ+aIkeehruiupOaJv+aLhemjjumZqScKfQoKX2Z1Y2tfZW5zdXJlX2NvbmZpZ19leGlzdHMoKSB7CiAgICBpZiBbIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBfZnVja19zZWVkX2NvbmZpZ19wbGFjZWhvbGRlcnMKICAgICAgICBfZnVja19zZWN1cmVfY29uZmlnX2ZpbGUKICAgICAgICByZXR1cm4KICAgIGZpCgogICAgbWtkaXIgLXAgIiQoZGlybmFtZSAiJENPTkZJR19GSUxFIikiCiAgICBjYXQgPDwnQ0ZHJyA+ICIkQ09ORklHX0ZJTEUiCiMgZnVja2l0cyDphY3nva7npLrkvosKIyDljrvmjonooYzpppbnmoQgI++8jOaUueaIkOS9oOiHquW3seeahOWAvOWNs+WPr+OAggoKIyDoh6rlu7ov6Ieq5a6a5LmJIFdvcmtlciDlhaXlj6MKIyBleHBvcnQgRlVDS19BUElfRU5EUE9JTlQ9Imh0dHBzOi8veW91ci1kb21haW4ud29ya2Vycy5kZXYvIgoKIyDmnKzlnLAgT3BlbkFJIOWFvOWuuSBLZXnvvIjlvLrng4jmjqjojZDvvIkKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0tFWT0ic2stLi4uIgoKIyDnrqHnkIblkZjkuJPnlKjlhY3pop3luqblr4bpkqXvvIjku4XliIbkuqvnu5nkv6Hku7vnmoTkurrvvIkKIyBleHBvcnQgRlVDS19BRE1JTl9LRVk9ImFkbS0uLi4iCgojIOimhueblum7mOiupOaooeWei+aIliBBUEkg5Z+65Z2ACiMgZXhwb3J0IEZVQ0tfT1BFTkFJX01PREVMPSJncHQtNG8tbWluaSIKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0JBU0U9Imh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEiCgojIOmineWkluWIq+WQje+8iOS4jeS8muW9seWTjem7mOiupCBmdWNr77yJCiMgZXhwb3J0IEZVQ0tfQUxJQVM9Iui/kOihjCIKCiMg6Ieq5Yqo5omn6KGM6L+U5Zue5ZG95Luk77yI5Y2x6Zmp77yM6LCo5oWO5byA5ZCv77yJCiMgZXhwb3J0IEZVQ0tfQVVUT19FWEVDPWZhbHNlCgojIOivt+axgui2heaXtuaXtumXtO+8iOenku+8iQojIGV4cG9ydCBGVUNLX1RJTUVPVVQ9MzAKCiMg5piv5ZCm6L6T5Ye66LCD6K+V5L+h5oGvCiMgZXhwb3J0IEZVQ0tfREVCVUc9ZmFsc2UKCiMg56aB55So5YaF572uIGZ1Y2sg5Yir5ZCNCiMgZXhwb3J0IEZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTPWZhbHNlCgojIC0tLSDlronlhajorr7nva4gLS0tCiMg5a6J5YWo5qih5byP77yac3RyaWN077yI5Lil5qC877yJLCBiYWxhbmNlZO+8iOWdh+ihoe+8jOm7mOiupO+8iSwgb2Zm77yI5YWz6Zet77yJCiMgZXhwb3J0IEZVQ0tfU0VDVVJJVFlfTU9ERT0iYmFsYW5jZWQiCgojIOeZveWQjeWNleWPr+S/oeWRveS7pOaooeW8j++8iOmAl+WPt+WIhumalO+8iQojIGV4cG9ydCBGVUNLX1NFQ1VSSVRZX1dISVRFTElTVD0iZG9ja2VyIHJtIC1mLHJtIC1yZiAvdG1wL3NhZmUtZGlyIgoKIyAtLS0g5a6h6K6h5pel5b+XIC0tLQojIOWQr+eUqOWuoeiuoeaXpeW/l+iusOW9leaJgOacieaJp+ihjOeahOWRveS7pAojIGV4cG9ydCBGVUNLX0FVRElUX0xPRz10cnVlCgojIOiHquWumuS5ieWuoeiuoeaXpeW/l+aWh+S7tui3r+W+hO+8iOm7mOiupO+8mn4vLmZ1Y2svLmF1ZGl0LmxvZ++8iQojIGV4cG9ydCBGVUNLX0FVRElUX0xPR19GSUxFPSIkSE9NRS8uZnVjay8uYXVkaXQubG9nIgpDRkcKCiAgICBfZnVja19zZWVkX2NvbmZpZ19wbGFjZWhvbGRlcnMKICAgIF9mdWNrX3NlY3VyZV9jb25maWdfZmlsZQp9CgojIOaYvuekuumFjee9ruaPkOekugpfZnVja19zaG93X2NvbmZpZ19oZWxwKCkgewogICAgX2Z1Y2tfZW5zdXJlX2NvbmZpZ19leGlzdHMKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d96YWN572u5paH5Lu277yaJHtDX1JFU0VUfSAke0NfQ1lBTn0kQ09ORklHX0ZJTEUke0NfUkVTRVR9IgogICAgaWYgWyAtbiAiJHtFRElUT1I6LX0iIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfeWPr+S7peS9v+eUqO+8miR7Q19SRVNFVH0gJHtDX0NZQU59JHtFRElUT1J9ICRDT05GSUdfRklMRSR7Q19SRVNFVH0iCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33nlKjku7vmhI/nvJbovpHlmajmiZPlvIDor6Xmlofku7bljbPlj6/kv67mlLnphY3nva7jgIIke0NfUkVTRVR9IgogICAgZmkKICAgIGVjaG8gLWUgIiR7Q19DWUFOfeWPr+eUqOmAiemhue+8miR7Q19SRVNFVH1GVUNLX0FQSV9FTkRQT0lOVCwgRlVDS19PUEVOQUlfQVBJX0tFWSwgRlVDS19BRE1JTl9LRVksIEZVQ0tfT1BFTkFJX01PREVMLCBGVUNLX09QRU5BSV9BUElfQkFTRSwgRlVDS19BTElBUywgRlVDS19BVVRPX0VYRUMsIEZVQ0tfVElNRU9VVCwgRlVDS19ERUJVRywgRlVDS19ESVNBQkxFX0RFRkFVTFRfQUxJQVMiCiAgICBlY2hvIC1lICIke0NfRElNfeWuieWFqOivtOaYju+8mumFjee9ruaWh+S7tuS8muiHquWKqCBjaG1vZCA2MDDvvIzpmLLmraIgS2V5IOazhOmcsuOAgiR7Q19SRVNFVH0iCn0KCiMg5Y246L296ISa5pysCl91bmluc3RhbGxfc2NyaXB0KCkgewogICAgZWNobyAtZSAiJHtDX1JFRF9CT0xEfeWlveWlveWlve+8gSR7Q19SRVNFVH0ke0NfWUVMTE9XfeaAjuS5iOedgO+8jOimgeWNuOejqOadgOmptOWViu+8n+ihjOWViuS9oOS4quiAgeWFre+8jOaIkeecn+iwouiwouS9oOS6huOAgiR7Q19SRVNFVH0iCgogICAgIyDmib7phY3nva7mlofku7YKICAgIGxvY2FsIHByb2ZpbGVfZmlsZQogICAgcHJvZmlsZV9maWxlPSQoX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSkKICAgIGxvY2FsIHNvdXJjZV9saW5lPSJzb3VyY2UgJE1BSU5fU0giCgogICAgaWYgWyAiJHByb2ZpbGVfZmlsZSIgIT0gInVua25vd25fcHJvZmlsZSIgXSAmJiBbIC1mICIkcHJvZmlsZV9maWxlIiBdOyB0aGVuCiAgICAgICAgaWYgZ3JlcCAtcUYgIiRzb3VyY2VfbGluZSIgIiRwcm9maWxlX2ZpbGUiOyB0aGVuCiAgICAgICAgICAgICMg55SoIHNlZCDmiorpgqPlh6DooYzliKDkuobvvIzpobrkvr/lpIfkuKrku70KICAgICAgICAgICAgaWYgc2VkIC0tdmVyc2lvbiA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICAgICAgICAgIHNlZCAtaS5iYWsgIlx8JHNvdXJjZV9saW5lXHxkIiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICAgICAgICAgIHNlZCAtaS5iYWsgIlx8IyBBZGRlZCBieSBmdWNraXRzIGluc3RhbGxlclx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHNlZCAtaS5iYWsgIiIgLWUgIlx8JHNvdXJjZV9saW5lXHxkIiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICAgICAgICAgIHNlZCAtaS5iYWsgIiIgLWUgIlx8IyBBZGRlZCBieSBmdWNraXRzIGluc3RhbGxlclx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgIGZpCiAgICAgICAgZmkKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfeaJvuS4jeWIsCBzaGVsbCDphY3nva7mlofku7bvvIzmgqjlj6/ku6XmiYvliqjliKDpmaTnm7jlhbPphY3nva7jgIIke0NfUkVTRVR9IgogICAgZmkKCiAgICBpZiBbIC1kICIkSU5TVEFMTF9ESVIiIF07IHRoZW4KICAgICAgICBybSAtcmYgIiRJTlNUQUxMX0RJUiIKICAgIGZpCgogICAgc2xlZXAgMwogICAgZWNobyAtZSAiJHtDX0dSRUVOfeihjO+8jOaIkeWFiOi1sOS4gOatpe+8jOWRiui+nuOAgiR7Q19DWUFOfei1tue0p+mHjeWQr+S9oOmCo+e7iOerr+WQp++8jOS4jeeEtuS8muWIq+WQjeaxoeafk+OAgiR7Q19SRVNFVH0iCiAgICBzbGVlcCAzCiAgICBlY2hvIC1lICIke0NfWUVMTE9XfeS4tOWIq+S5i+mZhe+8jOeMruS4iuS4gOmmluWwj+ivl++8jOelneaCqOWJjeeoi+S8vOmUpu+8miR7Q19SRVNFVH0iCiAgICBzbGVlcCAyCiAgICBlY2hvIC1lICJcbiR7Q19SRUR944CK6K+X57uPwrflvbzpmLPjgIske0NfUkVTRVR9IgogICAgc2xlZXAgMgogICAgZWNobyAtZSAiJHtDX1lFTExPV33lvbzpmLPoi6Xoh7PvvIzliJ3ljYfkuJzmm6bjgIIke0NfUkVTRVR9IgogICAgc2xlZXAgMgogICAgZWNobyAtZSAiJHtDX1lFTExPV33nu6/pm77po5LolL3vvIzkvLzluZXnu6Hnu7jjgIIke0NfUkVTRVR9IgogICAgc2xlZXAgMwogICAgZWNobyAtZSAiJHtDX1lFTExPV33lvbzpmLPnr53noqfvvIzpm77pnILmtqfmu4HjgIIke0NfUkVTRVR9IgogICAgc2xlZXAgNAogICAgZWNobyAtZSAiJHtDX1lFTExPV33otaTnn7PlhqzmuqrvvIzkvLznjpvnkZnmva3jgIIke0NfUkVTRVR9IgogICAgc2xlZXAgNAogICAgZWNobyAtZSAiJHtDX1lFTExPV33lvbzpmLPmmZrmhI/vvIzmmpbmoqbkvLzkuZDjgIIke0NfUkVTRVR9IgogICAgc2xlZXAgMwogICAgZWNobyAtZSAiJHtDX1lFTExPV33lr5DmuLjmta7mspDvvIzoi6Xpm4npo57oiJ7jgIIke0NfUkVTRVR9Igp9CgojIOi3nyBBUEkg6YCa5L+h55qE5Li75Ye95pWwCiMg5Y+C5pWw5bCx5piv6KaB5omn6KGM55qE5ZG95LukCl9mdWNrX2V4ZWN1dGVfcHJvbXB0KCkgewogICAgIyDlpoLmnpznlKjmiLflj6rovpPlhaUgImZ1Y2sgdW5pbnN0YWxsIgogICAgaWYgWyAiJDEiID0gInVuaW5zdGFsbCIgXSAmJiBbICIkIyIgLWVxIDEgXTsgdGhlbgogICAgICAgIF91bmluc3RhbGxfc2NyaXB0CiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgIyDlpoLmnpznlKjmiLfovpPlhaUgImZ1Y2sgY29uZmlnIgogICAgaWYgWyAiJDEiID0gImNvbmZpZyIgXSAmJiBbICIkIyIgLWVxIDEgXTsgdGhlbgogICAgICAgIF9mdWNrX3Nob3dfY29uZmlnX2hlbHAKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBpZiAhIGNvbW1hbmQgLXYgY3VybCAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfSdmdWNrJyDlkb3ku6TpnIDopoEgJ2N1cmwn77yM6K+35YWI5a6J6KOFIGN1cmzjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBpZiBbICIkIyIgLWVxIDAgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96K+35o+Q5L6b6KaB5omn6KGM55qE5ZG95Luk44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgcHJvbXB0PSIkKiIKICAgIGxvY2FsIGF1dG9fbW9kZT0iJHtGVUNLX0FVVE9fRVhFQzotMH0iCiAgICBsb2NhbCBjdXJsX3RpbWVvdXQ9IiR7RlVDS19USU1FT1VUOi0zMH0iCiAgICBsb2NhbCBzeXNpbmZvX3N0cmluZwogICAgc3lzaW5mb19zdHJpbmc9JChfZnVja19jb2xsZWN0X3N5c2luZm9fc3RyaW5nKQoKICAgIGxvY2FsIHJlc3BvbnNlPSIiCiAgICBsb2NhbCBleGl0X2NvZGU9MAogICAgaWYgX2Z1Y2tfc2hvdWxkX3VzZV9sb2NhbF9hcGk7IHRoZW4KICAgICAgICBwcmludGYgIiR7Q19ZRUxMT1d95L2/55So5pys5ZywIEFQSSBLZXkuLi4gJHtDX1JFU0VUfSIKICAgICAgICByZXNwb25zZT0kKF9mdWNrX3JlcXVlc3RfbG9jYWxfbW9kZWwgIiRwcm9tcHQiICIkc3lzaW5mb19zdHJpbmciICIkY3VybF90aW1lb3V0IikKICAgICAgICBleGl0X2NvZGU9JD8KICAgIGVsc2UKICAgICAgICBsb2NhbCBzcGlubmVyX2xhYmVsPSLmgJ3ogIPkuK3wn5KtICIKICAgICAgICBwcmludGYgJyVzJyAiJHNwaW5uZXJfbGFiZWwiCiAgICAgICAgcmVzcG9uc2U9JChfZnVja19yZXF1ZXN0X3dvcmtlcl9tb2RlbCAiJHByb21wdCIgIiRzeXNpbmZvX3N0cmluZyIgIiRjdXJsX3RpbWVvdXQiICIkc3Bpbm5lcl9sYWJlbCIpCiAgICAgICAgZXhpdF9jb2RlPSQ/CiAgICBmaQoKICAgIHByaW50ZiAiXHIiICMgQ2xlYXIgdGhlIGxpbmUgYmVmb3JlIHByaW50aW5nIGEgbmV3bGluZQogICAgZWNobyAiIgoKICAgIGlmIFsgJGV4aXRfY29kZSAtbmUgMCBdIHx8IFsgLXogIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgIHJldHVybiAkZXhpdF9jb2RlCiAgICBmaQoKICAgIGVjaG8gLWUgIiR7Q19DWUFOfeS4uuaCqOeUn+aIkOS6huS7peS4i+WRveS7pO+8miR7Q19SRVNFVH0iCiAgICBlY2hvIC1lICIke0NfRElNfS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0ke0NfUkVTRVR9IgogICAgcHJpbnRmICclc1xuJyAiJHJlc3BvbnNlIgogICAgZWNobyAtZSAiJHtDX0RJTX0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJHtDX1JFU0VUfSIKCiAgICAjIOWuieWFqOajgOafpeWNsemZqeWRveS7pAogICAgbG9jYWwgc2VjdXJpdHlfcmVzdWx0IHNlY3VyaXR5X2xldmVsIHNlY3VyaXR5X3JlYXNvbgogICAgc2VjdXJpdHlfcmVzdWx0PSQoX2Z1Y2tfZGV0ZWN0X2Rhbmdlcm91c19jb21tYW5kICIkcmVzcG9uc2UiKQogICAgc2VjdXJpdHlfbGV2ZWw9JHtzZWN1cml0eV9yZXN1bHQlJXwqfQogICAgc2VjdXJpdHlfcmVhc29uPSR7c2VjdXJpdHlfcmVzdWx0Iyp8fQoKICAgICMg5qC55o2u5Lil6YeN5oCn57qn5Yir5aSE55CG5a6J5YWo5Yaz562WCiAgICBpZiAhIF9mdWNrX3NlY3VyaXR5X2hhbmRsZV9kZWNpc2lvbiAiJHNlY3VyaXR5X2xldmVsIiAiJHNlY3VyaXR5X3JlYXNvbiIgIiRyZXNwb25zZSI7IHRoZW4KICAgICAgICBlY2hvIC1lICIke0NfUkVEfeKdjCDlkb3ku6Tlm6DlronlhajnrZbnlaXooqvkuK3mraLjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBsb2NhbCBzaG91bGRfZXhlYz1mYWxzZQoKICAgIGlmIF9mdWNrX3RydXRoeSAiJGF1dG9fbW9kZSI7IHRoZW4KICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfeKaoSDlt7LlvIDlkK/oh6rliqjmiafooYzmqKHlvI/vvIznq4vljbPov5DooYwuLi4ke0NfUkVTRVR9IgogICAgICAgIHNob3VsZF9leGVjPXRydWUKICAgIGVsc2UKICAgICAgICB3aGlsZSB0cnVlOyBkbwogICAgICAgICAgICBwcmludGYgIiR7Q19CT0xEfeaYr+WQpuaJp+ihjO+8n1tZL25dICR7Q19SRVNFVH0iCiAgICAgICAgICAgIGxvY2FsIGNvbmZpcm1hdGlvbiBub3JtYWxpemVkCiAgICAgICAgICAgIGlmIFsgLXIgL2Rldi90dHkgXTsgdGhlbgogICAgICAgICAgICAgICAgSUZTPSByZWFkIC1yIGNvbmZpcm1hdGlvbiA8IC9kZXYvdHR5CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIHJlYWQgLXIgY29uZmlybWF0aW9uCiAgICAgICAgICAgIGZpCgogICAgICAgICAgICBjb25maXJtYXRpb249JChwcmludGYgJyVzJyAiJHtjb25maXJtYXRpb246LX0iIHwgdHIgLWQgJyBcdFxyJykKICAgICAgICAgICAgbm9ybWFsaXplZD0kKHByaW50ZiAnJXMnICIkY29uZmlybWF0aW9uIiB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQoKICAgICAgICAgICAgY2FzZSAiJG5vcm1hbGl6ZWQiIGluCiAgICAgICAgICAgICAgICAiInwieSJ8InllcyJ8IuaYryIpCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2V4ZWM9dHJ1ZQogICAgICAgICAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19HUkVFTn3inIUg5omn6KGM5LitLi4uJHtDX1JFU0VUfSIKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAibiJ8Im5vInwi5ZCmIikKICAgICAgICAgICAgICAgICAgICBzaG91bGRfZXhlYz1mYWxzZQogICAgICAgICAgICAgICAgICAgIF9mdWNrX2F1ZGl0X2xvZyAiQUJPUlQiICIkcmVzcG9uc2UiCiAgICAgICAgICAgICAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33inYwg5bey5Y+W5raI44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgKikKICAgICAgICAgICAgICAgICAgICAjIExvb3AKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBlc2FjCiAgICAgICAgZG9uZQogICAgZmkKCiAgICBpZiBbICIkc2hvdWxkX2V4ZWMiID0gInRydWUiIF07IHRoZW4KICAgICAgICBldmFsICIkcmVzcG9uc2UiCiAgICAgICAgbG9jYWwgZXhpdF9jb2RlPSQ/CiAgICAgICAgCiAgICAgICAgIyDorrDlvZXlkb3ku6TmiafooYwKICAgICAgICBfZnVja19hdWRpdF9sb2cgIkVYRUMiICIkcmVzcG9uc2UiICIkZXhpdF9jb2RlIgogICAgICAgIAogICAgICAgIGlmIFsgJGV4aXRfY29kZSAtbmUgMCBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19SRURfQk9MRH3plJnor6/vvIEke0NfUkVEfeWRveS7pOaJp+ihjOWksei0pe+8jOmAgOWHuueggSAkZXhpdF9jb2Rl44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZmkKICAgICAgICByZXR1cm4gJGV4aXRfY29kZQogICAgZWxzZQogICAgICAgICMgIuW3suWPlua2iOOAgiIg5raI5oGv546w5Zyo5Zyo5b6q546v5YaF5omT5Y2w77yMCiAgICAgICAgIyDmiYDku6XlpoLmnpwgc2hvdWxkX2V4ZWMg5Li6IGZhbHNl77yM55u05o6l6L+U5ZueIDEg5Y2z5Y+v44CCCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCn0KCiMg5a6a5LmJ5Yir5ZCN77yI5pSv5oyB6Ieq5a6a5LmJ5Yir5ZCN77yJCl9mdWNrX2RlZmluZV9hbGlhc2VzKCkgewogICAgbG9jYWwgZGVmYXVsdF9hbGlhcz0iZnVjayIKCiAgICBpZiAhIF9mdWNrX3RydXRoeSAiJHtGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUzotMH0iOyB0aGVuCiAgICAgICAgYWxpYXMgIiRkZWZhdWx0X2FsaWFzIj0nX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQnCiAgICBmaQoKICAgIGlmIFsgLW4gIiR7RlVDS19BTElBUzotfSIgXSAmJiBbICIkRlVDS19BTElBUyIgIT0gIiRkZWZhdWx0X2FsaWFzIiBdOyB0aGVuCiAgICAgICAgYWxpYXMgIiRGVUNLX0FMSUFTIj0nX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQnCiAgICBmaQp9CgpfZnVja19kZWZpbmVfYWxpYXNlcwoKIyAtLS0g5qC45b+D6YC76L6R57uT5p2fIC0tLQpFT0YKCiMgLS0tIOaguOW/g+mAu+i+kSBIZXJlZG9jIOe7k+adnyAtLS0KCiMg5bCG5YaF5bWM5qC45b+D6YC76L6R5YaZ5Yiw5paH5Lu25Lit77yI5a6J6KOFL+S4tOaXtuaooeW8j+mDveS8mueUqOWIsO+8iQpfZnVja193cml0ZV9jb3JlKCkgewogICAgbG9jYWwgdGFyZ2V0PSIkMSIKICAgIHByaW50ZiAnJXNcbicgIiRDT1JFX0xPR0lDIiA+ICIkdGFyZ2V0Igp9CgojIOWwhuaguOW/g+mAu+i+kei9veWFpeW9k+WJjSBzaGVsbApfZnVja19zb3VyY2VfY29yZSgpIHsKICAgIGxvY2FsIHRtcF9jb3JlCiAgICB0bXBfY29yZT0kKG1rdGVtcCkKICAgIF9mdWNrX3dyaXRlX2NvcmUgIiR0bXBfY29yZSIKICAgICMgc2hlbGxjaGVjayBkaXNhYmxlPVNDMTA5MAogICAgc291cmNlICIkdG1wX2NvcmUiCiAgICBybSAtZiAiJHRtcF9jb3JlIgp9CgojIC0tLSDlronoo4Xlh73mlbAgKOeUseWklumDqOiEmuacrOi/kOihjCkgLS0tCgojIOaJvueUqOaItyBzaGVsbCDphY3nva7mlofku7bnmoTovoXliqnlh73mlbAKX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSgpIHsKICAgIGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgInpzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uenNocmMiCiAgICBlbGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgImJhc2giOyB0aGVuCiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnByb2ZpbGUiIF07IHRoZW4KICAgICAgICAjIOWFvOWuuSBzaCwga3NoIOetiQogICAgICAgIGVjaG8gIiRIT01FLy5wcm9maWxlIgogICAgZWxpZiBbIC1mICIkSE9NRS8uenNocmMiIF07IHRoZW4KICAgICAgICAjIFNIRUxMIOWPmOmHj+ayoeiuvue9ruaXtueahOWkh+eUqOaWueahiAogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLmJhc2hyYyIgXTsgdGhlbgogICAgICAgICMgU0hFTEwg5Y+Y6YeP5rKh6K6+572u5pe255qE5aSH55So5pa55qGICiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsc2UKICAgICAgICBlY2hvICJ1bmtub3duX3Byb2ZpbGUiCiAgICBmaQp9CgojIOS4u+WuieijheWHveaVsApfaW5zdGFsbGVyX3NlY3VyZV9jb25maWdfZmlsZSgpIHsKICAgIGlmIFsgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNobW9kIDYwMCAiJENPTkZJR19GSUxFIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICBmaQp9CgpfaW5zdGFsbF9zY3JpcHQoKSB7CiAgICBlY2hvIC1lICIke0NfQk9MRH3lvIDlp4vlronoo4UgZnVja2l0cy4uLiR7Q19SRVNFVH0iCiAgICBta2RpciAtcCAiJElOU1RBTExfRElSIgogICAgCiAgICAjIOaKiuaguOW/g+mAu+i+keWGmei/myBtYWluLnNoCiAgICBfZnVja193cml0ZV9jb3JlICIkTUFJTl9TSCIKCiAgICBpZiBbICQ/IC1uZSAwIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeaXoOazleWGmeWFpeaWh+S7tu+8jOivt+ajgOafpeebruW9leadg+mZkOOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgICMgTWFrZSBtYWluLnNoIGV4ZWN1dGFibGUKICAgIGNobW9kICt4ICIkTUFJTl9TSCIKCiAgICAjIOWmguaenOayoeaciemFjee9ruaWh+S7tuWImeeUn+aIkOS4gOS4quekuuS+iwogICAgaWYgWyAhIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBjYXQgPDwnQ0ZHJyA+ICIkQ09ORklHX0ZJTEUiCiMgZnVja2l0cyDphY3nva7npLrkvosKIyDljrvmjonooYzpppbnmoQgI++8jOaUueaIkOS9oOiHquW3seeahOWAvOWNs+WPr+OAggoKIyDoh6rlu7ov6Ieq5a6a5LmJIFdvcmtlciDlhaXlj6MKIyBleHBvcnQgRlVDS19BUElfRU5EUE9JTlQ9Imh0dHBzOi8veW91ci1kb21haW4ud29ya2Vycy5kZXYvIgoKIyDmnKzlnLAgT3BlbkFJIOWFvOWuuSBLZXnvvIjlvLrng4jmjqjojZDvvIkKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0tFWT0ic2stLi4uIgoKIyDopobnm5bpu5jorqTmqKHlnovmiJYgQVBJIOWfuuWdgAojIGV4cG9ydCBGVUNLX09QRU5BSV9NT0RFTD0iZ3B0LTRvLW1pbmkiCiMgZXhwb3J0IEZVQ0tfT1BFTkFJX0FQSV9CQVNFPSJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxIgoKIyDpop3lpJbliKvlkI3vvIjkuI3kvJrlvbHlk43pu5jorqQgZnVja++8iQojIGV4cG9ydCBGVUNLX0FMSUFTPSLov5DooYwiCgojIOiHquWKqOaJp+ihjOi/lOWbnueahOWRveS7pO+8iOWNsemZqe+8jOiwqOaFjuW8gOWQr++8iQojIGV4cG9ydCBGVUNLX0FVVE9fRVhFQz1mYWxzZQoKIyDor7fmsYLotoXml7bml7bpl7TvvIjnp5LvvIkKIyBleHBvcnQgRlVDS19USU1FT1VUPTMwCgojIOaYr+WQpui+k+WHuuiwg+ivleS/oeaBrwojIGV4cG9ydCBGVUNLX0RFQlVHPWZhbHNlCgojIOemgeeUqOWGhee9riBmdWNrIOWIq+WQjQojIGV4cG9ydCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUz1mYWxzZQpDRkcKICAgICAgICBfaW5zdGFsbGVyX3NlY3VyZV9jb25maWdfZmlsZQogICAgZmkKCiAgICAjIOaKiiBzb3VyY2Ug6YKj6KGM5Yqg5YiwIHNoZWxsIOmFjee9ruaWh+S7tumHjAogICAgbG9jYWwgcHJvZmlsZV9maWxlCiAgICBwcm9maWxlX2ZpbGU9JChfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKQogICAgCiAgICBpZiBbICIkcHJvZmlsZV9maWxlIiA9ICJ1bmtub3duX3Byb2ZpbGUiIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeaJvuS4jeWIsCAuYmFzaHJjLCAuenNocmMg5oiWIC5wcm9maWxl77yM5peg5rOV6Ieq5Yqo6YWN572u44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33or7fmiYvliqjlsIbku6XkuIvlhoXlrrnmt7vliqDliLDmgqjnmoQgc2hlbGwg6YWN572u5paH5Lu25Lit77yaJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZWNobyAtZSAiXG4gICR7Q19DWUFOfXNvdXJjZSAkTUFJTl9TSCR7Q19SRVNFVH1cbiIgPiYyCiAgICAgICAgcmV0dXJuCiAgICBmaQogICAgCiAgICBsb2NhbCBzb3VyY2VfbGluZT0ic291cmNlICRNQUlOX1NIIgogICAgaWYgISBncmVwIC1xRiAiJHNvdXJjZV9saW5lIiAiJHByb2ZpbGVfZmlsZSI7IHRoZW4KICAgICAgICAjIOS/neivgeaWh+S7tuacgOWQjuacieaNouihjAogICAgICAgIGlmIFsgLW4gIiQodGFpbCAtYzEgIiRwcm9maWxlX2ZpbGUiKSIgXTsgdGhlbgogICAgICAgICAgICBlY2hvICIiID4+ICIkcHJvZmlsZV9maWxlIgogICAgICAgIGZpCiAgICAgICAgZWNobyAiIyBBZGRlZCBieSBmdWNraXRzIGluc3RhbGxlciIgPj4gIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgZWNobyAiJHNvdXJjZV9saW5lIiA+PiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICBlY2hvIC1lICIke0NfR1JFRU595a6J6KOF5a6M5oiQ77yBJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9Xfeivt+mHjeWQr+e7iOerr+aIluaJp+ihjCAke0NfQk9MRH1zb3VyY2UgJHByb2ZpbGVfZmlsZSR7Q19ZRUxMT1d9IOS7peS9v+abtOaUueeUn+aViOOAgiR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiXG4ke0NfQk9MRH0tLS0g5L2/55So5pa55rOVIC0tLSR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAi5L2/55SoICR7Q19SRURfQk9MRH1mdWNrJHtDX1JFU0VUfSDlkb3ku6TlkI7ot5/mgqjmg7PmiafooYznmoTmk43kvZzljbPlj6/jgIIiCiAgICAgICAgZWNobyAtZSAi56S65L6LOiIKICAgICAgICBlY2hvIC1lICIgICR7Q19DWUFOfWZ1Y2sgaW5zdGFsbCBnaXQke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIiAgJHtDX0NZQU59ZnVjayB1bmluc3RhbGwgZ2l0JHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19DWUFOfWZ1Y2sg5om+5Ye65b2T5YmN55uu5b2V5omA5pyJ5aSn5LqOMTBNQueahOaWh+S7tiR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiICAke0NfUkVEX0JPTER9ZnVjayB1bmluc3RhbGwke0NfUkVTRVR9ICR7Q19HUkVFTn0jIOWNuOi9vSBmdWNraXRzJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19SRURfQk9MRH1mdWNrIGNvbmZpZyR7Q19SRVNFVH0gJHtDX0dSRUVOfSMg5pi+56S66YWN572u5biu5YqpJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICJcbiR7Q19ZRUxMT1d96K6w5b6X6YeN5ZCv57uI56uv5Lul5L2/55So5paw5ZG95Luk77yBJHtDX1JFU0VUfSIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfWUVMTE9XfeajgOa1i+WIsOW3suWuieijhe+8jOW3suS4uuaCqOabtOaWsOiEmuacrOOAgiR7Q19SRVNFVH0iCiAgICBmaQp9CgoKIyAtLS0g5Li76ISa5pys5YWl5Y+jIC0tLQoKIyDlpoLmnpzmnInlj4LmlbDkvKDov5vmnaUgKOavlOWmgiAiYmFzaCAtcyAuLi4iKQppZiBbICIkIyIgLWd0IDAgXTsgdGhlbgogICAgaWYgWyAiJDEiID0gImluc3RhbGwiIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfaW5zdGFsbF9zY3JpcHQKICAgICAgICBleGl0IDAKICAgIGZpCgogICAgX2Z1Y2tfc291cmNlX2NvcmUKICAgIF9mdWNrX2V4ZWN1dGVfcHJvbXB0ICIkQCIKZWxzZQogICAgX2luc3RhbGxfc2NyaXB0CmZpCg==`);

const README_URL_EN = 'https://github.com/Silentely/fuckits/blob/main/README.en.md';
const README_URL_ZH = 'https://github.com/Silentely/fuckits';
const INSTALLER_FILENAME_EN = 'fuckits.sh';
const INSTALLER_FILENAME_ZH = 'fuckits-zh.sh';
const SHARED_DEFAULT_LIMIT = 10;
const SECONDS_IN_DAY = 24 * 60 * 60;

let lastQuotaDate = null;
const sharedUsage = new Map();

function resolveSharedLimit(env) {
  const raw = Number(env?.SHARED_DAILY_LIMIT ?? env?.SHARED_DEFAULT_LIMIT);
  if (Number.isFinite(raw) && raw > 0) {
    return Math.floor(raw);
  }
  return SHARED_DEFAULT_LIMIT;
}

/**
 * 
 * @param {string} a 
 * @param {string} b 
 * @returns {boolean} 
 */
function timingSafeEqual(a, b) {
  if (typeof a !== 'string' || typeof b !== 'string') {
    return false;
  }

  // 
  const lenA = a.length;
  const lenB = b.length;

  // 
  const maxLen = Math.max(lenA, lenB);

  let result = lenA ^ lenB; // 

  for (let i = 0; i < maxLen; i++) {
    // 
    const charA = a.charCodeAt(i % lenA) || 0;
    const charB = b.charCodeAt(i % lenB) || 0;
    result |= charA ^ charB;
  }

  return result === 0;
}

function resolveQuotaStore(env) {
  if (env?.QUOTA_KV && typeof env.QUOTA_KV.get === 'function') {
    return env.QUOTA_KV;
  }

  const alias = env?.QUOTA_KV_BINDING;
  if (alias && env?.[alias] && typeof env[alias].get === 'function') {
    return env[alias];
  }

  if (env?.fuckits && typeof env.fuckits.get === 'function') {
    return env.fuckits;
  }

  return null;
}

async function checkSharedQuota(ip, limit, env) {
  const quotaStore = resolveQuotaStore(env);
  if (quotaStore) {
    return checkSharedQuotaKV(quotaStore, ip, limit);
  }
  return checkSharedQuotaInMemory(ip, limit);
}

function checkSharedQuotaInMemory(ip, limit) {
  const today = new Date().toISOString().slice(0, 10);
  if (lastQuotaDate !== today) {
    sharedUsage.clear();
    lastQuotaDate = today;
  }
  const key = ip || 'anonymous';
  const current = (sharedUsage.get(key) || 0) + 1;
  sharedUsage.set(key, current);
  return {
    allowed: current <= limit,
    remaining: Math.max(limit - current, 0),
    count: current,
  };
}

/**
 *  KV 
 *
 *   (Race Condition Notice)
 * =========================================
 *  get  check  put 
 *
 * 1.  kv.get()  kv.put()  10-50ms
 *    ""
 *
 * 2.  N 
 *     N  N-1 
 *
 * 3. KV  PoP  < 60s
 *    
 *
 * 
 * - 
 * - 
 * -  1-3 /
 *
 *  Cloudflare Durable Objects
 *
 * @param {object} kv - KV 
 * @param {string} ip -  IP 
 * @param {number} limit - 
 * @returns {Promise<{allowed: boolean, remaining: number, count: number}>}
 */
async function checkSharedQuotaKV(kv, ip, limit) {
  const today = new Date().toISOString().slice(0, 10);
  const key = `quota:${today}:${ip || 'anonymous'}`;
  const ttl = secondsUntilNextUtcMidnight();

  try {
    const raw = await kv.get(key);
    const currentCount = Number(raw) || 0;

    // 
    // 
    if (currentCount >= limit) {
      return {
        allowed: false,
        remaining: 0,
        count: currentCount,
      };
    }

    const newCount = currentCount + 1;
    await kv.put(key, String(newCount), { expirationTtl: ttl > 0 ? ttl : SECONDS_IN_DAY });

    return {
      allowed: newCount <= limit,
      remaining: Math.max(limit - newCount, 0),
      count: newCount,
    };
  } catch (error) {
    console.error('Failed to persist quota counter, falling back to in-memory map', error);
    return checkSharedQuotaInMemory(ip, limit);
  }
}

function secondsUntilNextUtcMidnight() {
  const now = new Date();
  const midnight = Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate() + 1);
  return Math.ceil((midnight - now.getTime()) / 1000);
}

function isBrowserRequest(userAgent = '') {
  return /Mozilla|Chrome|Safari|Firefox|Edg/.test(userAgent);
}

/**
 *  AI 
 *  AI 
 *
 * :
 * 1.  ( markdown)
 * 2.  fenced  (```bash ... ```)
 * 3.  ()
 * 4.  (`command`)
 * 5.  ()
 *
 * @param {string} rawCommand AI 
 * @returns {string} 
 */
function sanitizeCommand(rawCommand) {
  if (!rawCommand || typeof rawCommand !== 'string') {
    return '';
  }

  let command = rawCommand.trim();

  //  1:  fenced  (```bash ... ```  ```sh ... ``` )
  // :  ^  $ 
  const fencedBlockPattern = /```(?:bash|sh|shell|zsh|command)?\s*\n([\s\S]*?)\n```/;
  const fencedMatch = command.match(fencedBlockPattern);
  if (fencedMatch && fencedMatch[1].trim()) {
    command = fencedMatch[1].trim();
  } else {
    //  2:  fenced  (```command```)
    const inlineFencedPattern = /```(?:bash|sh|shell|zsh|command)?\s*([^\n`]+?)\s*```/;
    const inlineFencedMatch = command.match(inlineFencedPattern);
    if (inlineFencedMatch && inlineFencedMatch[1].trim()) {
      command = inlineFencedMatch[1].trim();
    } else {
      //  3:  (`command`)
      // 
      if (command.includes('`') && /[a-zA-Z].*:/.test(command)) {
        const inlineCodePattern = /`([^`]+)`/;
        const inlineMatch = command.match(inlineCodePattern);
        if (inlineMatch && inlineMatch[1].trim()) {
          //  ()
          const extracted = inlineMatch[1].trim();
          if (/^[a-zA-Z_\/\.]/.test(extracted) && !extracted.includes(' is ')) {
            command = extracted;
          }
        }
      }
    }
  }

  //  shebang  (#!/bin/bash, #!/usr/bin/env bash, )
  command = command.replace(/^#!\/(?:usr\/)?(?:bin\/)?(?:env\s+)?(?:ba)?sh\s*\n?/gm, '');

  //  shell  ( #  #! )
  // : 
  command = command.replace(/^[^\S\n]*#(?!!)[^\n]*\n?/gm, '');

  // 
  command = command.replace(/^\s*\n+/, '');

  // 
  command = command.replace(/\n+\s*$/, '');

  return command.trim();
}

function resolveLocale(url, headers) {
  const pathname = url.pathname.toLowerCase();
  if (pathname === '/zh' || pathname.startsWith('/zh/')) {
    return 'zh';
  }

  const langParam = (url.searchParams.get('lang') || '').toLowerCase();
  if (langParam) {
    //  lang  URL 
    if (langParam.startsWith('zh')) {
      return 'zh';
    }
    if (langParam.startsWith('en')) {
      return 'en';
    }
  }

  const acceptLanguage = (headers.get('Accept-Language') || '').toLowerCase();
  if (acceptLanguage.split(',').some((token) => token.trim().startsWith('zh'))) {
    return 'zh';
  }

  return 'en';
}


export default {
  async fetch(request, env, ctx) {
    const url = new URL(request.url);

    if (request.method === 'OPTIONS') {
      return addCorsHeaders(handleOptionsRequest());
    }

    if (request.method === 'GET' && url.pathname === '/health') {
      return addCorsHeaders(handleHealthCheck(env));
    }

    if (request.method === 'GET') {
      return addCorsHeaders(await handleGetRequest(request));
    } else if (request.method === 'POST') {
      return addCorsHeaders(await handlePostRequest(request, env));
    } else {
      return addCorsHeaders(new Response('Expected GET or POST', { status: 405 }));
    }
  },
};

function handleOptionsRequest() {
  return new Response(null, {
    status: 204,
    headers: {
      'Access-Control-Allow-Origin': '*',
      'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type',
    },
  });
}

function addCorsHeaders(response) {
  const newHeaders = new Headers(response.headers);
  newHeaders.set('Access-Control-Allow-Origin', '*');
  return new Response(response.body, {
    status: response.status,
    statusText: response.statusText,
    headers: newHeaders,
  });
}

function handleHealthCheck(env) {
  const payload = {
    status: 'ok',
    timestamp: new Date().toISOString(),
    hasApiKey: Boolean(env?.OPENAI_API_KEY),
  };

  return new Response(JSON.stringify(payload), {
    status: 200,
    headers: { 'Content-Type': 'application/json; charset=utf-8' },
  });
}

/**
 * Handles GET requests to serve the installer script or redirect browsers to GitHub.
 * @param {Request} request The incoming request.
 * @returns {Response} A response with the shell script or a redirect.
 */
function handleGetRequest(request) {
  const userAgent = request.headers.get('User-Agent') || '';

  const url = new URL(request.url);
  const locale = resolveLocale(url, request.headers);
  const isBrowser = isBrowserRequest(userAgent);

  // If the request comes from a browser, redirect to the appropriate README.
  if (isBrowser) {
    const docsUrl = locale === 'zh' ? README_URL_ZH : README_URL_EN;
    return Response.redirect(docsUrl, 302);
  }
  // Otherwise, serve the installer script based on the resolved locale.
  const script = locale === 'zh' ? INSTALLER_SCRIPT_ZH : INSTALLER_SCRIPT;
  const filename = locale === 'zh' ? INSTALLER_FILENAME_ZH : INSTALLER_FILENAME_EN;

  return new Response(script, {
    headers: {
      'Content-Type': 'text/plain; charset=utf-8',
      'Content-Disposition': `attachment; filename="${filename}"`,
    },
  });
}

/**
 * Handles POST requests by forwarding the prompt to an AI model.
 * @param {Request} request The incoming request.
 * @param {object} env The environment variables.
 * @returns {Promise<Response>} A promise that resolves to the AI's response.
 */
async function handlePostRequest(request, env) {
  try {
    const { sysinfo, prompt, adminKey } = await request.json();

    //  sysinfo
    if (!sysinfo || sysinfo.trim() === '') {
      return new Response(
        JSON.stringify({ error: 'Missing or empty "sysinfo" in request body' }),
        {
          status: 400,
          headers: { 'Content-Type': 'application/json' }
        }
      );
    }

    //  prompt
    if (!prompt || prompt.trim() === '') {
      return new Response(
        JSON.stringify({ error: 'Missing or empty "prompt" in request body' }),
        {
          status: 400,
          headers: { 'Content-Type': 'application/json' }
        }
      );
    }
    if (!env.OPENAI_API_KEY) {
      return new Response('Missing OPENAI_API_KEY secret', { status: 500 });
    }

    const normalizedAdminKey = typeof adminKey === 'string' ? adminKey.trim() : '';
    const hasAdminBypass = Boolean(
      normalizedAdminKey && env?.ADMIN_ACCESS_KEY && timingSafeEqual(normalizedAdminKey, env.ADMIN_ACCESS_KEY),
    );

    const clientIp = request.headers.get('CF-Connecting-IP') ||
      request.headers.get('X-Forwarded-For') ||
      'anonymous';
    if (!hasAdminBypass) {
      const sharedLimit = resolveSharedLimit(env);
      const quota = await checkSharedQuota(clientIp, sharedLimit, env);
      if (!quota.allowed) {
        const message = {
          error: 'DEMO_LIMIT_EXCEEDED',
          message: `Shared demo quota exceeded (max ${sharedLimit} calls per day).`,
          hint: 'Configure FUCK_OPENAI_API_KEY in ~/.fuck/config.sh to use your own key.',
          remaining: quota.remaining,
          limit: sharedLimit,
        };
        return new Response(JSON.stringify(message), {
          status: 429,
          headers: { 'Content-Type': 'application/json', 'Cache-Control': 'no-store' },
        });
      }
    }

    const model = env.OPENAI_API_MODEL || 'gpt-5-nano';
    const apiBase = (env.OPENAI_API_BASE || 'https://api.openai.com/v1').replace(/\/$/, '');
    const apiUrl = `${apiBase}/chat/completions`;

    const url = new URL(request.url);
    const locale = resolveLocale(url, request.headers);
    const isChinese = locale === 'zh';

    const system_prompt = isChinese
      ? ` shell  shell 


1. "" ls  ls ""
2.  if [ $# -eq 0 ]
3. 
4. markdown  \`\`\`bash shebang #!/bin/bash


- ""  : ls
- ""  : ls -la
- "10MB"  : find . -type f -size +10M

${sysinfo}`
      : `You are an expert shell command generator. Users describe tasks in natural language. Your task is to generate directly executable shell commands to accomplish their goals.

Important rules:
1. User input is natural language intent, NOT command arguments. For example, "list directory" means run ls, not ls "list directory"
2. Generate directly executable commands, not script templates with parameter handling (like if [ $# -eq 0 ])
3. For simple tasks return single commands, complex tasks can be multi-line scripts
4. Do not provide any explanation, comments, markdown formatting (like \`\`\`bash), or a shebang (e.g., #!/bin/bash)

Examples:
- User says "list directory"  Output: ls
- User says "show detailed file list"  Output: ls -la
- User says "find files larger than 10MB"  Output: find . -type f -size +10M

The user's system info is: ${sysinfo}`;

    const aiRequestPayload = {
      model: model,
      messages: [
        {
          role: 'system',
          content: system_prompt,
        },
        {
          role: 'user',
          content: prompt,
        },
      ],
      max_tokens: 1024,
      temperature: 0.2,
    };

    const aiResponse = await fetch(apiUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${env.OPENAI_API_KEY}`,
      },
      body: JSON.stringify(aiRequestPayload),
    });

    if (!aiResponse.ok) {
      const errorText = await aiResponse.text();
      return new Response(`AI API Error: ${errorText}`, { status: aiResponse.status });
    }

    const aiJson = await aiResponse.json();
    const command = aiJson.choices[0]?.message?.content.trim();

    if (!command) {
      return new Response('The AI returned an empty command.', { status: 500 });
    }

    //  AI  markdown shebang 
    const cleanedCommand = sanitizeCommand(command);

    if (!cleanedCommand) {
      return new Response('The AI returned an invalid command after sanitization.', { status: 500 });
    }

    return new Response(cleanedCommand, {
      headers: { 'Content-Type': 'text/plain' },
    });
  } catch (error) {
    return new Response(`Error: ${error.message}`, { status: 500 });
  }
}
