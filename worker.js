// --- FUCKIT.SH Cloudflare Worker ---

// This is the content of your main.sh installer script.
// It will be served when a user makes a GET request.
function b64_to_utf8(str) {
  try {
    // This is a more robust way to decode base64 to UTF-8
    const binaryString = atob(str);
    const len = binaryString.length;
    const bytes = new Uint8Array(len);
    for (let i = 0; i < len; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }
    return new TextDecoder().decode(bytes);
  } catch (e) {
    console.error("Failed to decode base64 string:", e);
    return ""; // Return empty string on failure
  }
}

const INSTALLER_SCRIPT = b64_to_utf8(`"IyEvYmluL2Jhc2gKIwojIGZ1Y2tpdHMgLSDlronoo4XohJrmnKzlkozkuLTml7bmiafooYzlmagKIwojIC0tLSDmjqjojZDnmoTlronlhajkvb/nlKjmlrnlvI8gLS0tCiMKIyAxLiDkuIvovb06CiMgICAgY3VybCAtbyBmdWNraXRzIGh0dHBzOi8vZnVja2l0cy4yNTUwMDU1Mi54eXoKIwojIDIuIOajgOafpeWGheWuuToKIyAgICBsZXNzIGZ1Y2tpdHMKIwojIDMuIOWuieijhei/kOihjDoKIyAgICBiYXNoIGZ1Y2tpdHMKIwojIDQuIOS4tOaXtui/kOihjDoKIyAgICBiYXNoIGZ1Y2tpdHMgInlvdXIgcHJvbXB0IgojCgpzZXQgLWV1byBwaXBlZmFpbAoKIyAtLS0g6Ziy5q2iIHJlYWRvbmx5IOWPmOmHj+mHjeWkjeWumuS5iSAtLS0KIyDmraTlrojljavlhYHorrjohJrmnKzooqvlpJrmrKEgc291cmNl77yI5L6L5aaC5Zyo5rWL6K+V5Lit77yJCmlmIFtbIC16ICIke0ZVQ0tJVFNfQ09OU1RBTlRTX0RFRklORUQ6LX0iIF1dOyB0aGVuCiAgICAjIOagh+iusOW4uOmHj+W3suWumuS5ie+8iGV4cG9ydCDkvb/lrZAgc2hlbGwg5Y+v6KeB77yJCiAgICBleHBvcnQgRlVDS0lUU19DT05TVEFOVFNfREVGSU5FRD0xCgojIC0tLSDpopzoibLlrprkuYkgLS0tCnJlYWRvbmx5IENfUkVTRVQ9J1wwMzNbMG0nCnJlYWRvbmx5IENfUkVEX0JPTEQ9J1wwMzNbMTszMW0nCnJlYWRvbmx5IENfUkVEPSdcMDMzWzA7MzFtJwpyZWFkb25seSBDX0dSRUVOPSdcMDMzWzA7MzJtJwpyZWFkb25seSBDX1lFTExPVz0nXDAzM1swOzMzbScKcmVhZG9ubHkgQ19DWUFOPSdcMDMzWzA7MzZtJwpyZWFkb25seSBDX0JPTEQ9J1wwMzNbMW0nCnJlYWRvbmx5IENfRElNPSdcMDMzWzJtJwoKIyAtLS0gRlVDSyEgLS0tCnJlYWRvbmx5IEZVQ0s9IiR7Q19SRURfQk9MRH1GVUNLISR7Q19SRVNFVH0iCnJlYWRvbmx5IEZDS049IiR7Q19SRUR9RipDS0lORyR7Q19SRVNFVH0iCgpyZWFkb25seSBGVUNLSVRTX0xPQ0FMRT0iZW4iCgoKIyAtLS0g6YWN572uIC0tLQppZiBbIC16ICIke0hPTUU6LX0iIF07IHRoZW4KICAgIGVjaG8gLWUgIlwwMzNbMTszMW1GVUNLIVwwMzNbMG0gXDAzM1swOzMxbVlvdXIgSE9NRSB2YXJpYWJsZSBpc24ndCBzZXQuIEkgZG9uJ3Qga25vdyB3aGVyZSB0byBpbnN0YWxsIHRoaXMgc2hpdC4gU2V0IGl0IHlvdXJzZWxmIChlLmcuLCBleHBvcnQgSE9NRT0vcm9vdCkuXDAzM1swbSIgPiYyCiAgICBleGl0IDEKZmkKcmVhZG9ubHkgSU5TVEFMTF9ESVI9IiRIT01FLy5mdWNrIgpyZWFkb25seSBNQUlOX1NIPSIkSU5TVEFMTF9ESVIvbWFpbi5zaCIKcmVhZG9ubHkgQ09ORklHX0ZJTEU9IiRJTlNUQUxMX0RJUi9jb25maWcuc2giCgpmaSAgIyByZWFkb25seSDluLjph4/lrojljavnu5PmnZ8KCgojIC0tLSDmoLjlv4PpgLvovpHvvIjltYzlhaXkuLrlrZfnrKbkuLLvvIktLS0KcmVhZCAtciAtZCAnJyBDT1JFX0xPR0lDIDw8J0VPRicgfHwgdHJ1ZQoKIyAtLS0gZnVja2l0cyDmoLjlv4PpgLvovpHlvIDlp4sgLS0tCgojIC0tLSDpopzoibLlrprkuYkgLS0tCiMg5LuF5Zyo5bCa5pyq5a6a5LmJ5pe25a6a5LmJ6aKc6Imy77yI55So5LqO5Li05pe25qih5byP77yJCmlmIFsgLXogIiR7Q19SRVNFVDotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgQ19SRVNFVD0nXDAzM1swbScKICAgIHJlYWRvbmx5IENfUkVEX0JPTEQ9J1wwMzNbMTszMW0nCiAgICByZWFkb25seSBDX1JFRD0nXDAzM1swOzMxbScKICAgIHJlYWRvbmx5IENfR1JFRU49J1wwMzNbMDszMm0nCiAgICByZWFkb25seSBDX1lFTExPVz0nXDAzM1swOzMzbScKICAgIHJlYWRvbmx5IENfQ1lBTj0nXDAzM1swOzM2bScKICAgIHJlYWRvbmx5IENfQk9MRD0nXDAzM1sxbScKICAgIHJlYWRvbmx5IENfRElNPSdcMDMzWzJtJwoKICAgICMgLS0tIEZVQ0shIC0tLQogICAgcmVhZG9ubHkgRlVDSz0iJHtDX1JFRF9CT0xEfUZVQ0shJHtDX1JFU0VUfSIKICAgIHJlYWRvbmx5IEZDS049IiR7Q19SRUR9RipDS0lORyR7Q19SRVNFVH0iCmZpCgppZiBbIC16ICIke0lOU1RBTExfRElSK3h9IiBdIHx8IFsgLXogIiR7TUFJTl9TSCt4fSIgXSB8fCBbIC16ICIke0NPTkZJR19GSUxFK3h9IiBdOyB0aGVuCiAgICBpZiBbIC16ICIke0hPTUU6LX0iIF07IHRoZW4KICAgICAgICByZWFkb25seSBJTlNUQUxMX0RJUj0iL3RtcC8uZnVjayIKICAgICAgICByZWFkb25seSBNQUlOX1NIPSIvdG1wLy5mdWNrL21haW4uc2giCiAgICAgICAgcmVhZG9ubHkgQ09ORklHX0ZJTEU9Ii90bXAvLmZ1Y2svY29uZmlnLnNoIgogICAgZWxzZQogICAgICAgIHJlYWRvbmx5IElOU1RBTExfRElSPSIkSE9NRS8uZnVjayIKICAgICAgICByZWFkb25seSBNQUlOX1NIPSIkSU5TVEFMTF9ESVIvbWFpbi5zaCIKICAgICAgICByZWFkb25seSBDT05GSUdfRklMRT0iJElOU1RBTExfRElSL2NvbmZpZy5zaCIKICAgIGZpCmZpCgojIE5vdGU6IENvbmZpZyBsb2FkaW5nIGlzIGRvbmUgQUZURVIgdmFsaWRhdGlvbiBmdW5jdGlvbnMgYXJlIGRlZmluZWQgKHNlZSBiZWxvdykKCmlmIFsgLXogIiR7REVGQVVMVF9BUElfRU5EUE9JTlQreH0iIF07IHRoZW4KICAgIHJlYWRvbmx5IERFRkFVTFRfQVBJX0VORFBPSU5UPSJodHRwczovL2Z1Y2tpdHMuMjU1MDA1NTIueHl6LyIKZmkKCiMgLS0tIOWuieWFqOmFjee9rumqjOivgSAtLS0KIyBWYWxpZGF0ZXMgY29uZmlnIGZpbGUgY29udGVudCBiZWZvcmUgc291cmNpbmcgdG8gcHJldmVudCBjb2RlIGluamVjdGlvbgojIEFyZ3VtZW50czogJDEgLSBmaWxlIHBhdGggdG8gdmFsaWRhdGUKIyBSZXR1cm5zOiAwIGlmIHNhZmUsIDEgaWYgdW5zYWZlIG9yIGVycm9yCl9mdWNrX3ZhbGlkYXRlX2NvbmZpZ19maWxlKCkgewogICAgbG9jYWwgZmlsZT0iJDEiCgogICAgIyBGaWxlIG11c3QgZXhpc3QgYW5kIGJlIHJlYWRhYmxlCiAgICBpZiBbICEgLWYgIiRmaWxlIiBdIHx8IFsgISAtciAiJGZpbGUiIF07IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIENoZWNrIGZpbGUgcGVybWlzc2lvbnMgLSBzaG91bGQgYmUgb3duZWQgYnkgY3VycmVudCB1c2VyCiAgICBpZiBbICIkKHN0YXQgLWMgJyV1JyAiJGZpbGUiIDI+L2Rldi9udWxsIHx8IHN0YXQgLWYgJyV1JyAiJGZpbGUiIDI+L2Rldi9udWxsKSIgIT0gIiQoaWQgLXUpIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1Db25maWcgZmlsZSBub3Qgb3duZWQgYnkgY3VycmVudCB1c2VyLCByZWZ1c2luZyB0byBzb3VyY2UuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbGluZV9udW09MAogICAgbG9jYWwgbGluZQoKICAgICMgUHJlLWRlZmluZSByZWdleCBwYXR0ZXJucyBhcyB2YXJpYWJsZXMgKHpzaCBjb21wYXRpYmlsaXR5OiBhdm9pZHMgc3BlY2lhbCBjaGFyYWN0ZXIgcGFyc2luZyBpc3N1ZXMpCiAgICBsb2NhbCByZV9jbWRfc3ViPSdcJFwoJwogICAgbG9jYWwgcmVfYmFja3RpY2s9J2AnCiAgICBsb2NhbCByZV9hcml0aD0nXCRcKFwoJwogICAgbG9jYWwgcmVfc2VtaT0nOycKICAgIGxvY2FsIHJlX2FuZD0nJiYnCiAgICBsb2NhbCByZV9vcj0nXHxcfCcKICAgIGxvY2FsIHJlX3BpcGU9J1x8JwogICAgbG9jYWwgcmVfZ3Q9Jz4nCiAgICBsb2NhbCByZV9sdD0nPCcKICAgIGxvY2FsIHJlX2FtcD0nJicKICAgIGxvY2FsIHJlX2VzYz0nXFxcJCcKCiAgICB3aGlsZSBJRlM9IHJlYWQgLXIgbGluZSB8fCBbIC1uICIkbGluZSIgXTsgZG8KICAgICAgICBsaW5lX251bT0kKChsaW5lX251bSArIDEpKQoKICAgICAgICAjIFNraXAgZW1wdHkgbGluZXMKICAgICAgICBpZiBbIC16ICIkbGluZSIgXSB8fCBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSokIF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyBTa2lwIGNvbW1lbnQgbGluZXMgKCMgYXQgc3RhcnQsIG9wdGlvbmFsbHkgd2l0aCBsZWFkaW5nIHdoaXRlc3BhY2UpCiAgICAgICAgaWYgW1sgIiRsaW5lIiA9fiBeW1s6c3BhY2U6XV0qIyBdXTsgdGhlbgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZpCgogICAgICAgICMgQ2hlY2sgZm9yIGRhbmdlcm91cyBzaGVsbCBtZXRhY2hhcmFjdGVycyBhbmQgY29tbWFuZCBzdWJzdGl0dXRpb24KICAgICAgICAjIFJlamVjdDogJCgpLCBgYCwgJCgoKSwgOywgJiYsIHx8LCB8IChwaXBlKSwgPiwgPCwgJiwgbmV3bGluZSBlc2NhcGVzCiAgICAgICAgaWYgW1sgIiRsaW5lIiA9fiAkcmVfY21kX3N1YiBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfYmFja3RpY2sgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2FyaXRoIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9zZW1pIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hbmQgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX29yIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9waXBlIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9ndCBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfbHQgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2FtcCBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfZXNjIF1dOyB0aGVuCiAgICAgICAgICAgIF9mdWNrX2RlYnVnICJDb25maWcgdmFsaWRhdGlvbiBmYWlsZWQgYXQgbGluZSAkbGluZV9udW06IGRhbmdlcm91cyBtZXRhY2hhcmFjdGVyIGRldGVjdGVkIgogICAgICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfVVuc2FmZSBjb25maWcgZmlsZTogZGFuZ2Vyb3VzIHNoZWxsIG1ldGFjaGFyYWN0ZXIgYXQgbGluZSAkbGluZV9udW0ke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICBmaQoKICAgICAgICAjIE9ubHkgYWxsb3c6IGV4cG9ydCBGVUNLXyo9Li4uIG9yIEZVQ0tfKj0uLi4gKHdpdGggb3B0aW9uYWwgd2hpdGVzcGFjZSkKICAgICAgICAjIEFsc28gYWxsb3c6IGV4cG9ydCBGVUNLSVRTX0xPQ0FMRT0uLi4KICAgICAgICBpZiBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSooZXhwb3J0W1s6c3BhY2U6XV0rKT8oRlVDS19bQS1aX10rfEZVQ0tJVFNfTE9DQUxFKT0gXV07IHRoZW4KICAgICAgICAgICAgY29udGludWUKICAgICAgICBmaQoKICAgICAgICAjIFJlamVjdCBhbnl0aGluZyBlbHNlCiAgICAgICAgX2Z1Y2tfZGVidWcgIkNvbmZpZyB2YWxpZGF0aW9uIGZhaWxlZCBhdCBsaW5lICRsaW5lX251bTogdW5yZWNvZ25pemVkIHBhdHRlcm4iCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1VbnNhZmUgY29uZmlnIGZpbGU6IHVucmVjb2duaXplZCBwYXR0ZXJuIGF0IGxpbmUgJGxpbmVfbnVtJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGRvbmUgPCAiJGZpbGUiCgogICAgcmV0dXJuIDAKfQoKIyBTYWZlbHkgc291cmNlIGEgY29uZmlnIGZpbGUgYWZ0ZXIgdmFsaWRhdGlvbgojIEFyZ3VtZW50czogJDEgLSBmaWxlIHBhdGggdG8gc291cmNlCiMgUmV0dXJuczogMCBpZiBzb3VyY2VkIHN1Y2Nlc3NmdWxseSwgMSBpZiB2YWxpZGF0aW9uIGZhaWxlZCBvciBmaWxlIGRvZXNuJ3QgZXhpc3QKX2Z1Y2tfc2FmZV9zb3VyY2VfY29uZmlnKCkgewogICAgbG9jYWwgZmlsZT0iJDEiCgogICAgaWYgWyAhIC1mICIkZmlsZSIgXTsgdGhlbgogICAgICAgIHJldHVybiAwICAjIE5vIGZpbGUgaXMgZmluZQogICAgZmkKCiAgICBpZiBfZnVja192YWxpZGF0ZV9jb25maWdfZmlsZSAiJGZpbGUiOyB0aGVuCiAgICAgICAgIyBzaGVsbGNoZWNrIGRpc2FibGU9U0MxMDkwCiAgICAgICAgc291cmNlICIkZmlsZSIKICAgICAgICByZXR1cm4gJD8KICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfUNvbmZpZyBmaWxlIHZhbGlkYXRpb24gZmFpbGVkLCBza2lwcGluZzogJGZpbGUke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyAtLS0g5Yqg6L2955So5oi36YWN572u77yI5bim6aqM6K+B77yJLS0tCiMgTm93IHRoYXQgdmFsaWRhdGlvbiBmdW5jdGlvbnMgYXJlIGRlZmluZWQsIHNhZmVseSBsb2FkIHRoZSBjb25maWcKX2Z1Y2tfc2FmZV9zb3VyY2VfY29uZmlnICIkQ09ORklHX0ZJTEUiCgojIC0tLSBBdWRpdCBMb2dnaW5nIC0tLQojIExvZ3MgY29tbWFuZCBleGVjdXRpb24gdG8gYXVkaXQgbG9nIGZpbGUKIyBBcmd1bWVudHM6ICQxIC0gZXZlbnQgKGUuZy4sICJFWEVDIiwgIkJMT0NLIiwgIkFCT1JUIiksICQyIC0gY29tbWFuZCwgJDMgLSBleGl0IGNvZGUgKG9wdGlvbmFsKQpfZnVja19hdWRpdF9sb2coKSB7CiAgICAjIENoZWNrIGlmIGF1ZGl0IGxvZ2dpbmcgaXMgZW5hYmxlZAogICAgaWYgWyAiJHtGVUNLX0FVRElUX0xPRzotZmFsc2V9IiAhPSAidHJ1ZSIgXTsgdGhlbgogICAgICAgIHJldHVybiAwCiAgICBmaQogICAgCiAgICBsb2NhbCBldmVudD0iJDEiCiAgICBsb2NhbCBjb21tYW5kPSIkMiIKICAgIGxvY2FsIGV4aXRfY29kZT0iJHszOi0tfSIKICAgIGxvY2FsIHRpbWVzdGFtcAogICAgdGltZXN0YW1wPSQoZGF0ZSAtdSAnKyVZLSVtLSVkICVIOiVNOiVTIFVUQycgMj4vZGV2L251bGwgfHwgZGF0ZSAnKyVZLSVtLSVkICVIOiVNOiVTJykKICAgIGxvY2FsIGxvZ19maWxlPSIke0ZVQ0tfQVVESVRfTE9HX0ZJTEU6LSRJTlNUQUxMX0RJUi8uYXVkaXQubG9nfSIKICAgIAogICAgIyBFbnN1cmUgbG9nIGRpcmVjdG9yeSBleGlzdHMKICAgIG1rZGlyIC1wICIkKGRpcm5hbWUgIiRsb2dfZmlsZSIpIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICAKICAgICMgU2FuaXRpemUgY29tbWFuZCBmb3IgbG9nZ2luZyAocmVtb3ZlIG5ld2xpbmVzLCBsaW1pdCBsZW5ndGgpCiAgICBsb2NhbCBzYW5pdGl6ZWRfY21kCiAgICBzYW5pdGl6ZWRfY21kPSQoZWNobyAiJGNvbW1hbmQiIHwgdHIgJ1xuJyAnICcgfCBoZWFkIC1jIDIwMCkKICAgIGlmIFsgJHsjY29tbWFuZH0gLWd0IDIwMCBdOyB0aGVuCiAgICAgICAgc2FuaXRpemVkX2NtZD0iJHtzYW5pdGl6ZWRfY21kfS4uLiIKICAgIGZpCiAgICAKICAgICMgV3JpdGUgdG8gbG9nIGZpbGUgKGZvcm1hdDogdGltZXN0YW1wfHVzZXJ8ZXZlbnR8ZXhpdF9jb2RlfGNvbW1hbmQpCiAgICBlY2hvICIke3RpbWVzdGFtcH18JHtVU0VSOi11bmtub3dufXwke2V2ZW50fXwke2V4aXRfY29kZX18JHtzYW5pdGl6ZWRfY21kfSIgPj4gIiRsb2dfZmlsZSIgMj4vZGV2L251bGwgfHwgdHJ1ZQogICAgCiAgICAjIFNlY3VyZSB0aGUgbG9nIGZpbGUKICAgIGNobW9kIDYwMCAiJGxvZ19maWxlIiAyPi9kZXYvbnVsbCB8fCB0cnVlCn0KCiMgSGVscGVyIHRvIGZpbmQgdGhlIHVzZXIncyBzaGVsbCBwcm9maWxlIGZpbGUKX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSgpIHsKICAgIGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgInpzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uenNocmMiCiAgICBlbGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgImJhc2giOyB0aGVuCiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnByb2ZpbGUiIF07IHRoZW4KICAgICAgICAjIEZhbGxiYWNrIGZvciBzaCwga3NoLCBldGMuCiAgICAgICAgZWNobyAiJEhPTUUvLnByb2ZpbGUiCiAgICBlbGlmIFsgLWYgIiRIT01FLy56c2hyYyIgXTsgdGhlbgogICAgICAgICMgRmFsbGJhY2sgaWYgU0hFTEwgdmFyIGlzbid0IHNldAogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLmJhc2hyYyIgXTsgdGhlbgogICAgICAgICMgRmFsbGJhY2sgaWYgU0hFTEwgdmFyIGlzbid0IHNldAogICAgICAgIGVjaG8gIiRIT01FLy5iYXNocmMiCiAgICBlbHNlCiAgICAgICAgZWNobyAidW5rbm93bl9wcm9maWxlIgogICAgZmkKfQoKIyAtLS0g57O757uf5L+h5oGv5pS26ZuGIC0tLQojIENhY2hlIGZpbGUgZm9yIHN0YXRpYyBzeXN0ZW0gaW5mb3JtYXRpb24gKHBlcnNpc3RlZCBhY3Jvc3MgcnVucykKIyBPbmx5IGRlZmluZSBpZiBub3QgYWxyZWFkeSBzZXQgKHByZXZlbnRzIHJlYWQtb25seSB2YXJpYWJsZSBlcnJvcnMpCmlmIFsgLXogIiR7RlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEU6LX0iIF07IHRoZW4KICAgIHJlYWRvbmx5IEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFPSIkSU5TVEFMTF9ESVIvLnN5c2luZm8uY2FjaGUiCmZpCiMgQ2FjaGUgc3RhdGUgdHJhY2tpbmcgdmFyaWFibGVzCl9GVUNLX1NUQVRJQ19DQUNIRV9MT0FERUQ9MApfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFk9MAoKIyBMb2FkcyBzdGF0aWMgc3lzdGVtIGluZm9ybWF0aW9uIGZyb20gY2FjaGUgZmlsZQojIEdsb2JhbHM6IF9GVUNLX1NUQVRJQ19DQUNIRV9MT0FERUQsIEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFCl9mdWNrX2xvYWRfc3RhdGljX2NhY2hlKCkgewogICAgIyBSZXR1cm4gZWFybHkgaWYgY2FjaGUgaXMgYWxyZWFkeSBsb2FkZWQKICAgIGlmIFsgIiR7X0ZVQ0tfU1RBVElDX0NBQ0hFX0xPQURFRDotMH0iIC1lcSAxIF07IHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBfRlVDS19TVEFUSUNfQ0FDSEVfTE9BREVEPTEKCiAgICAjIFNvdXJjZSBjYWNoZSBmaWxlIGlmIGl0IGV4aXN0cwogICAgaWYgWyAtZiAiJEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFIiBdOyB0aGVuCiAgICAgICAgIyBzaGVsbGNoZWNrIGRpc2FibGU9U0MxMDkwCiAgICAgICAgc291cmNlICIkRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUiIHx8IHRydWUKICAgIGZpCn0KCiMgTWFya3Mgc3RhdGljIGNhY2hlIGFzIGRpcnR5IChuZWVkcyB0byBiZSBwZXJzaXN0ZWQpCiMgR2xvYmFsczogX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZCl9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5KCkgewogICAgX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZPTEKfQoKIyBQZXJzaXN0cyBzdGF0aWMgc3lzdGVtIGluZm9ybWF0aW9uIHRvIGNhY2hlIGZpbGUKIyBHbG9iYWxzOiBfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFksIEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFCiMgUmV0dXJuczogMCBvbiBzdWNjZXNzLCAxIG9uIGZhaWx1cmUKX2Z1Y2tfcGVyc2lzdF9zdGF0aWNfY2FjaGUoKSB7CiAgICAjIE9ubHkgcGVyc2lzdCBpZiBjYWNoZSBpcyBkaXJ0eQogICAgaWYgWyAiJHtfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFk6LTB9IiAtbmUgMSBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgIyBFbnN1cmUgY2FjaGUgZGlyZWN0b3J5IGV4aXN0cwogICAgbG9jYWwgY2FjaGVfZGlyCiAgICBjYWNoZV9kaXI9JChkaXJuYW1lICIkRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUiKQogICAgaWYgISBta2RpciAtcCAiJGNhY2hlX2RpciIgMj4vZGV2L251bGw7IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIENyZWF0ZSB0ZW1wb3JhcnkgZmlsZSBmb3IgYXRvbWljIHdyaXRlCiAgICBsb2NhbCB0bXBfZmlsZQogICAgdG1wX2ZpbGU9JChta3RlbXApIHx8IHJldHVybiAxCgogICAgIyBXcml0ZSBjYWNoZWQgdmFyaWFibGVzIHRvIHRlbXBvcmFyeSBmaWxlCiAgICB7CiAgICAgICAgcHJpbnRmICdfRlVDS19DQUNIRURfRElTVFJPPSVxXFxuJyAiJHtfRlVDS19DQUNIRURfRElTVFJPOi19IgogICAgICAgIHByaW50ZiAnX0ZVQ0tfQ0FDSEVEX0tFUk5FTD0lcVxcbicgIiR7X0ZVQ0tfQ0FDSEVEX0tFUk5FTDotfSIKICAgICAgICBwcmludGYgJ19GVUNLX0NBQ0hFRF9BUkNIPSVxXFxuJyAiJHtfRlVDS19DQUNIRURfQVJDSDotfSIKICAgICAgICBwcmludGYgJ19GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUj0lcVxcbicgIiR7X0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSOi19IgogICAgfSA+ICIkdG1wX2ZpbGUiCgogICAgIyBBdG9taWMgbW92ZSB0byBmaW5hbCBsb2NhdGlvbgogICAgaWYgbXYgIiR0bXBfZmlsZSIgIiRGVUNLX1NZU0lORk9fQ0FDSEVfRklMRSIgMj4vZGV2L251bGw7IHRoZW4KICAgICAgICBfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFk9MAogICAgICAgIHJldHVybiAwCiAgICBlbHNlCiAgICAgICAgIyBDbGVhbiB1cCB0ZW1wb3JhcnkgZmlsZSBvbiBmYWlsdXJlCiAgICAgICAgcm0gLWYgIiR0bXBfZmlsZSIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyBEZXRlY3RzIHRoZSBkaXN0cmlidXRpb24vT1MgZmFtaWx5IHdpdGggY2FjaGluZyBzdXBwb3J0CiMgT3V0cHV0czogRGlzdHJpYnV0aW9uIHN0cmluZyAoZS5nLiwgIkRlYmlhbi1iYXNlZCAxMi4wNCAoVWJ1bnR1IDI0LjA0IExUUykiKQpfZnVja19kZXRlY3RfZGlzdHJvKCkgewogICAgX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUKCiAgICAjIFJldHVybiBjYWNoZWQgdmFsdWUgaWYgYXZhaWxhYmxlCiAgICBpZiBbIC1uICIke19GVUNLX0NBQ0hFRF9ESVNUUk86LX0iIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkX0ZVQ0tfQ0FDSEVEX0RJU1RSTyIKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBsb2NhbCBrZXJuZWxfbmFtZSBkaXN0cm8gaWQgdmVyc2lvbiBwcmV0dHkgZmFtaWx5CiAgICBrZXJuZWxfbmFtZT0kKHVuYW1lIC1zIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBkaXN0cm89InVua25vd24iCgogICAgIyBtYWNPUyBkZXRlY3Rpb24KICAgIGlmIFsgIiRrZXJuZWxfbmFtZSIgPSAiRGFyd2luIiBdOyB0aGVuCiAgICAgICAgbG9jYWwgcHJvZHVjdCB2ZXJzaW9uCiAgICAgICAgcHJvZHVjdD0kKHN3X3ZlcnMgLXByb2R1Y3ROYW1lIDI+L2Rldi9udWxsIHx8IHByaW50ZiAnbWFjT1MnKQogICAgICAgIHByb2R1Y3Q9JChwcmludGYgJyVzJyAiJHByb2R1Y3QiIHwgdHIgLWQgJ1xyXG4nKQogICAgICAgIHZlcnNpb249JChzd192ZXJzIC1wcm9kdWN0VmVyc2lvbiAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgICAgIHZlcnNpb249JChwcmludGYgJyVzJyAiJHZlcnNpb24iIHwgdHIgLWQgJ1xyXG4nKQogICAgICAgIGRpc3Rybz0iJHByb2R1Y3QgJHZlcnNpb24iCiAgICAjIExpbnV4IGRldGVjdGlvbiB1c2luZyAvZXRjL29zLXJlbGVhc2UKICAgIGVsaWYgWyAtciAvZXRjL29zLXJlbGVhc2UgXTsgdGhlbgogICAgICAgIGlkPSQoZ3JlcCAtRSAnXklEPScgL2V0Yy9vcy1yZWxlYXNlIHwgaGVhZCAtbjEgfCBjdXQgLWQ9IC1mMiB8IHRyIC1kICciJyB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQogICAgICAgIHZlcnNpb249JChncmVwIC1FICdeVkVSU0lPTl9JRD0nIC9ldGMvb3MtcmVsZWFzZSB8IGhlYWQgLW4xIHwgY3V0IC1kPSAtZjIgfCB0ciAtZCAnIicpCiAgICAgICAgcHJldHR5PSQoZ3JlcCAtRSAnXlBSRVRUWV9OQU1FPScgL2V0Yy9vcy1yZWxlYXNlIHwgaGVhZCAtbjEgfCBjdXQgLWQ9IC1mMi0gfCB0ciAtZCAnIicpCgogICAgICAgICMgRGV0ZXJtaW5lIE9TIGZhbWlseSBmb3IgYmV0dGVyIGNhdGVnb3JpemF0aW9uCiAgICAgICAgZmFtaWx5PSIiCiAgICAgICAgY2FzZSAiJGlkIiBpbgogICAgICAgICAgICB1YnVudHV8ZGViaWFuKQogICAgICAgICAgICAgICAgZmFtaWx5PSJEZWJpYW4tYmFzZWQiCiAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBjZW50b3N8cmhlbHxyb2NreXxhbG1hbGludXh8ZmVkb3JhKQogICAgICAgICAgICAgICAgZmFtaWx5PSJSSEVMLWJhc2VkIgogICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgYXJjaHxtYW5qYXJvfGVuZGVhdm91cm9zKQogICAgICAgICAgICAgICAgZmFtaWx5PSJBcmNoLWJhc2VkIgogICAgICAgICAgICAgICAgOzsKICAgICAgICBlc2FjCgogICAgICAgICMgRm9ybWF0IGRpc3RyaWJ1dGlvbiBzdHJpbmcgd2l0aCBmYW1pbHkgYW5kIHZlcnNpb24KICAgICAgICBpZiBbIC1uICIkZmFtaWx5IiBdOyB0aGVuCiAgICAgICAgICAgIGRpc3Rybz0iJGZhbWlseSAke3ZlcnNpb246LX0iCiAgICAgICAgICAgIGlmIFsgLW4gIiRwcmV0dHkiIF07IHRoZW4KICAgICAgICAgICAgICAgIGRpc3Rybz0iJGRpc3RybyAoJHtwcmV0dHl9KSIKICAgICAgICAgICAgZmkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGRpc3Rybz0iJHtwcmV0dHk6LUxpbnV4ICR2ZXJzaW9ufSIKICAgICAgICBmaQogICAgZWxzZQogICAgICAgIGRpc3Rybz0iJGtlcm5lbF9uYW1lIgogICAgZmkKCiAgICAjIENhY2hlIGFuZCByZXR1cm4gcmVzdWx0CiAgICBfRlVDS19DQUNIRURfRElTVFJPPSIkZGlzdHJvIgogICAgX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkKICAgIHByaW50ZiAnJXNcbicgIiRkaXN0cm8iCn0KCiMgR2V0cyBrZXJuZWwgdmVyc2lvbiBpbmZvcm1hdGlvbiB3aXRoIGNhY2hpbmcKIyBPdXRwdXRzOiBLZXJuZWwgdmVyc2lvbiBzdHJpbmcgKGUuZy4sICJMaW51eCA2LjguMC0zMS1nZW5lcmljIikKX2Z1Y2tfZ2V0X2tlcm5lbF92ZXJzaW9uKCkgewogICAgX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUKCiAgICAjIFJldHVybiBjYWNoZWQgdmFsdWUgaWYgYXZhaWxhYmxlCiAgICBpZiBbIC1uICIke19GVUNLX0NBQ0hFRF9LRVJORUw6LX0iIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkX0ZVQ0tfQ0FDSEVEX0tFUk5FTCIKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBsb2NhbCBrZXJuZWwKICAgIGtlcm5lbD0kKHVuYW1lIC1zciAyPi9kZXYvbnVsbCB8fCB1bmFtZSAtcyAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAga2VybmVsPSQocHJpbnRmICclcycgIiRrZXJuZWwiIHwgdHIgLWQgJ1xyXG4nKQoKICAgICMgQ2FjaGUgYW5kIHJldHVybiByZXN1bHQKICAgIF9GVUNLX0NBQ0hFRF9LRVJORUw9IiRrZXJuZWwiCiAgICBfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eQogICAgcHJpbnRmICclc1xuJyAiJGtlcm5lbCIKfQoKIyBHZXRzIHN5c3RlbSBhcmNoaXRlY3R1cmUgd2l0aCBjYWNoaW5nCiMgT3V0cHV0czogQXJjaGl0ZWN0dXJlIHN0cmluZyAoZS5nLiwgIng4Nl82NCIsICJhcm02NCIpCl9mdWNrX2dldF9hcmNoaXRlY3R1cmUoKSB7CiAgICBfZnVja19sb2FkX3N0YXRpY19jYWNoZQoKICAgICMgUmV0dXJuIGNhY2hlZCB2YWx1ZSBpZiBhdmFpbGFibGUKICAgIGlmIFsgLW4gIiR7X0ZVQ0tfQ0FDSEVEX0FSQ0g6LX0iIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkX0ZVQ0tfQ0FDSEVEX0FSQ0giCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgbG9jYWwgYXJjaAogICAgYXJjaD0kKHVuYW1lIC1tIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBhcmNoPSQocHJpbnRmICclcycgIiRhcmNoIiB8IHRyIC1kICdcclxuJykKCiAgICAjIENhY2hlIGFuZCByZXR1cm4gcmVzdWx0CiAgICBfRlVDS19DQUNIRURfQVJDSD0iJGFyY2giCiAgICBfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eQogICAgcHJpbnRmICclc1xuJyAiJGFyY2giCn0KCiMgQ29sbGVjdHMgdXNlciBpbmZvcm1hdGlvbiBpbmNsdWRpbmcgcGVybWlzc2lvbnMKIyBPdXRwdXRzOiBVc2VyIGluZm8gc3RyaW5nIChlLmcuLCAiVXNlcj1qb2huIHVpZD0xMDAwIGxldmVsPXN1ZG9lciBHcm91cHM9am9obiBhZG0gc3VkbyIpCl9mdWNrX2NvbGxlY3RfdXNlcl9pbmZvKCkgewogICAgbG9jYWwgY3VycmVudF91c2VyIHVpZCBncm91cHMgbGV2ZWwKICAgIGN1cnJlbnRfdXNlcj0iJHtVU0VSOi19IgoKICAgICMgRmFsbGJhY2sgaWYgVVNFUiBpcyBub3Qgc2V0CiAgICBpZiBbIC16ICIkY3VycmVudF91c2VyIiBdOyB0aGVuCiAgICAgICAgY3VycmVudF91c2VyPSQod2hvYW1pIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBmaQoKICAgICMgR2V0IFVJRCBhbmQgZ3JvdXBzIGlmIGlkIGNvbW1hbmQgaXMgYXZhaWxhYmxlCiAgICB1aWQ9InVua25vd24iCiAgICBncm91cHM9InVua25vd24iCiAgICBpZiBjb21tYW5kIC12IGlkID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgIHVpZD0kKGlkIC11ICIkY3VycmVudF91c2VyIiAyPi9kZXYvbnVsbCB8fCBpZCAtdSAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgICAgIGdyb3Vwcz0kKGlkIC1HbiAiJGN1cnJlbnRfdXNlciIgMj4vZGV2L251bGwgfHwgaWQgLUduIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBmaQoKICAgICMgRGV0ZXJtaW5lIHBlcm1pc3Npb24gbGV2ZWwKICAgIGxldmVsPSJ1c2VyIgogICAgaWYgWyAiJHVpZCIgPSAiMCIgXTsgdGhlbgogICAgICAgIGxldmVsPSJyb290IgogICAgZWxpZiBwcmludGYgJyVzJyAiJGdyb3VwcyIgfCBncmVwIC1FcSAnKF58W1s6c3BhY2U6XV0pKHN1ZG98d2hlZWx8YWRtaW4pKFtbOnNwYWNlOl1dfCQpJzsgdGhlbgogICAgICAgIGxldmVsPSJzdWRvZXIiCiAgICBmaQoKICAgIHByaW50ZiAnVXNlcj0lcyB1aWQ9JXMgbGV2ZWw9JXMgR3JvdXBzPSVzJyAiJGN1cnJlbnRfdXNlciIgIiR1aWQiICIkbGV2ZWwiICIkZ3JvdXBzIgp9CgojIENvbGxlY3RzIHZlcnNpb24gaW5mb3JtYXRpb24gZm9yIGNvbW1vbiBkZXZlbG9wbWVudCB0b29scwojIE91dHB1dHM6IFRvb2wgdmVyc2lvbnMgc3RyaW5nIChlLmcuLCAiZ2l0OmdpdCB2ZXJzaW9uIDIuMzQuMTsgZG9ja2VyOkRvY2tlciB2ZXJzaW9uIDI0LjAuNjsgLi4uIikKX2Z1Y2tfY29sbGVjdF90b29sX3ZlcnNpb25zKCkgewogICAgbG9jYWwgdG9vbHMgdG9vbCB2ZXJzaW9uIHJlc3VsdAogICAgdG9vbHM9ImdpdCBkb2NrZXIgbnBtIGt1YmVjdGwgY3VybCB3Z2V0IgogICAgcmVzdWx0PSIiCgogICAgZm9yIHRvb2wgaW4gJHRvb2xzOyBkbwogICAgICAgIHZlcnNpb249Im5vdC1pbnN0YWxsZWQiCgogICAgICAgIGlmIGNvbW1hbmQgLXYgIiR0b29sIiA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICAgICAgY2FzZSAiJHRvb2wiIGluCiAgICAgICAgICAgICAgICBnaXR8ZG9ja2VyfGN1cmx8d2dldCkKICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPSQoIiR0b29sIiAtLXZlcnNpb24gMj4vZGV2L251bGwgfCBoZWFkIC1uMSkKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgbnBtKQogICAgICAgICAgICAgICAgICAgIHZlcnNpb249JCgiJHRvb2wiIC0tdmVyc2lvbiAyPi9kZXYvbnVsbCB8IGhlYWQgLW4xKQogICAgICAgICAgICAgICAgICAgIFsgLW4gIiR2ZXJzaW9uIiBdICYmIHZlcnNpb249Im5wbSAkdmVyc2lvbiIKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAga3ViZWN0bCkKICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPSQoIiR0b29sIiB2ZXJzaW9uIC0tY2xpZW50IC0tc2hvcnQgMj4vZGV2L251bGwgfCBoZWFkIC1uMSkKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBlc2FjCiAgICAgICAgZmkKCiAgICAgICAgIyBDbGVhbiB1cCB2ZXJzaW9uIHN0cmluZwogICAgICAgIHZlcnNpb249JChwcmludGYgJyVzJyAiJHt2ZXJzaW9uOi11bmtub3dufSIgfCB0ciAnXHJcbicgJyAgJyB8IHRyIC1zICcgJyB8IHNlZCAtZSAncy9eICovLycgLWUgJ3MvICokLy8nKQogICAgICAgIFsgLXogIiR2ZXJzaW9uIiBdICYmIHZlcnNpb249InVua25vd24iCgogICAgICAgIHJlc3VsdD0iJHJlc3VsdCR0b29sOiR2ZXJzaW9uOyAiCiAgICBkb25lCgogICAgIyBSZW1vdmUgdHJhaWxpbmcgc2VtaWNvbG9uIGFuZCBzcGFjZQogICAgcmVzdWx0PSIke3Jlc3VsdCU7IH0iCiAgICBwcmludGYgJyVzJyAiJHJlc3VsdCIKfQoKIyBEZXRlY3RzIHRoZSBwYWNrYWdlIG1hbmFnZXIgd2l0aCBjYWNoaW5nIHN1cHBvcnQKIyBPdXRwdXRzOiBQYWNrYWdlIG1hbmFnZXIgbmFtZSAoYXB0LCB5dW0sIGRuZiwgcGFjbWFuLCB6eXBwZXIsIGJyZXcsIHVua25vd24pCl9mdWNrX2RldGVjdF9wa2dfbWFuYWdlcigpIHsKICAgIF9mdWNrX2xvYWRfc3RhdGljX2NhY2hlCgogICAgIyBSZXR1cm4gY2FjaGVkIHZhbHVlIGlmIGF2YWlsYWJsZQogICAgaWYgWyAtbiAiJHtfRlVDS19DQUNIRURfUEtHX01BTkFHRVI6LX0iIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkX0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSIgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGxvY2FsIG1hbmFnZXI9InVua25vd24iCgogICAgIyBEZXRlY3QgcGFja2FnZSBtYW5hZ2VyIGluIG9yZGVyIG9mIHByZWZlcmVuY2UKICAgIGlmIGNvbW1hbmQgLXYgYXB0LWdldCAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJhcHQiCiAgICBlbGlmIGNvbW1hbmQgLXYgeXVtICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9Inl1bSIKICAgIGVsaWYgY29tbWFuZCAtdiBkbmYgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0iZG5mIgogICAgZWxpZiBjb21tYW5kIC12IHBhY21hbiAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJwYWNtYW4iCiAgICBlbGlmIGNvbW1hbmQgLXYgenlwcGVyICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9Inp5cHBlciIKICAgIGVsaWYgY29tbWFuZCAtdiBicmV3ICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9ImJyZXciCiAgICBmaQoKICAgICMgQ2FjaGUgYW5kIHJldHVybiByZXN1bHQKICAgIF9GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUj0iJG1hbmFnZXIiCiAgICBfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eQogICAgcHJpbnRmICclc1xuJyAiJG1hbmFnZXIiCn0KCiMgQ29sbGVjdHMgc2ltcGxpZmllZCBzeXN0ZW0gaW5mb3JtYXRpb24gYXMgYSBzdHJ1Y3R1cmVkIHN0cmluZwojIE91dHB1dHM6IFN5c3RlbSBpbmZvIHN0cmluZyBmb3IgQUkgcHJvY2Vzc2luZwpfZnVja19jb2xsZWN0X3N5c2luZm9fc3RyaW5nKCkgewogICAgbG9jYWwgb3NfdHlwZSBrZXJuZWxfbmFtZSBwa2dfbWFuYWdlciBzdW1tYXJ5CgogICAgIyBEZXRlY3Qgb3BlcmF0aW5nIHN5c3RlbSB0eXBlCiAgICBrZXJuZWxfbmFtZT0kKHVuYW1lIC1zIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCgogICAgY2FzZSAiJGtlcm5lbF9uYW1lIiBpbgogICAgICAgIERhcndpbikKICAgICAgICAgICAgb3NfdHlwZT0ibWFjT1MiCiAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJicmV3IgogICAgICAgICAgICA7OwogICAgICAgIExpbnV4KQogICAgICAgICAgICBpZiBbIC1yIC9ldGMvb3MtcmVsZWFzZSBdOyB0aGVuCiAgICAgICAgICAgICAgICBsb2NhbCBpZAogICAgICAgICAgICAgICAgaWQ9JChncmVwIC1FICdeSUQ9JyAvZXRjL29zLXJlbGVhc2UgfCBoZWFkIC1uMSB8IGN1dCAtZD0gLWYyIHwgdHIgLWQgJyInIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCiAgICAgICAgICAgICAgICBjYXNlICIkaWQiIGluCiAgICAgICAgICAgICAgICAgICAgdWJ1bnR1fGRlYmlhbikKICAgICAgICAgICAgICAgICAgICAgICAgb3NfdHlwZT0iRGViaWFuIgogICAgICAgICAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0iYXB0IgogICAgICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgICAgIGNlbnRvc3xyaGVsfHJvY2t5fGFsbWFsaW51eHxmZWRvcmEpCiAgICAgICAgICAgICAgICAgICAgICAgIG9zX3R5cGU9IlJIRUwiCiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ5dW0iCiAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgYXJjaHxtYW5qYXJvKQogICAgICAgICAgICAgICAgICAgICAgICBvc190eXBlPSJBcmNoIgogICAgICAgICAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0icGFjbWFuIgogICAgICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgICAgICopCiAgICAgICAgICAgICAgICAgICAgICAgIG9zX3R5cGU9IkxpbnV4IgogICAgICAgICAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0idW5rbm93biIKICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgIGVzYWMKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgb3NfdHlwZT0iTGludXgiCiAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0idW5rbm93biIKICAgICAgICAgICAgZmkKICAgICAgICAgICAgOzsKICAgICAgICBNSU5HVyp8TVNZUyp8Q1lHV0lOKikKICAgICAgICAgICAgb3NfdHlwZT0iV2luZG93cyIKICAgICAgICAgICAgcGtnX21hbmFnZXI9InVua25vd24iCiAgICAgICAgICAgIDs7CiAgICAgICAgKikKICAgICAgICAgICAgb3NfdHlwZT0iJGtlcm5lbF9uYW1lIgogICAgICAgICAgICBwa2dfbWFuYWdlcj0idW5rbm93biIKICAgICAgICAgICAgOzsKICAgIGVzYWMKCiAgICAjIEZvcm1hdCBhcyBzaW1wbGUgc3RydWN0dXJlZCBzdHJpbmcKICAgIHByaW50ZiAtdiBzdW1tYXJ5ICdPUz0lczsgUGtnTWdyPSVzJyAiJG9zX3R5cGUiICIkcGtnX21hbmFnZXIiCiAgICBwcmludGYgJyVzXG4nICIkc3VtbWFyeSIKfQoKIyBFc2NhcGVzIGEgc3RyaW5nIGZvciB1c2UgaW4gYSBKU09OIHBheWxvYWQKX2Z1Y2tfanNvbl9lc2NhcGUoKSB7CiAgICBsb2NhbCBpbnB1dD0iJDEiCiAgICAjIFVzZSBwcmludGYgdG8gcHJvcGVybHkgaGFuZGxlIGNvbnRyb2wgY2hhcmFjdGVycwogICAgcHJpbnRmICclcycgIiRpbnB1dCIgfCBzZWQgLWUgJwogICAgICAgICMgRmlyc3QgZXNjYXBlIGJhY2tzbGFzaGVzIChtdXN0IGJlIGZpcnN0KQogICAgICAgIHMvXFwvXFxcXC9nCiAgICAgICAgIyBFc2NhcGUgZG91YmxlIHF1b3RlcwogICAgICAgIHMvIi9cXCIvZwogICAgICAgICMgRXNjYXBlIGNvbnRyb2wgY2hhcmFjdGVycyAoQVNDSUkgMC0zMSkKICAgICAgICBzL1x4MDAvXFx1MDAwMC9nCiAgICAgICAgcy9ceDAxL1xcdTAwMDEvZwogICAgICAgIHMvXHgwMi9cXHUwMDAyL2cKICAgICAgICBzL1x4MDMvXFx1MDAwMy9nCiAgICAgICAgcy9ceDA0L1xcdTAwMDQvZwogICAgICAgIHMvXHgwNS9cXHUwMDA1L2cKICAgICAgICBzL1x4MDYvXFx1MDAwNi9nCiAgICAgICAgcy9ceDA3L1xcdTAwMDcvZwogICAgICAgIHMvXHgwOC9cXGIvZwogICAgICAgIHMvXHgwOS9cXHQvZwogICAgICAgIHMvXHgwQS9cXG4vZwogICAgICAgIHMvXHgwQi9cXHUwMDBCL2cKICAgICAgICBzL1x4MEMvXFxmL2cKICAgICAgICBzL1x4MEQvXFxyL2cKICAgICAgICBzL1x4MEUvXFx1MDAwRS9nCiAgICAgICAgcy9ceDBGL1xcdTAwMEYvZwogICAgICAgIHMvXHgxMC9cXHUwMDEwL2cKICAgICAgICBzL1x4MTEvXFx1MDAxMS9nCiAgICAgICAgcy9ceDEyL1xcdTAwMTIvZwogICAgICAgIHMvXHgxMy9cXHUwMDEzL2cKICAgICAgICBzL1x4MTQvXFx1MDAxNC9nCiAgICAgICAgcy9ceDE1L1xcdTAwMTUvZwogICAgICAgIHMvXHgxNi9cXHUwMDE2L2cKICAgICAgICBzL1x4MTcvXFx1MDAxNy9nCiAgICAgICAgcy9ceDE4L1xcdTAwMTgvZwogICAgICAgIHMvXHgxOS9cXHUwMDE5L2cKICAgICAgICBzL1x4MUEvXFx1MDAxQS9nCiAgICAgICAgcy9ceDFCL1xcdTAwMUIvZwogICAgICAgIHMvXHgxQy9cXHUwMDFDL2cKICAgICAgICBzL1x4MUQvXFx1MDAxRC9nCiAgICAgICAgcy9ceDFFL1xcdTAwMUUvZwogICAgICAgIHMvXHgxRi9cXHUwMDFGL2cKICAgICcKfQoKX2Z1Y2tfc2hvdWxkX3VzZV9sb2NhbF9hcGkoKSB7CiAgICBpZiBbIC1uICIke0ZVQ0tfT1BFTkFJX0FQSV9LRVk6LX0iIF07IHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZmkKICAgIHJldHVybiAxCn0KCl9mdWNrX2xvY2FsX3N5c3RlbV9wcm9tcHQoKSB7CiAgICBsb2NhbCBzeXNpbmZvPSIkMSIKICAgIGlmIFsgIiRGVUNLSVRTX0xPQ0FMRSIgPSAiemgiIF07IHRoZW4KICAgICAgICBwcmludGYgJ+S9oOaYr+S4gOS4quS4k+S4mueahCBzaGVsbCDlkb3ku6TnlJ/miJDlmajjgILnlKjmiLfkvJrnlKjoh6rnhLbor63oqIDmj4/ov7Dku5bku6zmg7PopoHlrozmiJDnmoTku7vliqHjgILkvaDnmoTku7vliqHmmK/nlJ/miJDnm7TmjqXlj6/miafooYznmoQgc2hlbGwg5ZG95Luk5p2l5a6M5oiQ55So5oi355qE55uu5qCH44CCCgrph43opoHop4TliJnvvJoKMS4g55So5oi36L6T5YWl5piv6Ieq54S26K+t6KiA5o+P6L+w5oSP5Zu+77yM5LiN5piv5ZG95Luk5Y+C5pWw44CC5L6L5aaCIuWIl+WHuuebruW9lSLmhI/mgJ3mmK/miafooYwgbHMg5ZG95Luk77yM6ICM5LiN5pivIGxzICLliJflh7rnm67lvZUiCjIuIOeUn+aIkOebtOaOpeWPr+aJp+ihjOeahOWRveS7pO+8jOS4jeimgeeUn+aIkOW4puWPguaVsOWIpOaWreeahOiEmuacrOaooeadv++8iOWmgiBpZiBbICQjIC1lcSAwIF3vvIkKMy4g5a+55LqO566A5Y2V5Lu75Yqh55u05o6l6L+U5Zue5Y2V5p2h5ZG95Luk77yM5aSN5p2C5Lu75Yqh5Y+v5Lul5piv5aSa6KGM6ISa5pysCjQuIOS4jeimgeaPkOS+m+S7u+S9leino+mHiuOAgeazqOmHiuOAgW1hcmtkb3duIOagvOW8j++8iOavlOWmgiBgYGBiYXNo77yJ5oiWIHNoZWJhbmfvvIjkvovlpoIgIyEvYmluL2Jhc2jvvIkKCuekuuS+i++8mgotIOeUqOaIt+ivtCLliJflh7rnm67lvZUiIOKGkiDovpPlh7o6IGxzCi0g55So5oi36K+0IuaYvuekuuivpue7huaWh+S7tuWIl+ihqCIg4oaSIOi+k+WHujogbHMgLWxhCi0g55So5oi36K+0IuafpeaJvuWkp+S6jjEwTULnmoTmlofku7YiIOKGkiDovpPlh7o6IGZpbmQgLiAtdHlwZSBmIC1zaXplICsxME0KCueUqOaIt+eahOezu+e7n+S/oeaBr+aYr++8miVzJyAiJHN5c2luZm8iCiAgICBlbHNlCiAgICAgICAgcHJpbnRmICdZb3UgYXJlIGFuIGV4cGVydCBzaGVsbCBjb21tYW5kIGdlbmVyYXRvci4gVXNlcnMgZGVzY3JpYmUgdGFza3MgaW4gbmF0dXJhbCBsYW5ndWFnZS4gWW91ciB0YXNrIGlzIHRvIGdlbmVyYXRlIGRpcmVjdGx5IGV4ZWN1dGFibGUgc2hlbGwgY29tbWFuZHMgdG8gYWNjb21wbGlzaCB0aGVpciBnb2Fscy4KCkltcG9ydGFudCBydWxlczoKMS4gVXNlciBpbnB1dCBpcyBuYXR1cmFsIGxhbmd1YWdlIGludGVudCwgTk9UIGNvbW1hbmQgYXJndW1lbnRzLiBGb3IgZXhhbXBsZSwgImxpc3QgZGlyZWN0b3J5IiBtZWFucyBydW4gbHMsIG5vdCBscyAibGlzdCBkaXJlY3RvcnkiCjIuIEdlbmVyYXRlIGRpcmVjdGx5IGV4ZWN1dGFibGUgY29tbWFuZHMsIG5vdCBzY3JpcHQgdGVtcGxhdGVzIHdpdGggcGFyYW1ldGVyIGhhbmRsaW5nIChsaWtlIGlmIFsgJCMgLWVxIDAgXSkKMy4gRm9yIHNpbXBsZSB0YXNrcyByZXR1cm4gc2luZ2xlIGNvbW1hbmRzLCBjb21wbGV4IHRhc2tzIGNhbiBiZSBtdWx0aS1saW5lIHNjcmlwdHMKNC4gRG8gbm90IHByb3ZpZGUgYW55IGV4cGxhbmF0aW9uLCBjb21tZW50cywgbWFya2Rvd24gZm9ybWF0dGluZyAobGlrZSBgYGBiYXNoKSwgb3IgYSBzaGViYW5nIChlLmcuLCAjIS9iaW4vYmFzaCkKCkV4YW1wbGVzOgotIFVzZXIgc2F5cyAibGlzdCBkaXJlY3RvcnkiIOKGkiBPdXRwdXQ6IGxzCi0gVXNlciBzYXlzICJzaG93IGRldGFpbGVkIGZpbGUgbGlzdCIg4oaSIE91dHB1dDogbHMgLWxhCi0gVXNlciBzYXlzICJmaW5kIGZpbGVzIGxhcmdlciB0aGFuIDEwTUIiIOKGkiBPdXRwdXQ6IGZpbmQgLiAtdHlwZSBmIC1zaXplICsxME0KClRoZSB1c2VyJyInIidzIHN5c3RlbSBpbmZvIGlzOiAlcycgIiRzeXNpbmZvIgogICAgZmkKfQoKX2Z1Y2tfZXh0cmFjdF9jb21tYW5kX2Zyb21fanNvbigpIHsKICAgIGxvY2FsIGpzb25fZmlsZT0iJDEiCiAgICBpZiBjb21tYW5kIC12IHB5dGhvbjMgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgcHl0aG9uMyAtICIkanNvbl9maWxlIiA8PCdQWScKaW1wb3J0IGpzb24sIHN5cwpwYXRoID0gc3lzLmFyZ3ZbMV0Kd2l0aCBvcGVuKHBhdGgsICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjoKICAgIGRhdGEgPSBqc29uLmxvYWQoZikKY2hvaWNlcyA9IGRhdGEuZ2V0KCdjaG9pY2VzJykgb3IgW10KaWYgbm90IGNob2ljZXM6CiAgICBzeXMuZXhpdCgxKQptZXNzYWdlID0gY2hvaWNlc1swXS5nZXQoJ21lc3NhZ2UnKSBvciB7fQpjb250ZW50ID0gKG1lc3NhZ2UuZ2V0KCdjb250ZW50Jykgb3IgJycpLnN0cmlwKCkKaWYgbm90IGNvbnRlbnQ6CiAgICBzeXMuZXhpdCgxKQpwcmludChjb250ZW50KQpQWQogICAgICAgIHJldHVybgogICAgZmkKCiAgICBpZiBjb21tYW5kIC12IG5vZGUgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgbm9kZSAtICIkanNvbl9maWxlIiA8PCdKUycKY29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwpjb25zdCBwYXRoID0gcHJvY2Vzcy5hcmd2WzFdOwpjb25zdCBkYXRhID0gSlNPTi5wYXJzZShmcy5yZWFkRmlsZVN5bmMocGF0aCwgJ3V0ZjgnKSk7CmNvbnN0IGNob2ljZSA9IChkYXRhLmNob2ljZXMgJiYgZGF0YS5jaG9pY2VzWzBdKSB8fCB7fTsKY29uc3QgbWVzc2FnZSA9IGNob2ljZS5tZXNzYWdlIHx8IHt9Owpjb25zdCBjb250ZW50ID0gKG1lc3NhZ2UuY29udGVudCB8fCAnJykudHJpbSgpOwppZiAoIWNvbnRlbnQpIHsKICBwcm9jZXNzLmV4aXQoMSk7Cn0KY29uc29sZS5sb2coY29udGVudCk7CkpTCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9Q2Fubm90IHBhcnNlIEFJIHJlc3BvbnNlIGJlY2F1c2UgbmVpdGhlciBweXRob24zIG5vciBub2RlIGlzIGF2YWlsYWJsZS4ke0NfUkVTRVR9IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d9UGxlYXNlIGluc3RhbGwgcHl0aG9uMyBvciBub2RlIHRvIHVzZSBsb2NhbCBBUEkgbW9kZS4ke0NfUkVTRVR9IiA+JjIKICAgIHJldHVybiAxCn0KCl9mdWNrX3JlcXVlc3RfbG9jYWxfbW9kZWwoKSB7CiAgICBsb2NhbCBwcm9tcHQ9IiQxIgogICAgbG9jYWwgc3lzaW5mbz0iJDIiCiAgICBsb2NhbCBjdXJsX3RpbWVvdXQ9IiQzIgoKICAgIGxvY2FsIGFwaV9rZXk9IiR7RlVDS19PUEVOQUlfQVBJX0tFWTotfSIKICAgIGlmIFsgLXogIiRhcGlfa2V5IiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1Mb2NhbCBBUEkga2V5IG5vdCBjb25maWd1cmVkLiBTZXQgRlVDS19PUEVOQUlfQVBJX0tFWSBpbiB+Ly5mdWNrL2NvbmZpZy5zaC4ke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBsb2NhbCBtb2RlbD0iJHtGVUNLX09QRU5BSV9NT0RFTDotZ3B0LTUtbmFub30iCiAgICBsb2NhbCBhcGlfYmFzZT0iJHtGVUNLX09QRU5BSV9BUElfQkFTRTotaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MX0iCiAgICBhcGlfYmFzZT0ke2FwaV9iYXNlJS99CiAgICBsb2NhbCBhcGlfdXJsPSIkYXBpX2Jhc2UvY2hhdC9jb21wbGV0aW9ucyIKCiAgICBfZnVja19kZWJ1ZyAibG9jYWwgYXBpIGJhc2U9JGFwaV9iYXNlIgogICAgX2Z1Y2tfZGVidWcgImxvY2FsIG1vZGVsPSRtb2RlbCIKCiAgICBsb2NhbCBzeXN0ZW1fcHJvbXB0CiAgICBzeXN0ZW1fcHJvbXB0PSQoX2Z1Y2tfbG9jYWxfc3lzdGVtX3Byb21wdCAiJHN5c2luZm8iKQoKICAgIGxvY2FsIGVzY2FwZWRfcHJvbXB0IGVzY2FwZWRfc3lzdGVtCiAgICBlc2NhcGVkX3Byb21wdD0kKF9mdWNrX2pzb25fZXNjYXBlICIkcHJvbXB0IikKICAgIGVzY2FwZWRfc3lzdGVtPSQoX2Z1Y2tfanNvbl9lc2NhcGUgIiRzeXN0ZW1fcHJvbXB0IikKICAgIGxvY2FsIHBheWxvYWQKICAgIHBheWxvYWQ9JChwcmludGYgJ3sgIm1vZGVsIjogIiVzIiwgIm1lc3NhZ2VzIjogWyB7InJvbGUiOiJzeXN0ZW0iLCJjb250ZW50IjoiJXMifSwgeyJyb2xlIjoidXNlciIsImNvbnRlbnQiOiIlcyJ9IF0sICJtYXhfdG9rZW5zIjogMTAyNCwgInRlbXBlcmF0dXJlIjogMC4yIH0nIFwKICAgICAgICAiJG1vZGVsIiAiJGVzY2FwZWRfc3lzdGVtIiAiJGVzY2FwZWRfcHJvbXB0IikKCiAgICBsb2NhbCB0bXBfanNvbgogICAgdG1wX2pzb249JChta3RlbXApIHx8IHJldHVybiAxCgogICAgaWYgISBjdXJsIC1mc1MgLS1tYXgtdGltZSAiJGN1cmxfdGltZW91dCIgIiRhcGlfdXJsIiBcCiAgICAgICAgLUggIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiIgXAogICAgICAgIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJGFwaV9rZXkiIFwKICAgICAgICAtZCAiJHBheWxvYWQiID4gIiR0bXBfanNvbiI7IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfUxvY2FsIEFQSSByZXF1ZXN0IGZhaWxlZC4ke0NfUkVTRVR9IiA+JjIKICAgICAgICBjYXQgIiR0bXBfanNvbiIgPiYyCiAgICAgICAgcm0gLWYgIiR0bXBfanNvbiIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBsb2NhbCBjb21tYW5kX291dHB1dAogICAgaWYgISBjb21tYW5kX291dHB1dD0kKF9mdWNrX2V4dHJhY3RfY29tbWFuZF9mcm9tX2pzb24gIiR0bXBfanNvbiIpOyB0aGVuCiAgICAgICAgcm0gLWYgIiR0bXBfanNvbiIKICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfVVuYWJsZSB0byBwYXJzZSBsb2NhbCBtb2RlbCByZXNwb25zZS4ke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBybSAtZiAiJHRtcF9qc29uIgogICAgcHJpbnRmICclc1xuJyAiJGNvbW1hbmRfb3V0cHV0Igp9CgpfZnVja19yZXF1ZXN0X3dvcmtlcl9tb2RlbCgpIHsKICAgIGxvY2FsIHByb21wdD0iJDEiCiAgICBsb2NhbCBzeXNpbmZvPSIkMiIKICAgIGxvY2FsIGN1cmxfdGltZW91dD0iJDMiCiAgICBsb2NhbCBzcGlubmVyX2xhYmVsPSIkezQ6LX0iCgogICAgbG9jYWwgYWRtaW5fa2V5PSIke0ZVQ0tfQURNSU5fS0VZOi19IgogICAgbG9jYWwgYWRtaW5fc2VnbWVudD0iIgogICAgaWYgWyAtbiAiJGFkbWluX2tleSIgXTsgdGhlbgogICAgICAgIGFkbWluX3NlZ21lbnQ9JChwcmludGYgJywgImFkbWluS2V5IjogIiVzIicgIiQoIF9mdWNrX2pzb25fZXNjYXBlICIkYWRtaW5fa2V5IiApIikKICAgIGZpCgogICAgbG9jYWwgcGF5bG9hZAogICAgcGF5bG9hZD0kKHByaW50ZiAneyAic3lzaW5mbyI6ICIlcyIsICJwcm9tcHQiOiAiJXMiJXMgfScgXAogICAgICAgICIkKCBfZnVja19qc29uX2VzY2FwZSAiJHN5c2luZm8iICkiIFwKICAgICAgICAiJCggX2Z1Y2tfanNvbl9lc2NhcGUgIiRwcm9tcHQiICkiIFwKICAgICAgICAiJGFkbWluX3NlZ21lbnQiKQoKICAgIGxvY2FsIGFwaV91cmw9IiR7RlVDS19BUElfRU5EUE9JTlQ6LSRERUZBVUxUX0FQSV9FTkRQT0lOVH0iCgogICAgX2Z1Y2tfZGVidWcgIkFQSSBVUkw6ICRhcGlfdXJsIgogICAgX2Z1Y2tfZGVidWcgIlBheWxvYWQ6ICRwYXlsb2FkIgogICAgX2Z1Y2tfZGVidWcgIlRpbWVvdXQ6ICRjdXJsX3RpbWVvdXQiCgogICAgbG9jYWwgdG1wX3Jlc3BvbnNlIHRtcF9zdGF0dXMKICAgIHRtcF9yZXNwb25zZT0kKG1rdGVtcCkKICAgIHRtcF9zdGF0dXM9JChta3RlbXApCgogICAgKAogICAgICAgIGN1cmwgLXNTIC0tbWF4LXRpbWUgIiRjdXJsX3RpbWVvdXQiIC1YIFBPU1QgIiRhcGlfdXJsIiBcCiAgICAgICAgICAgIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIFwKICAgICAgICAgICAgLWQgIiRwYXlsb2FkIiAtbyAiJHRtcF9yZXNwb25zZSIgLXcgIiV7aHR0cF9jb2RlfSIgPiAiJHRtcF9zdGF0dXMiCiAgICApICYKICAgIGxvY2FsIHBpZD0kIQoKICAgIGlmIFsgLXQgMiBdOyB0aGVuCiAgICAgICAgX2Z1Y2tfc3Bpbm5lciAiJHBpZCIgIiRzcGlubmVyX2xhYmVsIiA+JjIKICAgIGZpCgogICAgbG9jYWwgY3VybF9leGl0PTAKICAgIGlmICEgd2FpdCAiJHBpZCI7IHRoZW4KICAgICAgICBjdXJsX2V4aXQ9JD8KICAgIGZpCgogICAgbG9jYWwgaHR0cF9zdGF0dXM9IiIKICAgIGlmIFsgLWYgIiR0bXBfc3RhdHVzIiBdOyB0aGVuCiAgICAgICAgaHR0cF9zdGF0dXM9JCh0ciAtZCAnXHJcbicgPCAiJHRtcF9zdGF0dXMiKQogICAgICAgIHJtIC1mICIkdG1wX3N0YXR1cyIKICAgIGZpCgogICAgbG9jYWwgcmVzcG9uc2U9IiIKICAgIGlmIFsgLWYgIiR0bXBfcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICByZXNwb25zZT0kKGNhdCAiJHRtcF9yZXNwb25zZSIpCiAgICAgICAgcm0gLWYgIiR0bXBfcmVzcG9uc2UiCiAgICBmaQoKICAgIGlmIFsgJGN1cmxfZXhpdCAtbmUgMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1GYWlsZWQgdG8gcmVhY2ggdGhlIHNoYXJlZCBXb3JrZXIuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgaWYgWyAtbiAiJHJlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19ESU19JHJlc3BvbnNlJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZmkKICAgICAgICByZXR1cm4gJGN1cmxfZXhpdAogICAgZmkKCiAgICBpZiBbIC16ICIkaHR0cF9zdGF0dXMiIF07IHRoZW4KICAgICAgICBodHRwX3N0YXR1cz0wCiAgICBmaQoKICAgIGlmIFsgIiRodHRwX3N0YXR1cyIgLWVxIDQyOSBdICYmIHByaW50ZiAnJXMnICIkcmVzcG9uc2UiIHwgZ3JlcCAtcSAnREVNT19MSU1JVF9FWENFRURFRCc7IHRoZW4KICAgICAgICBsb2NhbCBsaW1pdAogICAgICAgIGxpbWl0PSQocHJpbnRmICclcycgIiRyZXNwb25zZSIgfCBzZWQgLW4gJ3MvLioibGltaXQiOltbOnNwYWNlOl1dKlwoWzAtOV1cK1wpLiovXDEvcCcgfCBoZWFkIC1uMSkKICAgICAgICBsb2NhbCByZW1haW5pbmcKICAgICAgICByZW1haW5pbmc9JChwcmludGYgJyVzJyAiJHJlc3BvbnNlIiB8IHNlZCAtbiAncy8uKiJyZW1haW5pbmciOltbOnNwYWNlOl1dKlwoWzAtOV1cK1wpLiovXDEvcCcgfCBoZWFkIC1uMSkKICAgICAgICBbIC16ICIkbGltaXQiIF0gJiYgbGltaXQ9MTAKICAgICAgICBfZnVja19ub3RpZnlfZGVtb19saW1pdCAiJGxpbWl0IiAiJHJlbWFpbmluZyIKICAgICAgICByZXR1cm4gMgogICAgZmkKCiAgICBpZiBbICIkaHR0cF9zdGF0dXMiIC1nZSA0MDAgXSB8fCBbIC16ICIkcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfVNoYXJlZCBXb3JrZXIgcmV0dXJuZWQgSFRUUCAkaHR0cF9zdGF0dXMuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgaWYgWyAtbiAiJHJlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19ESU19JHJlc3BvbnNlJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZmkKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBwcmludGYgJyVzXG4nICIkcmVzcG9uc2UiCn0KCl9mdWNrX25vdGlmeV9kZW1vX2xpbWl0KCkgewogICAgbG9jYWwgZGFpbHlfbGltaXQ9IiR7MTotMTB9IgogICAgbG9jYWwgcmVtYWluaW5nPSIkezI6LTB9IgoKICAgIGVjaG8gLWUgIiRGVUNLICR7Q19ZRUxMT1d9U2hhcmVkIGRlbW8gcXVvdGEgZXhoYXVzdGVkICgke2RhaWx5X2xpbWl0fSBjYWxscyBwZXIgZGF5KS4ke0NfUkVTRVR9IiA+JjIKICAgIGNhc2UgIiRyZW1haW5pbmciIGluCiAgICAgICAgJyd8KlshMC05XSopIDs7CiAgICAgICAgKikKICAgICAgICAgICAgaWYgWyAiJHJlbWFpbmluZyIgLWd0IDAgXTsgdGhlbgogICAgICAgICAgICAgICAgZWNobyAtZSAiJHtDX0RJTX0kcmVtYWluaW5nIGNhbGxzIGxlZnQgZm9yIHRvZGF5LiR7Q19SRVNFVH0iID4mMgogICAgICAgICAgICBmaQogICAgICAgICAgICA7OwogICAgZXNhYwoKICAgIF9mdWNrX2Vuc3VyZV9jb25maWdfZXhpc3RzCiAgICBfZnVja19zZWN1cmVfY29uZmlnX2ZpbGUKCiAgICBlY2hvIC1lICIke0NfQ1lBTn1Td2l0Y2ggdG8geW91ciBvd24ga2V5OiR7Q19SRVNFVH0gcnVuICR7Q19HUkVFTn1mdWNrIGNvbmZpZyR7Q19SRVNFVH0gYW5kIHNldCAke0NfQk9MRH1GVUNLX09QRU5BSV9BUElfS0VZJHtDX1JFU0VUfSAocGx1cyBvcHRpb25hbCAke0NfQk9MRH1GVUNLX09QRU5BSV9NT0RFTCR7Q19SRVNFVH0vJHtDX0JPTER9RlVDS19PUEVOQUlfQVBJX0JBU0Uke0NfUkVTRVR9KS4iID4mMgogICAgZWNobyAtZSAiJHtDX0NZQU59VHJ1c3RlZCBtYWludGFpbmVyIG92ZXJyaWRlOiR7Q19SRVNFVH0gc2V0ICR7Q19CT0xEfUZVQ0tfQURNSU5fS0VZJHtDX1JFU0VUfSBpZiB5b3Ugd2VyZSBpc3N1ZWQgdGhlIHdvcmtlcidzIEFETUlOX0FDQ0VTU19LRVkgdG8gYnlwYXNzIHRoZSBzaGFyZWQgcXVvdGEuIiA+JjIKICAgIGVjaG8gLWUgIiR7Q19DWUFOfUNvbmZpZyBwYXRoOiR7Q19SRVNFVH0gJHtDX0dSRUVOfSRDT05GSUdfRklMRSR7Q19SRVNFVH0iID4mMgogICAgaWYgWyAtbiAiJHtFRElUT1I6LX0iIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfUhpbnQ6JHtDX1JFU0VUfSAke0VESVRPUn0gXCIkQ09ORklHX0ZJTEVcIiIgPiYyCiAgICBmaQogICAgZWNobyAtZSAiJHtDX0RJTX1TZWN1cml0eToke0NfUkVTRVR9IHRoZSBmaWxlIHBlcm1pc3Npb25zIGFyZSBsb2NrZWQgdG8gNjAwIHNvIHRoZSBrZXkgc3RheXMgbG9jYWwuIiA+JjIKfQoKIyBTaW1wbGUgaGVscGVyIHRvIHBhcnNlIGJvb2xlYW4tbGlrZSB2YWx1ZXMKX2Z1Y2tfdHJ1dGh5KCkgewogICAgbG9jYWwgdmFsdWU9IiR7MTotfSIKICAgIGxvY2FsIG5vcm1hbGl6ZWQKICAgIG5vcm1hbGl6ZWQ9JChwcmludGYgJyVzJyAiJHZhbHVlIiB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQogICAgY2FzZSAiJG5vcm1hbGl6ZWQiIGluCiAgICAgICAgMXx0cnVlfHllc3x5fG9uKQogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgICAgICopCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgICAgIDs7CiAgICBlc2FjCn0KCiMgRGVidWcgaGVscGVyCl9mdWNrX2RlYnVnKCkgewogICAgaWYgX2Z1Y2tfdHJ1dGh5ICIke0ZVQ0tfREVCVUc6LTB9IjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19ESU19W2RlYnVnXSAkKiR7Q19SRVNFVH0iID4mMgogICAgZmkKfQoKIyBTcGlubmVyIGFuaW1hdGlvbgpfZnVja19zcGlubmVyKCkgewogICAgbG9jYWwgcGlkPSQxCiAgICBsb2NhbCBwcmVmaXg9IiR7MjotfSIKICAgIGxvY2FsIGRlbGF5PTAuMQogICAgbG9jYWwgLWEgZnJhbWVzPSgifCIgIi8iICItIiAiXFwiKQogICAgbG9jYWwgZnJhbWVfY291bnQ9JHsjZnJhbWVzW0BdfQogICAgbG9jYWwgZnJhbWVfaWR4PTAKICAgIGxvY2FsIGhhc19wcmVmaXg9MAogICAgaWYgWyAtbiAiJHByZWZpeCIgXTsgdGhlbgogICAgICAgIGhhc19wcmVmaXg9MQogICAgZmkKICAgIAogICAgdHB1dCBjaXZpcyAyPi9kZXYvbnVsbCB8fCBwcmludGYgIlwwMzNbPzI1bCIKCiAgICB3aGlsZSBraWxsIC0wICIkcGlkIiAyPi9kZXYvbnVsbDsgZG8KICAgICAgICBpZiBbICIkaGFzX3ByZWZpeCIgLWVxIDEgXTsgdGhlbgogICAgICAgICAgICBwcmludGYgIlxyJXMlcyIgIiRwcmVmaXgiICIke2ZyYW1lc1skZnJhbWVfaWR4XX0iCiAgICAgICAgZWxzZQogICAgICAgICAgICBwcmludGYgIiAlcyAiICIke2ZyYW1lc1skZnJhbWVfaWR4XX0iCiAgICAgICAgICAgIHByaW50ZiAiXGJcYlxiIgogICAgICAgIGZpCiAgICAgICAgZnJhbWVfaWR4PSQoKCAoZnJhbWVfaWR4ICsgMSkgJSBmcmFtZV9jb3VudCApKQogICAgICAgIHNsZWVwICIkZGVsYXkiCiAgICBkb25lCgogICAgaWYgWyAiJGhhc19wcmVmaXgiIC1lcSAxIF07IHRoZW4KICAgICAgICBwcmludGYgIlxyJXMiICIkcHJlZml4IgogICAgICAgIHRwdXQgZWwgMj4vZGV2L251bGwgfHwgcHJpbnRmICJcMDMzW0siCiAgICBlbHNlCiAgICAgICAgcHJpbnRmICIgICBcYlxiXGIiCiAgICBmaQogICAgCiAgICB0cHV0IGNub3JtIDI+L2Rldi9udWxsIHx8IHByaW50ZiAiXDAzM1s/MjVoIgp9CgojIERldGVjdHMgcG90ZW50aWFsbHkgZGFuZ2Vyb3VzIGNvbW1hbmRzIGFuZCBwcmludHMgYSB3YXJuaW5nCiMgLS0tIOWuieWFqOajgOa1i+W8leaTju+8iOesrOS6jOmYtuaute+8iS0tLQoKIyBCbG9jay1sZXZlbCBzZWN1cml0eSBydWxlcyAoaGlnaGVzdCBzZXZlcml0eSAtIGV4ZWN1dGlvbiBkZW5pZWQpCiMgRm9ybWF0OiAncGF0dGVybnx8fHJlYXNvbicKIyBOb3RlOiBOb3QgdXNpbmcgJ3JlYWRvbmx5JyB0byBlbnN1cmUgY29tcGF0aWJpbGl0eSB3aXRoIGZ1bmN0aW9uLXNjb3BlZCBzb3VyY2luZwppZiBbIC16ICIke19GVUNLX1NFQ1VSSVRZX0JMT0NLX1JVTEVTK3h9IiBdIHx8IFtbICR7I19GVUNLX1NFQ1VSSVRZX0JMT0NLX1JVTEVTW0BdfSAtZXEgMCBdXSAyPi9kZXYvbnVsbDsgdGhlbgogICAgX0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVM9KAogICAgICAgICcoXnxbOyZ8WzpzcGFjZTpdXSlybVtbOnNwYWNlOl1dKy1yZltbOnNwYWNlOl1dKy8oW1s6c3BhY2U6XV18JCl8fHxSZWN1cnNpdmUgZGVsZXRlIHRhcmdldGluZyByb290IGZpbGVzeXN0ZW0nCiAgICAgICAgJ3JtW1s6c3BhY2U6XV0rLXJmW1s6c3BhY2U6XV0rL1wqfHx8UmVjdXJzaXZlIGRlbGV0ZSB1c2luZyAvKiB1bmRlciByb290JwogICAgICAgICdybVtbOnNwYWNlOl1dKy1yZltbOnNwYWNlOl1dKy0tbm8tcHJlc2VydmUtcm9vdHx8fHJtIC0tbm8tcHJlc2VydmUtcm9vdCBhZ2FpbnN0IC8nCiAgICAgICAgJ3JtW1s6c3BhY2U6XV0rLXJmW1s6c3BhY2U6XV0rXC5cKnx8fFJlY3Vyc2l2ZSBkZWxldGUgdGFyZ2V0aW5nIGhpZGRlbi9zeXN0ZW0gZmlsZXMnCiAgICAgICAgJ1xiZGRcYlteI1xuXSpcYihvZnxpZik9L2Rldi98fHxSYXcgZGlzayB3cml0ZSB2aWEgZGQgdGFyZ2V0aW5nIC9kZXYgZGV2aWNlcycKICAgICAgICAnXGJta2ZzKFwuXHcrKT9cYnx8fEZpbGVzeXN0ZW0gZm9ybWF0IGNvbW1hbmQgZGV0ZWN0ZWQnCiAgICAgICAgJ1xiZmRpc2tcYnxcYnBhcnRlZFxifFxiZm9ybWF0XGJ8XGJ3aXBlZnNcYnxcYnNocmVkXGJ8fHxQYXJ0aXRpb24gb3IgZGlzayB3aXBlIGNvbW1hbmQgZGV0ZWN0ZWQnCiAgICAgICAgJzpcKFwpW1s6c3BhY2U6XV0qXHtbWzpzcGFjZTpdXSo6W1s6c3BhY2U6XV0qXHxbWzpzcGFjZTpdXSo6W1s6c3BhY2U6XV0qJltbOnNwYWNlOl1dKlx9W1s6c3BhY2U6XV0qO1tbOnNwYWNlOl1dKjp8fHxGb3JrIGJvbWIgZnVuY3Rpb24gZGV0ZWN0ZWQnCiAgICApCmZpCgojIENoYWxsZW5nZS1sZXZlbCBzZWN1cml0eSBydWxlcyAocmVxdWlyZXMgZXhwbGljaXQgdXNlciBjb25maXJtYXRpb24pCiMgRm9ybWF0OiAncGF0dGVybnx8fHJlYXNvbicKIyBOb3RlOiBOb3QgdXNpbmcgJ3JlYWRvbmx5JyB0byBlbnN1cmUgY29tcGF0aWJpbGl0eSB3aXRoIGZ1bmN0aW9uLXNjb3BlZCBzb3VyY2luZwppZiBbIC16ICIke19GVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9SVUxFUyt4fSIgXSB8fCBbWyAkeyNfRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfUlVMRVNbQF19IC1lcSAwIF1dIDI+L2Rldi9udWxsOyB0aGVuCiAgICBfRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfUlVMRVM9KAogICAgICAgICdjdXJsW158XSpcfFxzKihiYXNofHNoKXx8fFJlbW90ZSBzY3JpcHQgZXhlY3V0aW9uIHZpYSBjdXJsIHBpcGVsaW5lJwogICAgICAgICd3Z2V0W158XSpcfFxzKihiYXNofHNoKXx8fFJlbW90ZSBzY3JpcHQgZXhlY3V0aW9uIHZpYSB3Z2V0IHBpcGVsaW5lJwogICAgICAgICdcYnNvdXJjZVxzK2h0dHBzPzovL3x8fFNvdXJjaW5nIGEgcmVtb3RlIGZpbGUgb3ZlciBIVFRQKFMpJwogICAgICAgICdcYmV2YWxcYnxcYmV4ZWNcYnx8fEV4cGxpY2l0IGV2YWwvZXhlYyB1c2FnZScKICAgICAgICAnXCRcKFteKV0qXCl8fHxDb21tYW5kIHN1YnN0aXR1dGlvbiB1c2luZyAkKCknCiAgICAgICAgJ2BbXmBdKmB8fHxDb21tYW5kIHN1YnN0aXR1dGlvbiB1c2luZyBiYWNrdGlja3MnCiAgICAgICAgJ1xiKHNofGJhc2h8ZW52KVxzKy1jXGJ8fHxOZXN0ZWQgc2hlbGwgaW52b2NhdGlvbiB0aHJvdWdoIC1jJwogICAgICAgICdcYnB5dGhvblswLTkuXSpccystY1xifHx8SW5saW5lIGludGVycHJldGVyIGV4ZWN1dGlvbiB2aWEgLWMnCiAgICAgICAgJyhefFs7JnxbOnNwYWNlOl1dKShjcHxtdnxybXxjaG1vZHxjaG93bnxzZWR8dGVlfGNhdClbXjsmfF0qLyhldGN8Ym9vdHxzeXN8cHJvY3xkZXYpXGJ8fHxPcGVyYXRpb24gdG91Y2hlcyBjcml0aWNhbCBzeXN0ZW0gcGF0aHMnCiAgICAgICAgJ1xicGVybFxzKy1lXGJ8fHxJbmxpbmUgUGVybCBleGVjdXRpb24gdmlhIC1lJwogICAgICAgICdcYnJ1YnlccystZVxifHx8SW5saW5lIFJ1YnkgZXhlY3V0aW9uIHZpYSAtZScKICAgICAgICAnXGJub2RlXHMrLWVcYnx8fElubGluZSBOb2RlLmpzIGV4ZWN1dGlvbiB2aWEgLWUnCiAgICAgICAgJ1xicGhwXHMrLXJcYnx8fElubGluZSBQSFAgZXhlY3V0aW9uIHZpYSAtcicKICAgICAgICAnYmFzZTY0W158XSpcfFxzKihiYXNofHNofGV2YWwpfHx8QmFzZTY0IGVuY29kZWQgY29tbWFuZCBleGVjdXRpb24nCiAgICAgICAgJ1xieGFyZ3NcYi4qKC1JfC1pfHt9KS4qXGIoc2h8YmFzaHxybXxjaG1vZClcYnx8fENvbW1hbmQgZXhlY3V0aW9uIHZpYSB4YXJncycKICAgICAgICAnXGJmaW5kXGJbXnw7XSotZXhlY1xifHx8Q29tbWFuZCBleGVjdXRpb24gdmlhIGZpbmQgLWV4ZWMnCiAgICAgICAgJ1xiKGF3a3xnYXdrfG5hd2t8bWF3aylcYltefDtdKnN5c3RlbVxzKlwofHx8SW5kaXJlY3QgY29tbWFuZCBleGVjdXRpb24gdmlhIGF3ayBzeXN0ZW0oKScKICAgICAgICAnXGJwcmludGZcYi4qXFxcXHhbMC05YS1mQS1GXXx8fFBvdGVudGlhbCBoZXgtZW5jb2RlZCBjb21tYW5kIGluamVjdGlvbicKICAgICAgICAnXCRce1tefV0qI1x9fHx8UGFyYW1ldGVyIGV4cGFuc2lvbiB0aGF0IG1heSBhbHRlciBjb21tYW5kJwogICAgICAgICdlY2hvXHMrW158XSpcfFxzKihiYXNofHNofGV2YWwpfHx8RWNobyBwaXBlbGluZSB0byBzaGVsbCBleGVjdXRpb24nCiAgICApCmZpCgojIFdhcm4tbGV2ZWwgc2VjdXJpdHkgcnVsZXMgKHdhcm5pbmcgb25seSwgdXNlciBjYW4gcHJvY2VlZCkKIyBGb3JtYXQ6ICdwYXR0ZXJufHx8cmVhc29uJwojIE5vdGU6IE5vdCB1c2luZyAncmVhZG9ubHknIHRvIGVuc3VyZSBjb21wYXRpYmlsaXR5IHdpdGggZnVuY3Rpb24tc2NvcGVkIHNvdXJjaW5nCmlmIFsgLXogIiR7X0ZVQ0tfU0VDVVJJVFlfV0FSTl9SVUxFUyt4fSIgXSB8fCBbWyAkeyNfRlVDS19TRUNVUklUWV9XQVJOX1JVTEVTW0BdfSAtZXEgMCBdXSAyPi9kZXYvbnVsbDsgdGhlbgogICAgX0ZVQ0tfU0VDVVJJVFlfV0FSTl9SVUxFUz0oCiAgICAgICAgJ3N1ZG9bWzpzcGFjZTpdXStbXjsmfF0qcm1bWzpzcGFjZTpdXSstcmZ8fHxzdWRvIHJtIC1yZiBkZXRlY3RlZCcKICAgICAgICAncm1bWzpzcGFjZTpdXSstcmZcYnx8fFJlY3Vyc2l2ZSBkZWxldGUgcmVxdWVzdCBkZXRlY3RlZCcKICAgICAgICAnY2htb2RbWzpzcGFjZTpdXSsuKjc3N1xifHx8V29ybGQtd3JpdGFibGUgcGVybWlzc2lvbiBjaGFuZ2UgZGV0ZWN0ZWQnCiAgICAgICAgJz5bWzpzcGFjZTpdXSovKGV0Yy8ocGFzc3dkfHNoYWRvd3xzdWRvZXJzKXxkZXYvc2RbYS16XSspfHx8T3V0cHV0IHJlZGlyZWN0aW9uIGludG8gc2Vuc2l0aXZlIHN5c3RlbSBmaWxlcycKICAgICkKZmkKCiMgR2V0cyB0aGUgY3VycmVudCBzZWN1cml0eSBtb2RlIGZyb20gY29uZmlndXJhdGlvbgojIE91dHB1dHM6ICJzdHJpY3QiLCAiYmFsYW5jZWQiLCBvciAib2ZmIgpfZnVja19zZWN1cml0eV9tb2RlKCkgewogICAgbG9jYWwgbW9kZT0iJHtGVUNLX1NFQ1VSSVRZX01PREU6LWJhbGFuY2VkfSIKICAgIG1vZGU9JChwcmludGYgJyVzJyAiJG1vZGUiIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCgogICAgY2FzZSAiJG1vZGUiIGluCiAgICAgICAgc3RyaWN0KSBwcmludGYgJ3N0cmljdFxuJyA7OwogICAgICAgIG9mZnxkaXNhYmxlZHxub25lKSBwcmludGYgJ29mZlxuJyA7OwogICAgICAgIGJhbGFuY2VkfGRlZmF1bHR8IiIpIHByaW50ZiAnYmFsYW5jZWRcbicgOzsKICAgICAgICAqKSBwcmludGYgJ2JhbGFuY2VkXG4nIDs7CiAgICBlc2FjCn0KCiMgR2V0cyB0aGUgZGVmYXVsdCBjaGFsbGVuZ2UgdGV4dCBmb3Igc2VjdXJpdHkgY29uZmlybWF0aW9ucwojIE91dHB1dHM6IERlZmF1bHQgY2hhbGxlbmdlIHBocmFzZQpfZnVja19zZWN1cml0eV9kZWZhdWx0X2NoYWxsZW5nZV90ZXh0KCkgewogICAgcHJpbnRmICdJIGFjY2VwdCB0aGUgcmlzaycKfQoKIyBDaGVja3MgaWYgYSBjb21tYW5kIG1hdGNoZXMgdGhlIHNlY3VyaXR5IHdoaXRlbGlzdAojIEFyZ3VtZW50czogJDEgLSBjb21tYW5kIHRvIGNoZWNrCiMgUmV0dXJuczogMCBpZiB3aGl0ZWxpc3RlZCwgMSBvdGhlcndpc2UKX2Z1Y2tfc2VjdXJpdHlfaXNfd2hpdGVsaXN0ZWQoKSB7CiAgICBsb2NhbCBjb21tYW5kPSIkMSIKICAgIGxvY2FsIHdoaXRlbGlzdD0iJHtGVUNLX1NFQ1VSSVRZX1dISVRFTElTVDotfSIKCiAgICBpZiBbIC16ICIkd2hpdGVsaXN0IiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbm9ybWFsaXplZCBlbnRyeQogICAgbm9ybWFsaXplZD0kKHByaW50ZiAnJXMnICIkd2hpdGVsaXN0IiB8IHRyICcsJyAnXG4nKQoKICAgIHdoaWxlIElGUz0gcmVhZCAtciBlbnRyeTsgZG8KICAgICAgICBlbnRyeT0kKHByaW50ZiAnJXMnICIkZW50cnkiIHwgc2VkIC1lICdzL15bWzpzcGFjZTpdXSovLycgLWUgJ3MvW1s6c3BhY2U6XV0qJC8vJykKICAgICAgICBbIC16ICIkZW50cnkiIF0gJiYgY29udGludWUKCiAgICAgICAgaWYgcHJpbnRmICclcycgIiRjb21tYW5kIiB8IGdyZXAgLUZxICIkZW50cnkiOyB0aGVuCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgZmkKICAgIGRvbmUgPDw8ICIkbm9ybWFsaXplZCIKCiAgICByZXR1cm4gMQp9CgojIENvbnZlcnRzIHNlY3VyaXR5IGxldmVsIHRvIG51bWVyaWMgdmFsdWUgZm9yIGNvbXBhcmlzb24KIyBBcmd1bWVudHM6ICQxIC0gc2VjdXJpdHkgbGV2ZWwgKGJsb2NrL2NoYWxsZW5nZS93YXJuL29rKQojIE91dHB1dHM6IE51bWVyaWMgdmFsdWUgKDMvMi8xLzApCl9mdWNrX3NlY3VyaXR5X2xldmVsX3ZhbHVlKCkgewogICAgY2FzZSAiJDEiIGluCiAgICAgICAgYmxvY2spIHByaW50ZiAnM1xuJyA7OwogICAgICAgIGNoYWxsZW5nZSkgcHJpbnRmICcyXG4nIDs7CiAgICAgICAgd2FybikgcHJpbnRmICcxXG4nIDs7CiAgICAgICAgKikgcHJpbnRmICcwXG4nIDs7CiAgICBlc2FjCn0KCiMgUHJvbW90ZXMgc2VjdXJpdHkgbGV2ZWwgaWYgY2FuZGlkYXRlIGlzIG1vcmUgc2V2ZXJlCiMgQXJndW1lbnRzOiAkMSAtIGN1cnJlbnQgbGV2ZWwsICQyIC0gY2FuZGlkYXRlIGxldmVsCiMgT3V0cHV0czogVGhlIG1vcmUgc2V2ZXJlIGxldmVsCl9mdWNrX3NlY3VyaXR5X3Byb21vdGUoKSB7CiAgICBsb2NhbCBjdXJyZW50PSIkMSIKICAgIGxvY2FsIGNhbmRpZGF0ZT0iJDIiCiAgICBsb2NhbCBjdXJyZW50X3ZhbCBjYW5kaWRhdGVfdmFsCgogICAgY3VycmVudF92YWw9JChfZnVja19zZWN1cml0eV9sZXZlbF92YWx1ZSAiJGN1cnJlbnQiKQogICAgY2FuZGlkYXRlX3ZhbD0kKF9mdWNrX3NlY3VyaXR5X2xldmVsX3ZhbHVlICIkY2FuZGlkYXRlIikKCiAgICBpZiBbICIkY2FuZGlkYXRlX3ZhbCIgLWd0ICIkY3VycmVudF92YWwiIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkY2FuZGlkYXRlIgogICAgZWxzZQogICAgICAgIHByaW50ZiAnJXNcbicgIiRjdXJyZW50IgogICAgZmkKfQoKIyBBcHBsaWVzIHNlY3VyaXR5IG1vZGUgYWRqdXN0bWVudHMgdG8gc2V2ZXJpdHkgbGV2ZWwKIyBBcmd1bWVudHM6ICQxIC0gbW9kZSAoc3RyaWN0L2JhbGFuY2VkL29mZiksICQyIC0gc2V2ZXJpdHkgbGV2ZWwKIyBPdXRwdXRzOiBBZGp1c3RlZCBzZXZlcml0eSBsZXZlbApfZnVja19zZWN1cml0eV9hcHBseV9tb2RlKCkgewogICAgbG9jYWwgbW9kZT0iJDEiCiAgICBsb2NhbCBzZXZlcml0eT0iJDIiCgogICAgY2FzZSAiJG1vZGUiIGluCiAgICAgICAgc3RyaWN0KQogICAgICAgICAgICBjYXNlICIkc2V2ZXJpdHkiIGluCiAgICAgICAgICAgICAgICB3YXJuKSBzZXZlcml0eT0iY2hhbGxlbmdlIiA7OwogICAgICAgICAgICAgICAgY2hhbGxlbmdlKSBzZXZlcml0eT0iYmxvY2siIDs7CiAgICAgICAgICAgIGVzYWMKICAgICAgICAgICAgOzsKICAgIGVzYWMKCiAgICBwcmludGYgJyVzXG4nICIkc2V2ZXJpdHkiCn0KCiMgTWF0Y2hlcyBjb21tYW5kIGFnYWluc3QgYSBzZWN1cml0eSBydWxlIHRhYmxlCiMgQXJndW1lbnRzOiAkMSAtIGNvbW1hbmQsICQyIC0gcnVsZSB0YWJsZSBuYW1lCiMgT3V0cHV0czogUmVhc29uIHN0cmluZyBpZiBtYXRjaGVkCiMgUmV0dXJuczogMCBpZiBtYXRjaGVkLCAxIG90aGVyd2lzZQpfZnVja19zZWN1cml0eV9tYXRjaF9ydWxlKCkgewogICAgbG9jYWwgY29tbWFuZD0iJDEiCiAgICBsb2NhbCB0YWJsZT0iJDIiCiAgICBsb2NhbCAtYSBydWxlcz0oKQoKICAgICMgU0VDVVJJVFkgTk9URTogVGhpcyBldmFsIGlzIFNBRkUgYmVjYXVzZToKICAgICMgLSAkdGFibGUgb25seSByZWNlaXZlcyBoYXJkY29kZWQgaW50ZXJuYWwgYXJyYXkgbmFtZXMgZnJvbSBjYWxsZXJzIHdpdGhpbiB0aGlzIHNjcmlwdAogICAgIyAtIFZhbGlkIHZhbHVlczogX0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVMsIF9GVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9SVUxFUywgX0ZVQ0tfU0VDVVJJVFlfV0FSTl9SVUxFUwogICAgIyAtIE5vIHVzZXIgaW5wdXQgY2FuIHJlYWNoIHRoaXMgdmFyaWFibGU7IGl0J3MgcHVyZWx5IGZvciBkeW5hbWljIGFycmF5IG5hbWUgcmVzb2x1dGlvbgogICAgIyAtIFRoaXMgcGF0dGVybiBpcyBhIHN0YW5kYXJkIEJhc2ggaWRpb20gZm9yIGluZGlyZWN0IGFycmF5IGFjY2VzcyAoQmFzaCAzLnggY29tcGF0aWJsZSkKICAgIGV2YWwgInJ1bGVzPShcIlwkeyR7dGFibGV9W0BdfVwiKSIKCiAgICBsb2NhbCBydWxlIHBhdHRlcm4gcmVhc29uCiAgICBmb3IgcnVsZSBpbiAiJHtydWxlc1tAXX0iOyBkbwogICAgICAgIHBhdHRlcm49JHtydWxlJSV8fHwqfQogICAgICAgIHJlYXNvbj0ke3J1bGUjKnx8fH0KICAgICAgICBbIC16ICIkcGF0dGVybiIgXSAmJiBjb250aW51ZQoKICAgICAgICBpZiBwcmludGYgJyVzJyAiJGNvbW1hbmQiIHwgZ3JlcCAtRWlxIC0tICIkcGF0dGVybiI7IHRoZW4KICAgICAgICAgICAgcHJpbnRmICclc1xuJyAiJHJlYXNvbiIKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICBmaQogICAgZG9uZQoKICAgIHJldHVybiAxCn0KCiMgRGlzcGxheXMgd2FybmluZyBtZXNzYWdlIGZvciBwb3RlbnRpYWxseSBkYW5nZXJvdXMgY29tbWFuZHMKIyBBcmd1bWVudHM6ICQxIC0gcmVhc29uIGZvciB3YXJuaW5nCl9mdWNrX3NlY3VyaXR5X3dhcm5fbWVzc2FnZSgpIHsKICAgIGxvY2FsIHJlYXNvbj0iJDEiCiAgICBlY2hvIC1lICIke0NfUkVEX0JPTER94pqg77iPICBTRUNVUklUWSBXQVJOSU5HOiR7Q19SRVNFVH0gJHtyZWFzb259IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d9UmV2aWV3IHRoZSBjb21tYW5kIG1hbnVhbGx5IG9yIGFkZCBhIHdoaXRlbGlzdCBlbnRyeSBpZiB5b3UgZnVsbHkgdHJ1c3QgaXQuJHtDX1JFU0VUfSIgPiYyCn0KCiMgRGlzcGxheXMgYmxvY2sgbWVzc2FnZSBmb3IgcHJvaGliaXRlZCBjb21tYW5kcwojIEFyZ3VtZW50czogJDEgLSByZWFzb24gZm9yIGJsb2NraW5nCl9mdWNrX3NlY3VyaXR5X2Jsb2NrX21lc3NhZ2UoKSB7CiAgICBsb2NhbCByZWFzb249IiQxIgogICAgZWNobyAtZSAiJHtDX1JFRF9CT0xEfeKblCBTRUNVUklUWSBCTE9DSzoke0NfUkVTRVR9ICR7cmVhc29ufSIgPiYyCiAgICBlY2hvIC1lICIke0NfUkVEfUV4ZWN1dGlvbiBkZW5pZWQuIEFkanVzdCBGVUNLX1NFQ1VSSVRZX01PREUgb3Igd2hpdGVsaXN0IHRoZSBjb21tYW5kIGlmIGFic29sdXRlbHkgbmVjZXNzYXJ5LiR7Q19SRVNFVH0iID4mMgp9CgojIERpc3BsYXlzIGNoYWxsZW5nZSBtZXNzYWdlIGZvciBoaWdoLXJpc2sgY29tbWFuZHMKIyBBcmd1bWVudHM6ICQxIC0gcmVhc29uIGZvciBjaGFsbGVuZ2UsICQyIC0gcmVxdWlyZWQgcGhyYXNlCl9mdWNrX3NlY3VyaXR5X2NoYWxsZW5nZV9tZXNzYWdlKCkgewogICAgbG9jYWwgcmVhc29uPSIkMSIKICAgIGxvY2FsIHBocmFzZT0iJDIiCiAgICBlY2hvIC1lICIke0NfUkVEX0JPTER94pqg77iPICBTRUNVUklUWSBDSEFMTEVOR0U6JHtDX1JFU0VUfSAke3JlYXNvbn0iID4mMgogICAgZWNobyAtZSAiJHtDX0NZQU59VHlwZSB0aGUgZm9sbG93aW5nIHBocmFzZSB0byBjb250aW51ZToke0NfUkVTRVR9IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19CT0xEfSR7cGhyYXNlfSR7Q19SRVNFVH0iID4mMgp9CgojIFByb21wdHMgdXNlciB0byBlbnRlciB0aGUgcmVxdWlyZWQgcGhyYXNlIGZvciBzZWN1cml0eSBjaGFsbGVuZ2UKIyBBcmd1bWVudHM6ICQxIC0gcmVxdWlyZWQgcGhyYXNlCiMgUmV0dXJuczogMCBpZiBwaHJhc2UgbWF0Y2hlcywgMSBvdGhlcndpc2UKX2Z1Y2tfc2VjdXJpdHlfcHJvbXB0X3BocmFzZSgpIHsKICAgIGxvY2FsIHBocmFzZT0iJDEiCiAgICBsb2NhbCBpbnB1dD0iIgoKICAgIHByaW50ZiAiJWI+ICViIiAiJENfQk9MRCIgIiRDX1JFU0VUIiA+JjIKCiAgICBpZiBbIC1yIC9kZXYvdHR5IF07IHRoZW4KICAgICAgICBpZiAhIElGUz0gcmVhZCAtciBpbnB1dCA8IC9kZXYvdHR5OyB0aGVuCiAgICAgICAgICAgIHByaW50ZiAiXG4iID4mMgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgIGZpCiAgICBlbHNlCiAgICAgICAgaWYgISBJRlM9IHJlYWQgLXIgaW5wdXQ7IHRoZW4KICAgICAgICAgICAgcHJpbnRmICJcbiIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKICAgIGZpCgogICAgcHJpbnRmICJcbiIgPiYyCiAgICBbICIkaW5wdXQiID0gIiRwaHJhc2UiIF0KfQoKIyBIYW5kbGVzIHNlY3VyaXR5IGRlY2lzaW9uIGJhc2VkIG9uIHNldmVyaXR5IGxldmVsCiMgQXJndW1lbnRzOiAkMSAtIHNldmVyaXR5IGxldmVsLCAkMiAtIHJlYXNvbiwgJDMgLSBjb21tYW5kCiMgUmV0dXJuczogMCB0byBhbGxvdyBleGVjdXRpb24sIDEgdG8gZGVueQpfZnVja19zZWN1cml0eV9oYW5kbGVfZGVjaXNpb24oKSB7CiAgICBsb2NhbCBzZXZlcml0eT0iJDEiCiAgICBsb2NhbCByZWFzb249IiQyIgogICAgbG9jYWwgY29tbWFuZD0iJDMiCgogICAgY2FzZSAiJHNldmVyaXR5IiBpbgogICAgICAgICIifG9rfG9mZikKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgOzsKICAgICAgICB3YXJuKQogICAgICAgICAgICBfZnVja19zZWN1cml0eV93YXJuX21lc3NhZ2UgIiR7cmVhc29uOi1Qb3RlbnRpYWxseSBkYW5nZXJvdXMgY29tbWFuZCBkZXRlY3RlZH0iCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIDs7CiAgICAgICAgY2hhbGxlbmdlKQogICAgICAgICAgICBsb2NhbCBwaHJhc2U9IiR7RlVDS19TRUNVUklUWV9DSEFMTEVOR0VfVEVYVDotJChfZnVja19zZWN1cml0eV9kZWZhdWx0X2NoYWxsZW5nZV90ZXh0KX0iCiAgICAgICAgICAgIF9mdWNrX3NlY3VyaXR5X2NoYWxsZW5nZV9tZXNzYWdlICIke3JlYXNvbjotSGlnaC1yaXNrIGNvbW1hbmQgZGV0ZWN0ZWR9IiAiJHBocmFzZSIKCiAgICAgICAgICAgIGlmIF9mdWNrX3NlY3VyaXR5X3Byb21wdF9waHJhc2UgIiRwaHJhc2UiOyB0aGVuCiAgICAgICAgICAgICAgICBlY2hvIC1lICIke0NfR1JFRU59U2VjdXJpdHkgY2hhbGxlbmdlIGFja25vd2xlZGdlZC4ke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIGZpCgogICAgICAgICAgICBlY2hvIC1lICIke0NfUkVEfVNlY3VyaXR5IGNoYWxsZW5nZSBmYWlsZWQuIENvbW1hbmQgYWJvcnRlZC4ke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICAgICAgOzsKICAgICAgICBibG9jaykKICAgICAgICAgICAgX2Z1Y2tfYXVkaXRfbG9nICJCTE9DSyIgIiRjb21tYW5kIgogICAgICAgICAgICBfZnVja19zZWN1cml0eV9ibG9ja19tZXNzYWdlICIke3JlYXNvbjotQ29tbWFuZCBibG9ja2VkIGJ5IHBvbGljeX0iCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgICAgIDs7CiAgICAgICAgKikKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgOzsKICAgIGVzYWMKfQoKIyBFdmFsdWF0ZXMgY29tbWFuZCBzZWN1cml0eSBhbmQgcmV0dXJucyBzZXZlcml0eSBsZXZlbCB3aXRoIHJlYXNvbgojIEFyZ3VtZW50czogJDEgLSBjb21tYW5kIHRvIGV2YWx1YXRlCiMgT3V0cHV0czogInNldmVyaXR5fHJlYXNvbiIgc3RyaW5nCiMgUmV0dXJuczogMCBhbHdheXMgKHJlc3VsdCBpcyBpbiBvdXRwdXQpCl9mdWNrX3NlY3VyaXR5X2V2YWx1YXRlX2NvbW1hbmQoKSB7CiAgICBsb2NhbCBjb21tYW5kPSIkMSIKICAgIGxvY2FsIG1vZGUgc2V2ZXJpdHkgcmVhc29uIG1hdGNoIHByb21vdGVkIHN0cnVjdHVyYWxfcmVhc29uCgogICAgbW9kZT0kKF9mdWNrX3NlY3VyaXR5X21vZGUpCgogICAgIyBTZWN1cml0eSBlbmdpbmUgZGlzYWJsZWQKICAgIGlmIFsgIiRtb2RlIiA9ICJvZmYiIF07IHRoZW4KICAgICAgICBwcmludGYgJ29mZnxTZWN1cml0eSBlbmdpbmUgZGlzYWJsZWRcbicKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICAjIENoZWNrIHdoaXRlbGlzdAogICAgaWYgX2Z1Y2tfc2VjdXJpdHlfaXNfd2hpdGVsaXN0ZWQgIiRjb21tYW5kIjsgdGhlbgogICAgICAgIHByaW50ZiAnb2t8Q29tbWFuZCBtYXRjaGVkIHdoaXRlbGlzdFxuJwogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIHNldmVyaXR5PSJvayIKICAgIHJlYXNvbj0iIgogICAgbWF0Y2g9IiIKCiAgICAjIENoZWNrIGJsb2NrIHJ1bGVzIChoaWdoZXN0IHByaW9yaXR5KQogICAgaWYgbWF0Y2g9JChfZnVja19zZWN1cml0eV9tYXRjaF9ydWxlICIkY29tbWFuZCIgIl9GVUNLX1NFQ1VSSVRZX0JMT0NLX1JVTEVTIik7IHRoZW4KICAgICAgICBzZXZlcml0eT0iYmxvY2siCiAgICAgICAgcmVhc29uPSIkbWF0Y2giCiAgICBmaQoKICAgICMgQ2hlY2sgY2hhbGxlbmdlIHJ1bGVzIChtZWRpdW0gcHJpb3JpdHkpCiAgICBpZiBbICIkc2V2ZXJpdHkiICE9ICJibG9jayIgXSAmJiBtYXRjaD0kKF9mdWNrX3NlY3VyaXR5X21hdGNoX3J1bGUgIiRjb21tYW5kIiAiX0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1JVTEVTIik7IHRoZW4KICAgICAgICBzZXZlcml0eT0iY2hhbGxlbmdlIgogICAgICAgIHJlYXNvbj0iJG1hdGNoIgogICAgZmkKCiAgICAjIENoZWNrIHdhcm4gcnVsZXMgKGxvdyBwcmlvcml0eSkKICAgIGlmIFsgIiRzZXZlcml0eSIgPSAib2siIF0gJiYgbWF0Y2g9JChfZnVja19zZWN1cml0eV9tYXRjaF9ydWxlICIkY29tbWFuZCIgIl9GVUNLX1NFQ1VSSVRZX1dBUk5fUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJ3YXJuIgogICAgICAgIHJlYXNvbj0iJG1hdGNoIgogICAgZmkKCiAgICAjIENoZWNrIGZvciBjb21tYW5kIGNoYWluaW5nL3BpcGluZyAoc3RydWN0dXJhbCBhbmFseXNpcykKICAgIGlmIHByaW50ZiAnJXMnICIkY29tbWFuZCIgfCBncmVwIC1FaXEgJygmJnxcfFx8fDt8XHwpJzsgdGhlbgogICAgICAgIHN0cnVjdHVyYWxfcmVhc29uPSJDb21tYW5kIGNoYWluaW5nIG9yIHBpcGluZyBkZXRlY3RlZCIKICAgICAgICBwcm9tb3RlZD0kKF9mdWNrX3NlY3VyaXR5X3Byb21vdGUgIiRzZXZlcml0eSIgIndhcm4iKQoKICAgICAgICBpZiBbICIkcHJvbW90ZWQiICE9ICIkc2V2ZXJpdHkiIF07IHRoZW4KICAgICAgICAgICAgc2V2ZXJpdHk9IiRwcm9tb3RlZCIKICAgICAgICAgICAgcmVhc29uPSIkc3RydWN0dXJhbF9yZWFzb24iCiAgICAgICAgZWxpZiBbIC16ICIkcmVhc29uIiBdOyB0aGVuCiAgICAgICAgICAgIHJlYXNvbj0iJHN0cnVjdHVyYWxfcmVhc29uIgogICAgICAgIGZpCiAgICBmaQoKICAgICMgQXBwbHkgc2VjdXJpdHkgbW9kZSBhZGp1c3RtZW50cwogICAgc2V2ZXJpdHk9JChfZnVja19zZWN1cml0eV9hcHBseV9tb2RlICIkbW9kZSIgIiRzZXZlcml0eSIpCgogICAgcHJpbnRmICclc3wlc1xuJyAiJHNldmVyaXR5IiAiJHtyZWFzb246LVNhZmUgZXhlY3V0aW9ufSIKfQoKIyBMZWdhY3kgZnVuY3Rpb24gZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkKIyBBcmd1bWVudHM6ICQxIC0gY29tbWFuZCB0byBjaGVjawojIE91dHB1dHM6ICJzZXZlcml0eXxyZWFzb24iIHN0cmluZwpfZnVja19kZXRlY3RfZGFuZ2Vyb3VzX2NvbW1hbmQoKSB7CiAgICBfZnVja19zZWN1cml0eV9ldmFsdWF0ZV9jb21tYW5kICIkMSIKfQoKCiMgRW5zdXJlIGEgY29uZmlnIGZpbGUgZXhpc3RzIHRvIGhlbHAgdXNlcnMgdHdlYWsgdGhlIGJlaGF2aW91cgpfZnVja19zZWN1cmVfY29uZmlnX2ZpbGUoKSB7CiAgICBpZiBbIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBjaG1vZCA2MDAgIiRDT05GSUdfRklMRSIgMj4vZGV2L251bGwgfHwgdHJ1ZQogICAgZmkKfQoKX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50KCkgewogICAgbG9jYWwga2V5PSIkMSIKICAgIGxvY2FsIGNvbW1lbnQ9IiQyIgogICAgbG9jYWwgc2FtcGxlPSIkMyIKICAgIGxvY2FsIHF1b3RlZD0iJHs0Oi0xfSIKICAgIFsgLWYgIiRDT05GSUdfRklMRSIgXSB8fCByZXR1cm4KICAgIGlmIGdyZXAgLUVxICJeXFxzKiM/XFxzKmV4cG9ydFxccyska2V5IiAiJENPTkZJR19GSUxFIjsgdGhlbgogICAgICAgIHJldHVybgogICAgZmkKCiAgICBsb2NhbCBhc3NpZ25tZW50CiAgICBpZiBbICIkcXVvdGVkIiA9ICIxIiBdOyB0aGVuCiAgICAgICAgYXNzaWdubWVudD0iIyBleHBvcnQgJGtleT1cIiRzYW1wbGVcIiIKICAgIGVsc2UKICAgICAgICBhc3NpZ25tZW50PSIjIGV4cG9ydCAka2V5PSRzYW1wbGUiCiAgICBmaQoKICAgIHsKICAgICAgICBwcmludGYgJ1xuJwogICAgICAgIHByaW50ZiAnIyAlc1xuJyAiJGNvbW1lbnQiCiAgICAgICAgcHJpbnRmICclc1xuJyAiJGFzc2lnbm1lbnQiCiAgICB9ID4+ICIkQ09ORklHX0ZJTEUiCn0KCl9mdWNrX3NlZWRfY29uZmlnX3BsYWNlaG9sZGVycygpIHsKICAgIFsgLWYgIiRDT05GSUdfRklMRSIgXSB8fCByZXR1cm4KICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19PUEVOQUlfQVBJX0tFWSIgIkxvY2FsIE9wZW5BSS1jb21wYXRpYmxlIEFQSSBrZXkgKHJlY29tbWVuZGVkKSIgJ3NrLS4uLicKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19BRE1JTl9LRVkiICJPcHRpb25hbDogYWRtaW4gYnlwYXNzIGtleSBmb3IgdHJ1c3RlZCBtYWludGFpbmVycyIgJ2FkbS0uLi4nCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfT1BFTkFJX01PREVMIiAiT3B0aW9uYWw6IG92ZXJyaWRlIG1vZGVsIHdoZW4gdXNpbmcgeW91ciBvd24ga2V5IiAnZ3B0LTRvLW1pbmknCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfT1BFTkFJX0FQSV9CQVNFIiAiT3B0aW9uYWw6IG92ZXJyaWRlIEFQSSBiYXNlIiAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19BTElBUyIgIkFkZCBhbiBleHRyYSBhbGlhcyBiZXNpZGVzIHRoZSBkZWZhdWx0ICdmdWNrJyIgJ3BscycKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19BVVRPX0VYRUMiICJTa2lwIGNvbmZpcm1hdGlvbiBwcm9tcHRzICh1c2Ugd2l0aCBjYXV0aW9uISkiICdmYWxzZScgMAogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX1RJTUVPVVQiICJPdmVycmlkZSBjdXJsIHRpbWVvdXQgKHNlY29uZHMpIiAnMzAnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19ERUJVRyIgIkVuYWJsZSB2ZXJib3NlIGRlYnVnIGxvZ3MiICdmYWxzZScgMAogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUyIgIkRpc2FibGUgdGhlIGJ1aWx0LWluICdmdWNrJyBhbGlhcyIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfU0VDVVJJVFlfTU9ERSIgIlNlY3VyaXR5IGVuZ2luZSBtb2RlOiBzdHJpY3R8YmFsYW5jZWR8b2ZmIiAnYmFsYW5jZWQnCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfU0VDVVJJVFlfV0hJVEVMSVNUIiAiQ29tbWEvbmV3bGluZSBzZXBhcmF0ZWQgY29tbWFuZCBwYXR0ZXJucyB0byBieXBhc3Mgc2VjdXJpdHkgY2hlY2tzIiAnJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9URVhUIiAiUGhyYXNlIHJlcXVpcmVkIGZvciBoaWdoLXJpc2sgY29tbWFuZCBjb25maXJtYXRpb24iICdJIGFjY2VwdCB0aGUgcmlzaycKfQoKX2Z1Y2tfZW5zdXJlX2NvbmZpZ19leGlzdHMoKSB7CiAgICBpZiBbIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBfZnVja19zZWVkX2NvbmZpZ19wbGFjZWhvbGRlcnMKICAgICAgICBfZnVja19zZWN1cmVfY29uZmlnX2ZpbGUKICAgICAgICByZXR1cm4KICAgIGZpCgogICAgbWtkaXIgLXAgIiQoZGlybmFtZSAiJENPTkZJR19GSUxFIikiCiAgICBjYXQgPDwnQ0ZHJyA+ICIkQ09ORklHX0ZJTEUiCiMgZnVja2l0cyBjb25maWd1cmF0aW9uCiMgVG9nZ2xlIHRoZSBleHBvcnRzIGJlbG93IHRvIGN1c3RvbWlzZSB5b3VyIGV4cGVyaWVuY2UuCgojIEN1c3RvbSBBUEkgZW5kcG9pbnQgdGhhdCBwb2ludHMgdG8geW91ciBzZWxmLWhvc3RlZCB3b3JrZXIKIyBleHBvcnQgRlVDS19BUElfRU5EUE9JTlQ9Imh0dHBzOi8veW91ci1kb21haW4ud29ya2Vycy5kZXYvIgoKIyBMb2NhbCBPcGVuQUktY29tcGF0aWJsZSBBUEkga2V5IChyZWNvbW1lbmRlZCkKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0tFWT0ic2stLi4uIgoKIyBPcHRpb25hbDogYWRtaW4gYnlwYXNzIGtleSBmb3IgdHJ1c3RlZCBtYWludGFpbmVycwojIGV4cG9ydCBGVUNLX0FETUlOX0tFWT0iYWRtLS4uLiIKCiMgT3B0aW9uYWw6IG92ZXJyaWRlIG1vZGVsL2Jhc2Ugd2hlbiB1c2luZyB5b3VyIG93biBrZXkKIyBleHBvcnQgRlVDS19PUEVOQUlfTU9ERUw9ImdwdC00by1taW5pIgojIGV4cG9ydCBGVUNLX09QRU5BSV9BUElfQkFTRT0iaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MSIKCiMgQWRkIGFuIGV4dHJhIGFsaWFzIGJlc2lkZXMgdGhlIGRlZmF1bHQgJ2Z1Y2snCiMgZXhwb3J0IEZVQ0tfQUxJQVM9InBscyIKCiMgU2tpcCBjb25maXJtYXRpb24gcHJvbXB0cyAodXNlIHdpdGggY2F1dGlvbiEpCiMgZXhwb3J0IEZVQ0tfQVVUT19FWEVDPWZhbHNlCgojIE92ZXJyaWRlIGN1cmwgdGltZW91dCAoc2Vjb25kcykKIyBleHBvcnQgRlVDS19USU1FT1VUPTMwCgojIEVuYWJsZSB2ZXJib3NlIGRlYnVnIGxvZ3MKIyBleHBvcnQgRlVDS19ERUJVRz1mYWxzZQoKIyBEaXNhYmxlIHRoZSBidWlsdC1pbiAnZnVjaycgYWxpYXMKIyBleHBvcnQgRlVDS19ESVNBQkxFX0RFRkFVTFRfQUxJQVM9ZmFsc2UKCiMgLS0tIFNlY3VyaXR5IFNldHRpbmdzIC0tLQojIFNlY3VyaXR5IG1vZGU6IHN0cmljdCwgYmFsYW5jZWQgKGRlZmF1bHQpLCBvciBvZmYKIyBleHBvcnQgRlVDS19TRUNVUklUWV9NT0RFPSJiYWxhbmNlZCIKCiMgV2hpdGVsaXN0IHRydXN0ZWQgY29tbWFuZCBwYXR0ZXJucyAoY29tbWEtc2VwYXJhdGVkKQojIGV4cG9ydCBGVUNLX1NFQ1VSSVRZX1dISVRFTElTVD0iZG9ja2VyIHJtIC1mLHJtIC1yZiAvdG1wL3NhZmUtZGlyIgoKIyAtLS0gQXVkaXQgTG9nZ2luZyAtLS0KIyBFbmFibGUgYXVkaXQgbG9nZ2luZyBvZiBhbGwgZXhlY3V0ZWQgY29tbWFuZHMKIyBleHBvcnQgRlVDS19BVURJVF9MT0c9dHJ1ZQoKIyBDdXN0b20gYXVkaXQgbG9nIGZpbGUgcGF0aCAoZGVmYXVsdDogfi8uZnVjay8uYXVkaXQubG9nKQojIGV4cG9ydCBGVUNLX0FVRElUX0xPR19GSUxFPSIkSE9NRS8uZnVjay8uYXVkaXQubG9nIgpDRkcKCiAgICBfZnVja19zZWVkX2NvbmZpZ19wbGFjZWhvbGRlcnMKICAgIF9mdWNrX3NlY3VyZV9jb25maWdfZmlsZQp9CgpfZnVja19zaG93X2NvbmZpZ19oZWxwKCkgewogICAgX2Z1Y2tfZW5zdXJlX2NvbmZpZ19leGlzdHMKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d9Q29uZmlndXJhdGlvbiBmaWxlOiR7Q19SRVNFVH0gJHtDX0NZQU59JENPTkZJR19GSUxFJHtDX1JFU0VUfSIKICAgIGlmIFsgLW4gIiR7RURJVE9SOi19IiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31FZGl0IHdpdGg6JHtDX1JFU0VUfSAke0NfQ1lBTn0ke0VESVRPUn0gXCIkQ09ORklHX0ZJTEVcIiR7Q19SRVNFVH0iCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31PcGVuIHRoaXMgZmlsZSBpbiB5b3VyIGZhdm91cml0ZSBlZGl0b3IgdG8gY3VzdG9taXNlIGZ1Y2tpdHMuJHtDX1JFU0VUfSIKICAgIGZpCiAgICBlY2hvIC1lICIke0NfQ1lBTn1BdmFpbGFibGUgdG9nZ2xlczoke0NfUkVTRVR9IEZVQ0tfQVBJX0VORFBPSU5ULCBGVUNLX09QRU5BSV9BUElfS0VZLCBGVUNLX0FETUlOX0tFWSwgRlVDS19PUEVOQUlfTU9ERUwsIEZVQ0tfT1BFTkFJX0FQSV9CQVNFLCBGVUNLX0FMSUFTLCBGVUNLX0FVVE9fRVhFQywgRlVDS19USU1FT1VULCBGVUNLX0RFQlVHLCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUyIKICAgIGVjaG8gLWUgIiR7Q19ESU19UHJvIHRpcDoke0NfUkVTRVR9IHdlIGxvY2sgJHtDT05GSUdfRklMRX0gdG8gY2htb2QgNjAwIHNvIHlvdXIgQVBJIGtleSBzdGF5cyBsb2NhbC4iCn0KCiMgVW5pbnN0YWxscyB0aGUgc2NyaXB0Cl91bmluc3RhbGxfc2NyaXB0KCkgewogICAgZWNobyAtZSAiJEZVQ0sgJHtDX1lFTExPV31TbyB5b3UncmUga2lja2luZyBtZSBvdXQ/IEZpbmUuJHtDX1JFU0VUfSIKCiAgICAjIEZpbmQgdGhlIHByb2ZpbGUgZmlsZQogICAgbG9jYWwgcHJvZmlsZV9maWxlCiAgICBwcm9maWxlX2ZpbGU9JChfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKQogICAgbG9jYWwgc291cmNlX2xpbmU9InNvdXJjZSAkTUFJTl9TSCIKCiAgICBpZiBbICIkcHJvZmlsZV9maWxlIiAhPSAidW5rbm93bl9wcm9maWxlIiBdICYmIFsgLWYgIiRwcm9maWxlX2ZpbGUiIF07IHRoZW4KICAgICAgICBpZiBncmVwIC1xRiAiJHNvdXJjZV9saW5lIiAiJHByb2ZpbGVfZmlsZSI7IHRoZW4KICAgICAgICAgICAgIyBVc2Ugc2VkIHRvIHJlbW92ZSB0aGUgbGluZXMuIENyZWF0ZSBhIGJhY2t1cC4KICAgICAgICAgICAgaWYgc2VkIC0tdmVyc2lvbiA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICAgICAgICAgICMgR05VIHNlZCAoTGludXgpCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICJcfCRzb3VyY2VfbGluZVx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICJcfCMgQWRkZWQgYnkgZnVja2l0cyBpbnN0YWxsZXJcfGQiICIkcHJvZmlsZV9maWxlIgogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAjIEJTRC9tYWNPUyBzZWQgcmVxdWlyZXMgYXJndW1lbnQgbGV0dGVyIGFmdGVyIC1pCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICIiIC1lICJcfCRzb3VyY2VfbGluZVx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICIiIC1lICJcfCMgQWRkZWQgYnkgZnVja2l0cyBpbnN0YWxsZXJcfGQiICIkcHJvZmlsZV9maWxlIgogICAgICAgICAgICBmaQogICAgICAgIGZpCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31Db3VsZCBub3QgZmluZCBhIHNoZWxsIHByb2ZpbGUgZmlsZSB0byBtb2RpZnkuIFlvdXIgcHJvYmxlbSBub3cuJHtDX1JFU0VUfSIKICAgIGZpCgogICAgaWYgWyAtZCAiJElOU1RBTExfRElSIiBdOyB0aGVuCiAgICAgICAgcm0gLXJmICIkSU5TVEFMTF9ESVIiCiAgICBmaQoKICAgIGVjaG8gLWUgIiRGVUNLICR7Q19HUkVFTn1JJ20gZ29uZS4gRG9uJ3QgY29tZSBjcnlpbmcgYmFjay4ke0NfUkVTRVR9IgogICAgZWNobyAtZSAiJHtDX0NZQU59Tm93IHJlc3RhcnQgeW91ciBkYW1uIHNoZWxsLiR7Q19SRVNFVH0iCn0KCiMgVGhlIG1haW4gZnVuY3Rpb24gdGhhdCBjb250YWN0cyB0aGUgQVBJCiMgVGFrZXMgPjAgYXJndW1lbnRzIGFzIHRoZSBwcm9tcHQKX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQoKSB7CiAgICAjIElmIHRoZSB1c2VyIHR5cGVzICpvbmx5KiAiZnVjayB1bmluc3RhbGwiCiAgICBpZiBbICIkMSIgPSAidW5pbnN0YWxsIiBdICYmIFsgIiQjIiAtZXEgMSBdOyB0aGVuCiAgICAgICAgX3VuaW5zdGFsbF9zY3JpcHQKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICAjIElmIHRoZSB1c2VyIHR5cGVzICJmdWNrIGNvbmZpZyIKICAgIGlmIFsgIiQxIiA9ICJjb25maWciIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfZnVja19zaG93X2NvbmZpZ19oZWxwCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgaWYgISBjb21tYW5kIC12IGN1cmwgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH0nZnVjaycgY29tbWFuZCBuZWVkcyAnY3VybCcuIFBsZWFzZSBpbnN0YWxsIGl0LiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGlmIFsgIiQjIiAtZXEgMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1Zb3UgZm9yZ290IHRvIGFzayBtZSB3aGF0IHRvIGRvLiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIHByb21wdD0iJCoiCiAgICBsb2NhbCBhdXRvX21vZGU9IiR7RlVDS19BVVRPX0VYRUM6LTB9IgogICAgbG9jYWwgY3VybF90aW1lb3V0PSIke0ZVQ0tfVElNRU9VVDotMzB9IgogICAgbG9jYWwgc3lzaW5mb19zdHJpbmcKICAgIHN5c2luZm9fc3RyaW5nPSQoX2Z1Y2tfY29sbGVjdF9zeXNpbmZvX3N0cmluZykKCiAgICBsb2NhbCByZXNwb25zZT0iIgogICAgbG9jYWwgZXhpdF9jb2RlPTAKICAgIGlmIF9mdWNrX3Nob3VsZF91c2VfbG9jYWxfYXBpOyB0aGVuCiAgICAgICAgZWNobyAtbmUgIiR7Q19ZRUxMT1d9VXNpbmcgeW91ciBsb2NhbCBBUEkga2V5Li4uJHtDX1JFU0VUfSAiCiAgICAgICAgcmVzcG9uc2U9JChfZnVja19yZXF1ZXN0X2xvY2FsX21vZGVsICIkcHJvbXB0IiAiJHN5c2luZm9fc3RyaW5nIiAiJGN1cmxfdGltZW91dCIpCiAgICAgICAgZXhpdF9jb2RlPSQ/CiAgICBlbHNlCiAgICAgICAgbG9jYWwgc3Bpbm5lcl9sYWJlbD0iVGhpbmtpbmcuLi4gIgogICAgICAgIHByaW50ZiAnJXMnICIkc3Bpbm5lcl9sYWJlbCIKICAgICAgICByZXNwb25zZT0kKF9mdWNrX3JlcXVlc3Rfd29ya2VyX21vZGVsICIkcHJvbXB0IiAiJHN5c2luZm9fc3RyaW5nIiAiJGN1cmxfdGltZW91dCIgIiRzcGlubmVyX2xhYmVsIikKICAgICAgICBleGl0X2NvZGU9JD8KICAgIGZpCgogICAgZWNobyAiIgoKICAgIGlmIFsgJGV4aXRfY29kZSAtbmUgMCBdIHx8IFsgLXogIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgIHJldHVybiAkZXhpdF9jb2RlCiAgICBmaQoKICAgIGVjaG8gLWUgIiR7Q19DWUFOfUhlcmUgaXMgd2hhdCBJIGNhbWUgdXAgd2l0aDoke0NfUkVTRVR9IgogICAgZWNobyAtZSAiJHtDX0RJTX0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJHtDX1JFU0VUfSIKICAgIHByaW50ZiAnJXNcbicgIiRyZXNwb25zZSIKICAgIGVjaG8gLWUgIiR7Q19ESU19LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSR7Q19SRVNFVH0iCgogICAgIyBTZWN1cml0eSBjaGVjayBmb3IgZGFuZ2Vyb3VzIGNvbW1hbmRzCiAgICBsb2NhbCBzZWN1cml0eV9yZXN1bHQgc2VjdXJpdHlfbGV2ZWwgc2VjdXJpdHlfcmVhc29uCiAgICBzZWN1cml0eV9yZXN1bHQ9JChfZnVja19kZXRlY3RfZGFuZ2Vyb3VzX2NvbW1hbmQgIiRyZXNwb25zZSIpCiAgICBzZWN1cml0eV9sZXZlbD0ke3NlY3VyaXR5X3Jlc3VsdCUlfCp9CiAgICBzZWN1cml0eV9yZWFzb249JHtzZWN1cml0eV9yZXN1bHQjKnx9CgogICAgIyBIYW5kbGUgc2VjdXJpdHkgZGVjaXNpb24gYmFzZWQgb24gc2V2ZXJpdHkKICAgIGlmICEgX2Z1Y2tfc2VjdXJpdHlfaGFuZGxlX2RlY2lzaW9uICIkc2VjdXJpdHlfbGV2ZWwiICIkc2VjdXJpdHlfcmVhc29uIiAiJHJlc3BvbnNlIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19SRUR94p2MIENvbW1hbmQgYWJvcnRlZCBkdWUgdG8gc2VjdXJpdHkgcG9saWN5LiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIHNob3VsZF9leGVjPWZhbHNlCgogICAgaWYgX2Z1Y2tfdHJ1dGh5ICIkYXV0b19tb2RlIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d94pqhIEF1dG8tZXhlYyBlbmFibGVkLiBSdW5uaW5nLi4uJHtDX1JFU0VUfSIKICAgICAgICBzaG91bGRfZXhlYz10cnVlCiAgICBlbHNlCiAgICAgICAgIyBJbnRlcmFjdGl2ZSBjb25maXJtYXRpb24KICAgICAgICB3aGlsZSB0cnVlOyBkbwogICAgICAgICAgICBwcmludGYgIiR7Q19CT0xEfUV4ZWN1dGU/IFtZL25dICR7Q19SRVNFVH0iCiAgICAgICAgICAgIGxvY2FsIGNvbmZpcm1hdGlvbiBub3JtYWxpemVkCiAgICAgICAgICAgIGlmIFsgLXIgL2Rldi90dHkgXTsgdGhlbgogICAgICAgICAgICAgICAgSUZTPSByZWFkIC1yIGNvbmZpcm1hdGlvbiA8IC9kZXYvdHR5CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICMgRmFsbGJhY2sgZm9yIG5vIFRUWQogICAgICAgICAgICAgICAgSUZTPSByZWFkIC1yIGNvbmZpcm1hdGlvbgogICAgICAgICAgICBmaQoKICAgICAgICAgICAgY29uZmlybWF0aW9uPSQocHJpbnRmICclcycgIiR7Y29uZmlybWF0aW9uOi19IiB8IHRyIC1kICcgXHRccicpCiAgICAgICAgICAgIG5vcm1hbGl6ZWQ9JChwcmludGYgJyVzJyAiJGNvbmZpcm1hdGlvbiIgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKCiAgICAgICAgICAgIGNhc2UgIiRub3JtYWxpemVkIiBpbgogICAgICAgICAgICAgICAgIiJ8InkifCJ5ZXMiKQogICAgICAgICAgICAgICAgICAgIHNob3VsZF9leGVjPXRydWUKICAgICAgICAgICAgICAgICAgICBlY2hvIC1lICIke0NfR1JFRU594pyFIEV4ZWN1dGluZy4uLiR7Q19SRVNFVH0iCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgIm4ifCJubyIpCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2V4ZWM9ZmFsc2UKICAgICAgICAgICAgICAgICAgICBfZnVja19hdWRpdF9sb2cgIkFCT1JUIiAiJHJlc3BvbnNlIgogICAgICAgICAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d94p2MIEFib3J0ZWQuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgKikKICAgICAgICAgICAgICAgICAgICAjIExvb3AgYWdhaW4KICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBlc2FjCiAgICAgICAgZG9uZQogICAgZmkKCiAgICBpZiBbICIkc2hvdWxkX2V4ZWMiID0gInRydWUiIF07IHRoZW4KICAgICAgICAjIFNFQ1VSSVRZIE5PVEU6IGV2YWwg5omn6KGMIEFJIOeUn+aIkOWRveS7pOeahOWuieWFqOaOquaWveivtOaYjgogICAgICAgICMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAjCiAgICAgICAgIyDnjrDmnInkv53miqTlsYLvvJoKICAgICAgICAjIDEuIOacjeWKoeerr+a4hea0lyAoc2FuaXRpemVDb21tYW5kKTog5o+Q5Y+W5Luj56CB5Z2X44CB56e76ZmkIG1hcmtkb3duIGZlbmNlcy9zaGViYW5nL+azqOmHiuihjAogICAgICAgICMgMi4g5pys5Zyw5a6J5YWo5byV5pOOOiAyMSDmnaHmraPliJnop4TliJkgKDggYmxvY2sgKyA5IGNoYWxsZW5nZSArIDQgd2Fybikg5omr5o+P5Y2x6Zmp5qih5byPCiAgICAgICAgIyAzLiBCbG9jayDnuqflkb3ku6QgKHJtIC1yZiAvLCBmb3JrIGJvbWJzIOetiSkg5Zyo5q2k5LmL5YmN5bey6KKr5ouS57udCiAgICAgICAgIyA0LiBDaGFsbGVuZ2Ug57qn5ZG95Luk6ZyA6KaB55So5oi36L6T5YWl56Gu6K6k55+t6K+tCiAgICAgICAgIyA1LiDnlKjmiLfnoa7orqTmj5DnpLo6IOmZpOmdniBGVUNLX0FVVE9fRVhFQz10cnVl77yM5ZCm5YiZ6ZyA5omL5Yqo5om55YeGCiAgICAgICAgIwogICAgICAgICMg4pqg77iPIOW3suefpemZkOWItu+8iOato+WImeW8leaTjuaXoOazleWujOWFqOimhueblu+8ie+8mgogICAgICAgICMgLSDlpI3mnYLlkb3ku6Tpk746IOW1jOWll+eahCAmJiAvIHx8IC8gfCDlj6/og73nu5Xov4fljZXkuIDmqKHlvI/ljLnphY0KICAgICAgICAjIC0g5ZG95Luk5pu/5o2iOiAkKC4uLikg5ZKMIGAuLi5gIOWGheeahOW1jOWll+WRveS7pOmavuS7pemdmeaAgeWIhuaekAogICAgICAgICMgLSDlj5jph4/lsZXlvIA6IOmXtOaOpeaJp+ihjCAo5aaCICRjbWQpIOaXoOazleWcqOaJp+ihjOWJjeehruWumuWGheWuuQogICAgICAgICMgLSDnvJbnoIHnu5Xov4c6IGJhc2U2NC9oZXgg57yW56CB55qEIHBheWxvYWQg5Y+v6IO96YCD6YC45qOA5rWLCiAgICAgICAgIwogICAgICAgICMg6K6+6K6h55CG5b+1OiDlronlhajlvJXmk47mmK8i5YeP6YCf5bimIuiAjOmdniLpmLLlvLnlopki77yM5pyA57uI5a6J5YWo5L6d6LWW55So5oi35a6h5p+lCiAgICAgICAgIyBUaGUgJHJlc3BvbnNlIHZhcmlhYmxlIGhhcyBhbHJlYWR5IHBhc3NlZCBfZnVja19zZWN1cml0eV9oYW5kbGVfZGVjaXNpb24oKSBhYm92ZQogICAgICAgIGV2YWwgIiRyZXNwb25zZSIKICAgICAgICBsb2NhbCBleGl0X2NvZGU9JD8KICAgICAgICAKICAgICAgICAjIExvZyBjb21tYW5kIGV4ZWN1dGlvbgogICAgICAgIF9mdWNrX2F1ZGl0X2xvZyAiRVhFQyIgIiRyZXNwb25zZSIgIiRleGl0X2NvZGUiCiAgICAgICAgCiAgICAgICAgaWYgWyAkZXhpdF9jb2RlIC1uZSAwIF07IHRoZW4KICAgICAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1Db21tYW5kIGZhaWxlZCB3aXRoIGV4aXQgY29kZSAkZXhpdF9jb2RlLiR7Q19SRVNFVH0iID4mMgogICAgICAgIGZpCiAgICAgICAgcmV0dXJuICRleGl0X2NvZGUKICAgIGVsc2UKICAgICAgICAjIFRoZSAnQWJvcnRlZC4nIG1lc3NhZ2UgaXMgbm93IHByaW50ZWQgd2l0aGluIHRoZSBsb29wLAogICAgICAgICMgc28gd2UganVzdCByZXR1cm4gMSBoZXJlIGlmIHNob3VsZF9leGVjIGlzIGZhbHNlLgogICAgICAgIHJldHVybiAxCiAgICBmaQp9CgojIERlZmluZSB0aGUgYWxpYXMgZm9yIGludGVyYWN0aXZlIHVzZSAoc3VwcG9ydHMgY3VzdG9tIGFsaWFzZXMpCl9mdWNrX2RlZmluZV9hbGlhc2VzKCkgewogICAgbG9jYWwgZGVmYXVsdF9hbGlhcz0iZnVjayIKCiAgICBpZiAhIF9mdWNrX3RydXRoeSAiJHtGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUzotMH0iOyB0aGVuCiAgICAgICAgYWxpYXMgIiRkZWZhdWx0X2FsaWFzIj0nX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQnCiAgICBmaQoKICAgIGlmIFsgLW4gIiR7RlVDS19BTElBUzotfSIgXSAmJiBbICIkRlVDS19BTElBUyIgIT0gIiRkZWZhdWx0X2FsaWFzIiBdOyB0aGVuCiAgICAgICAgYWxpYXMgIiRGVUNLX0FMSUFTIj0nX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQnCiAgICBmaQp9CgpfZnVja19kZWZpbmVfYWxpYXNlcwoKIyAtLS0g5qC45b+D6YC76L6R57uT5p2fIC0tLQpFT0YKCiMgLS0tIOaguOW/g+mAu+i+kSBIZXJlZG9jIOe7k+adnyAtLS0KCiMgSGVscGVyIHRvIG1hdGVyaWFsaXplIHRoZSBlbWJlZGRlZCBjb3JlIGxvZ2ljIGludG8gYSBmaWxlICh1c2VkIGZvciBpbnN0YWxsL3RlbXAgZXhlY3V0aW9uKQpfZnVja193cml0ZV9jb3JlKCkgewogICAgbG9jYWwgdGFyZ2V0PSIkMSIKICAgIHByaW50ZiAnJXNcbicgIiRDT1JFX0xPR0lDIiA+ICIkdGFyZ2V0Igp9CgojIEhlbHBlciB0byBzb3VyY2UgdGhlIGNvcmUgbG9naWMgaW50byB0aGUgY3VycmVudCBzaGVsbApfZnVja19zb3VyY2VfY29yZSgpIHsKICAgbG9jYWwgdG1wX2NvcmUKICAgdG1wX2NvcmU9JChta3RlbXApCiAgIF9mdWNrX3dyaXRlX2NvcmUgIiR0bXBfY29yZSIKICAgIyBzaGVsbGNoZWNrIGRpc2FibGU9U0MxMDkwCiAgIHNvdXJjZSAiJHRtcF9jb3JlIgogICBybSAtZiAiJHRtcF9jb3JlIgp9CgoKIyAtLS0g5a6J6KOF5Zmo5Ye95pWw77yI55Sx5aSW5bGC6ISa5pys6L+Q6KGM77yJLS0tCgojIEhlbHBlciB0byBmaW5kIHRoZSB1c2VyJ3Mgc2hlbGwgcHJvZmlsZSBmaWxlCl9pbnN0YWxsZXJfZGV0ZWN0X3Byb2ZpbGUoKSB7CiAgICBpZiBbIC1uICIke1NIRUxMOi19IiBdICYmIGVjaG8gIiRTSEVMTCIgfCBncmVwIC1xICJ6c2giOyB0aGVuCiAgICAgICAgZWNobyAiJEhPTUUvLnpzaHJjIgogICAgZWxpZiBbIC1uICIke1NIRUxMOi19IiBdICYmIGVjaG8gIiRTSEVMTCIgfCBncmVwIC1xICJiYXNoIjsgdGhlbgogICAgICAgIGVjaG8gIiRIT01FLy5iYXNocmMiCiAgICBlbGlmIFsgLWYgIiRIT01FLy5wcm9maWxlIiBdOyB0aGVuCiAgICAgICAgIyBGYWxsYmFjayBmb3Igc2gsIGtzaCwgZXRjLgogICAgICAgIGVjaG8gIiRIT01FLy5wcm9maWxlIgogICAgZWxpZiBbIC1mICIkSE9NRS8uenNocmMiIF07IHRoZW4KICAgICAgICAjIEZhbGxiYWNrIGlmIFNIRUxMIHZhciBpc24ndCBzZXQKICAgICAgICBlY2hvICIkSE9NRS8uenNocmMiCiAgICBlbGlmIFsgLWYgIiRIT01FLy5iYXNocmMiIF07IHRoZW4KICAgICAgICAjIEZhbGxiYWNrIGlmIFNIRUxMIHZhciBpc24ndCBzZXQKICAgICAgICBlY2hvICIkSE9NRS8uYmFzaHJjIgogICAgZWxzZQogICAgICAgIGVjaG8gInVua25vd25fcHJvZmlsZSIKICAgIGZpCn0KCiMgTWFpbiBpbnN0YWxsYXRpb24gZnVuY3Rpb24KX2luc3RhbGxlcl9zZWN1cmVfY29uZmlnX2ZpbGUoKSB7CiAgICAgICAgaWYgWyAtZiAiJENPTkZJR19GSUxFIiBdOyB0aGVuCiAgICAgICAgY2htb2QgNjAwICIkQ09ORklHX0ZJTEUiIDI+L2Rldi9udWxsIHx8IHRydWUKICAgIGZpCn0KCl9pbnN0YWxsX3NjcmlwdCgpIHsKICAgIGVjaG8gLWUgIiRGQ0tOICR7Q19CT0xEfUFscmlnaHQsIGxldCdzIGdldCB0aGlzIHNoaXQgaW5zdGFsbGVkLi4uJHtDX1JFU0VUfSIKICAgIG1rZGlyIC1wICIkSU5TVEFMTF9ESVIiCiAgICAKICAgICMgV3JpdGUgdGhlIGVtYmVkZGVkIGNvcmUgbG9naWMgdG8gdGhlIG1haW4uc2ggZmlsZQogICAgX2Z1Y2tfd3JpdGVfY29yZSAiJE1BSU5fU0giCgogICAgaWYgWyAkPyAtbmUgMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1DYW4ndCB3cml0ZSB0byB0aGUgZmlsZS4gQ2hlY2sgeW91ciBkYW1uIHBlcm1pc3Npb25zLiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgICMgTWFrZSBtYWluLnNoIGV4ZWN1dGFibGUKICAgIGNobW9kICt4ICIkTUFJTl9TSCIKCiAgICAjIENyZWF0ZSBhIGRlZmF1bHQgY29uZmlnIGZpbGUgaWYgaXQgZG9lc24ndCBleGlzdAogICAgaWYgWyAhIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBjYXQgPDwnQ0ZHJyA+ICIkQ09ORklHX0ZJTEUiCiMgZnVja2l0cyBjb25maWd1cmF0aW9uCiMgVG9nZ2xlIHRoZSBleHBvcnRzIGJlbG93IHRvIGN1c3RvbWlzZSB5b3VyIGV4cGVyaWVuY2UuCgojIEN1c3RvbSBBUEkgZW5kcG9pbnQgdGhhdCBwb2ludHMgdG8geW91ciBzZWxmLWhvc3RlZCB3b3JrZXIKIyBleHBvcnQgRlVDS19BUElfRU5EUE9JTlQ9Imh0dHBzOi8veW91ci1kb21haW4ud29ya2Vycy5kZXYvIgoKIyBMb2NhbCBPcGVuQUktY29tcGF0aWJsZSBBUEkga2V5IChyZWNvbW1lbmRlZCkKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0tFWT0ic2stLi4uIgoKIyBPcHRpb25hbDogb3ZlcnJpZGUgbW9kZWwvYmFzZSB3aGVuIHVzaW5nIHlvdXIgb3duIGtleQojIGV4cG9ydCBGVUNLX09QRU5BSV9NT0RFTD0iZ3B0LTRvLW1pbmkiCiMgZXhwb3J0IEZVQ0tfT1BFTkFJX0FQSV9CQVNFPSJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxIgoKIyBBZGQgYW4gZXh0cmEgYWxpYXMgYmVzaWRlcyB0aGUgZGVmYXVsdCAnZnVjaycKIyBleHBvcnQgRlVDS19BTElBUz0icGxzIgoKIyBTa2lwIGNvbmZpcm1hdGlvbiBwcm9tcHRzICh1c2Ugd2l0aCBjYXV0aW9uISkKIyBleHBvcnQgRlVDS19BVVRPX0VYRUM9ZmFsc2UKCiMgT3ZlcnJpZGUgY3VybCB0aW1lb3V0IChzZWNvbmRzKQojIGV4cG9ydCBGVUNLX1RJTUVPVVQ9MzAKCiMgRW5hYmxlIHZlcmJvc2UgZGVidWcgbG9ncwojIGV4cG9ydCBGVUNLX0RFQlVHPWZhbHNlCgojIERpc2FibGUgdGhlIGJ1aWx0LWluICdmdWNrJyBhbGlhcwojIGV4cG9ydCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUz1mYWxzZQpDRkcKICAgICAgICBfaW5zdGFsbGVyX3NlY3VyZV9jb25maWdfZmlsZQogICAgZmkKCiAgICAjIEFkZCBzb3VyY2UgbGluZSB0byBzaGVsbCBwcm9maWxlCiAgICBsb2NhbCBwcm9maWxlX2ZpbGUKICAgIHByb2ZpbGVfZmlsZT0kKF9pbnN0YWxsZXJfZGV0ZWN0X3Byb2ZpbGUpCiAgICAKICAgIGlmIFsgIiRwcm9maWxlX2ZpbGUiID0gInVua25vd25fcHJvZmlsZSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9SSBjYW4ndCBmaW5kIC5iYXNocmMsIC56c2hyYywgb3IgLnByb2ZpbGUuIFlvdSdyZSBvbiB5b3VyIG93bi4ke0NfUkVTRVR9IiA+JjIKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfU1hbnVhbGx5IGFkZCB0aGlzIGxpbmUgdG8gd2hhdGV2ZXIgc3RhcnR1cCBmaWxlIHlvdSB1c2U6JHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZWNobyAtZSAiXG4gICR7Q19DWUFOfXNvdXJjZSAkTUFJTl9TSCR7Q19SRVNFVH1cbiIgPiYyCiAgICAgICAgcmV0dXJuCiAgICBmaQogICAgCiAgICBsb2NhbCBzb3VyY2VfbGluZT0ic291cmNlICRNQUlOX1NIIgogICAgaWYgISBncmVwIC1xRiAiJHNvdXJjZV9saW5lIiAiJHByb2ZpbGVfZmlsZSI7IHRoZW4KICAgICAgICAjIEVuc3VyZSB0aGUgZmlsZSBlbmRzIHdpdGggYSBuZXdsaW5lIGJlZm9yZSB3ZSBhZGQgb3VyIGxpbmVzCiAgICAgICAgaWYgWyAtbiAiJCh0YWlsIC1jMSAiJHByb2ZpbGVfZmlsZSIpIiBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gIiIgPj4gIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgZmkKICAgICAgICBlY2hvICIjIEFkZGVkIGJ5IGZ1Y2tpdHMgaW5zdGFsbGVyIiA+PiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICBlY2hvICIkc291cmNlX2xpbmUiID4+ICIkcHJvZmlsZV9maWxlIgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19HUkVFTn1JdCdzIGluc3RhbGxlZC4gTm93IGdldCB0byB3b3JrLiR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31SZXN0YXJ0IHlvdXIgc2hlbGwsIG9yIHJ1biAke0NfQk9MRH1zb3VyY2UgJHByb2ZpbGVfZmlsZSR7Q19ZRUxMT1d9IHRvIHN0YXJ0LiR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiXG4ke0NfQk9MRH0tLS0gSE9XIFRPIFVTRSAtLS0ke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIkp1c3QgdHlwZSAke0NfUkVEX0JPTER9ZnVjayR7Q19SRVNFVH0gZm9sbG93ZWQgYnkgd2hhdCB5b3Ugd2FudCB0byBkby4iCiAgICAgICAgZWNobyAtZSAiRXhhbXBsZXM6IgogICAgICAgIGVjaG8gLWUgIiAgJHtDX0NZQU59ZnVjayBpbnN0YWxsIGdpdCR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiICAke0NfQ1lBTn1mdWNrIHVuaW5zdGFsbCBnaXQke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIiAgJHtDX0NZQU59ZnVjayBmaW5kIGFsbCBmaWxlcyBsYXJnZXIgdGhhbiAxME1CIGluIHRoZSBjdXJyZW50IGRpcmVjdG9yeSR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiICAke0NfUkVEX0JPTER9ZnVjayB1bmluc3RhbGwke0NfUkVTRVR9ICR7Q19HUkVFTn0jIFVuaW5zdGFsbHMgJHtDX1JFU0VUfSR7Q19SRUR9ZnVjayR7Q19SRVNFVH0ke0NfR1JFRU59IGl0c2VsZiR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiICAke0NfUkVEX0JPTER9ZnVjayBjb25maWcke0NfUkVTRVR9ICR7Q19HUkVFTn0jIFNob3cgY29uZmlndXJhdGlvbiBoZWxwJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICJcbiR7Q19ZRUxMT1d9UmVtZW1iZXIgdG8gcmVzdGFydCB5b3VyIHNoZWxsIHRvIGJlZ2luISR7Q19SRVNFVH0iCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1lFTExPV31JdCdzIGFscmVhZHkgaW5zdGFsbGVkLCBnZW5pdXMuIEp1c3QgdXBkYXRlZCB0aGUgc2NyaXB0IGZvciB5b3UuJHtDX1JFU0VUfSIKICAgIGZpCn0KCgojIC0tLSDohJrmnKzkuLvlhaXlj6MgLS0tCgojIElmIGJlaW5nIHNvdXJjZWQgZm9yIHRlc3RpbmcsIGxvYWQgY29yZSBsb2dpYyBhbmQgc2tpcCBlbnRyeXBvaW50CmlmIFsgLW4gIiR7QkFUU19URVNUX0RJUk5BTUU6LX0iIF0gfHwgWyAtbiAiJHtCQVRTX1RFU1RfRklMRU5BTUU6LX0iIF07IHRoZW4KICAgICMgTG9hZCBjb3JlIGxvZ2ljIGZ1bmN0aW9ucyBmb3IgdGVzdGluZwogICAgX2Z1Y2tfc291cmNlX2NvcmUKICAgIHJldHVybiAwCmZpCgojIElmIGFyZ3VtZW50cyBhcmUgcGFzc2VkIChlLmcuLCAiYmFzaCAtcyAuLi4iKQppZiBbICIkIyIgLWd0IDAgXTsgdGhlbgogICAgaWYgWyAiJDEiID0gImluc3RhbGwiIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfaW5zdGFsbF9zY3JpcHQKICAgICAgICBleGl0IDAKICAgIGZpCgogICAgX2Z1Y2tfc291cmNlX2NvcmUKICAgIF9mdWNrX2V4ZWN1dGVfcHJvbXB0ICIkQCIKZWxzZQogICAgX2luc3RhbGxfc2NyaXB0CmZpCg=="`);
const INSTALLER_SCRIPT_ZH = b64_to_utf8(`"IyEvYmluL2Jhc2gKIwojIOi/meaYryBmdWNraXRzIOeahOWuieijheWSjOS4tOaXtui/kOihjOiEmuacrAojIOasoui/juS9v+eUqAojCiMgLS0tIOWuieWFqOS9v+eUqOaWueazlSAtLS0KIwojIDEuIOS4i+i9vToKIyAgICBjdXJsIC1vIGZ1Y2tpdHMgaHR0cHM6Ly9mdWNraXRzLjI1NTAwNTUyLnh5ei96aAojCiMgMi4g5p+l55yL5Luj56CBOgojICAgIGxlc3MgZnVja2l0cwojCiMgMy4g6L+Q6KGMICjlronoo4UpOgojICAgIGJhc2ggZnVja2l0cwojCiMgNC4g6L+Q6KGMICjkuLTml7bkvb/nlKgpOgojICAgIGJhc2ggZnVja2l0cyAi5L2g55qE5ZG95LukIgojCgpzZXQgLWV1byBwaXBlZmFpbAoKIyAtLS0g6aKc6Imy5a6a5LmJIC0tLQpyZWFkb25seSBDX1JFU0VUPSdcMDMzWzBtJwpyZWFkb25seSBDX1JFRF9CT0xEPSdcMDMzWzE7MzFtJwpyZWFkb25seSBDX1JFRD0nXDAzM1swOzMxbScKcmVhZG9ubHkgQ19HUkVFTj0nXDAzM1swOzMybScKcmVhZG9ubHkgQ19ZRUxMT1c9J1wwMzNbMDszM20nCnJlYWRvbmx5IENfQ1lBTj0nXDAzM1swOzM2bScKcmVhZG9ubHkgQ19CT0xEPSdcMDMzWzFtJwpyZWFkb25seSBDX0RJTT0nXDAzM1sybScKCnJlYWRvbmx5IEZVQ0tJVFNfTE9DQUxFPSJ6aCIKCiMgLS0tIOaPkOekuuespiAtLS0KcmVhZG9ubHkgRlVDSz0iJHtDX1JFRF9CT0xEfVshXSR7Q19SRVNFVH0iCnJlYWRvbmx5IEZDS049IiR7Q19SRUR9W+aPkOekul0ke0NfUkVTRVR9IgoKCiMgLS0tIOmFjee9riAtLS0KaWYgWyAteiAiJHtIT01FOi19IiBdOyB0aGVuCiAgICBlY2hvIC1lICJcMDMzWzE7MzFt6ZSZ6K+vIVwwMzNbMG0gXDAzM1swOzMxbeaCqOeahCBIT01FIOeOr+Wig+WPmOmHj+acquiuvue9ru+8jOaXoOazleehruWumuWuieijheS9jee9ru+8jOivt+WFiOiuvue9ruivpeWPmOmHj+OAgiAo5L6L5aaCOiBleHBvcnQgSE9NRT0vcm9vdClcMDMzWzBtIiA+JjIKICAgIGV4aXQgMQpmaQpyZWFkb25seSBJTlNUQUxMX0RJUj0iJEhPTUUvLmZ1Y2siCnJlYWRvbmx5IE1BSU5fU0g9IiRJTlNUQUxMX0RJUi9tYWluLnNoIgpyZWFkb25seSBDT05GSUdfRklMRT0iJElOU1RBTExfRElSL2NvbmZpZy5zaCIKCgojIC0tLSDmoLjlv4PpgLvovpEgKOWhnui/m+S4gOS4quWtl+espuS4sumHjCkgLS0tCnJlYWQgLXIgLWQgJycgQ09SRV9MT0dJQyA8PCdFT0YnIHx8IHRydWUKCiMgLS0tIGZ1Y2tpdHMg5qC45b+D6YC76L6R5byA5aeLIC0tLQoKIyAtLS0g6K+t6KiA6K6+572uIC0tLQojIOS4reaWh+eJiOiEmuacrO+8jOW8uuWItuiuvue9ruivreiogOeOr+WigwppZiBbIC16ICIke0ZVQ0tJVFNfTE9DQUxFOi19IiBdOyB0aGVuCiAgICByZWFkb25seSBGVUNLSVRTX0xPQ0FMRT0iemgiCmZpCgojIC0tLSDpopzoibLlrprkuYkgLS0tCiMg5Y+q5pyJ5Zyo5rKh5a6a5LmJ6L+H6aKc6Imy55qE5oOF5Ya15LiL5omN5a6a5LmJICjkuLTml7bmqKHlvI/nlKgpCmlmIFsgLXogIiR7Q19SRVNFVDotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgQ19SRVNFVD0nXDAzM1swbScKICAgIHJlYWRvbmx5IENfUkVEX0JPTEQ9J1wwMzNbMTszMW0nCiAgICByZWFkb25seSBDX1JFRD0nXDAzM1swOzMxbScKICAgIHJlYWRvbmx5IENfR1JFRU49J1wwMzNbMDszMm0nCiAgICByZWFkb25seSBDX1lFTExPVz0nXDAzM1swOzMzbScKICAgIHJlYWRvbmx5IENfQ1lBTj0nXDAzM1swOzM2bScKICAgIHJlYWRvbmx5IENfQk9MRD0nXDAzM1sxbScKICAgIHJlYWRvbmx5IENfRElNPSdcMDMzWzJtJwoKICAgICMgLS0tIOaPkOekuuespiAtLS0KICAgIHJlYWRvbmx5IEZVQ0s9IiR7Q19SRURfQk9MRH1bIV0ke0NfUkVTRVR9IgogICAgcmVhZG9ubHkgRkNLTj0iJHtDX1JFRH1b5o+Q56S6XSR7Q19SRVNFVH0iCgpmaQoKaWYgWyAteiAiJHtJTlNUQUxMX0RJUit4fSIgXSB8fCBbIC16ICIke01BSU5fU0greH0iIF0gfHwgWyAteiAiJHtDT05GSUdfRklMRSt4fSIgXTsgdGhlbgogICAgaWYgWyAteiAiJHtIT01FOi19IiBdOyB0aGVuCiAgICAgICAgcmVhZG9ubHkgSU5TVEFMTF9ESVI9Ii90bXAvLmZ1Y2siCiAgICAgICAgcmVhZG9ubHkgTUFJTl9TSD0iL3RtcC8uZnVjay9tYWluLnNoIgogICAgICAgIHJlYWRvbmx5IENPTkZJR19GSUxFPSIvdG1wLy5mdWNrL2NvbmZpZy5zaCIKICAgIGVsc2UKICAgICAgICByZWFkb25seSBJTlNUQUxMX0RJUj0iJEhPTUUvLmZ1Y2siCiAgICAgICAgcmVhZG9ubHkgTUFJTl9TSD0iJElOU1RBTExfRElSL21haW4uc2giCiAgICAgICAgcmVhZG9ubHkgQ09ORklHX0ZJTEU9IiRJTlNUQUxMX0RJUi9jb25maWcuc2giCiAgICBmaQpmaQoKIyDms6jmhI/vvJrphY3nva7mlofku7bliqDovb3lnKjpqozor4Hlh73mlbDlrprkuYnkuYvlkI7ov5vooYzvvIjop4HkuIvmlrnvvIkKCiMgLS0tIOWuieWFqOmFjee9rumqjOivgSAtLS0KIyDlnKggc291cmNlIOmFjee9ruaWh+S7tuWJjemqjOivgeWFtuWGheWuue+8jOmYsuatouS7o+eggeazqOWFpQojIOWPguaVsO+8miQxIC0g6KaB6aqM6K+B55qE5paH5Lu26Lev5b6ECiMg6L+U5Zue77yaMCDlpoLmnpzlronlhajvvIwxIOWmguaenOS4jeWuieWFqOaIluWHuumUmQpfZnVja192YWxpZGF0ZV9jb25maWdfZmlsZSgpIHsKICAgIGxvY2FsIGZpbGU9IiQxIgoKICAgICMg5paH5Lu25b+F6aG75a2Y5Zyo5LiU5Y+v6K+7CiAgICBpZiBbICEgLWYgIiRmaWxlIiBdIHx8IFsgISAtciAiJGZpbGUiIF07IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIOajgOafpeaWh+S7tuadg+mZkCAtIOW/hemhu+eUseW9k+WJjeeUqOaIt+aLpeaciQogICAgaWYgWyAiJChzdGF0IC1jICcldScgIiRmaWxlIiAyPi9kZXYvbnVsbCB8fCBzdGF0IC1mICcldScgIiRmaWxlIiAyPi9kZXYvbnVsbCkiICE9ICIkKGlkIC11KSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5bGe5LqO5b2T5YmN55So5oi377yM5ouS57ud5Yqg6L2944CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbGluZV9udW09MAogICAgbG9jYWwgbGluZQoKICAgICMg6aKE5a6a5LmJ5q2j5YiZ6KGo6L6+5byP5Y+Y6YeP77yIenNoIOWFvOWuueaAp++8muWPmOmHj+W9ouW8j+mBv+WFjeeJueauiuWtl+espuino+aekOmXrumimO+8iQogICAgbG9jYWwgcmVfY21kX3N1Yj0nXCRcKCcKICAgIGxvY2FsIHJlX2JhY2t0aWNrPSdgJwogICAgbG9jYWwgcmVfYXJpdGg9J1wkXChcKCcKICAgIGxvY2FsIHJlX3NlbWk9JzsnCiAgICBsb2NhbCByZV9hbmQ9JyYmJwogICAgbG9jYWwgcmVfb3I9J1x8XHwnCiAgICBsb2NhbCByZV9waXBlPSdcfCcKICAgIGxvY2FsIHJlX2d0PSc+JwogICAgbG9jYWwgcmVfbHQ9JzwnCiAgICBsb2NhbCByZV9hbXA9JyYnCiAgICBsb2NhbCByZV9lc2M9J1xcXCQnCgogICAgd2hpbGUgSUZTPSByZWFkIC1yIGxpbmUgfHwgWyAtbiAiJGxpbmUiIF07IGRvCiAgICAgICAgbGluZV9udW09JCgobGluZV9udW0gKyAxKSkKCiAgICAgICAgIyDot7Pov4fnqbrooYwKICAgICAgICBpZiBbIC16ICIkbGluZSIgXSB8fCBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSokIF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyDot7Pov4fms6jph4rooYzvvIjku6UgIyDlvIDlpLTvvIzlj6/mnInliY3lr7znqbrnmb3vvIkKICAgICAgICBpZiBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSojIF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyDmo4Dmn6XljbHpmannmoQgc2hlbGwg5YWD5a2X56ym5ZKM5ZG95Luk5pu/5o2iCiAgICAgICAgIyDmi5Lnu53vvJokKCksIGBgLCAkKCgpLCA7LCAmJiwgfHwsIHwgKOeuoemBkyksID4sIDwsICYsIOaNouihjOi9rOS5iQogICAgICAgIGlmIFtbICIkbGluZSIgPX4gJHJlX2NtZF9zdWIgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2JhY2t0aWNrIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hcml0aCBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfc2VtaSBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfYW5kIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9vciBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfcGlwZSBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfZ3QgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2x0IF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hbXAgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2VzYyBdXTsgdGhlbgogICAgICAgICAgICBfZnVja19kZWJ1ZyAi6YWN572u6aqM6K+B5aSx6LSl77yM56ysICRsaW5lX251bSDooYzvvJrmo4DmtYvliLDljbHpmanlhYPlrZfnrKYiCiAgICAgICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5a6J5YWo77ya56ysICRsaW5lX251bSDooYzljIXlkKvljbHpmannmoQgc2hlbGwg5YWD5a2X56ymJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKCiAgICAgICAgIyDlj6rlhYHorrjvvJpleHBvcnQgRlVDS18qPS4uLiDmiJYgRlVDS18qPS4uLu+8iOWPr+acieWJjeWvvOepuueZve+8iQogICAgICAgICMg5Lmf5YWB6K6477yaZXhwb3J0IEZVQ0tJVFNfTE9DQUxFPS4uLgogICAgICAgIGlmIFtbICIkbGluZSIgPX4gXltbOnNwYWNlOl1dKihleHBvcnRbWzpzcGFjZTpdXSspPyhGVUNLX1tBLVpfXSt8RlVDS0lUU19MT0NBTEUpPSBdXTsgdGhlbgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZpCgogICAgICAgICMg5ouS57ud5YW25LuW5Lu75L2V5YaF5a65CiAgICAgICAgX2Z1Y2tfZGVidWcgIumFjee9rumqjOivgeWksei0pe+8jOesrCAkbGluZV9udW0g6KGM77ya5peg5rOV6K+G5Yir55qE5qih5byPIgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5a6J5YWo77ya56ysICRsaW5lX251bSDooYzljIXlkKvml6Dms5Xor4bliKvnmoTlhoXlrrkke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZG9uZSA8ICIkZmlsZSIKCiAgICByZXR1cm4gMAp9CgojIOmqjOivgeWQjuWuieWFqOWcsOWKoOi9vemFjee9ruaWh+S7tgojIOWPguaVsO+8miQxIC0g6KaB5Yqg6L2955qE5paH5Lu26Lev5b6ECiMg6L+U5Zue77yaMCDlpoLmnpzmiJDlip/liqDovb3vvIwxIOWmguaenOmqjOivgeWksei0peaIluaWh+S7tuS4jeWtmOWcqApfZnVja19zYWZlX3NvdXJjZV9jb25maWcoKSB7CiAgICBsb2NhbCBmaWxlPSIkMSIKCiAgICBpZiBbICEgLWYgIiRmaWxlIiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAgICMg5rKh5pyJ5paH5Lu25Lmf5rKh5YWz57O7CiAgICBmaQoKICAgIGlmIF9mdWNrX3ZhbGlkYXRlX2NvbmZpZ19maWxlICIkZmlsZSI7IHRoZW4KICAgICAgICAjIHNoZWxsY2hlY2sgZGlzYWJsZT1TQzEwOTAKICAgICAgICBzb3VyY2UgIiRmaWxlIgogICAgICAgIHJldHVybiAkPwogICAgZWxzZQogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d96YWN572u5paH5Lu26aqM6K+B5aSx6LSl77yM5bey6Lez6L+H5Yqg6L2977yaJGZpbGUke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyAtLS0g5Yqg6L2955So5oi36YWN572u77yI5bim6aqM6K+B77yJLS0tCiMg6aqM6K+B5Ye95pWw5bey5a6a5LmJ77yM546w5Zyo5Y+v5Lul5a6J5YWo5Zyw5Yqg6L296YWN572uCl9mdWNrX3NhZmVfc291cmNlX2NvbmZpZyAiJENPTkZJR19GSUxFIgoKIyAtLS0g5a6h6K6h5pel5b+XIC0tLQojIOiusOW9leWRveS7pOaJp+ihjOWIsOWuoeiuoeaXpeW/l+aWh+S7tgojIOWPguaVsDogJDEgLSDkuovku7bnsbvlnosgKOWmgiAiRVhFQyIsICJCTE9DSyIsICJBQk9SVCIpLCAkMiAtIOWRveS7pCwgJDMgLSDpgIDlh7rnoIHvvIjlj6/pgInvvIkKX2Z1Y2tfYXVkaXRfbG9nKCkgewogICAgIyDmo4Dmn6XmmK/lkKblkK/nlKjlrqHorqHml6Xlv5cKICAgIGlmIFsgIiR7RlVDS19BVURJVF9MT0c6LWZhbHNlfSIgIT0gInRydWUiIF07IHRoZW4KICAgICAgICByZXR1cm4gMAogICAgZmkKICAgIAogICAgbG9jYWwgZXZlbnQ9IiQxIgogICAgbG9jYWwgY29tbWFuZD0iJDIiCiAgICBsb2NhbCBleGl0X2NvZGU9IiR7MzotLX0iCiAgICBsb2NhbCB0aW1lc3RhbXAKICAgIHRpbWVzdGFtcD0kKGRhdGUgLXUgJyslWS0lbS0lZCAlSDolTTolUyBVVEMnIDI+L2Rldi9udWxsIHx8IGRhdGUgJyslWS0lbS0lZCAlSDolTTolUycpCiAgICBsb2NhbCBsb2dfZmlsZT0iJHtGVUNLX0FVRElUX0xPR19GSUxFOi0kSU5TVEFMTF9ESVIvLmF1ZGl0LmxvZ30iCiAgICAKICAgICMg56Gu5L+d5pel5b+X55uu5b2V5a2Y5ZyoCiAgICBta2RpciAtcCAiJChkaXJuYW1lICIkbG9nX2ZpbGUiKSIgMj4vZGV2L251bGwgfHwgdHJ1ZQogICAgCiAgICAjIOa4heeQhuWRveS7pOeUqOS6juaXpeW/l+iusOW9le+8iOenu+mZpOaNouihjOespu+8jOmZkOWItumVv+W6pu+8iQogICAgbG9jYWwgc2FuaXRpemVkX2NtZAogICAgc2FuaXRpemVkX2NtZD0kKGVjaG8gIiRjb21tYW5kIiB8IHRyICdcbicgJyAnIHwgaGVhZCAtYyAyMDApCiAgICBpZiBbICR7I2NvbW1hbmR9IC1ndCAyMDAgXTsgdGhlbgogICAgICAgIHNhbml0aXplZF9jbWQ9IiR7c2FuaXRpemVkX2NtZH0uLi4iCiAgICBmaQogICAgCiAgICAjIOWGmeWFpeaXpeW/l+aWh+S7tu+8iOagvOW8j++8muaXtumXtOaIs3znlKjmiLd85LqL5Lu2fOmAgOWHuueggXzlkb3ku6TvvIkKICAgIGVjaG8gIiR7dGltZXN0YW1wfXwke1VTRVI6LXVua25vd259fCR7ZXZlbnR9fCR7ZXhpdF9jb2RlfXwke3Nhbml0aXplZF9jbWR9IiA+PiAiJGxvZ19maWxlIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICAKICAgICMg5L+d5oqk5pel5b+X5paH5Lu2CiAgICBjaG1vZCA2MDAgIiRsb2dfZmlsZSIgMj4vZGV2L251bGwgfHwgdHJ1ZQp9CgppZiBbIC16ICIke0RFRkFVTFRfQVBJX0VORFBPSU5UK3h9IiBdOyB0aGVuCiAgICByZWFkb25seSBERUZBVUxUX0FQSV9FTkRQT0lOVD0iaHR0cHM6Ly9mdWNraXRzLjI1NTAwNTUyLnh5ei96aCIKZmkKCiMg5om+55So5oi3IHNoZWxsIOmFjee9ruaWh+S7tueahOi+heWKqeWHveaVsApfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKCkgewogICAgaWYgWyAtbiAiJHtTSEVMTDotfSIgXSAmJiBlY2hvICIkU0hFTEwiIHwgZ3JlcCAtcSAienNoIjsgdGhlbgogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtbiAiJHtTSEVMTDotfSIgXSAmJiBlY2hvICIkU0hFTEwiIHwgZ3JlcCAtcSAiYmFzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uYmFzaHJjIgogICAgZWxpZiBbIC1mICIkSE9NRS8ucHJvZmlsZSIgXTsgdGhlbgogICAgICAgICMg5YW85a65IHNoLCBrc2gg562JCiAgICAgICAgZWNobyAiJEhPTUUvLnByb2ZpbGUiCiAgICBlbGlmIFsgLWYgIiRIT01FLy56c2hyYyIgXTsgdGhlbgogICAgICAgICMgU0hFTEwg5Y+Y6YeP5rKh6K6+572u5pe255qE5aSH55So5pa55qGICiAgICAgICAgZWNobyAiJEhPTUUvLnpzaHJjIgogICAgZWxpZiBbIC1mICIkSE9NRS8uYmFzaHJjIiBdOyB0aGVuCiAgICAgICAgIyBTSEVMTCDlj5jph4/msqHorr7nva7ml7bnmoTlpIfnlKjmlrnmoYgKICAgICAgICBlY2hvICIkSE9NRS8uYmFzaHJjIgogICAgZWxzZQogICAgICAgIGVjaG8gInVua25vd25fcHJvZmlsZSIKICAgIGZpCn0KCiMgLS0tIOezu+e7n+S/oeaBr+aUtumbhuaooeWdlyAtLS0KIyDpnZnmgIHns7vnu5/kv6Hmga/nvJPlrZjmlofku7bvvIjot6jov5DooYzmjIHkuYXljJbvvIkKIyDku4XlnKjmnKrlrprkuYnml7borr7nva7vvIjpmLLmraIgcmVhZC1vbmx5IOWPmOmHj+mUmeivr++8iQppZiBbIC16ICIke0ZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFOi19IiBdOyB0aGVuCiAgICByZWFkb25seSBGVUNLX1NZU0lORk9fQ0FDSEVfRklMRT0iJElOU1RBTExfRElSLy5zeXNpbmZvLmNhY2hlIgpmaQojIOe8k+WtmOeKtuaAgei3n+i4quWPmOmHjwpfRlVDS19TVEFUSUNfQ0FDSEVfTE9BREVEPTAKX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZPTAKCiMg5LuO57yT5a2Y5paH5Lu25Yqg6L296Z2Z5oCB57O757uf5L+h5oGvCiMg5YWo5bGA5Y+Y6YePOiBfRlVDS19TVEFUSUNfQ0FDSEVfTE9BREVELCBGVUNLX1NZU0lORk9fQ0FDSEVfRklMRQpfZnVja19sb2FkX3N0YXRpY19jYWNoZSgpIHsKICAgICMg5aaC5p6c57yT5a2Y5bey5Yqg6L295YiZ55u05o6l6L+U5ZueCiAgICBpZiBbICIke19GVUNLX1NUQVRJQ19DQUNIRV9MT0FERUQ6LTB9IiAtZXEgMSBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgX0ZVQ0tfU1RBVElDX0NBQ0hFX0xPQURFRD0xCgogICAgIyDlpoLmnpznvJPlrZjmlofku7blrZjlnKjliJnliqDovb0KICAgIGlmIFsgLWYgIiRGVUNLX1NZU0lORk9fQ0FDSEVfRklMRSIgXTsgdGhlbgogICAgICAgICMgc2hlbGxjaGVjayBkaXNhYmxlPVNDMTA5MAogICAgICAgIHNvdXJjZSAiJEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFIiB8fCB0cnVlCiAgICBmaQp9CgojIOagh+iusOmdmeaAgee8k+WtmOS4uuiEj++8iOmcgOimgeaMgeS5heWMlu+8iQojIOWFqOWxgOWPmOmHjzogX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZCl9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5KCkgewogICAgX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZPTEKfQoKIyDlsIbpnZnmgIHns7vnu5/kv6Hmga/mjIHkuYXljJbliLDnvJPlrZjmlofku7YKIyDlhajlsYDlj5jph486IF9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWSwgRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUKIyDov5Tlm57lgLw6IOaIkOWKn+i/lOWbniAw77yM5aSx6LSl6L+U5ZueIDEKX2Z1Y2tfcGVyc2lzdF9zdGF0aWNfY2FjaGUoKSB7CiAgICAjIOS7heWcqOe8k+WtmOiEj+aXtuaJjeaMgeS5heWMlgogICAgaWYgWyAiJHtfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFk6LTB9IiAtbmUgMSBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgIyDnoa7kv53nvJPlrZjnm67lvZXlrZjlnKgKICAgIGxvY2FsIGNhY2hlX2RpcgogICAgY2FjaGVfZGlyPSQoZGlybmFtZSAiJEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFIikKICAgIGlmICEgbWtkaXIgLXAgIiRjYWNoZV9kaXIiIDI+L2Rldi9udWxsOyB0aGVuCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgIyDliJvlu7rkuLTml7bmlofku7bov5vooYzljp/lrZDlhpnlhaUKICAgIGxvY2FsIHRtcF9maWxlCiAgICB0bXBfZmlsZT0kKG1rdGVtcCkgfHwgcmV0dXJuIDEKCiAgICAjIOWwhue8k+WtmOWPmOmHj+WGmeWFpeS4tOaXtuaWh+S7tgogICAgewogICAgICAgIHByaW50ZiAnX0ZVQ0tfQ0FDSEVEX0RJU1RSTz0lcVxcbicgIiR7X0ZVQ0tfQ0FDSEVEX0RJU1RSTzotfSIKICAgICAgICBwcmludGYgJ19GVUNLX0NBQ0hFRF9LRVJORUw9JXFcXG4nICIke19GVUNLX0NBQ0hFRF9LRVJORUw6LX0iCiAgICAgICAgcHJpbnRmICdfRlVDS19DQUNIRURfQVJDSD0lcVxcbicgIiR7X0ZVQ0tfQ0FDSEVEX0FSQ0g6LX0iCiAgICAgICAgcHJpbnRmICdfRlVDS19DQUNIRURfUEtHX01BTkFHRVI9JXFcXG4nICIke19GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUjotfSIKICAgIH0gPiAiJHRtcF9maWxlIgoKICAgICMg5Y6f5a2Q56e75Yqo5Yiw5pyA57uI5L2N572uCiAgICBpZiBtdiAiJHRtcF9maWxlIiAiJEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFIiAyPi9kZXYvbnVsbDsgdGhlbgogICAgICAgIF9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWT0wCiAgICAgICAgcmV0dXJuIDAKICAgIGVsc2UKICAgICAgICAjIOWksei0peaXtua4heeQhuS4tOaXtuaWh+S7tgogICAgICAgIHJtIC1mICIkdG1wX2ZpbGUiCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCn0KCiMg5qOA5rWL5Y+R6KGM54mIL+ezu+e7n+WutuaXj++8iOaUr+aMgee8k+WtmO+8iQojIOi+k+WHujog5Y+R6KGM54mI5a2X56ym5Liy77yI5aaC77yaIkRlYmlhbiDns7sgMTIuMDQgKFVidW50dSAyNC4wNCBMVFMpIu+8iQpfZnVja19kZXRlY3RfZGlzdHJvKCkgewogICAgX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUKCiAgICAjIOWmguaenOaciee8k+WtmOWAvOWImeebtOaOpei/lOWbngogICAgaWYgWyAtbiAiJHtfRlVDS19DQUNIRURfRElTVFJPOi19IiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJF9GVUNLX0NBQ0hFRF9ESVNUUk8iCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgbG9jYWwga2VybmVsX25hbWUgZGlzdHJvIGlkIHZlcnNpb24gcHJldHR5IGZhbWlseQogICAga2VybmVsX25hbWU9JCh1bmFtZSAtcyAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgZGlzdHJvPSJ1bmtub3duIgoKICAgICMgbWFjT1Mg5qOA5rWLCiAgICBpZiBbICIka2VybmVsX25hbWUiID0gIkRhcndpbiIgXTsgdGhlbgogICAgICAgIGxvY2FsIHByb2R1Y3QgdmVyc2lvbgogICAgICAgIHByb2R1Y3Q9JChzd192ZXJzIC1wcm9kdWN0TmFtZSAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ21hY09TJykKICAgICAgICBwcm9kdWN0PSQocHJpbnRmICclcycgIiRwcm9kdWN0IiB8IHRyIC1kICdcclxuJykKICAgICAgICB2ZXJzaW9uPSQoc3dfdmVycyAtcHJvZHVjdFZlcnNpb24gMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgICAgICB2ZXJzaW9uPSQocHJpbnRmICclcycgIiR2ZXJzaW9uIiB8IHRyIC1kICdcclxuJykKICAgICAgICBkaXN0cm89IiRwcm9kdWN0ICR2ZXJzaW9uIgogICAgIyBMaW51eCDkvb/nlKggL2V0Yy9vcy1yZWxlYXNlIOajgOa1iwogICAgZWxpZiBbIC1yIC9ldGMvb3MtcmVsZWFzZSBdOyB0aGVuCiAgICAgICAgaWQ9JChncmVwIC1FICdeSUQ9JyAvZXRjL29zLXJlbGVhc2UgfCBoZWFkIC1uMSB8IGN1dCAtZD0gLWYyIHwgdHIgLWQgJyInIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCiAgICAgICAgdmVyc2lvbj0kKGdyZXAgLUUgJ15WRVJTSU9OX0lEPScgL2V0Yy9vcy1yZWxlYXNlIHwgaGVhZCAtbjEgfCBjdXQgLWQ9IC1mMiB8IHRyIC1kICciJykKICAgICAgICBwcmV0dHk9JChncmVwIC1FICdeUFJFVFRZX05BTUU9JyAvZXRjL29zLXJlbGVhc2UgfCBoZWFkIC1uMSB8IGN1dCAtZD0gLWYyLSB8IHRyIC1kICciJykKCiAgICAgICAgIyDnoa7lrprns7vnu5/lrrbml4/ku6Xkvr/mm7Tlpb3lnLDliIbnsbsKICAgICAgICBmYW1pbHk9IiIKICAgICAgICBjYXNlICIkaWQiIGluCiAgICAgICAgICAgIHVidW50dXxkZWJpYW4pCiAgICAgICAgICAgICAgICBmYW1pbHk9IkRlYmlhbiDns7siCiAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBjZW50b3N8cmhlbHxyb2NreXxhbG1hbGludXh8ZmVkb3JhKQogICAgICAgICAgICAgICAgZmFtaWx5PSJSSEVMIOezuyIKICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgIGFyY2h8bWFuamFyb3xlbmRlYXZvdXJvcykKICAgICAgICAgICAgICAgIGZhbWlseT0iQXJjaCDns7siCiAgICAgICAgICAgICAgICA7OwogICAgICAgIGVzYWMKCiAgICAgICAgIyDmoLzlvI/ljJblj5HooYzniYjlrZfnrKbkuLLvvIzljIXlkKvlrrbml4/lkozniYjmnKzkv6Hmga8KICAgICAgICBpZiBbIC1uICIkZmFtaWx5IiBdOyB0aGVuCiAgICAgICAgICAgIGRpc3Rybz0iJGZhbWlseSAke3ZlcnNpb246LX0iCiAgICAgICAgICAgIGlmIFsgLW4gIiRwcmV0dHkiIF07IHRoZW4KICAgICAgICAgICAgICAgIGRpc3Rybz0iJGRpc3RybyAoJHtwcmV0dHl9KSIKICAgICAgICAgICAgZmkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGRpc3Rybz0iJHtwcmV0dHk6LUxpbnV4ICR2ZXJzaW9ufSIKICAgICAgICBmaQogICAgZWxzZQogICAgICAgIGRpc3Rybz0iJGtlcm5lbF9uYW1lIgogICAgZmkKCiAgICAjIOe8k+WtmOW5tui/lOWbnue7k+aenAogICAgX0ZVQ0tfQ0FDSEVEX0RJU1RSTz0iJGRpc3RybyIKICAgIF9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5CiAgICBwcmludGYgJyVzXG4nICIkZGlzdHJvIgp9CgojIOiOt+WPluWGheaguOeJiOacrOS/oeaBr++8iOaUr+aMgee8k+WtmO+8iQojIOi+k+WHujog5YaF5qC454mI5pys5a2X56ym5Liy77yI5aaC77yaIkxpbnV4IDYuOC4wLTMxLWdlbmVyaWMi77yJCl9mdWNrX2dldF9rZXJuZWxfdmVyc2lvbigpIHsKICAgIF9mdWNrX2xvYWRfc3RhdGljX2NhY2hlCgogICAgIyDlpoLmnpzmnInnvJPlrZjlgLzliJnnm7TmjqXov5Tlm54KICAgIGlmIFsgLW4gIiR7X0ZVQ0tfQ0FDSEVEX0tFUk5FTDotfSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRfRlVDS19DQUNIRURfS0VSTkVMIgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGxvY2FsIGtlcm5lbAogICAga2VybmVsPSQodW5hbWUgLXNyIDI+L2Rldi9udWxsIHx8IHVuYW1lIC1zIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICBrZXJuZWw9JChwcmludGYgJyVzJyAiJGtlcm5lbCIgfCB0ciAtZCAnXHJcbicpCgogICAgIyDnvJPlrZjlubbov5Tlm57nu5PmnpwKICAgIF9GVUNLX0NBQ0hFRF9LRVJORUw9IiRrZXJuZWwiCiAgICBfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eQogICAgcHJpbnRmICclc1xuJyAiJGtlcm5lbCIKfQoKIyDojrflj5bns7vnu5/mnrbmnoTvvIjmlK/mjIHnvJPlrZjvvIkKIyDovpPlh7o6IOaetuaehOWtl+espuS4su+8iOWmgu+8miJ4ODZfNjQiLCAiYXJtNjQi77yJCl9mdWNrX2dldF9hcmNoaXRlY3R1cmUoKSB7CiAgICBfZnVja19sb2FkX3N0YXRpY19jYWNoZQoKICAgICMg5aaC5p6c5pyJ57yT5a2Y5YC85YiZ55u05o6l6L+U5ZueCiAgICBpZiBbIC1uICIke19GVUNLX0NBQ0hFRF9BUkNIOi19IiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJF9GVUNLX0NBQ0hFRF9BUkNIIgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGxvY2FsIGFyY2gKICAgIGFyY2g9JCh1bmFtZSAtbSAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgYXJjaD0kKHByaW50ZiAnJXMnICIkYXJjaCIgfCB0ciAtZCAnXHJcbicpCgogICAgIyDnvJPlrZjlubbov5Tlm57nu5PmnpwKICAgIF9GVUNLX0NBQ0hFRF9BUkNIPSIkYXJjaCIKICAgIF9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5CiAgICBwcmludGYgJyVzXG4nICIkYXJjaCIKfQoKIyDmlLbpm4bnlKjmiLfkv6Hmga/ljIXmi6zmnYPpmZDnuqfliKsKIyDovpPlh7o6IOeUqOaIt+S/oeaBr+Wtl+espuS4su+8iOWmgu+8miJVc2VyPWpvaG4gdWlkPTEwMDAgbGV2ZWw9c3Vkb2VyIEdyb3Vwcz1qb2huIGFkbSBzdWRvIu+8iQpfZnVja19jb2xsZWN0X3VzZXJfaW5mbygpIHsKICAgIGxvY2FsIGN1cnJlbnRfdXNlciB1aWQgZ3JvdXBzIGxldmVsCiAgICBjdXJyZW50X3VzZXI9IiR7VVNFUjotfSIKCiAgICAjIOWmguaenCBVU0VSIOacquiuvue9ruWImeS9v+eUqOWkh+eUqOaWueazlQogICAgaWYgWyAteiAiJGN1cnJlbnRfdXNlciIgXTsgdGhlbgogICAgICAgIGN1cnJlbnRfdXNlcj0kKHdob2FtaSAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgZmkKCiAgICAjIOWmguaenCBpZCDlkb3ku6Tlj6/nlKjliJnojrflj5YgVUlEIOWSjOeUqOaIt+e7hAogICAgdWlkPSJ1bmtub3duIgogICAgZ3JvdXBzPSJ1bmtub3duIgogICAgaWYgY29tbWFuZCAtdiBpZCA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICB1aWQ9JChpZCAtdSAiJGN1cnJlbnRfdXNlciIgMj4vZGV2L251bGwgfHwgaWQgLXUgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgICAgICBncm91cHM9JChpZCAtR24gIiRjdXJyZW50X3VzZXIiIDI+L2Rldi9udWxsIHx8IGlkIC1HbiAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgZmkKCiAgICAjIOehruWumuadg+mZkOe6p+WIqwogICAgbGV2ZWw9InVzZXIiCiAgICBpZiBbICIkdWlkIiA9ICIwIiBdOyB0aGVuCiAgICAgICAgbGV2ZWw9InJvb3QiCiAgICBlbGlmIHByaW50ZiAnJXMnICIkZ3JvdXBzIiB8IGdyZXAgLUVxICcoXnxbWzpzcGFjZTpdXSkoc3Vkb3x3aGVlbHxhZG1pbikoW1s6c3BhY2U6XV18JCknOyB0aGVuCiAgICAgICAgbGV2ZWw9InN1ZG9lciIKICAgIGZpCgogICAgcHJpbnRmICdVc2VyPSVzIHVpZD0lcyBsZXZlbD0lcyBHcm91cHM9JXMnICIkY3VycmVudF91c2VyIiAiJHVpZCIgIiRsZXZlbCIgIiRncm91cHMiCn0KCiMg5pS26ZuG5bi455So5byA5Y+R5bel5YW355qE54mI5pys5L+h5oGvCiMg6L6T5Ye6OiDlt6XlhbfniYjmnKzlrZfnrKbkuLLvvIjlpoLvvJoiZ2l0OmdpdCB2ZXJzaW9uIDIuMzQuMTsgZG9ja2VyOkRvY2tlciB2ZXJzaW9uIDI0LjAuNjsgLi4uIu+8iQpfZnVja19jb2xsZWN0X3Rvb2xfdmVyc2lvbnMoKSB7CiAgICBsb2NhbCB0b29scyB0b29sIHZlcnNpb24gcmVzdWx0CiAgICB0b29scz0iZ2l0IGRvY2tlciBucG0ga3ViZWN0bCBjdXJsIHdnZXQiCiAgICByZXN1bHQ9IiIKCiAgICBmb3IgdG9vbCBpbiAkdG9vbHM7IGRvCiAgICAgICAgdmVyc2lvbj0ibm90LWluc3RhbGxlZCIKCiAgICAgICAgaWYgY29tbWFuZCAtdiAiJHRvb2wiID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgICAgICBjYXNlICIkdG9vbCIgaW4KICAgICAgICAgICAgICAgIGdpdHxkb2NrZXJ8Y3VybHx3Z2V0KQogICAgICAgICAgICAgICAgICAgIHZlcnNpb249JCgiJHRvb2wiIC0tdmVyc2lvbiAyPi9kZXYvbnVsbCB8IGhlYWQgLW4xKQogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICBucG0pCiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbj0kKCIkdG9vbCIgLS12ZXJzaW9uIDI+L2Rldi9udWxsIHwgaGVhZCAtbjEpCiAgICAgICAgICAgICAgICAgICAgWyAtbiAiJHZlcnNpb24iIF0gJiYgdmVyc2lvbj0ibnBtICR2ZXJzaW9uIgogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICBrdWJlY3RsKQogICAgICAgICAgICAgICAgICAgIHZlcnNpb249JCgiJHRvb2wiIHZlcnNpb24gLS1jbGllbnQgLS1zaG9ydCAyPi9kZXYvbnVsbCB8IGhlYWQgLW4xKQogICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgIGVzYWMKICAgICAgICBmaQoKICAgICAgICAjIOa4heeQhueJiOacrOWtl+espuS4sgogICAgICAgIHZlcnNpb249JChwcmludGYgJyVzJyAiJHt2ZXJzaW9uOi11bmtub3dufSIgfCB0ciAnXHJcbicgJyAgJyB8IHRyIC1zICcgJyB8IHNlZCAtZSAncy9eICovLycgLWUgJ3MvICokLy8nKQogICAgICAgIFsgLXogIiR2ZXJzaW9uIiBdICYmIHZlcnNpb249InVua25vd24iCgogICAgICAgIHJlc3VsdD0iJHJlc3VsdCR0b29sOiR2ZXJzaW9uOyAiCiAgICBkb25lCgogICAgIyDnp7vpmaTmnKvlsL7nmoTliIblj7flkoznqbrmoLwKICAgIHJlc3VsdD0iJHtyZXN1bHQlOyB9IgogICAgcHJpbnRmICclcycgIiRyZXN1bHQiCn0KCiMg5qOA5rWL5YyF566h55CG5Zmo77yI5pSv5oyB57yT5a2Y77yJCiMg6L6T5Ye6OiDljIXnrqHnkIblmajlkI3np7DvvIhhcHQsIHl1bSwgZG5mLCBwYWNtYW4sIHp5cHBlciwgYnJldywgdW5rbm93bu+8iQpfZnVja19kZXRlY3RfcGtnX21hbmFnZXIoKSB7CiAgICBfZnVja19sb2FkX3N0YXRpY19jYWNoZQoKICAgICMg5aaC5p6c5pyJ57yT5a2Y5YC85YiZ55u05o6l6L+U5ZueCiAgICBpZiBbIC1uICIke19GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUjotfSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRfRlVDS19DQUNIRURfUEtHX01BTkFHRVIiCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgbG9jYWwgbWFuYWdlcj0idW5rbm93biIKCiAgICAjIOaMieS8mOWFiOe6p+ajgOa1i+WMheeuoeeQhuWZqAogICAgaWYgY29tbWFuZCAtdiBhcHQtZ2V0ICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9ImFwdCIKICAgIGVsaWYgY29tbWFuZCAtdiB5dW0gJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0ieXVtIgogICAgZWxpZiBjb21tYW5kIC12IGRuZiAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJkbmYiCiAgICBlbGlmIGNvbW1hbmQgLXYgcGFjbWFuICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9InBhY21hbiIKICAgIGVsaWYgY29tbWFuZCAtdiB6eXBwZXIgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0ienlwcGVyIgogICAgZWxpZiBjb21tYW5kIC12IGJyZXcgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0iYnJldyIKICAgIGZpCgogICAgIyDnvJPlrZjlubbov5Tlm57nu5PmnpwKICAgIF9GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUj0iJG1hbmFnZXIiCiAgICBfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eQogICAgcHJpbnRmICclc1xuJyAiJG1hbmFnZXIiCn0KCiMg5pS26ZuG566A5YyW55qE57O757uf5L+h5oGv5bm25qC85byP5YyW5Li657uT5p6E5YyW5a2X56ym5LiyCiMg6L6T5Ye6OiDnlKjkuo4gQUkg5aSE55CG55qE57O757uf5L+h5oGv5a2X56ym5LiyCl9mdWNrX2NvbGxlY3Rfc3lzaW5mb19zdHJpbmcoKSB7CiAgICBsb2NhbCBvc190eXBlIGtlcm5lbF9uYW1lIHBrZ19tYW5hZ2VyIHN1bW1hcnkKCiAgICAjIOajgOa1i+aTjeS9nOezu+e7n+exu+WeiwogICAga2VybmVsX25hbWU9JCh1bmFtZSAtcyAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQoKICAgIGNhc2UgIiRrZXJuZWxfbmFtZSIgaW4KICAgICAgICBEYXJ3aW4pCiAgICAgICAgICAgIG9zX3R5cGU9Im1hY09TIgogICAgICAgICAgICBwa2dfbWFuYWdlcj0iYnJldyIKICAgICAgICAgICAgOzsKICAgICAgICBMaW51eCkKICAgICAgICAgICAgaWYgWyAtciAvZXRjL29zLXJlbGVhc2UgXTsgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgaWQKICAgICAgICAgICAgICAgIGlkPSQoZ3JlcCAtRSAnXklEPScgL2V0Yy9vcy1yZWxlYXNlIHwgaGVhZCAtbjEgfCBjdXQgLWQ9IC1mMiB8IHRyIC1kICciJyB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQogICAgICAgICAgICAgICAgY2FzZSAiJGlkIiBpbgogICAgICAgICAgICAgICAgICAgIHVidW50dXxkZWJpYW4pCiAgICAgICAgICAgICAgICAgICAgICAgIG9zX3R5cGU9IkRlYmlhbiIKICAgICAgICAgICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9ImFwdCIKICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICAgICBjZW50b3N8cmhlbHxyb2NreXxhbG1hbGludXh8ZmVkb3JhKQogICAgICAgICAgICAgICAgICAgICAgICBvc190eXBlPSJSSEVMIgogICAgICAgICAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0ieXVtIgogICAgICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgICAgIGFyY2h8bWFuamFybykKICAgICAgICAgICAgICAgICAgICAgICAgb3NfdHlwZT0iQXJjaCIKICAgICAgICAgICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9InBhY21hbiIKICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICAgICAqKQogICAgICAgICAgICAgICAgICAgICAgICBvc190eXBlPSJMaW51eCIKICAgICAgICAgICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9InVua25vd24iCiAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICBlc2FjCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG9zX3R5cGU9IkxpbnV4IgogICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9InVua25vd24iCiAgICAgICAgICAgIGZpCiAgICAgICAgICAgIDs7CiAgICAgICAgTUlOR1cqfE1TWVMqfENZR1dJTiopCiAgICAgICAgICAgIG9zX3R5cGU9IldpbmRvd3MiCiAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ1bmtub3duIgogICAgICAgICAgICA7OwogICAgICAgICopCiAgICAgICAgICAgIG9zX3R5cGU9IiRrZXJuZWxfbmFtZSIKICAgICAgICAgICAgcGtnX21hbmFnZXI9InVua25vd24iCiAgICAgICAgICAgIDs7CiAgICBlc2FjCgogICAgIyDmoLzlvI/ljJbkuLrnroDljZXnmoTnu5PmnoTljJblrZfnrKbkuLIKICAgIHByaW50ZiAtdiBzdW1tYXJ5ICdPUz0lczsgUGtnTWdyPSVzJyAiJG9zX3R5cGUiICIkcGtnX21hbmFnZXIiCiAgICBwcmludGYgJyVzXG4nICIkc3VtbWFyeSIKfQoKX2Z1Y2tfanNvbl9lc2NhcGUoKSB7CiAgICBsb2NhbCBpbnB1dD0iJDEiCiAgICAjIOS9v+eUqCBwcmludGYg5q2j56Gu5aSE55CG5o6n5Yi25a2X56ymCiAgICBwcmludGYgJyVzJyAiJGlucHV0IiB8IHNlZCAtZSAnCiAgICAgICAgIyDpppblhYjovazkuYnlj43mlpzmnaDvvIjlv4XpobvmmK/nrKzkuIDkuKrvvIkKICAgICAgICBzL1xcL1xcXFwvZwogICAgICAgICMg6L2s5LmJ5Y+M5byV5Y+3CiAgICAgICAgcy8iL1xcIi9nCiAgICAgICAgIyDovazkuYnmjqfliLblrZfnrKbvvIhBU0NJSSAwLTMx77yJCiAgICAgICAgcy9ceDAwL1xcdTAwMDAvZwogICAgICAgIHMvXHgwMS9cXHUwMDAxL2cKICAgICAgICBzL1x4MDIvXFx1MDAwMi9nCiAgICAgICAgcy9ceDAzL1xcdTAwMDMvZwogICAgICAgIHMvXHgwNC9cXHUwMDA0L2cKICAgICAgICBzL1x4MDUvXFx1MDAwNS9nCiAgICAgICAgcy9ceDA2L1xcdTAwMDYvZwogICAgICAgIHMvXHgwNy9cXHUwMDA3L2cKICAgICAgICBzL1x4MDgvXFxiL2cKICAgICAgICBzL1x4MDkvXFx0L2cKICAgICAgICBzL1x4MEEvXFxuL2cKICAgICAgICBzL1x4MEIvXFx1MDAwQi9nCiAgICAgICAgcy9ceDBDL1xcZi9nCiAgICAgICAgcy9ceDBEL1xcci9nCiAgICAgICAgcy9ceDBFL1xcdTAwMEUvZwogICAgICAgIHMvXHgwRi9cXHUwMDBGL2cKICAgICAgICBzL1x4MTAvXFx1MDAxMC9nCiAgICAgICAgcy9ceDExL1xcdTAwMTEvZwogICAgICAgIHMvXHgxMi9cXHUwMDEyL2cKICAgICAgICBzL1x4MTMvXFx1MDAxMy9nCiAgICAgICAgcy9ceDE0L1xcdTAwMTQvZwogICAgICAgIHMvXHgxNS9cXHUwMDE1L2cKICAgICAgICBzL1x4MTYvXFx1MDAxNi9nCiAgICAgICAgcy9ceDE3L1xcdTAwMTcvZwogICAgICAgIHMvXHgxOC9cXHUwMDE4L2cKICAgICAgICBzL1x4MTkvXFx1MDAxOS9nCiAgICAgICAgcy9ceDFBL1xcdTAwMUEvZwogICAgICAgIHMvXHgxQi9cXHUwMDFCL2cKICAgICAgICBzL1x4MUMvXFx1MDAxQy9nCiAgICAgICAgcy9ceDFEL1xcdTAwMUQvZwogICAgICAgIHMvXHgxRS9cXHUwMDFFL2cKICAgICAgICBzL1x4MUYvXFx1MDAxRi9nCiAgICAnCn0KCl9mdWNrX3Nob3VsZF91c2VfbG9jYWxfYXBpKCkgewogICAgaWYgWyAtbiAiJHtGVUNLX09QRU5BSV9BUElfS0VZOi19IiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCiAgICByZXR1cm4gMQp9CgpfZnVja19sb2NhbF9zeXN0ZW1fcHJvbXB0KCkgewogICAgbG9jYWwgc3lzaW5mbz0iJDEiCiAgICBpZiBbICIkRlVDS0lUU19MT0NBTEUiID0gInpoIiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICfkvaDmmK/kuIDkuKrkuJPkuJrnmoQgc2hlbGwg5ZG95Luk55Sf5oiQ5Zmo44CC55So5oi35Lya55So6Ieq54S26K+t6KiA5o+P6L+w5LuW5Lus5oOz6KaB5a6M5oiQ55qE5Lu75Yqh44CC5L2g55qE5Lu75Yqh5piv55Sf5oiQ55u05o6l5Y+v5omn6KGM55qEIHNoZWxsIOWRveS7pOadpeWujOaIkOeUqOaIt+eahOebruagh+OAggoK6YeN6KaB6KeE5YiZ77yaCjEuIOeUqOaIt+i+k+WFpeaYr+iHqueEtuivreiogOaPj+i/sOaEj+Wbvu+8jOS4jeaYr+WRveS7pOWPguaVsOOAguS+i+WmgiLliJflh7rnm67lvZUi5oSP5oCd5piv5omn6KGMIGxzIOWRveS7pO+8jOiAjOS4jeaYryBscyAi5YiX5Ye655uu5b2VIgoyLiDnlJ/miJDnm7TmjqXlj6/miafooYznmoTlkb3ku6TvvIzkuI3opoHnlJ/miJDluKblj4LmlbDliKTmlq3nmoTohJrmnKzmqKHmnb/vvIjlpoIgaWYgWyAkIyAtZXEgMCBd77yJCjMuIOWvueS6jueugOWNleS7u+WKoeebtOaOpei/lOWbnuWNleadoeWRveS7pO+8jOWkjeadguS7u+WKoeWPr+S7peaYr+WkmuihjOiEmuacrAo0LiDkuI3opoHmj5Dkvpvku7vkvZXop6Pph4rjgIHms6jph4rjgIFtYXJrZG93biDmoLzlvI/vvIjmr5TlpoIgYGBgYmFzaO+8ieaIliBzaGViYW5n77yI5L6L5aaCICMhL2Jpbi9iYXNo77yJCgrnpLrkvovvvJoKLSDnlKjmiLfor7Qi5YiX5Ye655uu5b2VIiDihpIg6L6T5Ye6OiBscwotIOeUqOaIt+ivtCLmmL7npLror6bnu4bmlofku7bliJfooagiIOKGkiDovpPlh7o6IGxzIC1sYQotIOeUqOaIt+ivtCLmn6Xmib7lpKfkuo4xME1C55qE5paH5Lu2IiDihpIg6L6T5Ye6OiBmaW5kIC4gLXR5cGUgZiAtc2l6ZSArMTBNCgrnlKjmiLfnmoTns7vnu5/kv6Hmga/mmK/vvJolcycgIiRzeXNpbmZvIgogICAgZWxzZQogICAgICAgIHByaW50ZiAnWW91IGFyZSBhbiBleHBlcnQgc2hlbGwgY29tbWFuZCBnZW5lcmF0b3IuIFVzZXJzIGRlc2NyaWJlIHRhc2tzIGluIG5hdHVyYWwgbGFuZ3VhZ2UuIFlvdXIgdGFzayBpcyB0byBnZW5lcmF0ZSBkaXJlY3RseSBleGVjdXRhYmxlIHNoZWxsIGNvbW1hbmRzIHRvIGFjY29tcGxpc2ggdGhlaXIgZ29hbHMuCgpJbXBvcnRhbnQgcnVsZXM6CjEuIFVzZXIgaW5wdXQgaXMgbmF0dXJhbCBsYW5ndWFnZSBpbnRlbnQsIE5PVCBjb21tYW5kIGFyZ3VtZW50cy4gRm9yIGV4YW1wbGUsICJsaXN0IGRpcmVjdG9yeSIgbWVhbnMgcnVuIGxzLCBub3QgbHMgImxpc3QgZGlyZWN0b3J5IgoyLiBHZW5lcmF0ZSBkaXJlY3RseSBleGVjdXRhYmxlIGNvbW1hbmRzLCBub3Qgc2NyaXB0IHRlbXBsYXRlcyB3aXRoIHBhcmFtZXRlciBoYW5kbGluZyAobGlrZSBpZiBbICQjIC1lcSAwIF0pCjMuIEZvciBzaW1wbGUgdGFza3MgcmV0dXJuIHNpbmdsZSBjb21tYW5kcywgY29tcGxleCB0YXNrcyBjYW4gYmUgbXVsdGktbGluZSBzY3JpcHRzCjQuIERvIG5vdCBwcm92aWRlIGFueSBleHBsYW5hdGlvbiwgY29tbWVudHMsIG1hcmtkb3duIGZvcm1hdHRpbmcgKGxpa2UgYGBgYmFzaCksIG9yIGEgc2hlYmFuZyAoZS5nLiwgIyEvYmluL2Jhc2gpCgpFeGFtcGxlczoKLSBVc2VyIHNheXMgImxpc3QgZGlyZWN0b3J5IiDihpIgT3V0cHV0OiBscwotIFVzZXIgc2F5cyAic2hvdyBkZXRhaWxlZCBmaWxlIGxpc3QiIOKGkiBPdXRwdXQ6IGxzIC1sYQotIFVzZXIgc2F5cyAiZmluZCBmaWxlcyBsYXJnZXIgdGhhbiAxME1CIiDihpIgT3V0cHV0OiBmaW5kIC4gLXR5cGUgZiAtc2l6ZSArMTBNCgpUaGUgdXNlciciJyIncyBzeXN0ZW0gaW5mbyBpczogJXMnICIkc3lzaW5mbyIKICAgIGZpCn0KCl9mdWNrX2V4dHJhY3RfY29tbWFuZF9mcm9tX2pzb24oKSB7CiAgICBsb2NhbCBqc29uX2ZpbGU9IiQxIgogICAgaWYgY29tbWFuZCAtdiBweXRob24zID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgIHB5dGhvbjMgLSAiJGpzb25fZmlsZSIgPDwnUFkyJwppbXBvcnQganNvbiwgc3lzCnBhdGggPSBzeXMuYXJndlsxXQp3aXRoIG9wZW4ocGF0aCwgJ3InLCBlbmNvZGluZz0ndXRmLTgnKSBhcyBmOgogICAgZGF0YSA9IGpzb24ubG9hZChmKQpjaG9pY2VzID0gZGF0YS5nZXQoJ2Nob2ljZXMnKSBvciBbXQppZiBub3QgY2hvaWNlczoKICAgIHN5cy5leGl0KDEpCm1lc3NhZ2UgPSBjaG9pY2VzWzBdLmdldCgnbWVzc2FnZScpIG9yIHt9CmNvbnRlbnQgPSAobWVzc2FnZS5nZXQoJ2NvbnRlbnQnKSBvciAnJykuc3RyaXAoKQppZiBub3QgY29udGVudDoKICAgIHN5cy5leGl0KDEpCnByaW50KGNvbnRlbnQpClBZMgogICAgICAgIHJldHVybgogICAgZmkKCiAgICBpZiBjb21tYW5kIC12IG5vZGUgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgbm9kZSAtICIkanNvbl9maWxlIiA8PCdKUzInCmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTsKY29uc3QgcGF0aCA9IHByb2Nlc3MuYXJndlsxXTsKY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHBhdGgsICd1dGY4JykpOwpjb25zdCBjaG9pY2UgPSAoZGF0YS5jaG9pY2VzICYmIGRhdGEuY2hvaWNlc1swXSkgfHwge307CmNvbnN0IG1lc3NhZ2UgPSBjaG9pY2UubWVzc2FnZSB8fCB7fTsKY29uc3QgY29udGVudCA9IChtZXNzYWdlLmNvbnRlbnQgfHwgJycpLnRyaW0oKTsKaWYgKCFjb250ZW50KSB7CiAgcHJvY2Vzcy5leGl0KDEpOwp9CmNvbnNvbGUubG9nKGNvbnRlbnQpOwpKUzIKICAgICAgICByZXR1cm4KICAgIGZpCgogICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH3ml6Dms5Xop6PmnpDmqKHlnovov5Tlm57nmoTmlbDmja7vvIzor7flronoo4UgcHl0aG9uMyDmiJYgbm9kZeOAgiR7Q19SRVNFVH0iID4mMgogICAgcmV0dXJuIDEKfQoKX2Z1Y2tfcmVxdWVzdF9sb2NhbF9tb2RlbCgpIHsKICAgIGxvY2FsIHByb21wdD0iJDEiCiAgICBsb2NhbCBzeXNpbmZvPSIkMiIKICAgIGxvY2FsIGN1cmxfdGltZW91dD0iJDMiCgogICAgbG9jYWwgYXBpX2tleT0iJHtGVUNLX09QRU5BSV9BUElfS0VZOi19IgogICAgaWYgWyAteiAiJGFwaV9rZXkiIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeacqumFjee9ruacrOWcsCBBUEkgS2V577yM6K+35ZyoIH4vLmZ1Y2svY29uZmlnLnNoIOS4reiuvue9riBGVUNLX09QRU5BSV9BUElfS0VZ44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbW9kZWw9IiR7RlVDS19PUEVOQUlfTU9ERUw6LWdwdC01LW5hbm99IgogICAgbG9jYWwgYXBpX2Jhc2U9IiR7RlVDS19PUEVOQUlfQVBJX0JBU0U6LWh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjF9IgogICAgYXBpX2Jhc2U9JHthcGlfYmFzZSUvfQogICAgbG9jYWwgYXBpX3VybD0iJGFwaV9iYXNlL2NoYXQvY29tcGxldGlvbnMiCgogICAgX2Z1Y2tfZGVidWcgIuacrOWcsCBBUEkg5Z+65Z2AOiAkYXBpX2Jhc2UiCiAgICBfZnVja19kZWJ1ZyAi5pys5Zyw5qih5Z6LOiAkbW9kZWwiCgogICAgbG9jYWwgc3lzdGVtX3Byb21wdAogICAgc3lzdGVtX3Byb21wdD0kKF9mdWNrX2xvY2FsX3N5c3RlbV9wcm9tcHQgIiRzeXNpbmZvIikKCiAgICBsb2NhbCBwYXlsb2FkCiAgICBwYXlsb2FkPSQocHJpbnRmICd7ICJtb2RlbCI6ICIlcyIsICJtZXNzYWdlcyI6IFsgeyJyb2xlIjoic3lzdGVtIiwiY29udGVudCI6IiVzIn0sIHsicm9sZSI6InVzZXIiLCJjb250ZW50IjoiJXMifSBdLCAibWF4X3Rva2VucyI6IDEwMjQsICJ0ZW1wZXJhdHVyZSI6IDAuMiB9JyBcCiAgICAgICAgIiRtb2RlbCIgIiQoX2Z1Y2tfanNvbl9lc2NhcGUgIiRzeXN0ZW1fcHJvbXB0IikiICIkKF9mdWNrX2pzb25fZXNjYXBlICIkcHJvbXB0IikiKQoKICAgIGxvY2FsIHRtcF9qc29uCiAgICB0bXBfanNvbj0kKG1rdGVtcCkgfHwgcmV0dXJuIDEKCiAgICBpZiAhIGN1cmwgLWZzUyAtLW1heC10aW1lICIkY3VybF90aW1lb3V0IiAiJGFwaV91cmwiIFwKICAgICAgICAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiBcCiAgICAgICAgLUggIkF1dGhvcml6YXRpb246IEJlYXJlciAkYXBpX2tleSIgXAogICAgICAgIC1kICIkcGF5bG9hZCIgPiAiJHRtcF9qc29uIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR95pys5ZywIEFQSSDor7fmsYLlpLHotKXjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICBjYXQgIiR0bXBfanNvbiIgPiYyCiAgICAgICAgcm0gLWYgIiR0bXBfanNvbiIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBsb2NhbCBjb21tYW5kX291dHB1dAogICAgaWYgISBjb21tYW5kX291dHB1dD0kKF9mdWNrX2V4dHJhY3RfY29tbWFuZF9mcm9tX2pzb24gIiR0bXBfanNvbiIpOyB0aGVuCiAgICAgICAgcm0gLWYgIiR0bXBfanNvbiIKICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeaXoOazleino+aekOaooeWei+i/lOWbnuWGheWuueOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIHJtIC1mICIkdG1wX2pzb24iCiAgICBwcmludGYgJyVzXG4nICIkY29tbWFuZF9vdXRwdXQiCn0KCl9mdWNrX3JlcXVlc3Rfd29ya2VyX21vZGVsKCkgewogICAgbG9jYWwgcHJvbXB0PSIkMSIKICAgIGxvY2FsIHN5c2luZm89IiQyIgogICAgbG9jYWwgY3VybF90aW1lb3V0PSIkMyIKICAgIGxvY2FsIHNwaW5uZXJfbGFiZWw9IiR7NDotfSIKCiAgICBsb2NhbCBhZG1pbl9rZXk9IiR7RlVDS19BRE1JTl9LRVk6LX0iCiAgICBsb2NhbCBhZG1pbl9zZWdtZW50PSIiCiAgICBpZiBbIC1uICIkYWRtaW5fa2V5IiBdOyB0aGVuCiAgICAgICAgYWRtaW5fc2VnbWVudD0kKHByaW50ZiAnLCAiYWRtaW5LZXkiOiAiJXMiJyAiJCggX2Z1Y2tfanNvbl9lc2NhcGUgIiRhZG1pbl9rZXkiICkiKQogICAgZmkKCiAgICBsb2NhbCBwYXlsb2FkCiAgICBwYXlsb2FkPSQocHJpbnRmICd7ICJzeXNpbmZvIjogIiVzIiwgInByb21wdCI6ICIlcyIlcyB9JyBcCiAgICAgICAgIiQoIF9mdWNrX2pzb25fZXNjYXBlICIkc3lzaW5mbyIgKSIgXAogICAgICAgICIkKCBfZnVja19qc29uX2VzY2FwZSAiJHByb21wdCIgKSIgXAogICAgICAgICIkYWRtaW5fc2VnbWVudCIpCgogICAgbG9jYWwgYXBpX3VybD0iJHtGVUNLX0FQSV9FTkRQT0lOVDotJERFRkFVTFRfQVBJX0VORFBPSU5UfSIKCiAgICBfZnVja19kZWJ1ZyAiQVBJIFVSTDogJGFwaV91cmwiCiAgICBfZnVja19kZWJ1ZyAiUGF5bG9hZDogJHBheWxvYWQiCiAgICBfZnVja19kZWJ1ZyAiVGltZW91dDogJGN1cmxfdGltZW91dCIKCiAgICBsb2NhbCB0bXBfcmVzcG9uc2UgdG1wX3N0YXR1cwogICAgdG1wX3Jlc3BvbnNlPSQobWt0ZW1wKQogICAgdG1wX3N0YXR1cz0kKG1rdGVtcCkKCiAgICAoCiAgICAgICAgY3VybCAtc1MgLS1tYXgtdGltZSAiJGN1cmxfdGltZW91dCIgLVggUE9TVCAiJGFwaV91cmwiIFwKICAgICAgICAgICAgLUggIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiIgXAogICAgICAgICAgICAtZCAiJHBheWxvYWQiIC1vICIkdG1wX3Jlc3BvbnNlIiAtdyAiJXtodHRwX2NvZGV9IiA+ICIkdG1wX3N0YXR1cyIKICAgICkgJgogICAgbG9jYWwgcGlkPSQhCgogICAgaWYgWyAtdCAyIF07IHRoZW4KICAgICAgICBfZnVja19zcGlubmVyICIkcGlkIiAiJHNwaW5uZXJfbGFiZWwiID4mMgogICAgZmkKCiAgICBsb2NhbCBjdXJsX2V4aXQ9MAogICAgaWYgISB3YWl0ICIkcGlkIjsgdGhlbgogICAgICAgIGN1cmxfZXhpdD0kPwogICAgZmkKCiAgICBsb2NhbCBodHRwX3N0YXR1cz0iIgogICAgaWYgWyAtZiAiJHRtcF9zdGF0dXMiIF07IHRoZW4KICAgICAgICBodHRwX3N0YXR1cz0kKHRyIC1kICdcclxuJyA8ICIkdG1wX3N0YXR1cyIpCiAgICAgICAgcm0gLWYgIiR0bXBfc3RhdHVzIgogICAgZmkKCiAgICBsb2NhbCByZXNwb25zZT0iIgogICAgaWYgWyAtZiAiJHRtcF9yZXNwb25zZSIgXTsgdGhlbgogICAgICAgIHJlc3BvbnNlPSQoY2F0ICIkdG1wX3Jlc3BvbnNlIikKICAgICAgICBybSAtZiAiJHRtcF9yZXNwb25zZSIKICAgIGZpCgogICAgaWYgWyAkY3VybF9leGl0IC1uZSAwIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeaXoOazlei/nuaOpeWIsOWFseS6qyBXb3JrZXLjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICBpZiBbIC1uICIkcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICAgICAgZWNobyAtZSAiJHtDX0RJTX0kcmVzcG9uc2Uke0NfUkVTRVR9IiA+JjIKICAgICAgICBmaQogICAgICAgIHJldHVybiAkY3VybF9leGl0CiAgICBmaQoKICAgIGlmIFsgLXogIiRodHRwX3N0YXR1cyIgXTsgdGhlbgogICAgICAgIGh0dHBfc3RhdHVzPTAKICAgIGZpCgogICAgaWYgWyAiJGh0dHBfc3RhdHVzIiAtZXEgNDI5IF0gJiYgcHJpbnRmICclcycgIiRyZXNwb25zZSIgfCBncmVwIC1xICdERU1PX0xJTUlUX0VYQ0VFREVEJzsgdGhlbgogICAgICAgIGxvY2FsIGxpbWl0CiAgICAgICAgbGltaXQ9JChwcmludGYgJyVzJyAiJHJlc3BvbnNlIiB8IHNlZCAtbiAncy8uKiJsaW1pdCI6W1s6c3BhY2U6XV0qXChbMC05XVwrXCkuKi9cMS9wJyB8IGhlYWQgLW4xKQogICAgICAgIGxvY2FsIHJlbWFpbmluZwogICAgICAgIHJlbWFpbmluZz0kKHByaW50ZiAnJXMnICIkcmVzcG9uc2UiIHwgc2VkIC1uICdzLy4qInJlbWFpbmluZyI6W1s6c3BhY2U6XV0qXChbMC05XVwrXCkuKi9cMS9wJyB8IGhlYWQgLW4xKQogICAgICAgIFsgLXogIiRsaW1pdCIgXSAmJiBsaW1pdD0xMAogICAgICAgIF9mdWNrX25vdGlmeV9kZW1vX2xpbWl0ICIkbGltaXQiICIkcmVtYWluaW5nIgogICAgICAgIHJldHVybiAyCiAgICBmaQoKICAgIGlmIFsgIiRodHRwX3N0YXR1cyIgLWdlIDQwMCBdIHx8IFsgLXogIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR95YWx5LqrIFdvcmtlciDov5Tlm54gSFRUUCAkaHR0cF9zdGF0dXPjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICBpZiBbIC1uICIkcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICAgICAgZWNobyAtZSAiJHtDX0RJTX0kcmVzcG9uc2Uke0NfUkVTRVR9IiA+JjIKICAgICAgICBmaQogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIHByaW50ZiAnJXNcbicgIiRyZXNwb25zZSIKfQoKX2Z1Y2tfbm90aWZ5X2RlbW9fbGltaXQoKSB7CiAgICBsb2NhbCBkYWlseV9saW1pdD0iJHsxOi0xMH0iCiAgICBsb2NhbCByZW1haW5pbmc9IiR7MjotMH0iCgogICAgZWNobyAtZSAiJEZVQ0sgJHtDX1lFTExPV33lhbHkuqvkvZPpqozpop3luqblt7LnlKjlhYnvvIjmr4/lpKnmnIDlpJogJHtkYWlseV9saW1pdH0g5qyh77yJ44CCJHtDX1JFU0VUfSIgPiYyCiAgICBjYXNlICIkcmVtYWluaW5nIiBpbgogICAgICAgICcnfCpbITAtOV0qKSA7OwogICAgICAgICopCiAgICAgICAgICAgIGlmIFsgIiRyZW1haW5pbmciIC1ndCAwIF07IHRoZW4KICAgICAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19ESU195LuK5pel5Ymp5L2Z6aKd5bqm77yaJHJlbWFpbmluZyDmrKHjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgZmkKICAgICAgICAgICAgOzsKICAgIGVzYWMKCiAgICBfZnVja19lbnN1cmVfY29uZmlnX2V4aXN0cwogICAgX2Z1Y2tfc2VjdXJlX2NvbmZpZ19maWxlCgogICAgZWNobyAtZSAiJHtDX0NZQU596Kej5Yaz5pa55qGI77yaJHtDX1JFU0VUfei/kOihjCAke0NfR1JFRU59ZnVjayBjb25maWcke0NfUkVTRVR977yM5ZyoICR7Q19HUkVFTn0kQ09ORklHX0ZJTEUke0NfUkVTRVR9IOS4reiuvue9riAke0NfQk9MRH1GVUNLX09QRU5BSV9BUElfS0VZJHtDX1JFU0VUfe+8jOW/heimgeaXtuWQjOaXtumFjee9riAke0NfQk9MRH1GVUNLX09QRU5BSV9NT0RFTCR7Q19SRVNFVH0vJHtDX0JPTER9RlVDS19PUEVOQUlfQVBJX0JBU0Uke0NfUkVTRVR944CCIiA+JjIKICAgIGVjaG8gLWUgIiR7Q19DWUFOfeiLpeS9oOaMgeacieeuoeeQhuWRmOWFjemineWvhumSpe+8miR7Q19SRVNFVH3lkIzmoLflnKjor6Xmlofku7bkuK3phY3nva4gJHtDX0JPTER9RlVDS19BRE1JTl9LRVkke0NfUkVTRVR977yI6ZyA5LiOIFdvcmtlciDkvqfnmoQgQURNSU5fQUNDRVNTX0tFWSDljLnphY3vvInljbPlj6/ot7Pov4flhbHkuqvpop3luqbpmZDliLbjgIIiID4mMgogICAgaWYgWyAtbiAiJHtFRElUT1I6LX0iIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfeaPkOekuu+8miR7Q19SRVNFVH0ke0VESVRPUn0gXCIkQ09ORklHX0ZJTEVcIiIgPiYyCiAgICBmaQogICAgZWNobyAtZSAiJHtDX0RJTX3lronlhajmj5DnpLrvvJrphY3nva7mlofku7boh6rliqggY2htb2QgNjAw77yM5LuF6ZmQ5b2T5YmN55So5oi36K+75Y+W44CCJHtDX1JFU0VUfSIgPiYyCn0KCgojIOWIpOaWreaYr+WQpuS4uiB0cnVlL3llcy9vbiDnrYkKX2Z1Y2tfdHJ1dGh5KCkgewogICAgbG9jYWwgdmFsdWU9IiR7MTotfSIKICAgIGxvY2FsIG5vcm1hbGl6ZWQKICAgIG5vcm1hbGl6ZWQ9JChwcmludGYgJyVzJyAiJHZhbHVlIiB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQogICAgY2FzZSAiJG5vcm1hbGl6ZWQiIGluCiAgICAgICAgMXx0cnVlfHllc3x5fG9ufOaYr3zlvIB855yfKQogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgICAgICopCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgICAgIDs7CiAgICBlc2FjCn0KCiMg6LCD6K+V5pel5b+XCl9mdWNrX2RlYnVnKCkgewogICAgaWYgX2Z1Y2tfdHJ1dGh5ICIke0ZVQ0tfREVCVUc6LTB9IjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19ESU19W+iwg+ivlV0gJCoke0NfUkVTRVR9IiA+JjIKICAgIGZpCn0KCiMgU3Bpbm5lciDliqjnlLsKX2Z1Y2tfc3Bpbm5lcigpIHsKICAgIGxvY2FsIHBpZD0kMQogICAgbG9jYWwgcHJlZml4PSIkezI6LX0iCiAgICBsb2NhbCBkZWxheT0wLjEKICAgIGxvY2FsIC1hIGZyYW1lcz0oInwiICIvIiAiLSIgIlxcIikKICAgIGxvY2FsIGZyYW1lX2NvdW50PSR7I2ZyYW1lc1tAXX0KICAgIGxvY2FsIGZyYW1lX2lkeD0wCiAgICBsb2NhbCBoYXNfcHJlZml4PTAKICAgIGlmIFsgLW4gIiRwcmVmaXgiIF07IHRoZW4KICAgICAgICBoYXNfcHJlZml4PTEKICAgIGZpCiAgICAKICAgICMg6ZqQ6JeP5YWJ5qCHCiAgICB0cHV0IGNpdmlzIDI+L2Rldi9udWxsIHx8IHByaW50ZiAiXDAzM1s/MjVsIgoKICAgIHdoaWxlIGtpbGwgLTAgIiRwaWQiIDI+L2Rldi9udWxsOyBkbwogICAgICAgIGlmIFsgIiRoYXNfcHJlZml4IiAtZXEgMSBdOyB0aGVuCiAgICAgICAgICAgIHByaW50ZiAiXHIlcyVzIiAiJHByZWZpeCIgIiR7ZnJhbWVzWyRmcmFtZV9pZHhdfSIKICAgICAgICBlbHNlCiAgICAgICAgICAgIHByaW50ZiAiICVzICIgIiR7ZnJhbWVzWyRmcmFtZV9pZHhdfSIKICAgICAgICAgICAgcHJpbnRmICJcYlxiXGIiCiAgICAgICAgZmkKICAgICAgICBmcmFtZV9pZHg9JCgoIChmcmFtZV9pZHggKyAxKSAlIGZyYW1lX2NvdW50ICkpCiAgICAgICAgc2xlZXAgIiRkZWxheSIKICAgIGRvbmUKCiAgICBpZiBbICIkaGFzX3ByZWZpeCIgLWVxIDEgXTsgdGhlbgogICAgICAgIHByaW50ZiAiXHIlcyIgIiRwcmVmaXgiCiAgICAgICAgdHB1dCBlbCAyPi9kZXYvbnVsbCB8fCBwcmludGYgIlwwMzNbSyIKICAgIGVsc2UKICAgICAgICBwcmludGYgIiAgIFxiXGJcYiIKICAgIGZpCiAgICAKICAgICMg5oGi5aSN5YWJ5qCHCiAgICB0cHV0IGNub3JtIDI+L2Rldi9udWxsIHx8IHByaW50ZiAiXDAzM1s/MjVoIgp9CgojIC0tLSDlronlhajmo4DmtYvlvJXmk44gKFBoYXNlIDIpIC0tLQoKIyDpmLvmraLnuqflronlhajop4TliJnvvIjmnIDpq5jkuKXph43mgKcgLSDmi5Lnu53miafooYzvvIkKIyDmoLzlvI/vvJon5qih5byPfHx85Y6f5ZugJwppZiBbIC16ICIke19GVUNLX1NFQ1VSSVRZX0JMT0NLX1JVTEVTOi19IiBdOyB0aGVuCiAgICByZWFkb25seSAtYSBfRlVDS19TRUNVUklUWV9CTE9DS19SVUxFUz0oCiAgICAgICAgJyhefFs7JnxbOnNwYWNlOl1dKXJtW1s6c3BhY2U6XV0rLXJmW1s6c3BhY2U6XV0rLyhbWzpzcGFjZTpdXXwkKXx8fOajgOa1i+WIsCBybSAtcmYgL++8jOS8muebtOaOpeWIoOmZpOagueebruW9lScKICAgICAgICAncm1bWzpzcGFjZTpdXSstcmZbWzpzcGFjZTpdXSsvXCp8fHzmo4DmtYvliLAgcm0gLXJmIC8q77yM5Y+v6IO95riF56m65qC555uu5b2VJwogICAgICAgICdybVtbOnNwYWNlOl1dKy1yZltbOnNwYWNlOl1dKy0tbm8tcHJlc2VydmUtcm9vdHx8fOajgOa1i+WIsCAtLW5vLXByZXNlcnZlLXJvb3TvvIzpo47pmanmnoHpq5gnCiAgICAgICAgJ3JtW1s6c3BhY2U6XV0rLXJmW1s6c3BhY2U6XV0rXC5cKnx8fOajgOa1i+WIsCBybSAtcmYgLirvvIzlj6/og73liKDpmaTlhajpg6jpmpDol4/mlofku7YnCiAgICAgICAgJ1xiZGRcYlteI1xuXSpcYihvZnxpZik9L2Rldi98fHzmo4DmtYvliLAgZGQg5q2j5Zyo5YaZ5YWlIC9kZXYg6K6+5aSHJwogICAgICAgICdcYm1rZnMoXC5cdyspP1xifHx85qOA5rWL5YiwIG1rZnMv5qC85byP5YyW5pON5L2cJwogICAgICAgICdcYmZkaXNrXGJ8XGJwYXJ0ZWRcYnxcYmZvcm1hdFxifFxid2lwZWZzXGJ8XGJzaHJlZFxifHx85qOA5rWL5Yiw5YiG5Yy65oiW56OB55uY5pOm6Zmk5ZG95LukJwogICAgICAgICc6XChcKVxzKntccyo6XHMqXHxccyo6O1xzKn1ccyo7P1xzKjp8fHzmo4DmtYvliLAgRm9yayDngrjlvLnmqKHlvI8nCiAgICApCmZpCgojIOaMkeaImOe6p+WuieWFqOinhOWIme+8iOmcgOimgeaYjuehrueUqOaIt+ehruiupO+8iQojIOagvOW8j++8mifmqKHlvI98fHzljp/lm6AnCmlmIFsgLXogIiR7X0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1JVTEVTOi19IiBdOyB0aGVuCiAgICByZWFkb25seSAtYSBfRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfUlVMRVM9KAogICAgICAgICdjdXJsW158XSpcfFxzKihiYXNofHNoKXx8fGN1cmwg566h6YGTIGJhc2gvc2jvvIzlj6/og73ov5znqIvmiafooYzohJrmnKwnCiAgICAgICAgJ3dnZXRbXnxdKlx8XHMqKGJhc2h8c2gpfHx8d2dldCDnrqHpgZMgYmFzaC9zaO+8jOWPr+iDvei/nOeoi+aJp+ihjOiEmuacrCcKICAgICAgICAnXGJzb3VyY2VccytodHRwcz86Ly98fHxzb3VyY2Ug6L+c56iL6ISa5pysJwogICAgICAgICdcYmV2YWxcYnxcYmV4ZWNcYnx8fOS9v+eUqCBldmFsL2V4ZWMg5Yqo5oCB5omn6KGMJwogICAgICAgICdcJFwoW14pXSpcKXx8fOajgOa1i+WIsCAkKC4uLikg5ZG95Luk5pu/5o2iJwogICAgICAgICdgW15gXSpgfHx85qOA5rWL5Yiw5Y+N5byV5Y+35ZG95Luk5pu/5o2iJwogICAgICAgICdcYihzaHxiYXNofGVudilccystY1xifHx85qOA5rWL5YiwIHNoL2Jhc2ggLWMg5YyF6KOF5ZG95LukJwogICAgICAgICdcYnB5dGhvblswLTkuXSpccystY1xifHx85qOA5rWL5YiwIHB5dGhvbiAtYyDlhoXogZTohJrmnKwnCiAgICAgICAgJyhefFs7JnxbOnNwYWNlOl1dKShjcHxtdnxybXxjaG1vZHxjaG93bnxzZWR8dGVlfGNhdClbXjsmfF0qXGIvKGV0Y3xib290fHN5c3xwcm9jfGRldilcYnx8fOWRveS7pOaTjeS9nOWFs+mUruezu+e7n+i3r+W+hCcKICAgICAgICAnXGJwZXJsXHMrLWVcYnx8fOajgOa1i+WIsCBwZXJsIC1lIOWGheiBlOaJp+ihjCcKICAgICAgICAnXGJydWJ5XHMrLWVcYnx8fOajgOa1i+WIsCBydWJ5IC1lIOWGheiBlOaJp+ihjCcKICAgICAgICAnXGJub2RlXHMrLWVcYnx8fOajgOa1i+WIsCBub2RlIC1lIOWGheiBlOaJp+ihjCcKICAgICAgICAnXGJwaHBccystclxifHx85qOA5rWL5YiwIHBocCAtciDlhoXogZTmiafooYwnCiAgICAgICAgJ2Jhc2U2NFtefF0qXHxccyooYmFzaHxzaHxldmFsKXx8fOajgOa1i+WIsCBiYXNlNjQg57yW56CB5ZG95Luk5omn6KGMJwogICAgICAgICdcYnhhcmdzXGIuKigtSXwtaXx7fSkuKlxiKHNofGJhc2h8cm18Y2htb2QpXGJ8fHzmo4DmtYvliLDpgJrov4cgeGFyZ3Mg5omn6KGM5ZG95LukJwogICAgICAgICdcYmZpbmRcYltefDtdKi1leGVjXGJ8fHzmo4DmtYvliLDpgJrov4cgZmluZCAtZXhlYyDmiafooYzlkb3ku6QnCiAgICAgICAgJ1xiKGF3a3xnYXdrfG5hd2t8bWF3aylcYltefDtdKnN5c3RlbVxzKlwofHx85qOA5rWL5Yiw6YCa6L+HIGF3ayBzeXN0ZW0oKSDpl7TmjqXmiafooYwnCiAgICAgICAgJ1xicHJpbnRmXGIuKlxcXFx4WzAtOWEtZkEtRl18fHzmo4DmtYvliLDlj6/og73nmoTljYHlha3ov5vliLbnvJbnoIHlkb3ku6Tms6jlhaUnCiAgICAgICAgJ1wkXHtbXn1dKiNcfXx8fOajgOa1i+WIsOWPr+iDveaUueWPmOWRveS7pOeahOWPguaVsOWxleW8gCcKICAgICAgICAnZWNob1xzK1tefF0qXHxccyooYmFzaHxzaHxldmFsKXx8fOajgOa1i+WIsCBlY2hvIOeuoemBk+WIsCBzaGVsbCDmiafooYwnCiAgICApCmZpCgojIOitpuWRiue6p+WuieWFqOinhOWIme+8iOS7heitpuWRiu+8jOeUqOaIt+WPr+e7p+e7re+8iQojIOagvOW8j++8mifmqKHlvI98fHzljp/lm6AnCmlmIFsgLXogIiR7X0ZVQ0tfU0VDVVJJVFlfV0FSTl9SVUxFUzotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgLWEgX0ZVQ0tfU0VDVVJJVFlfV0FSTl9SVUxFUz0oCiAgICAgICAgJ3JtW1s6c3BhY2U6XV0rLXJmXGJ8fHzlj5HnjrAgcm0gLXJm77yM5omn6KGM5YmN6K+35YaN5qyh56Gu6K6kJwogICAgICAgICdjaG1vZFtbOnNwYWNlOl1dKy4qNzc3XGJ8fHzmo4DmtYvliLAgY2htb2QgNzc3IOadg+mZkCcKICAgICAgICAnc3Vkb1tbOnNwYWNlOl1dK1teOyZ8XSpybVtbOnNwYWNlOl1dKy1yZnx8fHN1ZG8gcm0gLXJmIOmjjumZqScKICAgICAgICAnPltbOnNwYWNlOl1dKi8oZXRjLyhwYXNzd2R8c2hhZG93fHN1ZG9lcnMpfGRldi9zZFthLXpdKyl8fHzph43lrprlkJHovpPlh7rliLDmlY/mhJ/ns7vnu5/mlofku7YnCiAgICApCmZpCgojIOS7jumFjee9ruiOt+WPluW9k+WJjeWuieWFqOaooeW8jwojIOi+k+WHuu+8miJzdHJpY3Qi44CBImJhbGFuY2VkIiDmiJYgIm9mZiIKX2Z1Y2tfc2VjdXJpdHlfbW9kZSgpIHsKICAgIGxvY2FsIG1vZGU9IiR7RlVDS19TRUNVUklUWV9NT0RFOi1iYWxhbmNlZH0iCiAgICBtb2RlPSQocHJpbnRmICclcycgIiRtb2RlIiB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQoKICAgIGNhc2UgIiRtb2RlIiBpbgogICAgICAgIHN0cmljdCkgcHJpbnRmICdzdHJpY3RcbicgOzsKICAgICAgICBvZmZ8ZGlzYWJsZWR8bm9uZSkgcHJpbnRmICdvZmZcbicgOzsKICAgICAgICBiYWxhbmNlZHxkZWZhdWx0fCIiKSBwcmludGYgJ2JhbGFuY2VkXG4nIDs7CiAgICAgICAgKikgcHJpbnRmICdiYWxhbmNlZFxuJyA7OwogICAgZXNhYwp9CgojIOiOt+WPluWuieWFqOehruiupOeahOm7mOiupOaMkeaImOaWh+acrAojIOi+k+WHuu+8mum7mOiupOaMkeaImOefreivrQpfZnVja19zZWN1cml0eV9kZWZhdWx0X2NoYWxsZW5nZV90ZXh0KCkgewogICAgcHJpbnRmICfmiJHnoa7orqTmib/mi4Xpo47pmaknCn0KCiMg5qOA5p+l5ZG95Luk5piv5ZCm5Yy56YWN5a6J5YWo55m95ZCN5Y2VCiMg5Y+C5pWw77yaJDEgLSDopoHmo4Dmn6XnmoTlkb3ku6QKIyDov5Tlm57vvJowIOWmguaenOWcqOeZveWQjeWNleS4re+8jDEg5ZCm5YiZCl9mdWNrX3NlY3VyaXR5X2lzX3doaXRlbGlzdGVkKCkgewogICAgbG9jYWwgY29tbWFuZD0iJDEiCiAgICBsb2NhbCB3aGl0ZWxpc3Q9IiR7RlVDS19TRUNVUklUWV9XSElURUxJU1Q6LX0iCgogICAgaWYgWyAteiAiJHdoaXRlbGlzdCIgXTsgdGhlbgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIG5vcm1hbGl6ZWQgZW50cnkKICAgIG5vcm1hbGl6ZWQ9JChwcmludGYgJyVzJyAiJHdoaXRlbGlzdCIgfCB0ciAnLCcgJ1xuJykKCiAgICB3aGlsZSBJRlM9IHJlYWQgLXIgZW50cnk7IGRvCiAgICAgICAgZW50cnk9JChwcmludGYgJyVzJyAiJGVudHJ5IiB8IHNlZCAtZSAncy9eW1s6c3BhY2U6XV0qLy8nIC1lICdzL1tbOnNwYWNlOl1dKiQvLycpCiAgICAgICAgWyAteiAiJGVudHJ5IiBdICYmIGNvbnRpbnVlCgogICAgICAgIGlmIHByaW50ZiAnJXMnICIkY29tbWFuZCIgfCBncmVwIC1GcSAiJGVudHJ5IjsgdGhlbgogICAgICAgICAgICByZXR1cm4gMAogICAgICAgIGZpCiAgICBkb25lIDw8PCAiJG5vcm1hbGl6ZWQiCgogICAgcmV0dXJuIDEKfQoKIyDlsIblronlhajnuqfliKvovazmjaLkuLrmlbDlgLzku6Xkvr/mr5TovoMKIyDlj4LmlbDvvJokMSAtIOWuieWFqOe6p+WIq++8iGJsb2NrL2NoYWxsZW5nZS93YXJuL29r77yJCiMg6L6T5Ye677ya5pWw5YC877yIMy8yLzEvMO+8iQpfZnVja19zZWN1cml0eV9sZXZlbF92YWx1ZSgpIHsKICAgIGNhc2UgIiQxIiBpbgogICAgICAgIGJsb2NrKSBwcmludGYgJzNcbicgOzsKICAgICAgICBjaGFsbGVuZ2UpIHByaW50ZiAnMlxuJyA7OwogICAgICAgIHdhcm4pIHByaW50ZiAnMVxuJyA7OwogICAgICAgICopIHByaW50ZiAnMFxuJyA7OwogICAgZXNhYwp9CgojIOWmguaenOWAmemAiee6p+WIq+abtOS4pemHjeWImeaPkOWNh+WuieWFqOe6p+WIqwojIOWPguaVsO+8miQxIC0g5b2T5YmN57qn5Yir77yMJDIgLSDlgJnpgInnuqfliKsKIyDovpPlh7rvvJrmm7TkuKXph43nmoTnuqfliKsKX2Z1Y2tfc2VjdXJpdHlfcHJvbW90ZSgpIHsKICAgIGxvY2FsIGN1cnJlbnQ9IiQxIgogICAgbG9jYWwgY2FuZGlkYXRlPSIkMiIKICAgIGxvY2FsIGN1cnJlbnRfdmFsIGNhbmRpZGF0ZV92YWwKCiAgICBjdXJyZW50X3ZhbD0kKF9mdWNrX3NlY3VyaXR5X2xldmVsX3ZhbHVlICIkY3VycmVudCIpCiAgICBjYW5kaWRhdGVfdmFsPSQoX2Z1Y2tfc2VjdXJpdHlfbGV2ZWxfdmFsdWUgIiRjYW5kaWRhdGUiKQoKICAgIGlmIFsgIiRjYW5kaWRhdGVfdmFsIiAtZ3QgIiRjdXJyZW50X3ZhbCIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRjYW5kaWRhdGUiCiAgICBlbHNlCiAgICAgICAgcHJpbnRmICclc1xuJyAiJGN1cnJlbnQiCiAgICBmaQp9CgojIOagueaNruWuieWFqOaooeW8j+iwg+aVtOS4pemHjeaAp+e6p+WIqwojIOWPguaVsO+8miQxIC0g5qih5byP77yIc3RyaWN0L2JhbGFuY2VkL29mZu+8ie+8jCQyIC0g5Lil6YeN5oCn57qn5YirCiMg6L6T5Ye677ya6LCD5pW05ZCO55qE5Lil6YeN5oCn57qn5YirCl9mdWNrX3NlY3VyaXR5X2FwcGx5X21vZGUoKSB7CiAgICBsb2NhbCBtb2RlPSIkMSIKICAgIGxvY2FsIHNldmVyaXR5PSIkMiIKCiAgICBjYXNlICIkbW9kZSIgaW4KICAgICAgICBzdHJpY3QpCiAgICAgICAgICAgIGNhc2UgIiRzZXZlcml0eSIgaW4KICAgICAgICAgICAgICAgIHdhcm4pIHNldmVyaXR5PSJjaGFsbGVuZ2UiIDs7CiAgICAgICAgICAgICAgICBjaGFsbGVuZ2UpIHNldmVyaXR5PSJibG9jayIgOzsKICAgICAgICAgICAgZXNhYwogICAgICAgICAgICA7OwogICAgZXNhYwoKICAgIHByaW50ZiAnJXNcbicgIiRzZXZlcml0eSIKfQoKIyDlsIblkb3ku6TkuI7lronlhajop4TliJnooajljLnphY0KIyDlj4LmlbDvvJokMSAtIOWRveS7pO+8jCQyIC0g6KeE5YiZ6KGo5ZCN56ewCiMg6L6T5Ye677ya5aaC5p6c5Yy56YWN5YiZ6L6T5Ye65Y6f5Zug5a2X56ym5LiyCiMg6L+U5Zue77yaMCDlpoLmnpzljLnphY3vvIwxIOWQpuWImQpfZnVja19zZWN1cml0eV9tYXRjaF9ydWxlKCkgewogICAgbG9jYWwgY29tbWFuZD0iJDEiCiAgICBsb2NhbCB0YWJsZT0iJDIiCiAgICBsb2NhbCAtYSBydWxlcz0oKQoKICAgIGV2YWwgInJ1bGVzPShcIlwkeyR7dGFibGV9W0BdfVwiKSIKCiAgICBsb2NhbCBydWxlIHBhdHRlcm4gcmVhc29uCiAgICBmb3IgcnVsZSBpbiAiJHtydWxlc1tAXX0iOyBkbwogICAgICAgIHBhdHRlcm49JHtydWxlJSV8fHwqfQogICAgICAgIHJlYXNvbj0ke3J1bGUjKnx8fH0KICAgICAgICBbIC16ICIkcGF0dGVybiIgXSAmJiBjb250aW51ZQoKICAgICAgICBpZiBwcmludGYgJyVzJyAiJGNvbW1hbmQiIHwgZ3JlcCAtRWlxIC0tICIkcGF0dGVybiI7IHRoZW4KICAgICAgICAgICAgcHJpbnRmICclc1xuJyAiJHJlYXNvbiIKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICBmaQogICAgZG9uZQoKICAgIHJldHVybiAxCn0KCiMg5pi+56S65r2c5Zyo5Y2x6Zmp5ZG95Luk55qE6K2m5ZGK5raI5oGvCiMg5Y+C5pWw77yaJDEgLSDorablkYrljp/lm6AKX2Z1Y2tfc2VjdXJpdHlfd2Fybl9tZXNzYWdlKCkgewogICAgbG9jYWwgcmVhc29uPSIkMSIKICAgIGVjaG8gLWUgIiR7Q19SRURfQk9MRH3imqDvuI8gIOWuieWFqOitpuWRiu+8miR7Q19SRVNFVH0ke3JlYXNvbn0iID4mMgogICAgZWNobyAtZSAiJHtDX1lFTExPV33or7fku5Tnu4blrqHmn6XvvIzoi6Xnoa7orqTlj6/kv6Hlj6/phY3nva4gRlVDS19TRUNVUklUWV9XSElURUxJU1TjgIIke0NfUkVTRVR9IiA+JjIKfQoKIyDmmL7npLrooqvnpoHmraLlkb3ku6TnmoTpmLvmraLmtojmga8KIyDlj4LmlbDvvJokMSAtIOmYu+atouWOn+WboApfZnVja19zZWN1cml0eV9ibG9ja19tZXNzYWdlKCkgewogICAgbG9jYWwgcmVhc29uPSIkMSIKICAgIGVjaG8gLWUgIiR7Q19SRURfQk9MRH3im5Qg5bey6Zi75q2i77yaJHtDX1JFU0VUfSR7cmVhc29ufSIgPiYyCiAgICBlY2hvIC1lICIke0NfUkVEfeaJp+ihjOiiq+aLkue7ne+8jOWPr+iwg+aVtCBGVUNLX1NFQ1VSSVRZX01PREUg5oiW5Yqg5YWl55m95ZCN5Y2V5ZCO6YeN6K+V44CCJHtDX1JFU0VUfSIgPiYyCn0KCiMg5pi+56S66auY6aOO6Zmp5ZG95Luk55qE5oyR5oiY5raI5oGvCiMg5Y+C5pWw77yaJDEgLSDmjJHmiJjljp/lm6DvvIwkMiAtIOmcgOimgeeahOefreivrQpfZnVja19zZWN1cml0eV9jaGFsbGVuZ2VfbWVzc2FnZSgpIHsKICAgIGxvY2FsIHJlYXNvbj0iJDEiCiAgICBsb2NhbCBwaHJhc2U9IiQyIgogICAgZWNobyAtZSAiJHtDX1JFRF9CT0xEfeKaoO+4jyAg6auY5Y2x5oyR5oiY77yaJHtDX1JFU0VUfSR7cmVhc29ufSIgPiYyCiAgICBlY2hvIC1lICIke0NfQ1lBTn3lpoLpnIDnu6fnu63vvIzor7fovpPlhaXkuIvmlrnnn63or63vvJoke0NfUkVTRVR9IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19CT0xEfSR7cGhyYXNlfSR7Q19SRVNFVH0iID4mMgp9CgojIOaPkOekuueUqOaIt+i+k+WFpeWuieWFqOaMkeaImOaJgOmcgOeahOefreivrQojIOWPguaVsO+8miQxIC0g6ZyA6KaB55qE55+t6K+tCiMg6L+U5Zue77yaMCDlpoLmnpznn63or63ljLnphY3vvIwxIOWQpuWImQpfZnVja19zZWN1cml0eV9wcm9tcHRfcGhyYXNlKCkgewogICAgbG9jYWwgcGhyYXNlPSIkMSIKICAgIGxvY2FsIGlucHV0PSIiCgogICAgcHJpbnRmICIlYj4gJWIiICIkQ19CT0xEIiAiJENfUkVTRVQiID4mMgoKICAgIGlmIFsgLXIgL2Rldi90dHkgXTsgdGhlbgogICAgICAgIGlmICEgSUZTPSByZWFkIC1yIGlucHV0IDwgL2Rldi90dHk7IHRoZW4KICAgICAgICAgICAgcHJpbnRmICJcbiIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKICAgIGVsc2UKICAgICAgICBpZiAhIElGUz0gcmVhZCAtciBpbnB1dDsgdGhlbgogICAgICAgICAgICBwcmludGYgIlxuIiA+JjIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICBmaQogICAgZmkKCiAgICBwcmludGYgIlxuIiA+JjIKICAgIFsgIiRpbnB1dCIgPSAiJHBocmFzZSIgXQp9CgojIOagueaNruS4pemHjeaAp+e6p+WIq+WkhOeQhuWuieWFqOWGs+etlgojIOWPguaVsO+8miQxIC0g5Lil6YeN5oCn57qn5Yir77yMJDIgLSDljp/lm6DvvIwkMyAtIOWRveS7pAojIOi/lOWbnu+8mjAg5YWB6K645omn6KGM77yMMSDmi5Lnu50KX2Z1Y2tfc2VjdXJpdHlfaGFuZGxlX2RlY2lzaW9uKCkgewogICAgbG9jYWwgc2V2ZXJpdHk9IiQxIgogICAgbG9jYWwgcmVhc29uPSIkMiIKICAgIGxvY2FsIGNvbW1hbmQ9IiQzIgoKICAgIGNhc2UgIiRzZXZlcml0eSIgaW4KICAgICAgICAiInxva3xvZmYpCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIDs7CiAgICAgICAgd2FybikKICAgICAgICAgICAgX2Z1Y2tfc2VjdXJpdHlfd2Fybl9tZXNzYWdlICIke3JlYXNvbjot5qOA5rWL5Yiw5r2c5Zyo6aOO6ZmpfSIKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgOzsKICAgICAgICBjaGFsbGVuZ2UpCiAgICAgICAgICAgIGxvY2FsIHBocmFzZT0iJHtGVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9URVhUOi0kKF9mdWNrX3NlY3VyaXR5X2RlZmF1bHRfY2hhbGxlbmdlX3RleHQpfSIKICAgICAgICAgICAgX2Z1Y2tfc2VjdXJpdHlfY2hhbGxlbmdlX21lc3NhZ2UgIiR7cmVhc29uOi3pq5jljbHlkb3ku6TvvIzor7flho3mrKHnoa7orqR9IiAiJHBocmFzZSIKCiAgICAgICAgICAgIGlmIF9mdWNrX3NlY3VyaXR5X3Byb21wdF9waHJhc2UgIiRwaHJhc2UiOyB0aGVuCiAgICAgICAgICAgICAgICBlY2hvIC1lICIke0NfR1JFRU595bey6YCa6L+H5a6J5YWo5oyR5oiY44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICBmaQoKICAgICAgICAgICAgZWNobyAtZSAiJHtDX1JFRH3lronlhajmjJHmiJjlpLHotKXvvIzlkb3ku6Tooqvlj5bmtojjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICAgICAgOzsKICAgICAgICBibG9jaykKICAgICAgICAgICAgX2Z1Y2tfYXVkaXRfbG9nICJCTE9DSyIgIiRjb21tYW5kIgogICAgICAgICAgICBfZnVja19zZWN1cml0eV9ibG9ja19tZXNzYWdlICIke3JlYXNvbjot5ZG95Luk6KKr5a6J5YWo562W55Wl6Zi75q2ifSIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICAgICAgOzsKICAgICAgICAqKQogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgZXNhYwp9CgojIOivhOS8sOWRveS7pOWuieWFqOaAp+W5tui/lOWbnuS4pemHjeaAp+e6p+WIq+WSjOWOn+WboAojIOWPguaVsO+8miQxIC0g6KaB6K+E5Lyw55qE5ZG95LukCiMg6L6T5Ye677yaIuS4pemHjeaAp3zljp/lm6AiIOWtl+espuS4sgojIOi/lOWbnu+8muWni+e7iOi/lOWbniAw77yI57uT5p6c5Zyo6L6T5Ye65Lit77yJCl9mdWNrX3NlY3VyaXR5X2V2YWx1YXRlX2NvbW1hbmQoKSB7CiAgICBsb2NhbCBjb21tYW5kPSIkMSIKICAgIGxvY2FsIG1vZGUgc2V2ZXJpdHkgcmVhc29uIG1hdGNoIHByb21vdGVkIHN0cnVjdHVyYWxfcmVhc29uCgogICAgbW9kZT0kKF9mdWNrX3NlY3VyaXR5X21vZGUpCgogICAgIyDlronlhajlvJXmk47lt7LnpoHnlKgKICAgIGlmIFsgIiRtb2RlIiA9ICJvZmYiIF07IHRoZW4KICAgICAgICBwcmludGYgJ29mZnzlronlhajlvJXmk47lt7LlhbPpl61cbicKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICAjIOajgOafpeeZveWQjeWNlQogICAgaWYgX2Z1Y2tfc2VjdXJpdHlfaXNfd2hpdGVsaXN0ZWQgIiRjb21tYW5kIjsgdGhlbgogICAgICAgIHByaW50ZiAnb2t85ZG95Luk5ZG95Lit55m95ZCN5Y2VXG4nCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgc2V2ZXJpdHk9Im9rIgogICAgcmVhc29uPSIiCiAgICBtYXRjaD0iIgoKICAgICMg5qOA5p+l6Zi75q2i6KeE5YiZ77yI5pyA6auY5LyY5YWI57qn77yJCiAgICBpZiBtYXRjaD0kKF9mdWNrX3NlY3VyaXR5X21hdGNoX3J1bGUgIiRjb21tYW5kIiAiX0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJibG9jayIKICAgICAgICByZWFzb249IiRtYXRjaCIKICAgIGZpCgogICAgIyDmo4Dmn6XmjJHmiJjop4TliJnvvIjkuK3nrYnkvJjlhYjnuqfvvIkKICAgIGlmIFsgIiRzZXZlcml0eSIgIT0gImJsb2NrIiBdICYmIG1hdGNoPSQoX2Z1Y2tfc2VjdXJpdHlfbWF0Y2hfcnVsZSAiJGNvbW1hbmQiICJfRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJjaGFsbGVuZ2UiCiAgICAgICAgcmVhc29uPSIkbWF0Y2giCiAgICBmaQoKICAgICMg5qOA5p+l6K2m5ZGK6KeE5YiZ77yI5L2O5LyY5YWI57qn77yJCiAgICBpZiBbICIkc2V2ZXJpdHkiID0gIm9rIiBdICYmIG1hdGNoPSQoX2Z1Y2tfc2VjdXJpdHlfbWF0Y2hfcnVsZSAiJGNvbW1hbmQiICJfRlVDS19TRUNVUklUWV9XQVJOX1JVTEVTIik7IHRoZW4KICAgICAgICBzZXZlcml0eT0id2FybiIKICAgICAgICByZWFzb249IiRtYXRjaCIKICAgIGZpCgogICAgIyDmo4Dmn6Xlkb3ku6Tpk77mjqUv566h6YGT77yI57uT5p6E5YiG5p6Q77yJCiAgICBpZiBwcmludGYgJyVzJyAiJGNvbW1hbmQiIHwgZ3JlcCAtRWlxICcoJiZ8XHxcfHw7fFx8KSc7IHRoZW4KICAgICAgICBzdHJ1Y3R1cmFsX3JlYXNvbj0i5qOA5rWL5Yiw5ZG95Luk5YiG6ZqU56ymL+euoemBkyIKICAgICAgICBwcm9tb3RlZD0kKF9mdWNrX3NlY3VyaXR5X3Byb21vdGUgIiRzZXZlcml0eSIgIndhcm4iKQoKICAgICAgICBpZiBbICIkcHJvbW90ZWQiICE9ICIkc2V2ZXJpdHkiIF07IHRoZW4KICAgICAgICAgICAgc2V2ZXJpdHk9IiRwcm9tb3RlZCIKICAgICAgICAgICAgcmVhc29uPSIkc3RydWN0dXJhbF9yZWFzb24iCiAgICAgICAgZWxpZiBbIC16ICIkcmVhc29uIiBdOyB0aGVuCiAgICAgICAgICAgIHJlYXNvbj0iJHN0cnVjdHVyYWxfcmVhc29uIgogICAgICAgIGZpCiAgICBmaQoKICAgICMg5bqU55So5a6J5YWo5qih5byP6LCD5pW0CiAgICBzZXZlcml0eT0kKF9mdWNrX3NlY3VyaXR5X2FwcGx5X21vZGUgIiRtb2RlIiAiJHNldmVyaXR5IikKCiAgICBwcmludGYgJyVzfCVzXG4nICIkc2V2ZXJpdHkiICIke3JlYXNvbjot5b2T5YmN5ZG95Luk5pyq5ZG95Lit5a6J5YWo6KeE5YiZfSIKfQoKIyDlkJHlkI7lhbzlrrnnmoTpgZfnlZnlh73mlbAKIyDlj4LmlbDvvJokMSAtIOimgeajgOafpeeahOWRveS7pAojIOi+k+WHuu+8miLkuKXph43mgKd85Y6f5ZugIiDlrZfnrKbkuLIKX2Z1Y2tfZGV0ZWN0X2Rhbmdlcm91c19jb21tYW5kKCkgewogICAgX2Z1Y2tfc2VjdXJpdHlfZXZhbHVhdGVfY29tbWFuZCAiJDEiCn0KCgojIOehruS/nemFjee9ruaWh+S7tuWtmOWcqApfZnVja19zZWN1cmVfY29uZmlnX2ZpbGUoKSB7CiAgICBpZiBbIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBjaG1vZCA2MDAgIiRDT05GSUdfRklMRSIgMj4vZGV2L251bGwgfHwgdHJ1ZQogICAgZmkKfQoKX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50KCkgewogICAgbG9jYWwga2V5PSIkMSIKICAgIGxvY2FsIGNvbW1lbnQ9IiQyIgogICAgbG9jYWwgc2FtcGxlPSIkMyIKICAgIGxvY2FsIHF1b3RlZD0iJHs0Oi0xfSIKICAgIFsgLWYgIiRDT05GSUdfRklMRSIgXSB8fCByZXR1cm4KICAgIGlmIGdyZXAgLUVxICJeXFxzKiM/XFxzKmV4cG9ydFxccyska2V5IiAiJENPTkZJR19GSUxFIjsgdGhlbgogICAgICAgIHJldHVybgogICAgZmkKCiAgICBsb2NhbCBhc3NpZ25tZW50CiAgICBpZiBbICIkcXVvdGVkIiA9ICIxIiBdOyB0aGVuCiAgICAgICAgYXNzaWdubWVudD0iIyBleHBvcnQgJGtleT1cIiRzYW1wbGVcIiIKICAgIGVsc2UKICAgICAgICBhc3NpZ25tZW50PSIjIGV4cG9ydCAka2V5PSRzYW1wbGUiCiAgICBmaQoKICAgIHsKICAgICAgICBwcmludGYgJ1xuJwogICAgICAgIHByaW50ZiAnIyAlc1xuJyAiJGNvbW1lbnQiCiAgICAgICAgcHJpbnRmICclc1xuJyAiJGFzc2lnbm1lbnQiCiAgICB9ID4+ICIkQ09ORklHX0ZJTEUiCn0KCl9mdWNrX3NlZWRfY29uZmlnX3BsYWNlaG9sZGVycygpIHsKICAgIFsgLWYgIiRDT05GSUdfRklMRSIgXSB8fCByZXR1cm4KICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19PUEVOQUlfQVBJX0tFWSIgIuacrOWcsCBPcGVuQUkg5YW85a65IEtlee+8iOaOqOiNkO+8iSIgJ3NrLS4uLicKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19BRE1JTl9LRVkiICLnrqHnkIblkZjlhY3pop3luqblr4bpkqXvvIjku4XliIbkuqvnu5nkv6Hku7vnmoTkurrvvIkiICdhZG0tLi4uJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX09QRU5BSV9NT0RFTCIgIuimhueblum7mOiupOaooeWeiyIgJ2dwdC00by1taW5pJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX09QRU5BSV9BUElfQkFTRSIgIuiHquWumuS5iSBBUEkg5Z+65Z2AIiAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MScKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19BTElBUyIgIumineWkluWIq+WQje+8iOS4jeW9seWTjem7mOiupCBmdWNr77yJIiAn6L+Q6KGMJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FVVE9fRVhFQyIgIuiHquWKqOaJp+ihjOi/lOWbnuWRveS7pO+8iOWNsemZqeaTjeS9nO+8iSIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfVElNRU9VVCIgIuivt+axgui2heaXtuaXtumXtO+8iOenku+8iSIgJzMwJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfREVCVUciICLmmK/lkKbovpPlh7rosIPor5Xkv6Hmga8iICdmYWxzZScgMAogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUyIgIuemgeeUqOWGhee9riBmdWNrIOWIq+WQjSIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfU0VDVVJJVFlfTU9ERSIgIuWuieWFqOW8leaTjuaooeW8j++8mnN0cmljdHxiYWxhbmNlZHxvZmYiICdiYWxhbmNlZCcKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9XSElURUxJU1QiICLku6XpgJflj7fmiJbmjaLooYzliIbpmpTnmoTkv6Hku7vlkb3ku6TniYfmrrUiICcnCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1RFWFQiICLpq5jljbHlkb3ku6TpnIDopoHovpPlhaXnmoTnoa7orqTnn63or60iICfmiJHnoa7orqTmib/mi4Xpo47pmaknCn0KCl9mdWNrX2Vuc3VyZV9jb25maWdfZXhpc3RzKCkgewogICAgaWYgWyAtZiAiJENPTkZJR19GSUxFIiBdOyB0aGVuCiAgICAgICAgX2Z1Y2tfc2VlZF9jb25maWdfcGxhY2Vob2xkZXJzCiAgICAgICAgX2Z1Y2tfc2VjdXJlX2NvbmZpZ19maWxlCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIG1rZGlyIC1wICIkKGRpcm5hbWUgIiRDT05GSUdfRklMRSIpIgogICAgY2F0IDw8J0NGRycgPiAiJENPTkZJR19GSUxFIgojIGZ1Y2tpdHMg6YWN572u56S65L6LCiMg5Y675o6J6KGM6aaW55qEICPvvIzmlLnmiJDkvaDoh6rlt7HnmoTlgLzljbPlj6/jgIIKCiMg6Ieq5bu6L+iHquWumuS5iSBXb3JrZXIg5YWl5Y+jCiMgZXhwb3J0IEZVQ0tfQVBJX0VORFBPSU5UPSJodHRwczovL3lvdXItZG9tYWluLndvcmtlcnMuZGV2LyIKCiMg5pys5ZywIE9wZW5BSSDlhbzlrrkgS2V577yI5by654OI5o6o6I2Q77yJCiMgZXhwb3J0IEZVQ0tfT1BFTkFJX0FQSV9LRVk9InNrLS4uLiIKCiMg566h55CG5ZGY5LiT55So5YWN6aKd5bqm5a+G6ZKl77yI5LuF5YiG5Lqr57uZ5L+h5Lu755qE5Lq677yJCiMgZXhwb3J0IEZVQ0tfQURNSU5fS0VZPSJhZG0tLi4uIgoKIyDopobnm5bpu5jorqTmqKHlnovmiJYgQVBJIOWfuuWdgAojIGV4cG9ydCBGVUNLX09QRU5BSV9NT0RFTD0iZ3B0LTRvLW1pbmkiCiMgZXhwb3J0IEZVQ0tfT1BFTkFJX0FQSV9CQVNFPSJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxIgoKIyDpop3lpJbliKvlkI3vvIjkuI3kvJrlvbHlk43pu5jorqQgZnVja++8iQojIGV4cG9ydCBGVUNLX0FMSUFTPSLov5DooYwiCgojIOiHquWKqOaJp+ihjOi/lOWbnuWRveS7pO+8iOWNsemZqe+8jOiwqOaFjuW8gOWQr++8iQojIGV4cG9ydCBGVUNLX0FVVE9fRVhFQz1mYWxzZQoKIyDor7fmsYLotoXml7bml7bpl7TvvIjnp5LvvIkKIyBleHBvcnQgRlVDS19USU1FT1VUPTMwCgojIOaYr+WQpui+k+WHuuiwg+ivleS/oeaBrwojIGV4cG9ydCBGVUNLX0RFQlVHPWZhbHNlCgojIOemgeeUqOWGhee9riBmdWNrIOWIq+WQjQojIGV4cG9ydCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUz1mYWxzZQoKIyAtLS0g5a6J5YWo6K6+572uIC0tLQojIOWuieWFqOaooeW8j++8mnN0cmljdO+8iOS4peagvO+8iSwgYmFsYW5jZWTvvIjlnYfooaHvvIzpu5jorqTvvIksIG9mZu+8iOWFs+mXre+8iQojIGV4cG9ydCBGVUNLX1NFQ1VSSVRZX01PREU9ImJhbGFuY2VkIgoKIyDnmb3lkI3ljZXlj6/kv6Hlkb3ku6TmqKHlvI/vvIjpgJflj7fliIbpmpTvvIkKIyBleHBvcnQgRlVDS19TRUNVUklUWV9XSElURUxJU1Q9ImRvY2tlciBybSAtZixybSAtcmYgL3RtcC9zYWZlLWRpciIKCiMgLS0tIOWuoeiuoeaXpeW/lyAtLS0KIyDlkK/nlKjlrqHorqHml6Xlv5forrDlvZXmiYDmnInmiafooYznmoTlkb3ku6QKIyBleHBvcnQgRlVDS19BVURJVF9MT0c9dHJ1ZQoKIyDoh6rlrprkuYnlrqHorqHml6Xlv5fmlofku7bot6/lvoTvvIjpu5jorqTvvJp+Ly5mdWNrLy5hdWRpdC5sb2fvvIkKIyBleHBvcnQgRlVDS19BVURJVF9MT0dfRklMRT0iJEhPTUUvLmZ1Y2svLmF1ZGl0LmxvZyIKQ0ZHCgogICAgX2Z1Y2tfc2VlZF9jb25maWdfcGxhY2Vob2xkZXJzCiAgICBfZnVja19zZWN1cmVfY29uZmlnX2ZpbGUKfQoKIyDmmL7npLrphY3nva7mj5DnpLoKX2Z1Y2tfc2hvd19jb25maWdfaGVscCgpIHsKICAgIF9mdWNrX2Vuc3VyZV9jb25maWdfZXhpc3RzCiAgICBlY2hvIC1lICIke0NfWUVMTE9XfemFjee9ruaWh+S7tu+8miR7Q19SRVNFVH0gJHtDX0NZQU59JENPTkZJR19GSUxFJHtDX1JFU0VUfSIKICAgIGlmIFsgLW4gIiR7RURJVE9SOi19IiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33lj6/ku6Xkvb/nlKjvvJoke0NfUkVTRVR9ICR7Q19DWUFOfSR7RURJVE9SfSAkQ09ORklHX0ZJTEUke0NfUkVTRVR9IgogICAgZWxzZQogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d955So5Lu75oSP57yW6L6R5Zmo5omT5byA6K+l5paH5Lu25Y2z5Y+v5L+u5pS56YWN572u44CCJHtDX1JFU0VUfSIKICAgIGZpCiAgICBlY2hvIC1lICIke0NfQ1lBTn3lj6/nlKjpgInpobnvvJoke0NfUkVTRVR9RlVDS19BUElfRU5EUE9JTlQsIEZVQ0tfT1BFTkFJX0FQSV9LRVksIEZVQ0tfQURNSU5fS0VZLCBGVUNLX09QRU5BSV9NT0RFTCwgRlVDS19PUEVOQUlfQVBJX0JBU0UsIEZVQ0tfQUxJQVMsIEZVQ0tfQVVUT19FWEVDLCBGVUNLX1RJTUVPVVQsIEZVQ0tfREVCVUcsIEZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTIgogICAgZWNobyAtZSAiJHtDX0RJTX3lronlhajor7TmmI7vvJrphY3nva7mlofku7bkvJroh6rliqggY2htb2QgNjAw77yM6Ziy5q2iIEtleSDms4TpnLLjgIIke0NfUkVTRVR9Igp9CgojIOWNuOi9veiEmuacrApfdW5pbnN0YWxsX3NjcmlwdCgpIHsKICAgIGVjaG8gLWUgIiR7Q19SRURfQk9MRH3lpb3lpb3lpb3vvIEke0NfUkVTRVR9JHtDX1lFTExPV33mgI7kuYjnnYDvvIzopoHljbjno6jmnYDpqbTllYrvvJ/ooYzllYrkvaDkuKrogIHlha3vvIzmiJHnnJ/osKLosKLkvaDkuobjgIIke0NfUkVTRVR9IgoKICAgICMg5om+6YWN572u5paH5Lu2CiAgICBsb2NhbCBwcm9maWxlX2ZpbGUKICAgIHByb2ZpbGVfZmlsZT0kKF9pbnN0YWxsZXJfZGV0ZWN0X3Byb2ZpbGUpCiAgICBsb2NhbCBzb3VyY2VfbGluZT0ic291cmNlICRNQUlOX1NIIgoKICAgIGlmIFsgIiRwcm9maWxlX2ZpbGUiICE9ICJ1bmtub3duX3Byb2ZpbGUiIF0gJiYgWyAtZiAiJHByb2ZpbGVfZmlsZSIgXTsgdGhlbgogICAgICAgIGlmIGdyZXAgLXFGICIkc291cmNlX2xpbmUiICIkcHJvZmlsZV9maWxlIjsgdGhlbgogICAgICAgICAgICAjIOeUqCBzZWQg5oqK6YKj5Yeg6KGM5Yig5LqG77yM6aG65L6/5aSH5Liq5Lu9CiAgICAgICAgICAgIGlmIHNlZCAtLXZlcnNpb24gPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICJcfCRzb3VyY2VfbGluZVx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICJcfCMgQWRkZWQgYnkgZnVja2l0cyBpbnN0YWxsZXJcfGQiICIkcHJvZmlsZV9maWxlIgogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICIiIC1lICJcfCRzb3VyY2VfbGluZVx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICIiIC1lICJcfCMgQWRkZWQgYnkgZnVja2l0cyBpbnN0YWxsZXJcfGQiICIkcHJvZmlsZV9maWxlIgogICAgICAgICAgICBmaQogICAgICAgIGZpCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33mib7kuI3liLAgc2hlbGwg6YWN572u5paH5Lu277yM5oKo5Y+v5Lul5omL5Yqo5Yig6Zmk55u45YWz6YWN572u44CCJHtDX1JFU0VUfSIKICAgIGZpCgogICAgaWYgWyAtZCAiJElOU1RBTExfRElSIiBdOyB0aGVuCiAgICAgICAgcm0gLXJmICIkSU5TVEFMTF9ESVIiCiAgICBmaQoKICAgIHNsZWVwIDMKICAgIGVjaG8gLWUgIiR7Q19HUkVFTn3ooYzvvIzmiJHlhYjotbDkuIDmraXvvIzlkYrovp7jgIIke0NfQ1lBTn3otbbntKfph43lkK/kvaDpgqPnu4jnq6/lkKfvvIzkuI3nhLbkvJrliKvlkI3msaHmn5PjgIIke0NfUkVTRVR9IgogICAgc2xlZXAgMwogICAgZWNobyAtZSAiJHtDX1lFTExPV33kuLTliKvkuYvpmYXvvIznjK7kuIrkuIDpppblsI/or5fvvIznpZ3mgqjliY3nqIvkvLzplKbvvJoke0NfUkVTRVR9IgogICAgc2xlZXAgMgogICAgZWNobyAtZSAiXG4ke0NfUkVEfeOAiuivl+e7j8K35b286Ziz44CLJHtDX1JFU0VUfSIKICAgIHNsZWVwIDIKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d95b286Ziz6Iul6Iez77yM5Yid5Y2H5Lic5pum44CCJHtDX1JFU0VUfSIKICAgIHNsZWVwIDIKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d957uv6Zu+6aOS6JS977yM5Ly85bmV57uh57u444CCJHtDX1JFU0VUfSIKICAgIHNsZWVwIDMKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d95b286Ziz56+d56Kn77yM6Zu+6ZyC5ran5ruB44CCJHtDX1JFU0VUfSIKICAgIHNsZWVwIDQKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d96LWk55+z5Yas5rqq77yM5Ly8546b55GZ5r2t44CCJHtDX1JFU0VUfSIKICAgIHNsZWVwIDQKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d95b286Ziz5pma5oSP77yM5pqW5qKm5Ly85LmQ44CCJHtDX1JFU0VUfSIKICAgIHNsZWVwIDMKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d95a+Q5ri45rWu5rKQ77yM6Iul6ZuJ6aOe6Iie44CCJHtDX1JFU0VUfSIKfQoKIyDot58gQVBJIOmAmuS/oeeahOS4u+WHveaVsAojIOWPguaVsOWwseaYr+imgeaJp+ihjOeahOWRveS7pApfZnVja19leGVjdXRlX3Byb21wdCgpIHsKICAgICMg5aaC5p6c55So5oi35Y+q6L6T5YWlICJmdWNrIHVuaW5zdGFsbCIKICAgIGlmIFsgIiQxIiA9ICJ1bmluc3RhbGwiIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfdW5pbnN0YWxsX3NjcmlwdAogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgICMg5aaC5p6c55So5oi36L6T5YWlICJmdWNrIGNvbmZpZyIKICAgIGlmIFsgIiQxIiA9ICJjb25maWciIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfZnVja19zaG93X2NvbmZpZ19oZWxwCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgaWYgISBjb21tYW5kIC12IGN1cmwgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH0nZnVjaycg5ZG95Luk6ZyA6KaBICdjdXJsJ++8jOivt+WFiOWuieijhSBjdXJs44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgaWYgWyAiJCMiIC1lcSAwIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeivt+aPkOS+m+imgeaJp+ihjOeahOWRveS7pOOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIHByb21wdD0iJCoiCiAgICBsb2NhbCBhdXRvX21vZGU9IiR7RlVDS19BVVRPX0VYRUM6LTB9IgogICAgbG9jYWwgY3VybF90aW1lb3V0PSIke0ZVQ0tfVElNRU9VVDotMzB9IgogICAgbG9jYWwgc3lzaW5mb19zdHJpbmcKICAgIHN5c2luZm9fc3RyaW5nPSQoX2Z1Y2tfY29sbGVjdF9zeXNpbmZvX3N0cmluZykKCiAgICBsb2NhbCByZXNwb25zZT0iIgogICAgbG9jYWwgZXhpdF9jb2RlPTAKICAgIGlmIF9mdWNrX3Nob3VsZF91c2VfbG9jYWxfYXBpOyB0aGVuCiAgICAgICAgcHJpbnRmICIke0NfWUVMTE9XfeS9v+eUqOacrOWcsCBBUEkgS2V5Li4uICR7Q19SRVNFVH0iCiAgICAgICAgcmVzcG9uc2U9JChfZnVja19yZXF1ZXN0X2xvY2FsX21vZGVsICIkcHJvbXB0IiAiJHN5c2luZm9fc3RyaW5nIiAiJGN1cmxfdGltZW91dCIpCiAgICAgICAgZXhpdF9jb2RlPSQ/CiAgICBlbHNlCiAgICAgICAgbG9jYWwgc3Bpbm5lcl9sYWJlbD0i5oCd6ICD5Lit8J+SrSAiCiAgICAgICAgcHJpbnRmICclcycgIiRzcGlubmVyX2xhYmVsIgogICAgICAgIHJlc3BvbnNlPSQoX2Z1Y2tfcmVxdWVzdF93b3JrZXJfbW9kZWwgIiRwcm9tcHQiICIkc3lzaW5mb19zdHJpbmciICIkY3VybF90aW1lb3V0IiAiJHNwaW5uZXJfbGFiZWwiKQogICAgICAgIGV4aXRfY29kZT0kPwogICAgZmkKCiAgICBwcmludGYgIlxyIiAjIENsZWFyIHRoZSBsaW5lIGJlZm9yZSBwcmludGluZyBhIG5ld2xpbmUKICAgIGVjaG8gIiIKCiAgICBpZiBbICRleGl0X2NvZGUgLW5lIDAgXSB8fCBbIC16ICIkcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICByZXR1cm4gJGV4aXRfY29kZQogICAgZmkKCiAgICBlY2hvIC1lICIke0NfQ1lBTn3kuLrmgqjnlJ/miJDkuobku6XkuIvlkb3ku6TvvJoke0NfUkVTRVR9IgogICAgZWNobyAtZSAiJHtDX0RJTX0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJHtDX1JFU0VUfSIKICAgIHByaW50ZiAnJXNcbicgIiRyZXNwb25zZSIKICAgIGVjaG8gLWUgIiR7Q19ESU19LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSR7Q19SRVNFVH0iCgogICAgIyDlronlhajmo4Dmn6XljbHpmanlkb3ku6QKICAgIGxvY2FsIHNlY3VyaXR5X3Jlc3VsdCBzZWN1cml0eV9sZXZlbCBzZWN1cml0eV9yZWFzb24KICAgIHNlY3VyaXR5X3Jlc3VsdD0kKF9mdWNrX2RldGVjdF9kYW5nZXJvdXNfY29tbWFuZCAiJHJlc3BvbnNlIikKICAgIHNlY3VyaXR5X2xldmVsPSR7c2VjdXJpdHlfcmVzdWx0JSV8Kn0KICAgIHNlY3VyaXR5X3JlYXNvbj0ke3NlY3VyaXR5X3Jlc3VsdCMqfH0KCiAgICAjIOagueaNruS4pemHjeaAp+e6p+WIq+WkhOeQhuWuieWFqOWGs+etlgogICAgaWYgISBfZnVja19zZWN1cml0eV9oYW5kbGVfZGVjaXNpb24gIiRzZWN1cml0eV9sZXZlbCIgIiRzZWN1cml0eV9yZWFzb24iICIkcmVzcG9uc2UiOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1JFRH3inYwg5ZG95Luk5Zug5a6J5YWo562W55Wl6KKr5Lit5q2i44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgc2hvdWxkX2V4ZWM9ZmFsc2UKCiAgICBpZiBfZnVja190cnV0aHkgIiRhdXRvX21vZGUiOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33imqEg5bey5byA5ZCv6Ieq5Yqo5omn6KGM5qih5byP77yM56uL5Y2z6L+Q6KGMLi4uJHtDX1JFU0VUfSIKICAgICAgICBzaG91bGRfZXhlYz10cnVlCiAgICBlbHNlCiAgICAgICAgd2hpbGUgdHJ1ZTsgZG8KICAgICAgICAgICAgcHJpbnRmICIke0NfQk9MRH3mmK/lkKbmiafooYzvvJ9bWS9uXSAke0NfUkVTRVR9IgogICAgICAgICAgICBsb2NhbCBjb25maXJtYXRpb24gbm9ybWFsaXplZAogICAgICAgICAgICBpZiBbIC1yIC9kZXYvdHR5IF07IHRoZW4KICAgICAgICAgICAgICAgIElGUz0gcmVhZCAtciBjb25maXJtYXRpb24gPCAvZGV2L3R0eQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICByZWFkIC1yIGNvbmZpcm1hdGlvbgogICAgICAgICAgICBmaQoKICAgICAgICAgICAgY29uZmlybWF0aW9uPSQocHJpbnRmICclcycgIiR7Y29uZmlybWF0aW9uOi19IiB8IHRyIC1kICcgXHRccicpCiAgICAgICAgICAgIG5vcm1hbGl6ZWQ9JChwcmludGYgJyVzJyAiJGNvbmZpcm1hdGlvbiIgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKCiAgICAgICAgICAgIGNhc2UgIiRub3JtYWxpemVkIiBpbgogICAgICAgICAgICAgICAgIiJ8InkifCJ5ZXMifCLmmK8iKQogICAgICAgICAgICAgICAgICAgIHNob3VsZF9leGVjPXRydWUKICAgICAgICAgICAgICAgICAgICBlY2hvIC1lICIke0NfR1JFRU594pyFIOaJp+ihjOS4rS4uLiR7Q19SRVNFVH0iCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgIm4ifCJubyJ8IuWQpiIpCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2V4ZWM9ZmFsc2UKICAgICAgICAgICAgICAgICAgICBfZnVja19hdWRpdF9sb2cgIkFCT1JUIiAiJHJlc3BvbnNlIgogICAgICAgICAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d94p2MIOW3suWPlua2iOOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICopCiAgICAgICAgICAgICAgICAgICAgIyBMb29wCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgZXNhYwogICAgICAgIGRvbmUKICAgIGZpCgogICAgaWYgWyAiJHNob3VsZF9leGVjIiA9ICJ0cnVlIiBdOyB0aGVuCiAgICAgICAgZXZhbCAiJHJlc3BvbnNlIgogICAgICAgIGxvY2FsIGV4aXRfY29kZT0kPwogICAgICAgIAogICAgICAgICMg6K6w5b2V5ZG95Luk5omn6KGMCiAgICAgICAgX2Z1Y2tfYXVkaXRfbG9nICJFWEVDIiAiJHJlc3BvbnNlIiAiJGV4aXRfY29kZSIKICAgICAgICAKICAgICAgICBpZiBbICRleGl0X2NvZGUgLW5lIDAgXTsgdGhlbgogICAgICAgICAgICBlY2hvIC1lICIke0NfUkVEX0JPTER96ZSZ6K+v77yBJHtDX1JFRH3lkb3ku6TmiafooYzlpLHotKXvvIzpgIDlh7rnoIEgJGV4aXRfY29kZeOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIGZpCiAgICAgICAgcmV0dXJuICRleGl0X2NvZGUKICAgIGVsc2UKICAgICAgICAjICLlt7Llj5bmtojjgIIiIOa2iOaBr+eOsOWcqOWcqOW+queOr+WGheaJk+WNsO+8jAogICAgICAgICMg5omA5Lul5aaC5p6cIHNob3VsZF9leGVjIOS4uiBmYWxzZe+8jOebtOaOpei/lOWbniAxIOWNs+WPr+OAggogICAgICAgIHJldHVybiAxCiAgICBmaQp9CgojIOWumuS5ieWIq+WQje+8iOaUr+aMgeiHquWumuS5ieWIq+WQje+8iQpfZnVja19kZWZpbmVfYWxpYXNlcygpIHsKICAgIGxvY2FsIGRlZmF1bHRfYWxpYXM9ImZ1Y2siCgogICAgaWYgISBfZnVja190cnV0aHkgIiR7RlVDS19ESVNBQkxFX0RFRkFVTFRfQUxJQVM6LTB9IjsgdGhlbgogICAgICAgIGFsaWFzICIkZGVmYXVsdF9hbGlhcyI9J19mdWNrX2V4ZWN1dGVfcHJvbXB0JwogICAgZmkKCiAgICBpZiBbIC1uICIke0ZVQ0tfQUxJQVM6LX0iIF0gJiYgWyAiJEZVQ0tfQUxJQVMiICE9ICIkZGVmYXVsdF9hbGlhcyIgXTsgdGhlbgogICAgICAgIGFsaWFzICIkRlVDS19BTElBUyI9J19mdWNrX2V4ZWN1dGVfcHJvbXB0JwogICAgZmkKfQoKX2Z1Y2tfZGVmaW5lX2FsaWFzZXMKCiMgLS0tIOaguOW/g+mAu+i+kee7k+adnyAtLS0KRU9GCgojIC0tLSDmoLjlv4PpgLvovpEgSGVyZWRvYyDnu5PmnZ8gLS0tCgojIOWwhuWGheW1jOaguOW/g+mAu+i+keWGmeWIsOaWh+S7tuS4re+8iOWuieijhS/kuLTml7bmqKHlvI/pg73kvJrnlKjliLDvvIkKX2Z1Y2tfd3JpdGVfY29yZSgpIHsKICAgIGxvY2FsIHRhcmdldD0iJDEiCiAgICBwcmludGYgJyVzXG4nICIkQ09SRV9MT0dJQyIgPiAiJHRhcmdldCIKfQoKIyDlsIbmoLjlv4PpgLvovpHovb3lhaXlvZPliY0gc2hlbGwKX2Z1Y2tfc291cmNlX2NvcmUoKSB7CiAgICBsb2NhbCB0bXBfY29yZQogICAgdG1wX2NvcmU9JChta3RlbXApCiAgICBfZnVja193cml0ZV9jb3JlICIkdG1wX2NvcmUiCiAgICAjIHNoZWxsY2hlY2sgZGlzYWJsZT1TQzEwOTAKICAgIHNvdXJjZSAiJHRtcF9jb3JlIgogICAgcm0gLWYgIiR0bXBfY29yZSIKfQoKIyDlsIblhoXltYzmoLjlv4PpgLvovpHlhpnlhaXmjIflrprmlofku7bvvIjlronoo4XkuI7kuLTml7bmiafooYzkvJrnlKjliLDvvIkKX2Z1Y2tfd3JpdGVfY29yZSgpIHsKICAgIGxvY2FsIHRhcmdldD0iJDEiCiAgICBwcmludGYgJyVzXG4nICIkQ09SRV9MT0dJQyIgPiAiJHRhcmdldCIKfQoKCiMgLS0tIOWuieijheWHveaVsCAo55Sx5aSW6YOo6ISa5pys6L+Q6KGMKSAtLS0KCiMg5om+55So5oi3IHNoZWxsIOmFjee9ruaWh+S7tueahOi+heWKqeWHveaVsApfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKCkgewogICAgaWYgWyAtbiAiJHtTSEVMTDotfSIgXSAmJiBlY2hvICIkU0hFTEwiIHwgZ3JlcCAtcSAienNoIjsgdGhlbgogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtbiAiJHtTSEVMTDotfSIgXSAmJiBlY2hvICIkU0hFTEwiIHwgZ3JlcCAtcSAiYmFzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uYmFzaHJjIgogICAgZWxpZiBbIC1mICIkSE9NRS8ucHJvZmlsZSIgXTsgdGhlbgogICAgICAgICMg5YW85a65IHNoLCBrc2gg562JCiAgICAgICAgZWNobyAiJEhPTUUvLnByb2ZpbGUiCiAgICBlbGlmIFsgLWYgIiRIT01FLy56c2hyYyIgXTsgdGhlbgogICAgICAgICMgU0hFTEwg5Y+Y6YeP5rKh6K6+572u5pe255qE5aSH55So5pa55qGICiAgICAgICAgZWNobyAiJEhPTUUvLnpzaHJjIgogICAgZWxpZiBbIC1mICIkSE9NRS8uYmFzaHJjIiBdOyB0aGVuCiAgICAgICAgIyBTSEVMTCDlj5jph4/msqHorr7nva7ml7bnmoTlpIfnlKjmlrnmoYgKICAgICAgICBlY2hvICIkSE9NRS8uYmFzaHJjIgogICAgZWxzZQogICAgICAgIGVjaG8gInVua25vd25fcHJvZmlsZSIKICAgIGZpCn0KCiMg5Li75a6J6KOF5Ye95pWwCl9pbnN0YWxsZXJfc2VjdXJlX2NvbmZpZ19maWxlKCkgewogICAgaWYgWyAtZiAiJENPTkZJR19GSUxFIiBdOyB0aGVuCiAgICAgICAgY2htb2QgNjAwICIkQ09ORklHX0ZJTEUiIDI+L2Rldi9udWxsIHx8IHRydWUKICAgIGZpCn0KCl9pbnN0YWxsX3NjcmlwdCgpIHsKICAgIGVjaG8gLWUgIiR7Q19CT0xEfeW8gOWni+WuieijhSBmdWNraXRzLi4uJHtDX1JFU0VUfSIKICAgIG1rZGlyIC1wICIkSU5TVEFMTF9ESVIiCiAgICAKICAgICMg5oqK5qC45b+D6YC76L6R5YaZ6L+bIG1haW4uc2gKICAgIF9mdWNrX3dyaXRlX2NvcmUgIiRNQUlOX1NIIgoKICAgIGlmIFsgJD8gLW5lIDAgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR95peg5rOV5YaZ5YWl5paH5Lu277yM6K+35qOA5p+l55uu5b2V5p2D6ZmQ44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgIyBNYWtlIG1haW4uc2ggZXhlY3V0YWJsZQogICAgY2htb2QgK3ggIiRNQUlOX1NIIgoKICAgICMg5aaC5p6c5rKh5pyJ6YWN572u5paH5Lu25YiZ55Sf5oiQ5LiA5Liq56S65L6LCiAgICBpZiBbICEgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNhdCA8PCdDRkcnID4gIiRDT05GSUdfRklMRSIKIyBmdWNraXRzIOmFjee9ruekuuS+iwojIOWOu+aOieihjOmmlueahCAj77yM5pS55oiQ5L2g6Ieq5bex55qE5YC85Y2z5Y+v44CCCgojIOiHquW7ui/oh6rlrprkuYkgV29ya2VyIOWFpeWPowojIGV4cG9ydCBGVUNLX0FQSV9FTkRQT0lOVD0iaHR0cHM6Ly95b3VyLWRvbWFpbi53b3JrZXJzLmRldi8iCgojIOacrOWcsCBPcGVuQUkg5YW85a65IEtlee+8iOW8uueDiOaOqOiNkO+8iQojIGV4cG9ydCBGVUNLX09QRU5BSV9BUElfS0VZPSJzay0uLi4iCgojIOimhueblum7mOiupOaooeWei+aIliBBUEkg5Z+65Z2ACiMgZXhwb3J0IEZVQ0tfT1BFTkFJX01PREVMPSJncHQtNG8tbWluaSIKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0JBU0U9Imh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEiCgojIOmineWkluWIq+WQje+8iOS4jeS8muW9seWTjem7mOiupCBmdWNr77yJCiMgZXhwb3J0IEZVQ0tfQUxJQVM9Iui/kOihjCIKCiMg6Ieq5Yqo5omn6KGM6L+U5Zue55qE5ZG95Luk77yI5Y2x6Zmp77yM6LCo5oWO5byA5ZCv77yJCiMgZXhwb3J0IEZVQ0tfQVVUT19FWEVDPWZhbHNlCgojIOivt+axgui2heaXtuaXtumXtO+8iOenku+8iQojIGV4cG9ydCBGVUNLX1RJTUVPVVQ9MzAKCiMg5piv5ZCm6L6T5Ye66LCD6K+V5L+h5oGvCiMgZXhwb3J0IEZVQ0tfREVCVUc9ZmFsc2UKCiMg56aB55So5YaF572uIGZ1Y2sg5Yir5ZCNCiMgZXhwb3J0IEZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTPWZhbHNlCkNGRwogICAgICAgIF9pbnN0YWxsZXJfc2VjdXJlX2NvbmZpZ19maWxlCiAgICBmaQoKICAgICMg5oqKIHNvdXJjZSDpgqPooYzliqDliLAgc2hlbGwg6YWN572u5paH5Lu26YeMCiAgICBsb2NhbCBwcm9maWxlX2ZpbGUKICAgIHByb2ZpbGVfZmlsZT0kKF9pbnN0YWxsZXJfZGV0ZWN0X3Byb2ZpbGUpCiAgICAKICAgIGlmIFsgIiRwcm9maWxlX2ZpbGUiID0gInVua25vd25fcHJvZmlsZSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR95om+5LiN5YiwIC5iYXNocmMsIC56c2hyYyDmiJYgLnByb2ZpbGXvvIzml6Dms5Xoh6rliqjphY3nva7jgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9Xfeivt+aJi+WKqOWwhuS7peS4i+WGheWuuea3u+WKoOWIsOaCqOeahCBzaGVsbCDphY3nva7mlofku7bkuK3vvJoke0NfUkVTRVR9IiA+JjIKICAgICAgICBlY2hvIC1lICJcbiAgJHtDX0NZQU59c291cmNlICRNQUlOX1NIJHtDX1JFU0VUfVxuIiA+JjIKICAgICAgICByZXR1cm4KICAgIGZpCiAgICAKICAgIGxvY2FsIHNvdXJjZV9saW5lPSJzb3VyY2UgJE1BSU5fU0giCiAgICBpZiAhIGdyZXAgLXFGICIkc291cmNlX2xpbmUiICIkcHJvZmlsZV9maWxlIjsgdGhlbgogICAgICAgICMg5L+d6K+B5paH5Lu25pyA5ZCO5pyJ5o2i6KGMCiAgICAgICAgaWYgWyAtbiAiJCh0YWlsIC1jMSAiJHByb2ZpbGVfZmlsZSIpIiBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gIiIgPj4gIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgZmkKICAgICAgICBlY2hvICIjIEFkZGVkIGJ5IGZ1Y2tpdHMgaW5zdGFsbGVyIiA+PiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICBlY2hvICIkc291cmNlX2xpbmUiID4+ICIkcHJvZmlsZV9maWxlIgogICAgICAgIGVjaG8gLWUgIiR7Q19HUkVFTn3lronoo4XlrozmiJDvvIEke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d96K+36YeN5ZCv57uI56uv5oiW5omn6KGMICR7Q19CT0xEfXNvdXJjZSAkcHJvZmlsZV9maWxlJHtDX1lFTExPV30g5Lul5L2/5pu05pS555Sf5pWI44CCJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICJcbiR7Q19CT0xEfS0tLSDkvb/nlKjmlrnms5UgLS0tJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICLkvb/nlKggJHtDX1JFRF9CT0xEfWZ1Y2ske0NfUkVTRVR9IOWRveS7pOWQjui3n+aCqOaDs+aJp+ihjOeahOaTjeS9nOWNs+WPr+OAgiIKICAgICAgICBlY2hvIC1lICLnpLrkvos6IgogICAgICAgIGVjaG8gLWUgIiAgJHtDX0NZQU59ZnVjayBpbnN0YWxsIGdpdCR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiICAke0NfQ1lBTn1mdWNrIHVuaW5zdGFsbCBnaXQke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIiAgJHtDX0NZQU59ZnVjayDmib7lh7rlvZPliY3nm67lvZXmiYDmnInlpKfkuo4xME1C55qE5paH5Lu2JHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19SRURfQk9MRH1mdWNrIHVuaW5zdGFsbCR7Q19SRVNFVH0gJHtDX0dSRUVOfSMg5Y246L29IGZ1Y2tpdHMke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIiAgJHtDX1JFRF9CT0xEfWZ1Y2sgY29uZmlnJHtDX1JFU0VUfSAke0NfR1JFRU59IyDmmL7npLrphY3nva7luK7liqkke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIlxuJHtDX1lFTExPV33orrDlvpfph43lkK/nu4jnq6/ku6Xkvb/nlKjmlrDlkb3ku6TvvIEke0NfUkVTRVR9IgogICAgZWxzZQogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19ZRUxMT1d95qOA5rWL5Yiw5bey5a6J6KOF77yM5bey5Li65oKo5pu05paw6ISa5pys44CCJHtDX1JFU0VUfSIKICAgIGZpCn0KCgojIC0tLSDkuLvohJrmnKzlhaXlj6MgLS0tCgojIOWmguaenOacieWPguaVsOS8oOi/m+adpSAo5q+U5aaCICJiYXNoIC1zIC4uLiIpCmlmIFsgIiQjIiAtZ3QgMCBdOyB0aGVuCiAgICBpZiBbICIkMSIgPSAiaW5zdGFsbCIgXSAmJiBbICIkIyIgLWVxIDEgXTsgdGhlbgogICAgICAgIF9pbnN0YWxsX3NjcmlwdAogICAgICAgIGV4aXQgMAogICAgZmkKCiAgICBfZnVja19zb3VyY2VfY29yZQogICAgX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQgIiRAIgplbHNlCiAgICBfaW5zdGFsbF9zY3JpcHQKZmkK"`);

const README_URL_EN = 'https://github.com/Silentely/fuckits/blob/main/README.en.md';
const README_URL_ZH = 'https://github.com/Silentely/fuckits';
const INSTALLER_FILENAME_EN = 'fuckits.sh';
const INSTALLER_FILENAME_ZH = 'fuckits-zh.sh';
const SHARED_DEFAULT_LIMIT = 10;
const SECONDS_IN_DAY = 24 * 60 * 60;

let lastQuotaDate = null;
const sharedUsage = new Map();

function resolveSharedLimit(env) {
  const raw = Number(env?.SHARED_DAILY_LIMIT ?? env?.SHARED_DEFAULT_LIMIT);
  if (Number.isFinite(raw) && raw > 0) {
    return Math.floor(raw);
  }
  return SHARED_DEFAULT_LIMIT;
}

/**
 * 
 * @param {string} a 
 * @param {string} b 
 * @returns {boolean} 
 */
function timingSafeEqual(a, b) {
  if (typeof a !== 'string' || typeof b !== 'string') {
    return false;
  }

  // 
  const lenA = a.length;
  const lenB = b.length;

  // 
  const maxLen = Math.max(lenA, lenB);

  let result = lenA ^ lenB; // 

  for (let i = 0; i < maxLen; i++) {
    // 
    const charA = a.charCodeAt(i % lenA) || 0;
    const charB = b.charCodeAt(i % lenB) || 0;
    result |= charA ^ charB;
  }

  return result === 0;
}

function resolveQuotaStore(env) {
  if (env?.QUOTA_KV && typeof env.QUOTA_KV.get === 'function') {
    return env.QUOTA_KV;
  }

  const alias = env?.QUOTA_KV_BINDING;
  if (alias && env?.[alias] && typeof env[alias].get === 'function') {
    return env[alias];
  }

  if (env?.fuckits && typeof env.fuckits.get === 'function') {
    return env.fuckits;
  }

  return null;
}

async function checkSharedQuota(ip, limit, env) {
  const quotaStore = resolveQuotaStore(env);
  if (quotaStore) {
    return checkSharedQuotaKV(quotaStore, ip, limit);
  }
  return checkSharedQuotaInMemory(ip, limit);
}

function checkSharedQuotaInMemory(ip, limit) {
  const today = new Date().toISOString().slice(0, 10);
  if (lastQuotaDate !== today) {
    sharedUsage.clear();
    lastQuotaDate = today;
  }
  const key = ip || 'anonymous';
  const current = (sharedUsage.get(key) || 0) + 1;
  sharedUsage.set(key, current);
  return {
    allowed: current <= limit,
    remaining: Math.max(limit - current, 0),
    count: current,
  };
}

/**
 *  KV 
 *
 *   (Race Condition Notice)
 * =========================================
 *  get  check  put 
 *
 * 1.  kv.get()  kv.put()  10-50ms
 *    ""
 *
 * 2.  N 
 *     N  N-1 
 *
 * 3. KV  PoP  < 60s
 *    
 *
 * 
 * - 
 * - 
 * -  1-3 /
 *
 *  Cloudflare Durable Objects
 *
 * @param {object} kv - KV 
 * @param {string} ip -  IP 
 * @param {number} limit - 
 * @returns {Promise<{allowed: boolean, remaining: number, count: number}>}
 */
async function checkSharedQuotaKV(kv, ip, limit) {
  const today = new Date().toISOString().slice(0, 10);
  const key = `quota:${today}:${ip || 'anonymous'}`;
  const ttl = secondsUntilNextUtcMidnight();

  try {
    const raw = await kv.get(key);
    const currentCount = Number(raw) || 0;

    // 
    // 
    if (currentCount >= limit) {
      return {
        allowed: false,
        remaining: 0,
        count: currentCount,
      };
    }

    const newCount = currentCount + 1;
    await kv.put(key, String(newCount), { expirationTtl: ttl > 0 ? ttl : SECONDS_IN_DAY });

    return {
      allowed: newCount <= limit,
      remaining: Math.max(limit - newCount, 0),
      count: newCount,
    };
  } catch (error) {
    console.error('Failed to persist quota counter, falling back to in-memory map', error);
    return checkSharedQuotaInMemory(ip, limit);
  }
}

function secondsUntilNextUtcMidnight() {
  const now = new Date();
  const midnight = Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate() + 1);
  return Math.ceil((midnight - now.getTime()) / 1000);
}

function isBrowserRequest(userAgent = '') {
  return /Mozilla|Chrome|Safari|Firefox|Edg/.test(userAgent);
}

/**
 *  AI 
 *  AI 
 *
 * :
 * 1.  ( markdown)
 * 2.  fenced  (```bash ... ```)
 * 3.  ()
 * 4.  (`command`)
 * 5.  ()
 *
 * @param {string} rawCommand AI 
 * @returns {string} 
 */
function sanitizeCommand(rawCommand) {
  if (!rawCommand || typeof rawCommand !== 'string') {
    return '';
  }

  let command = rawCommand.trim();

  //  1:  fenced  (```bash ... ```  ```sh ... ``` )
  // :  ^  $ 
  const fencedBlockPattern = /```(?:bash|sh|shell|zsh|command)?\s*\n([\s\S]*?)\n```/;
  const fencedMatch = command.match(fencedBlockPattern);
  if (fencedMatch && fencedMatch[1].trim()) {
    command = fencedMatch[1].trim();
  } else {
    //  2:  fenced  (```command```)
    const inlineFencedPattern = /```(?:bash|sh|shell|zsh|command)?\s*([^\n`]+?)\s*```/;
    const inlineFencedMatch = command.match(inlineFencedPattern);
    if (inlineFencedMatch && inlineFencedMatch[1].trim()) {
      command = inlineFencedMatch[1].trim();
    } else {
      //  3:  (`command`)
      // 
      if (command.includes('`') && /[a-zA-Z].*:/.test(command)) {
        const inlineCodePattern = /`([^`]+)`/;
        const inlineMatch = command.match(inlineCodePattern);
        if (inlineMatch && inlineMatch[1].trim()) {
          //  ()
          const extracted = inlineMatch[1].trim();
          if (/^[a-zA-Z_\/\.]/.test(extracted) && !extracted.includes(' is ')) {
            command = extracted;
          }
        }
      }
    }
  }

  //  shebang  (#!/bin/bash, #!/usr/bin/env bash, )
  command = command.replace(/^#!\/(?:usr\/)?(?:bin\/)?(?:env\s+)?(?:ba)?sh\s*\n?/gm, '');

  //  shell  ( #  #! )
  // : 
  command = command.replace(/^[^\S\n]*#(?!!)[^\n]*\n?/gm, '');

  // 
  command = command.replace(/^\s*\n+/, '');

  // 
  command = command.replace(/\n+\s*$/, '');

  return command.trim();
}

function resolveLocale(url, headers) {
  const pathname = url.pathname.toLowerCase();
  if (pathname === '/zh' || pathname.startsWith('/zh/')) {
    return 'zh';
  }

  const langParam = (url.searchParams.get('lang') || '').toLowerCase();
  if (langParam) {
    //  lang  URL 
    if (langParam.startsWith('zh')) {
      return 'zh';
    }
    if (langParam.startsWith('en')) {
      return 'en';
    }
  }

  const acceptLanguage = (headers.get('Accept-Language') || '').toLowerCase();
  if (acceptLanguage.split(',').some((token) => token.trim().startsWith('zh'))) {
    return 'zh';
  }

  return 'en';
}


export default {
  async fetch(request, env, ctx) {
    const url = new URL(request.url);

    if (request.method === 'OPTIONS') {
      return addCorsHeaders(handleOptionsRequest());
    }

    if (request.method === 'GET' && url.pathname === '/health') {
      return addCorsHeaders(handleHealthCheck(env));
    }

    if (request.method === 'GET') {
      return addCorsHeaders(await handleGetRequest(request));
    } else if (request.method === 'POST') {
      return addCorsHeaders(await handlePostRequest(request, env));
    } else {
      return addCorsHeaders(new Response('Expected GET or POST', { status: 405 }));
    }
  },
};

function handleOptionsRequest() {
  return new Response(null, {
    status: 204,
    headers: {
      'Access-Control-Allow-Origin': '*',
      'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type',
    },
  });
}

function addCorsHeaders(response) {
  const newHeaders = new Headers(response.headers);
  newHeaders.set('Access-Control-Allow-Origin', '*');
  return new Response(response.body, {
    status: response.status,
    statusText: response.statusText,
    headers: newHeaders,
  });
}

function handleHealthCheck(env) {
  const payload = {
    status: 'ok',
    timestamp: new Date().toISOString(),
    hasApiKey: Boolean(env?.OPENAI_API_KEY),
  };

  return new Response(JSON.stringify(payload), {
    status: 200,
    headers: { 'Content-Type': 'application/json; charset=utf-8' },
  });
}

/**
 * Handles GET requests to serve the installer script or redirect browsers to GitHub.
 * @param {Request} request The incoming request.
 * @returns {Response} A response with the shell script or a redirect.
 */
function handleGetRequest(request) {
  const userAgent = request.headers.get('User-Agent') || '';

  const url = new URL(request.url);
  const locale = resolveLocale(url, request.headers);
  const isBrowser = isBrowserRequest(userAgent);

  // If the request comes from a browser, redirect to the appropriate README.
  if (isBrowser) {
    const docsUrl = locale === 'zh' ? README_URL_ZH : README_URL_EN;
    return Response.redirect(docsUrl, 302);
  }
  // Otherwise, serve the installer script based on the resolved locale.
  const script = locale === 'zh' ? INSTALLER_SCRIPT_ZH : INSTALLER_SCRIPT;
  const filename = locale === 'zh' ? INSTALLER_FILENAME_ZH : INSTALLER_FILENAME_EN;

  return new Response(script, {
    headers: {
      'Content-Type': 'text/plain; charset=utf-8',
      'Content-Disposition': `attachment; filename="${filename}"`,
    },
  });
}

/**
 * Handles POST requests by forwarding the prompt to an AI model.
 * @param {Request} request The incoming request.
 * @param {object} env The environment variables.
 * @returns {Promise<Response>} A promise that resolves to the AI's response.
 */
async function handlePostRequest(request, env) {
  try {
    const { sysinfo, prompt, adminKey } = await request.json();

    //  sysinfo
    if (!sysinfo || sysinfo.trim() === '') {
      return new Response(
        JSON.stringify({ error: 'Missing or empty "sysinfo" in request body' }),
        {
          status: 400,
          headers: { 'Content-Type': 'application/json' }
        }
      );
    }

    //  prompt
    if (!prompt || prompt.trim() === '') {
      return new Response(
        JSON.stringify({ error: 'Missing or empty "prompt" in request body' }),
        {
          status: 400,
          headers: { 'Content-Type': 'application/json' }
        }
      );
    }
    if (!env.OPENAI_API_KEY) {
      return new Response('Missing OPENAI_API_KEY secret', { status: 500 });
    }

    const normalizedAdminKey = typeof adminKey === 'string' ? adminKey.trim() : '';
    const hasAdminBypass = Boolean(
      normalizedAdminKey && env?.ADMIN_ACCESS_KEY && timingSafeEqual(normalizedAdminKey, env.ADMIN_ACCESS_KEY),
    );

    const clientIp = request.headers.get('CF-Connecting-IP') ||
      request.headers.get('X-Forwarded-For') ||
      'anonymous';
    if (!hasAdminBypass) {
      const sharedLimit = resolveSharedLimit(env);
      const quota = await checkSharedQuota(clientIp, sharedLimit, env);
      if (!quota.allowed) {
        const message = {
          error: 'DEMO_LIMIT_EXCEEDED',
          message: `Shared demo quota exceeded (max ${sharedLimit} calls per day).`,
          hint: 'Configure FUCK_OPENAI_API_KEY in ~/.fuck/config.sh to use your own key.',
          remaining: quota.remaining,
          limit: sharedLimit,
        };
        return new Response(JSON.stringify(message), {
          status: 429,
          headers: { 'Content-Type': 'application/json', 'Cache-Control': 'no-store' },
        });
      }
    }

    const model = env.OPENAI_API_MODEL || 'gpt-5-nano';
    const apiBase = (env.OPENAI_API_BASE || 'https://api.openai.com/v1').replace(/\/$/, '');
    const apiUrl = `${apiBase}/chat/completions`;

    const url = new URL(request.url);
    const locale = resolveLocale(url, request.headers);
    const isChinese = locale === 'zh';

    const system_prompt = isChinese
      ? ` shell  shell 


1. "" ls  ls ""
2.  if [ $# -eq 0 ]
3. 
4. markdown  \`\`\`bash shebang #!/bin/bash


- ""  : ls
- ""  : ls -la
- "10MB"  : find . -type f -size +10M

${sysinfo}`
      : `You are an expert shell command generator. Users describe tasks in natural language. Your task is to generate directly executable shell commands to accomplish their goals.

Important rules:
1. User input is natural language intent, NOT command arguments. For example, "list directory" means run ls, not ls "list directory"
2. Generate directly executable commands, not script templates with parameter handling (like if [ $# -eq 0 ])
3. For simple tasks return single commands, complex tasks can be multi-line scripts
4. Do not provide any explanation, comments, markdown formatting (like \`\`\`bash), or a shebang (e.g., #!/bin/bash)

Examples:
- User says "list directory"  Output: ls
- User says "show detailed file list"  Output: ls -la
- User says "find files larger than 10MB"  Output: find . -type f -size +10M

The user's system info is: ${sysinfo}`;

    const aiRequestPayload = {
      model: model,
      messages: [
        {
          role: 'system',
          content: system_prompt,
        },
        {
          role: 'user',
          content: prompt,
        },
      ],
      max_tokens: 1024,
      temperature: 0.2,
    };

    const aiResponse = await fetch(apiUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${env.OPENAI_API_KEY}`,
      },
      body: JSON.stringify(aiRequestPayload),
    });

    if (!aiResponse.ok) {
      const errorText = await aiResponse.text();
      return new Response(`AI API Error: ${errorText}`, { status: aiResponse.status });
    }

    const aiJson = await aiResponse.json();
    const command = aiJson.choices[0]?.message?.content.trim();

    if (!command) {
      return new Response('The AI returned an empty command.', { status: 500 });
    }

    //  AI  markdown shebang 
    const cleanedCommand = sanitizeCommand(command);

    if (!cleanedCommand) {
      return new Response('The AI returned an invalid command after sanitization.', { status: 500 });
    }

    return new Response(cleanedCommand, {
      headers: { 'Content-Type': 'text/plain' },
    });
  } catch (error) {
    return new Response(`Error: ${error.message}`, { status: 500 });
  }
}
