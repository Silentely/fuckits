// --- FUCKIT.SH Cloudflare Worker ---

// This is the content of your main.sh installer script.
// It will be served when a user makes a GET request.
function b64_to_utf8(str) {
  try {
    // This is a more robust way to decode base64 to UTF-8
    const binaryString = atob(str);
    const len = binaryString.length;
    const bytes = new Uint8Array(len);
    for (let i = 0; i < len; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }
    return new TextDecoder().decode(bytes);
  } catch (e) {
    console.error("Failed to decode base64 string:", e);
    return ""; // Return empty string on failure
  }
}

const INSTALLER_SCRIPT = b64_to_utf8(`IyEvYmluL2Jhc2gKIwojIFRoaXMgc2NyaXB0IGlzIHRoZSBpbnN0YWxsZXIgYW5kIHRlbXBvcmFyeSBydW5uZXIgZm9yIGZ1Y2tpdHMKIwojIC0tLSBSRUNPTU1FTkRFRCBTRUNVUkUgVVNBR0UgLS0tCiMKIyAxLiBEb3dubG9hZDoKIyAgICBjdXJsIC1vIGZ1Y2tpdHMgaHR0cHM6Ly9mdWNraXRzLjI1NTAwNTUyLnh5egojCiMgMi4gSW5zcGVjdDoKIyAgICBsZXNzIGZ1Y2tpdHMKIwojIDMuIFJ1biAoSW5zdGFsbCk6CiMgICAgYmFzaCBmdWNraXRzCiMKIyA0LiBSdW4gKFRlbXBvcmFyeSk6CiMgICAgYmFzaCBmdWNraXRzICJ5b3VyIHByb21wdCIKIwoKc2V0IC1ldW8gcGlwZWZhaWwKCiMgLS0tIFByZXZlbnQgUmUtZGVmaW5pdGlvbiBvZiByZWFkb25seSBWYXJpYWJsZXMgLS0tCiMgVGhpcyBndWFyZCBhbGxvd3MgdGhlIHNjcmlwdCB0byBiZSBzb3VyY2VkIG11bHRpcGxlIHRpbWVzIChlLmcuLCBpbiB0ZXN0cykKaWYgW1sgLXogIiR7RlVDS0lUU19DT05TVEFOVFNfREVGSU5FRDotfSIgXV07IHRoZW4KICAgICMgTWFyayBjb25zdGFudHMgYXMgYmVpbmcgZGVmaW5lZCAoZXhwb3J0IHRvIG1ha2UgdmlzaWJsZSB0byBzdWJzaGVsbHMpCiAgICBleHBvcnQgRlVDS0lUU19DT05TVEFOVFNfREVGSU5FRD0xCgojIC0tLSBDb2xvciBEZWZpbml0aW9ucyAtLS0KcmVhZG9ubHkgQ19SRVNFVD0nXDAzM1swbScKcmVhZG9ubHkgQ19SRURfQk9MRD0nXDAzM1sxOzMxbScKcmVhZG9ubHkgQ19SRUQ9J1wwMzNbMDszMW0nCnJlYWRvbmx5IENfR1JFRU49J1wwMzNbMDszMm0nCnJlYWRvbmx5IENfWUVMTE9XPSdcMDMzWzA7MzNtJwpyZWFkb25seSBDX0NZQU49J1wwMzNbMDszNm0nCnJlYWRvbmx5IENfQk9MRD0nXDAzM1sxbScKcmVhZG9ubHkgQ19ESU09J1wwMzNbMm0nCgojIC0tLSBGVUNLISAtLS0KcmVhZG9ubHkgRlVDSz0iJHtDX1JFRF9CT0xEfUZVQ0shJHtDX1JFU0VUfSIKcmVhZG9ubHkgRkNLTj0iJHtDX1JFRH1GKkNLSU5HJHtDX1JFU0VUfSIKCnJlYWRvbmx5IEZVQ0tJVFNfTE9DQUxFPSJlbiIKCgojIC0tLSBDb25maWd1cmF0aW9uIC0tLQppZiBbIC16ICIke0hPTUU6LX0iIF07IHRoZW4KICAgIGVjaG8gLWUgIlwwMzNbMTszMW1GVUNLIVwwMzNbMG0gXDAzM1swOzMxbVlvdXIgSE9NRSB2YXJpYWJsZSBpc24ndCBzZXQuIEkgZG9uJ3Qga25vdyB3aGVyZSB0byBpbnN0YWxsIHRoaXMgc2hpdC4gU2V0IGl0IHlvdXJzZWxmIChlLmcuLCBleHBvcnQgSE9NRT0vcm9vdCkuXDAzM1swbSIgPiYyCiAgICBleGl0IDEKZmkKcmVhZG9ubHkgSU5TVEFMTF9ESVI9IiRIT01FLy5mdWNrIgpyZWFkb25seSBNQUlOX1NIPSIkSU5TVEFMTF9ESVIvbWFpbi5zaCIKcmVhZG9ubHkgQ09ORklHX0ZJTEU9IiRJTlNUQUxMX0RJUi9jb25maWcuc2giCgpmaSAgIyBFbmQgb2YgcmVhZG9ubHkgY29uc3RhbnRzIGd1YXJkCgoKIyAtLS0gQ29yZSBMb2dpYyAoRW1iZWRkZWQgYXMgYSBzdHJpbmcpIC0tLQpyZWFkIC1yIC1kICcnIENPUkVfTE9HSUMgPDwnRU9GJyB8fCB0cnVlCgojIC0tLSBCZWdpbiBDb3JlIExvZ2ljIGZvciBmdWNraXRzIC0tLQoKIyAtLS0gQ29sb3IgRGVmaW5pdGlvbnMgLS0tCiMgT25seSBkZWZpbmUgY29sb3JzIGlmIHRoZXkgaGF2ZW4ndCBiZWVuIGRlZmluZWQgeWV0IChmb3IgdGVtcCBtb2RlKQppZiBbIC16ICIke0NfUkVTRVQ6LX0iIF07IHRoZW4KICAgIHJlYWRvbmx5IENfUkVTRVQ9J1wwMzNbMG0nCiAgICByZWFkb25seSBDX1JFRF9CT0xEPSdcMDMzWzE7MzFtJwogICAgcmVhZG9ubHkgQ19SRUQ9J1wwMzNbMDszMW0nCiAgICByZWFkb25seSBDX0dSRUVOPSdcMDMzWzA7MzJtJwogICAgcmVhZG9ubHkgQ19ZRUxMT1c9J1wwMzNbMDszM20nCiAgICByZWFkb25seSBDX0NZQU49J1wwMzNbMDszNm0nCiAgICByZWFkb25seSBDX0JPTEQ9J1wwMzNbMW0nCiAgICByZWFkb25seSBDX0RJTT0nXDAzM1sybScKCiAgICAjIC0tLSBGVUNLISAtLS0KICAgIHJlYWRvbmx5IEZVQ0s9IiR7Q19SRURfQk9MRH1GVUNLISR7Q19SRVNFVH0iCiAgICByZWFkb25seSBGQ0tOPSIke0NfUkVEfUYqQ0tJTkcke0NfUkVTRVR9IgpmaQoKaWYgWyAteiAiJHtJTlNUQUxMX0RJUit4fSIgXSB8fCBbIC16ICIke01BSU5fU0greH0iIF0gfHwgWyAteiAiJHtDT05GSUdfRklMRSt4fSIgXTsgdGhlbgogICAgaWYgWyAteiAiJHtIT01FOi19IiBdOyB0aGVuCiAgICAgICAgcmVhZG9ubHkgSU5TVEFMTF9ESVI9Ii90bXAvLmZ1Y2siCiAgICAgICAgcmVhZG9ubHkgTUFJTl9TSD0iL3RtcC8uZnVjay9tYWluLnNoIgogICAgICAgIHJlYWRvbmx5IENPTkZJR19GSUxFPSIvdG1wLy5mdWNrL2NvbmZpZy5zaCIKICAgIGVsc2UKICAgICAgICByZWFkb25seSBJTlNUQUxMX0RJUj0iJEhPTUUvLmZ1Y2siCiAgICAgICAgcmVhZG9ubHkgTUFJTl9TSD0iJElOU1RBTExfRElSL21haW4uc2giCiAgICAgICAgcmVhZG9ubHkgQ09ORklHX0ZJTEU9IiRJTlNUQUxMX0RJUi9jb25maWcuc2giCiAgICBmaQpmaQoKIyBOb3RlOiBDb25maWcgbG9hZGluZyBpcyBkb25lIEFGVEVSIHZhbGlkYXRpb24gZnVuY3Rpb25zIGFyZSBkZWZpbmVkIChzZWUgYmVsb3cpCgppZiBbIC16ICIke0RFRkFVTFRfQVBJX0VORFBPSU5UK3h9IiBdOyB0aGVuCiAgICByZWFkb25seSBERUZBVUxUX0FQSV9FTkRQT0lOVD0iaHR0cHM6Ly9mdWNraXRzLjI1NTAwNTUyLnh5ei8iCmZpCgojIC0tLSBTZWN1cmUgQ29uZmlnIFZhbGlkYXRpb24gLS0tCiMgVmFsaWRhdGVzIGNvbmZpZyBmaWxlIGNvbnRlbnQgYmVmb3JlIHNvdXJjaW5nIHRvIHByZXZlbnQgY29kZSBpbmplY3Rpb24KIyBBcmd1bWVudHM6ICQxIC0gZmlsZSBwYXRoIHRvIHZhbGlkYXRlCiMgUmV0dXJuczogMCBpZiBzYWZlLCAxIGlmIHVuc2FmZSBvciBlcnJvcgpfZnVja192YWxpZGF0ZV9jb25maWdfZmlsZSgpIHsKICAgIGxvY2FsIGZpbGU9IiQxIgoKICAgICMgRmlsZSBtdXN0IGV4aXN0IGFuZCBiZSByZWFkYWJsZQogICAgaWYgWyAhIC1mICIkZmlsZSIgXSB8fCBbICEgLXIgIiRmaWxlIiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgIyBDaGVjayBmaWxlIHBlcm1pc3Npb25zIC0gc2hvdWxkIGJlIG93bmVkIGJ5IGN1cnJlbnQgdXNlcgogICAgaWYgWyAiJChzdGF0IC1jICcldScgIiRmaWxlIiAyPi9kZXYvbnVsbCB8fCBzdGF0IC1mICcldScgIiRmaWxlIiAyPi9kZXYvbnVsbCkiICE9ICIkKGlkIC11KSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9Q29uZmlnIGZpbGUgbm90IG93bmVkIGJ5IGN1cnJlbnQgdXNlciwgcmVmdXNpbmcgdG8gc291cmNlLiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIGxpbmVfbnVtPTAKICAgIGxvY2FsIGxpbmUKCiAgICAjIFByZS1kZWZpbmUgcmVnZXggcGF0dGVybnMgYXMgdmFyaWFibGVzICh6c2ggY29tcGF0aWJpbGl0eTogYXZvaWRzIHNwZWNpYWwgY2hhcmFjdGVyIHBhcnNpbmcgaXNzdWVzKQogICAgbG9jYWwgcmVfY21kX3N1Yj0nXCRcKCcKICAgIGxvY2FsIHJlX2JhY2t0aWNrPSdgJwogICAgbG9jYWwgcmVfYXJpdGg9J1wkXChcKCcKICAgIGxvY2FsIHJlX3NlbWk9JzsnCiAgICBsb2NhbCByZV9hbmQ9JyYmJwogICAgbG9jYWwgcmVfb3I9J1x8XHwnCiAgICBsb2NhbCByZV9waXBlPSdcfCcKICAgIGxvY2FsIHJlX2d0PSc+JwogICAgbG9jYWwgcmVfbHQ9JzwnCiAgICBsb2NhbCByZV9hbXA9JyYnCiAgICBsb2NhbCByZV9lc2M9J1xcXCQnCgogICAgd2hpbGUgSUZTPSByZWFkIC1yIGxpbmUgfHwgWyAtbiAiJGxpbmUiIF07IGRvCiAgICAgICAgbGluZV9udW09JCgobGluZV9udW0gKyAxKSkKCiAgICAgICAgIyBTa2lwIGVtcHR5IGxpbmVzCiAgICAgICAgaWYgWyAteiAiJGxpbmUiIF0gfHwgW1sgIiRsaW5lIiA9fiBeW1s6c3BhY2U6XV0qJCBdXTsgdGhlbgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZpCgogICAgICAgICMgU2tpcCBjb21tZW50IGxpbmVzICgjIGF0IHN0YXJ0LCBvcHRpb25hbGx5IHdpdGggbGVhZGluZyB3aGl0ZXNwYWNlKQogICAgICAgIGlmIFtbICIkbGluZSIgPX4gXltbOnNwYWNlOl1dKiMgXV07IHRoZW4KICAgICAgICAgICAgY29udGludWUKICAgICAgICBmaQoKICAgICAgICAjIENoZWNrIGZvciBkYW5nZXJvdXMgc2hlbGwgbWV0YWNoYXJhY3RlcnMgYW5kIGNvbW1hbmQgc3Vic3RpdHV0aW9uCiAgICAgICAgIyBSZWplY3Q6ICQoKSwgYGAsICQoKCksIDssICYmLCB8fCwgfCAocGlwZSksID4sIDwsICYsIG5ld2xpbmUgZXNjYXBlcwogICAgICAgIGlmIFtbICIkbGluZSIgPX4gJHJlX2NtZF9zdWIgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2JhY2t0aWNrIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hcml0aCBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfc2VtaSBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfYW5kIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9vciBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfcGlwZSBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfZ3QgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2x0IF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hbXAgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2VzYyBdXTsgdGhlbgogICAgICAgICAgICBfZnVja19kZWJ1ZyAiQ29uZmlnIHZhbGlkYXRpb24gZmFpbGVkIGF0IGxpbmUgJGxpbmVfbnVtOiBkYW5nZXJvdXMgbWV0YWNoYXJhY3RlciBkZXRlY3RlZCIKICAgICAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1VbnNhZmUgY29uZmlnIGZpbGU6IGRhbmdlcm91cyBzaGVsbCBtZXRhY2hhcmFjdGVyIGF0IGxpbmUgJGxpbmVfbnVtJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKCiAgICAgICAgIyBPbmx5IGFsbG93OiBleHBvcnQgRlVDS18qPS4uLiBvciBGVUNLXyo9Li4uICh3aXRoIG9wdGlvbmFsIHdoaXRlc3BhY2UpCiAgICAgICAgIyBBbHNvIGFsbG93OiBleHBvcnQgRlVDS0lUU19MT0NBTEU9Li4uCiAgICAgICAgaWYgW1sgIiRsaW5lIiA9fiBeW1s6c3BhY2U6XV0qKGV4cG9ydFtbOnNwYWNlOl1dKyk/KEZVQ0tfW0EtWl9dK3xGVUNLSVRTX0xPQ0FMRSk9IF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyBSZWplY3QgYW55dGhpbmcgZWxzZQogICAgICAgIF9mdWNrX2RlYnVnICJDb25maWcgdmFsaWRhdGlvbiBmYWlsZWQgYXQgbGluZSAkbGluZV9udW06IHVucmVjb2duaXplZCBwYXR0ZXJuIgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9VW5zYWZlIGNvbmZpZyBmaWxlOiB1bnJlY29nbml6ZWQgcGF0dGVybiBhdCBsaW5lICRsaW5lX251bSR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBkb25lIDwgIiRmaWxlIgoKICAgIHJldHVybiAwCn0KCiMgU2FmZWx5IHNvdXJjZSBhIGNvbmZpZyBmaWxlIGFmdGVyIHZhbGlkYXRpb24KIyBBcmd1bWVudHM6ICQxIC0gZmlsZSBwYXRoIHRvIHNvdXJjZQojIFJldHVybnM6IDAgaWYgc291cmNlZCBzdWNjZXNzZnVsbHksIDEgaWYgdmFsaWRhdGlvbiBmYWlsZWQgb3IgZmlsZSBkb2Vzbid0IGV4aXN0Cl9mdWNrX3NhZmVfc291cmNlX2NvbmZpZygpIHsKICAgIGxvY2FsIGZpbGU9IiQxIgoKICAgIGlmIFsgISAtZiAiJGZpbGUiIF07IHRoZW4KICAgICAgICByZXR1cm4gMCAgIyBObyBmaWxlIGlzIGZpbmUKICAgIGZpCgogICAgaWYgX2Z1Y2tfdmFsaWRhdGVfY29uZmlnX2ZpbGUgIiRmaWxlIjsgdGhlbgogICAgICAgICMgc2hlbGxjaGVjayBkaXNhYmxlPVNDMTA5MAogICAgICAgIHNvdXJjZSAiJGZpbGUiCiAgICAgICAgcmV0dXJuICQ/CiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31Db25maWcgZmlsZSB2YWxpZGF0aW9uIGZhaWxlZCwgc2tpcHBpbmc6ICRmaWxlJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCn0KCiMgLS0tIExvYWQgVXNlciBDb25maWd1cmF0aW9uICh3aXRoIHZhbGlkYXRpb24pIC0tLQojIE5vdyB0aGF0IHZhbGlkYXRpb24gZnVuY3Rpb25zIGFyZSBkZWZpbmVkLCBzYWZlbHkgbG9hZCB0aGUgY29uZmlnCl9mdWNrX3NhZmVfc291cmNlX2NvbmZpZyAiJENPTkZJR19GSUxFIgoKIyBIZWxwZXIgdG8gZmluZCB0aGUgdXNlcidzIHNoZWxsIHByb2ZpbGUgZmlsZQpfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKCkgewogICAgaWYgWyAtbiAiJHtTSEVMTDotfSIgXSAmJiBlY2hvICIkU0hFTEwiIHwgZ3JlcCAtcSAienNoIjsgdGhlbgogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtbiAiJHtTSEVMTDotfSIgXSAmJiBlY2hvICIkU0hFTEwiIHwgZ3JlcCAtcSAiYmFzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uYmFzaHJjIgogICAgZWxpZiBbIC1mICIkSE9NRS8ucHJvZmlsZSIgXTsgdGhlbgogICAgICAgICMgRmFsbGJhY2sgZm9yIHNoLCBrc2gsIGV0Yy4KICAgICAgICBlY2hvICIkSE9NRS8ucHJvZmlsZSIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnpzaHJjIiBdOyB0aGVuCiAgICAgICAgIyBGYWxsYmFjayBpZiBTSEVMTCB2YXIgaXNuJ3Qgc2V0CiAgICAgICAgZWNobyAiJEhPTUUvLnpzaHJjIgogICAgZWxpZiBbIC1mICIkSE9NRS8uYmFzaHJjIiBdOyB0aGVuCiAgICAgICAgIyBGYWxsYmFjayBpZiBTSEVMTCB2YXIgaXNuJ3Qgc2V0CiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsc2UKICAgICAgICBlY2hvICJ1bmtub3duX3Byb2ZpbGUiCiAgICBmaQp9CgojIC0tLSBTeXN0ZW0gSW5mb3JtYXRpb24gQ29sbGVjdGlvbiAtLS0KIyBDYWNoZSBmaWxlIGZvciBzdGF0aWMgc3lzdGVtIGluZm9ybWF0aW9uIChwZXJzaXN0ZWQgYWNyb3NzIHJ1bnMpCiMgT25seSBkZWZpbmUgaWYgbm90IGFscmVhZHkgc2V0IChwcmV2ZW50cyByZWFkLW9ubHkgdmFyaWFibGUgZXJyb3JzKQppZiBbIC16ICIke0ZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFOi19IiBdOyB0aGVuCiAgICByZWFkb25seSBGVUNLX1NZU0lORk9fQ0FDSEVfRklMRT0iJElOU1RBTExfRElSLy5zeXNpbmZvLmNhY2hlIgpmaQojIENhY2hlIHN0YXRlIHRyYWNraW5nIHZhcmlhYmxlcwpfRlVDS19TVEFUSUNfQ0FDSEVfTE9BREVEPTAKX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZPTAKCiMgTG9hZHMgc3RhdGljIHN5c3RlbSBpbmZvcm1hdGlvbiBmcm9tIGNhY2hlIGZpbGUKIyBHbG9iYWxzOiBfRlVDS19TVEFUSUNfQ0FDSEVfTE9BREVELCBGVUNLX1NZU0lORk9fQ0FDSEVfRklMRQpfZnVja19sb2FkX3N0YXRpY19jYWNoZSgpIHsKICAgICMgUmV0dXJuIGVhcmx5IGlmIGNhY2hlIGlzIGFscmVhZHkgbG9hZGVkCiAgICBpZiBbICIke19GVUNLX1NUQVRJQ19DQUNIRV9MT0FERUQ6LTB9IiAtZXEgMSBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgX0ZVQ0tfU1RBVElDX0NBQ0hFX0xPQURFRD0xCgogICAgIyBTb3VyY2UgY2FjaGUgZmlsZSBpZiBpdCBleGlzdHMKICAgIGlmIFsgLWYgIiRGVUNLX1NZU0lORk9fQ0FDSEVfRklMRSIgXTsgdGhlbgogICAgICAgICMgc2hlbGxjaGVjayBkaXNhYmxlPVNDMTA5MAogICAgICAgIHNvdXJjZSAiJEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFIiB8fCB0cnVlCiAgICBmaQp9CgojIE1hcmtzIHN0YXRpYyBjYWNoZSBhcyBkaXJ0eSAobmVlZHMgdG8gYmUgcGVyc2lzdGVkKQojIEdsb2JhbHM6IF9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWQpfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eSgpIHsKICAgIF9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWT0xCn0KCiMgUGVyc2lzdHMgc3RhdGljIHN5c3RlbSBpbmZvcm1hdGlvbiB0byBjYWNoZSBmaWxlCiMgR2xvYmFsczogX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZLCBGVUNLX1NZU0lORk9fQ0FDSEVfRklMRQojIFJldHVybnM6IDAgb24gc3VjY2VzcywgMSBvbiBmYWlsdXJlCl9mdWNrX3BlcnNpc3Rfc3RhdGljX2NhY2hlKCkgewogICAgIyBPbmx5IHBlcnNpc3QgaWYgY2FjaGUgaXMgZGlydHkKICAgIGlmIFsgIiR7X0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZOi0wfSIgLW5lIDEgXTsgdGhlbgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgICMgRW5zdXJlIGNhY2hlIGRpcmVjdG9yeSBleGlzdHMKICAgIGxvY2FsIGNhY2hlX2RpcgogICAgY2FjaGVfZGlyPSQoZGlybmFtZSAiJEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFIikKICAgIGlmICEgbWtkaXIgLXAgIiRjYWNoZV9kaXIiIDI+L2Rldi9udWxsOyB0aGVuCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgIyBDcmVhdGUgdGVtcG9yYXJ5IGZpbGUgZm9yIGF0b21pYyB3cml0ZQogICAgbG9jYWwgdG1wX2ZpbGUKICAgIHRtcF9maWxlPSQobWt0ZW1wKSB8fCByZXR1cm4gMQoKICAgICMgV3JpdGUgY2FjaGVkIHZhcmlhYmxlcyB0byB0ZW1wb3JhcnkgZmlsZQogICAgewogICAgICAgIHByaW50ZiAnX0ZVQ0tfQ0FDSEVEX0RJU1RSTz0lcVxcbicgIiR7X0ZVQ0tfQ0FDSEVEX0RJU1RSTzotfSIKICAgICAgICBwcmludGYgJ19GVUNLX0NBQ0hFRF9LRVJORUw9JXFcXG4nICIke19GVUNLX0NBQ0hFRF9LRVJORUw6LX0iCiAgICAgICAgcHJpbnRmICdfRlVDS19DQUNIRURfQVJDSD0lcVxcbicgIiR7X0ZVQ0tfQ0FDSEVEX0FSQ0g6LX0iCiAgICAgICAgcHJpbnRmICdfRlVDS19DQUNIRURfUEtHX01BTkFHRVI9JXFcXG4nICIke19GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUjotfSIKICAgIH0gPiAiJHRtcF9maWxlIgoKICAgICMgQXRvbWljIG1vdmUgdG8gZmluYWwgbG9jYXRpb24KICAgIGlmIG12ICIkdG1wX2ZpbGUiICIkRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUiIDI+L2Rldi9udWxsOyB0aGVuCiAgICAgICAgX0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZPTAKICAgICAgICByZXR1cm4gMAogICAgZWxzZQogICAgICAgICMgQ2xlYW4gdXAgdGVtcG9yYXJ5IGZpbGUgb24gZmFpbHVyZQogICAgICAgIHJtIC1mICIkdG1wX2ZpbGUiCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCn0KCiMgRGV0ZWN0cyB0aGUgZGlzdHJpYnV0aW9uL09TIGZhbWlseSB3aXRoIGNhY2hpbmcgc3VwcG9ydAojIE91dHB1dHM6IERpc3RyaWJ1dGlvbiBzdHJpbmcgKGUuZy4sICJEZWJpYW4tYmFzZWQgMTIuMDQgKFVidW50dSAyNC4wNCBMVFMpIikKX2Z1Y2tfZGV0ZWN0X2Rpc3RybygpIHsKICAgIF9mdWNrX2xvYWRfc3RhdGljX2NhY2hlCgogICAgIyBSZXR1cm4gY2FjaGVkIHZhbHVlIGlmIGF2YWlsYWJsZQogICAgaWYgWyAtbiAiJHtfRlVDS19DQUNIRURfRElTVFJPOi19IiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJF9GVUNLX0NBQ0hFRF9ESVNUUk8iCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgbG9jYWwga2VybmVsX25hbWUgZGlzdHJvIGlkIHZlcnNpb24gcHJldHR5IGZhbWlseQogICAga2VybmVsX25hbWU9JCh1bmFtZSAtcyAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgZGlzdHJvPSJ1bmtub3duIgoKICAgICMgbWFjT1MgZGV0ZWN0aW9uCiAgICBpZiBbICIka2VybmVsX25hbWUiID0gIkRhcndpbiIgXTsgdGhlbgogICAgICAgIGxvY2FsIHByb2R1Y3QgdmVyc2lvbgogICAgICAgIHByb2R1Y3Q9JChzd192ZXJzIC1wcm9kdWN0TmFtZSAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ21hY09TJykKICAgICAgICBwcm9kdWN0PSQocHJpbnRmICclcycgIiRwcm9kdWN0IiB8IHRyIC1kICdcclxuJykKICAgICAgICB2ZXJzaW9uPSQoc3dfdmVycyAtcHJvZHVjdFZlcnNpb24gMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgICAgICB2ZXJzaW9uPSQocHJpbnRmICclcycgIiR2ZXJzaW9uIiB8IHRyIC1kICdcclxuJykKICAgICAgICBkaXN0cm89IiRwcm9kdWN0ICR2ZXJzaW9uIgogICAgIyBMaW51eCBkZXRlY3Rpb24gdXNpbmcgL2V0Yy9vcy1yZWxlYXNlCiAgICBlbGlmIFsgLXIgL2V0Yy9vcy1yZWxlYXNlIF07IHRoZW4KICAgICAgICBpZD0kKGdyZXAgLUUgJ15JRD0nIC9ldGMvb3MtcmVsZWFzZSB8IGhlYWQgLW4xIHwgY3V0IC1kPSAtZjIgfCB0ciAtZCAnIicgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKICAgICAgICB2ZXJzaW9uPSQoZ3JlcCAtRSAnXlZFUlNJT05fSUQ9JyAvZXRjL29zLXJlbGVhc2UgfCBoZWFkIC1uMSB8IGN1dCAtZD0gLWYyIHwgdHIgLWQgJyInKQogICAgICAgIHByZXR0eT0kKGdyZXAgLUUgJ15QUkVUVFlfTkFNRT0nIC9ldGMvb3MtcmVsZWFzZSB8IGhlYWQgLW4xIHwgY3V0IC1kPSAtZjItIHwgdHIgLWQgJyInKQoKICAgICAgICAjIERldGVybWluZSBPUyBmYW1pbHkgZm9yIGJldHRlciBjYXRlZ29yaXphdGlvbgogICAgICAgIGZhbWlseT0iIgogICAgICAgIGNhc2UgIiRpZCIgaW4KICAgICAgICAgICAgdWJ1bnR1fGRlYmlhbikKICAgICAgICAgICAgICAgIGZhbWlseT0iRGViaWFuLWJhc2VkIgogICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgY2VudG9zfHJoZWx8cm9ja3l8YWxtYWxpbnV4fGZlZG9yYSkKICAgICAgICAgICAgICAgIGZhbWlseT0iUkhFTC1iYXNlZCIKICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgIGFyY2h8bWFuamFyb3xlbmRlYXZvdXJvcykKICAgICAgICAgICAgICAgIGZhbWlseT0iQXJjaC1iYXNlZCIKICAgICAgICAgICAgICAgIDs7CiAgICAgICAgZXNhYwoKICAgICAgICAjIEZvcm1hdCBkaXN0cmlidXRpb24gc3RyaW5nIHdpdGggZmFtaWx5IGFuZCB2ZXJzaW9uCiAgICAgICAgaWYgWyAtbiAiJGZhbWlseSIgXTsgdGhlbgogICAgICAgICAgICBkaXN0cm89IiRmYW1pbHkgJHt2ZXJzaW9uOi19IgogICAgICAgICAgICBpZiBbIC1uICIkcHJldHR5IiBdOyB0aGVuCiAgICAgICAgICAgICAgICBkaXN0cm89IiRkaXN0cm8gKCR7cHJldHR5fSkiCiAgICAgICAgICAgIGZpCiAgICAgICAgZWxzZQogICAgICAgICAgICBkaXN0cm89IiR7cHJldHR5Oi1MaW51eCAkdmVyc2lvbn0iCiAgICAgICAgZmkKICAgIGVsc2UKICAgICAgICBkaXN0cm89IiRrZXJuZWxfbmFtZSIKICAgIGZpCgogICAgIyBDYWNoZSBhbmQgcmV0dXJuIHJlc3VsdAogICAgX0ZVQ0tfQ0FDSEVEX0RJU1RSTz0iJGRpc3RybyIKICAgIF9mdWNrX21hcmtfc3RhdGljX2NhY2hlX2RpcnR5CiAgICBwcmludGYgJyVzXG4nICIkZGlzdHJvIgp9CgojIEdldHMga2VybmVsIHZlcnNpb24gaW5mb3JtYXRpb24gd2l0aCBjYWNoaW5nCiMgT3V0cHV0czogS2VybmVsIHZlcnNpb24gc3RyaW5nIChlLmcuLCAiTGludXggNi44LjAtMzEtZ2VuZXJpYyIpCl9mdWNrX2dldF9rZXJuZWxfdmVyc2lvbigpIHsKICAgIF9mdWNrX2xvYWRfc3RhdGljX2NhY2hlCgogICAgIyBSZXR1cm4gY2FjaGVkIHZhbHVlIGlmIGF2YWlsYWJsZQogICAgaWYgWyAtbiAiJHtfRlVDS19DQUNIRURfS0VSTkVMOi19IiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJF9GVUNLX0NBQ0hFRF9LRVJORUwiCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgbG9jYWwga2VybmVsCiAgICBrZXJuZWw9JCh1bmFtZSAtc3IgMj4vZGV2L251bGwgfHwgdW5hbWUgLXMgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGtlcm5lbD0kKHByaW50ZiAnJXMnICIka2VybmVsIiB8IHRyIC1kICdcclxuJykKCiAgICAjIENhY2hlIGFuZCByZXR1cm4gcmVzdWx0CiAgICBfRlVDS19DQUNIRURfS0VSTkVMPSIka2VybmVsIgogICAgX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkKICAgIHByaW50ZiAnJXNcbicgIiRrZXJuZWwiCn0KCiMgR2V0cyBzeXN0ZW0gYXJjaGl0ZWN0dXJlIHdpdGggY2FjaGluZwojIE91dHB1dHM6IEFyY2hpdGVjdHVyZSBzdHJpbmcgKGUuZy4sICJ4ODZfNjQiLCAiYXJtNjQiKQpfZnVja19nZXRfYXJjaGl0ZWN0dXJlKCkgewogICAgX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUKCiAgICAjIFJldHVybiBjYWNoZWQgdmFsdWUgaWYgYXZhaWxhYmxlCiAgICBpZiBbIC1uICIke19GVUNLX0NBQ0hFRF9BUkNIOi19IiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJF9GVUNLX0NBQ0hFRF9BUkNIIgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGxvY2FsIGFyY2gKICAgIGFyY2g9JCh1bmFtZSAtbSAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgYXJjaD0kKHByaW50ZiAnJXMnICIkYXJjaCIgfCB0ciAtZCAnXHJcbicpCgogICAgIyBDYWNoZSBhbmQgcmV0dXJuIHJlc3VsdAogICAgX0ZVQ0tfQ0FDSEVEX0FSQ0g9IiRhcmNoIgogICAgX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkKICAgIHByaW50ZiAnJXNcbicgIiRhcmNoIgp9CgojIENvbGxlY3RzIHVzZXIgaW5mb3JtYXRpb24gaW5jbHVkaW5nIHBlcm1pc3Npb25zCiMgT3V0cHV0czogVXNlciBpbmZvIHN0cmluZyAoZS5nLiwgIlVzZXI9am9obiB1aWQ9MTAwMCBsZXZlbD1zdWRvZXIgR3JvdXBzPWpvaG4gYWRtIHN1ZG8iKQpfZnVja19jb2xsZWN0X3VzZXJfaW5mbygpIHsKICAgIGxvY2FsIGN1cnJlbnRfdXNlciB1aWQgZ3JvdXBzIGxldmVsCiAgICBjdXJyZW50X3VzZXI9IiR7VVNFUjotfSIKCiAgICAjIEZhbGxiYWNrIGlmIFVTRVIgaXMgbm90IHNldAogICAgaWYgWyAteiAiJGN1cnJlbnRfdXNlciIgXTsgdGhlbgogICAgICAgIGN1cnJlbnRfdXNlcj0kKHdob2FtaSAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgZmkKCiAgICAjIEdldCBVSUQgYW5kIGdyb3VwcyBpZiBpZCBjb21tYW5kIGlzIGF2YWlsYWJsZQogICAgdWlkPSJ1bmtub3duIgogICAgZ3JvdXBzPSJ1bmtub3duIgogICAgaWYgY29tbWFuZCAtdiBpZCA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICB1aWQ9JChpZCAtdSAiJGN1cnJlbnRfdXNlciIgMj4vZGV2L251bGwgfHwgaWQgLXUgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgICAgICBncm91cHM9JChpZCAtR24gIiRjdXJyZW50X3VzZXIiIDI+L2Rldi9udWxsIHx8IGlkIC1HbiAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAgZmkKCiAgICAjIERldGVybWluZSBwZXJtaXNzaW9uIGxldmVsCiAgICBsZXZlbD0idXNlciIKICAgIGlmIFsgIiR1aWQiID0gIjAiIF07IHRoZW4KICAgICAgICBsZXZlbD0icm9vdCIKICAgIGVsaWYgcHJpbnRmICclcycgIiRncm91cHMiIHwgZ3JlcCAtRXEgJyhefFtbOnNwYWNlOl1dKShzdWRvfHdoZWVsfGFkbWluKShbWzpzcGFjZTpdXXwkKSc7IHRoZW4KICAgICAgICBsZXZlbD0ic3Vkb2VyIgogICAgZmkKCiAgICBwcmludGYgJ1VzZXI9JXMgdWlkPSVzIGxldmVsPSVzIEdyb3Vwcz0lcycgIiRjdXJyZW50X3VzZXIiICIkdWlkIiAiJGxldmVsIiAiJGdyb3VwcyIKfQoKIyBDb2xsZWN0cyB2ZXJzaW9uIGluZm9ybWF0aW9uIGZvciBjb21tb24gZGV2ZWxvcG1lbnQgdG9vbHMKIyBPdXRwdXRzOiBUb29sIHZlcnNpb25zIHN0cmluZyAoZS5nLiwgImdpdDpnaXQgdmVyc2lvbiAyLjM0LjE7IGRvY2tlcjpEb2NrZXIgdmVyc2lvbiAyNC4wLjY7IC4uLiIpCl9mdWNrX2NvbGxlY3RfdG9vbF92ZXJzaW9ucygpIHsKICAgIGxvY2FsIHRvb2xzIHRvb2wgdmVyc2lvbiByZXN1bHQKICAgIHRvb2xzPSJnaXQgZG9ja2VyIG5wbSBrdWJlY3RsIGN1cmwgd2dldCIKICAgIHJlc3VsdD0iIgoKICAgIGZvciB0b29sIGluICR0b29sczsgZG8KICAgICAgICB2ZXJzaW9uPSJub3QtaW5zdGFsbGVkIgoKICAgICAgICBpZiBjb21tYW5kIC12ICIkdG9vbCIgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgICAgIGNhc2UgIiR0b29sIiBpbgogICAgICAgICAgICAgICAgZ2l0fGRvY2tlcnxjdXJsfHdnZXQpCiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbj0kKCIkdG9vbCIgLS12ZXJzaW9uIDI+L2Rldi9udWxsIHwgaGVhZCAtbjEpCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgIG5wbSkKICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPSQoIiR0b29sIiAtLXZlcnNpb24gMj4vZGV2L251bGwgfCBoZWFkIC1uMSkKICAgICAgICAgICAgICAgICAgICBbIC1uICIkdmVyc2lvbiIgXSAmJiB2ZXJzaW9uPSJucG0gJHZlcnNpb24iCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgIGt1YmVjdGwpCiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbj0kKCIkdG9vbCIgdmVyc2lvbiAtLWNsaWVudCAtLXNob3J0IDI+L2Rldi9udWxsIHwgaGVhZCAtbjEpCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgZXNhYwogICAgICAgIGZpCgogICAgICAgICMgQ2xlYW4gdXAgdmVyc2lvbiBzdHJpbmcKICAgICAgICB2ZXJzaW9uPSQocHJpbnRmICclcycgIiR7dmVyc2lvbjotdW5rbm93bn0iIHwgdHIgJ1xyXG4nICcgICcgfCB0ciAtcyAnICcgfCBzZWQgLWUgJ3MvXiAqLy8nIC1lICdzLyAqJC8vJykKICAgICAgICBbIC16ICIkdmVyc2lvbiIgXSAmJiB2ZXJzaW9uPSJ1bmtub3duIgoKICAgICAgICByZXN1bHQ9IiRyZXN1bHQkdG9vbDokdmVyc2lvbjsgIgogICAgZG9uZQoKICAgICMgUmVtb3ZlIHRyYWlsaW5nIHNlbWljb2xvbiBhbmQgc3BhY2UKICAgIHJlc3VsdD0iJHtyZXN1bHQlOyB9IgogICAgcHJpbnRmICclcycgIiRyZXN1bHQiCn0KCiMgRGV0ZWN0cyB0aGUgcGFja2FnZSBtYW5hZ2VyIHdpdGggY2FjaGluZyBzdXBwb3J0CiMgT3V0cHV0czogUGFja2FnZSBtYW5hZ2VyIG5hbWUgKGFwdCwgeXVtLCBkbmYsIHBhY21hbiwgenlwcGVyLCBicmV3LCB1bmtub3duKQpfZnVja19kZXRlY3RfcGtnX21hbmFnZXIoKSB7CiAgICBfZnVja19sb2FkX3N0YXRpY19jYWNoZQoKICAgICMgUmV0dXJuIGNhY2hlZCB2YWx1ZSBpZiBhdmFpbGFibGUKICAgIGlmIFsgLW4gIiR7X0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSOi19IiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJF9GVUNLX0NBQ0hFRF9QS0dfTUFOQUdFUiIKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBsb2NhbCBtYW5hZ2VyPSJ1bmtub3duIgoKICAgICMgRGV0ZWN0IHBhY2thZ2UgbWFuYWdlciBpbiBvcmRlciBvZiBwcmVmZXJlbmNlCiAgICBpZiBjb21tYW5kIC12IGFwdC1nZXQgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0iYXB0IgogICAgZWxpZiBjb21tYW5kIC12IHl1bSAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJ5dW0iCiAgICBlbGlmIGNvbW1hbmQgLXYgZG5mICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9ImRuZiIKICAgIGVsaWYgY29tbWFuZCAtdiBwYWNtYW4gJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0icGFjbWFuIgogICAgZWxpZiBjb21tYW5kIC12IHp5cHBlciAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJ6eXBwZXIiCiAgICBlbGlmIGNvbW1hbmQgLXYgYnJldyAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJicmV3IgogICAgZmkKCiAgICAjIENhY2hlIGFuZCByZXR1cm4gcmVzdWx0CiAgICBfRlVDS19DQUNIRURfUEtHX01BTkFHRVI9IiRtYW5hZ2VyIgogICAgX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkKICAgIHByaW50ZiAnJXNcbicgIiRtYW5hZ2VyIgp9CgojIENvbGxlY3RzIHNpbXBsaWZpZWQgc3lzdGVtIGluZm9ybWF0aW9uIGFzIGEgc3RydWN0dXJlZCBzdHJpbmcKIyBPdXRwdXRzOiBTeXN0ZW0gaW5mbyBzdHJpbmcgZm9yIEFJIHByb2Nlc3NpbmcKX2Z1Y2tfY29sbGVjdF9zeXNpbmZvX3N0cmluZygpIHsKICAgIGxvY2FsIG9zX3R5cGUga2VybmVsX25hbWUgcGtnX21hbmFnZXIgc3VtbWFyeQoKICAgICMgRGV0ZWN0IG9wZXJhdGluZyBzeXN0ZW0gdHlwZQogICAga2VybmVsX25hbWU9JCh1bmFtZSAtcyAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQoKICAgIGNhc2UgIiRrZXJuZWxfbmFtZSIgaW4KICAgICAgICBEYXJ3aW4pCiAgICAgICAgICAgIG9zX3R5cGU9Im1hY09TIgogICAgICAgICAgICBwa2dfbWFuYWdlcj0iYnJldyIKICAgICAgICAgICAgOzsKICAgICAgICBMaW51eCkKICAgICAgICAgICAgaWYgWyAtciAvZXRjL29zLXJlbGVhc2UgXTsgdGhlbgogICAgICAgICAgICAgICAgbG9jYWwgaWQKICAgICAgICAgICAgICAgIGlkPSQoZ3JlcCAtRSAnXklEPScgL2V0Yy9vcy1yZWxlYXNlIHwgaGVhZCAtbjEgfCBjdXQgLWQ9IC1mMiB8IHRyIC1kICciJyB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQogICAgICAgICAgICAgICAgY2FzZSAiJGlkIiBpbgogICAgICAgICAgICAgICAgICAgIHVidW50dXxkZWJpYW4pCiAgICAgICAgICAgICAgICAgICAgICAgIG9zX3R5cGU9IkRlYmlhbiIKICAgICAgICAgICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9ImFwdCIKICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICAgICBjZW50b3N8cmhlbHxyb2NreXxhbG1hbGludXh8ZmVkb3JhKQogICAgICAgICAgICAgICAgICAgICAgICBvc190eXBlPSJSSEVMIgogICAgICAgICAgICAgICAgICAgICAgICBwa2dfbWFuYWdlcj0ieXVtIgogICAgICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgICAgIGFyY2h8bWFuamFybykKICAgICAgICAgICAgICAgICAgICAgICAgb3NfdHlwZT0iQXJjaCIKICAgICAgICAgICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9InBhY21hbiIKICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICAgICAqKQogICAgICAgICAgICAgICAgICAgICAgICBvc190eXBlPSJMaW51eCIKICAgICAgICAgICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9InVua25vd24iCiAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICBlc2FjCiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIG9zX3R5cGU9IkxpbnV4IgogICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9InVua25vd24iCiAgICAgICAgICAgIGZpCiAgICAgICAgICAgIDs7CiAgICAgICAgTUlOR1cqfE1TWVMqfENZR1dJTiopCiAgICAgICAgICAgIG9zX3R5cGU9IldpbmRvd3MiCiAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ1bmtub3duIgogICAgICAgICAgICA7OwogICAgICAgICopCiAgICAgICAgICAgIG9zX3R5cGU9IiRrZXJuZWxfbmFtZSIKICAgICAgICAgICAgcGtnX21hbmFnZXI9InVua25vd24iCiAgICAgICAgICAgIDs7CiAgICBlc2FjCgogICAgIyBGb3JtYXQgYXMgc2ltcGxlIHN0cnVjdHVyZWQgc3RyaW5nCiAgICBwcmludGYgLXYgc3VtbWFyeSAnT1M9JXM7IFBrZ01ncj0lcycgIiRvc190eXBlIiAiJHBrZ19tYW5hZ2VyIgogICAgcHJpbnRmICclc1xuJyAiJHN1bW1hcnkiCn0KCiMgRXNjYXBlcyBhIHN0cmluZyBmb3IgdXNlIGluIGEgSlNPTiBwYXlsb2FkCl9mdWNrX2pzb25fZXNjYXBlKCkgewogICAgbG9jYWwgaW5wdXQ9IiQxIgogICAgIyBVc2UgcHJpbnRmIHRvIHByb3Blcmx5IGhhbmRsZSBjb250cm9sIGNoYXJhY3RlcnMKICAgIHByaW50ZiAnJXMnICIkaW5wdXQiIHwgc2VkIC1lICcKICAgICAgICAjIEZpcnN0IGVzY2FwZSBiYWNrc2xhc2hlcyAobXVzdCBiZSBmaXJzdCkKICAgICAgICBzL1xcL1xcXFwvZwogICAgICAgICMgRXNjYXBlIGRvdWJsZSBxdW90ZXMKICAgICAgICBzLyIvXFwiL2cKICAgICAgICAjIEVzY2FwZSBjb250cm9sIGNoYXJhY3RlcnMgKEFTQ0lJIDAtMzEpCiAgICAgICAgcy9ceDAwL1xcdTAwMDAvZwogICAgICAgIHMvXHgwMS9cXHUwMDAxL2cKICAgICAgICBzL1x4MDIvXFx1MDAwMi9nCiAgICAgICAgcy9ceDAzL1xcdTAwMDMvZwogICAgICAgIHMvXHgwNC9cXHUwMDA0L2cKICAgICAgICBzL1x4MDUvXFx1MDAwNS9nCiAgICAgICAgcy9ceDA2L1xcdTAwMDYvZwogICAgICAgIHMvXHgwNy9cXHUwMDA3L2cKICAgICAgICBzL1x4MDgvXFxiL2cKICAgICAgICBzL1x4MDkvXFx0L2cKICAgICAgICBzL1x4MEEvXFxuL2cKICAgICAgICBzL1x4MEIvXFx1MDAwQi9nCiAgICAgICAgcy9ceDBDL1xcZi9nCiAgICAgICAgcy9ceDBEL1xcci9nCiAgICAgICAgcy9ceDBFL1xcdTAwMEUvZwogICAgICAgIHMvXHgwRi9cXHUwMDBGL2cKICAgICAgICBzL1x4MTAvXFx1MDAxMC9nCiAgICAgICAgcy9ceDExL1xcdTAwMTEvZwogICAgICAgIHMvXHgxMi9cXHUwMDEyL2cKICAgICAgICBzL1x4MTMvXFx1MDAxMy9nCiAgICAgICAgcy9ceDE0L1xcdTAwMTQvZwogICAgICAgIHMvXHgxNS9cXHUwMDE1L2cKICAgICAgICBzL1x4MTYvXFx1MDAxNi9nCiAgICAgICAgcy9ceDE3L1xcdTAwMTcvZwogICAgICAgIHMvXHgxOC9cXHUwMDE4L2cKICAgICAgICBzL1x4MTkvXFx1MDAxOS9nCiAgICAgICAgcy9ceDFBL1xcdTAwMUEvZwogICAgICAgIHMvXHgxQi9cXHUwMDFCL2cKICAgICAgICBzL1x4MUMvXFx1MDAxQy9nCiAgICAgICAgcy9ceDFEL1xcdTAwMUQvZwogICAgICAgIHMvXHgxRS9cXHUwMDFFL2cKICAgICAgICBzL1x4MUYvXFx1MDAxRi9nCiAgICAnCn0KCl9mdWNrX3Nob3VsZF91c2VfbG9jYWxfYXBpKCkgewogICAgaWYgWyAtbiAiJHtGVUNLX09QRU5BSV9BUElfS0VZOi19IiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCiAgICByZXR1cm4gMQp9CgpfZnVja19sb2NhbF9zeXN0ZW1fcHJvbXB0KCkgewogICAgbG9jYWwgc3lzaW5mbz0iJDEiCiAgICBpZiBbICIkRlVDS0lUU19MT0NBTEUiID0gInpoIiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICfkvaDmmK/kuIDkuKrkuJPkuJrnmoQgc2hlbGwg5ZG95Luk55Sf5oiQ5Zmo44CC55So5oi35Lya55So6Ieq54S26K+t6KiA5o+P6L+w5LuW5Lus5oOz6KaB5a6M5oiQ55qE5Lu75Yqh44CC5L2g55qE5Lu75Yqh5piv55Sf5oiQ55u05o6l5Y+v5omn6KGM55qEIHNoZWxsIOWRveS7pOadpeWujOaIkOeUqOaIt+eahOebruagh+OAggoK6YeN6KaB6KeE5YiZ77yaCjEuIOeUqOaIt+i+k+WFpeaYr+iHqueEtuivreiogOaPj+i/sOaEj+Wbvu+8jOS4jeaYr+WRveS7pOWPguaVsOOAguS+i+WmgiLliJflh7rnm67lvZUi5oSP5oCd5piv5omn6KGMIGxzIOWRveS7pO+8jOiAjOS4jeaYryBscyAi5YiX5Ye655uu5b2VIgoyLiDnlJ/miJDnm7TmjqXlj6/miafooYznmoTlkb3ku6TvvIzkuI3opoHnlJ/miJDluKblj4LmlbDliKTmlq3nmoTohJrmnKzmqKHmnb/vvIjlpoIgaWYgWyAkIyAtZXEgMCBd77yJCjMuIOWvueS6jueugOWNleS7u+WKoeebtOaOpei/lOWbnuWNleadoeWRveS7pO+8jOWkjeadguS7u+WKoeWPr+S7peaYr+WkmuihjOiEmuacrAo0LiDkuI3opoHmj5Dkvpvku7vkvZXop6Pph4rjgIHms6jph4rjgIFtYXJrZG93biDmoLzlvI/vvIjmr5TlpoIgYGBgYmFzaO+8ieaIliBzaGViYW5n77yI5L6L5aaCICMhL2Jpbi9iYXNo77yJCgrnpLrkvovvvJoKLSDnlKjmiLfor7Qi5YiX5Ye655uu5b2VIiDihpIg6L6T5Ye6OiBscwotIOeUqOaIt+ivtCLmmL7npLror6bnu4bmlofku7bliJfooagiIOKGkiDovpPlh7o6IGxzIC1sYQotIOeUqOaIt+ivtCLmn6Xmib7lpKfkuo4xME1C55qE5paH5Lu2IiDihpIg6L6T5Ye6OiBmaW5kIC4gLXR5cGUgZiAtc2l6ZSArMTBNCgrnlKjmiLfnmoTns7vnu5/kv6Hmga/mmK/vvJolcycgIiRzeXNpbmZvIgogICAgZWxzZQogICAgICAgIHByaW50ZiAnWW91IGFyZSBhbiBleHBlcnQgc2hlbGwgY29tbWFuZCBnZW5lcmF0b3IuIFVzZXJzIGRlc2NyaWJlIHRhc2tzIGluIG5hdHVyYWwgbGFuZ3VhZ2UuIFlvdXIgdGFzayBpcyB0byBnZW5lcmF0ZSBkaXJlY3RseSBleGVjdXRhYmxlIHNoZWxsIGNvbW1hbmRzIHRvIGFjY29tcGxpc2ggdGhlaXIgZ29hbHMuCgpJbXBvcnRhbnQgcnVsZXM6CjEuIFVzZXIgaW5wdXQgaXMgbmF0dXJhbCBsYW5ndWFnZSBpbnRlbnQsIE5PVCBjb21tYW5kIGFyZ3VtZW50cy4gRm9yIGV4YW1wbGUsICJsaXN0IGRpcmVjdG9yeSIgbWVhbnMgcnVuIGxzLCBub3QgbHMgImxpc3QgZGlyZWN0b3J5IgoyLiBHZW5lcmF0ZSBkaXJlY3RseSBleGVjdXRhYmxlIGNvbW1hbmRzLCBub3Qgc2NyaXB0IHRlbXBsYXRlcyB3aXRoIHBhcmFtZXRlciBoYW5kbGluZyAobGlrZSBpZiBbICQjIC1lcSAwIF0pCjMuIEZvciBzaW1wbGUgdGFza3MgcmV0dXJuIHNpbmdsZSBjb21tYW5kcywgY29tcGxleCB0YXNrcyBjYW4gYmUgbXVsdGktbGluZSBzY3JpcHRzCjQuIERvIG5vdCBwcm92aWRlIGFueSBleHBsYW5hdGlvbiwgY29tbWVudHMsIG1hcmtkb3duIGZvcm1hdHRpbmcgKGxpa2UgYGBgYmFzaCksIG9yIGEgc2hlYmFuZyAoZS5nLiwgIyEvYmluL2Jhc2gpCgpFeGFtcGxlczoKLSBVc2VyIHNheXMgImxpc3QgZGlyZWN0b3J5IiDihpIgT3V0cHV0OiBscwotIFVzZXIgc2F5cyAic2hvdyBkZXRhaWxlZCBmaWxlIGxpc3QiIOKGkiBPdXRwdXQ6IGxzIC1sYQotIFVzZXIgc2F5cyAiZmluZCBmaWxlcyBsYXJnZXIgdGhhbiAxME1CIiDihpIgT3V0cHV0OiBmaW5kIC4gLXR5cGUgZiAtc2l6ZSArMTBNCgpUaGUgdXNlciciJyIncyBzeXN0ZW0gaW5mbyBpczogJXMnICIkc3lzaW5mbyIKICAgIGZpCn0KCl9mdWNrX2V4dHJhY3RfY29tbWFuZF9mcm9tX2pzb24oKSB7CiAgICBsb2NhbCBqc29uX2ZpbGU9IiQxIgogICAgaWYgY29tbWFuZCAtdiBweXRob24zID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgIHB5dGhvbjMgLSAiJGpzb25fZmlsZSIgPDwnUFknCmltcG9ydCBqc29uLCBzeXMKcGF0aCA9IHN5cy5hcmd2WzFdCndpdGggb3BlbihwYXRoLCAncicsIGVuY29kaW5nPSd1dGYtOCcpIGFzIGY6CiAgICBkYXRhID0ganNvbi5sb2FkKGYpCmNob2ljZXMgPSBkYXRhLmdldCgnY2hvaWNlcycpIG9yIFtdCmlmIG5vdCBjaG9pY2VzOgogICAgc3lzLmV4aXQoMSkKbWVzc2FnZSA9IGNob2ljZXNbMF0uZ2V0KCdtZXNzYWdlJykgb3Ige30KY29udGVudCA9IChtZXNzYWdlLmdldCgnY29udGVudCcpIG9yICcnKS5zdHJpcCgpCmlmIG5vdCBjb250ZW50OgogICAgc3lzLmV4aXQoMSkKcHJpbnQoY29udGVudCkKUFkKICAgICAgICByZXR1cm4KICAgIGZpCgogICAgaWYgY29tbWFuZCAtdiBub2RlID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgIG5vZGUgLSAiJGpzb25fZmlsZSIgPDwnSlMnCmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTsKY29uc3QgcGF0aCA9IHByb2Nlc3MuYXJndlsxXTsKY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHBhdGgsICd1dGY4JykpOwpjb25zdCBjaG9pY2UgPSAoZGF0YS5jaG9pY2VzICYmIGRhdGEuY2hvaWNlc1swXSkgfHwge307CmNvbnN0IG1lc3NhZ2UgPSBjaG9pY2UubWVzc2FnZSB8fCB7fTsKY29uc3QgY29udGVudCA9IChtZXNzYWdlLmNvbnRlbnQgfHwgJycpLnRyaW0oKTsKaWYgKCFjb250ZW50KSB7CiAgcHJvY2Vzcy5leGl0KDEpOwp9CmNvbnNvbGUubG9nKGNvbnRlbnQpOwpKUwogICAgICAgIHJldHVybgogICAgZmkKCiAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfUNhbm5vdCBwYXJzZSBBSSByZXNwb25zZSBiZWNhdXNlIG5laXRoZXIgcHl0aG9uMyBub3Igbm9kZSBpcyBhdmFpbGFibGUuJHtDX1JFU0VUfSIgPiYyCiAgICBlY2hvIC1lICIke0NfWUVMTE9XfVBsZWFzZSBpbnN0YWxsIHB5dGhvbjMgb3Igbm9kZSB0byB1c2UgbG9jYWwgQVBJIG1vZGUuJHtDX1JFU0VUfSIgPiYyCiAgICByZXR1cm4gMQp9CgpfZnVja19yZXF1ZXN0X2xvY2FsX21vZGVsKCkgewogICAgbG9jYWwgcHJvbXB0PSIkMSIKICAgIGxvY2FsIHN5c2luZm89IiQyIgogICAgbG9jYWwgY3VybF90aW1lb3V0PSIkMyIKCiAgICBsb2NhbCBhcGlfa2V5PSIke0ZVQ0tfT1BFTkFJX0FQSV9LRVk6LX0iCiAgICBpZiBbIC16ICIkYXBpX2tleSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9TG9jYWwgQVBJIGtleSBub3QgY29uZmlndXJlZC4gU2V0IEZVQ0tfT1BFTkFJX0FQSV9LRVkgaW4gfi8uZnVjay9jb25maWcuc2guJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbW9kZWw9IiR7RlVDS19PUEVOQUlfTU9ERUw6LWdwdC01LW5hbm99IgogICAgbG9jYWwgYXBpX2Jhc2U9IiR7RlVDS19PUEVOQUlfQVBJX0JBU0U6LWh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjF9IgogICAgYXBpX2Jhc2U9JHthcGlfYmFzZSUvfQogICAgbG9jYWwgYXBpX3VybD0iJGFwaV9iYXNlL2NoYXQvY29tcGxldGlvbnMiCgogICAgX2Z1Y2tfZGVidWcgImxvY2FsIGFwaSBiYXNlPSRhcGlfYmFzZSIKICAgIF9mdWNrX2RlYnVnICJsb2NhbCBtb2RlbD0kbW9kZWwiCgogICAgbG9jYWwgc3lzdGVtX3Byb21wdAogICAgc3lzdGVtX3Byb21wdD0kKF9mdWNrX2xvY2FsX3N5c3RlbV9wcm9tcHQgIiRzeXNpbmZvIikKCiAgICBsb2NhbCBlc2NhcGVkX3Byb21wdCBlc2NhcGVkX3N5c3RlbQogICAgZXNjYXBlZF9wcm9tcHQ9JChfZnVja19qc29uX2VzY2FwZSAiJHByb21wdCIpCiAgICBlc2NhcGVkX3N5c3RlbT0kKF9mdWNrX2pzb25fZXNjYXBlICIkc3lzdGVtX3Byb21wdCIpCiAgICBsb2NhbCBwYXlsb2FkCiAgICBwYXlsb2FkPSQocHJpbnRmICd7ICJtb2RlbCI6ICIlcyIsICJtZXNzYWdlcyI6IFsgeyJyb2xlIjoic3lzdGVtIiwiY29udGVudCI6IiVzIn0sIHsicm9sZSI6InVzZXIiLCJjb250ZW50IjoiJXMifSBdLCAibWF4X3Rva2VucyI6IDEwMjQsICJ0ZW1wZXJhdHVyZSI6IDAuMiB9JyBcCiAgICAgICAgIiRtb2RlbCIgIiRlc2NhcGVkX3N5c3RlbSIgIiRlc2NhcGVkX3Byb21wdCIpCgogICAgbG9jYWwgdG1wX2pzb24KICAgIHRtcF9qc29uPSQobWt0ZW1wKSB8fCByZXR1cm4gMQoKICAgIGlmICEgY3VybCAtZnNTIC0tbWF4LXRpbWUgIiRjdXJsX3RpbWVvdXQiICIkYXBpX3VybCIgXAogICAgICAgIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIFwKICAgICAgICAtSCAiQXV0aG9yaXphdGlvbjogQmVhcmVyICRhcGlfa2V5IiBcCiAgICAgICAgLWQgIiRwYXlsb2FkIiA+ICIkdG1wX2pzb24iOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1Mb2NhbCBBUEkgcmVxdWVzdCBmYWlsZWQuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgY2F0ICIkdG1wX2pzb24iID4mMgogICAgICAgIHJtIC1mICIkdG1wX2pzb24iCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgY29tbWFuZF9vdXRwdXQKICAgIGlmICEgY29tbWFuZF9vdXRwdXQ9JChfZnVja19leHRyYWN0X2NvbW1hbmRfZnJvbV9qc29uICIkdG1wX2pzb24iKTsgdGhlbgogICAgICAgIHJtIC1mICIkdG1wX2pzb24iCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1VbmFibGUgdG8gcGFyc2UgbG9jYWwgbW9kZWwgcmVzcG9uc2UuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgcm0gLWYgIiR0bXBfanNvbiIKICAgIHByaW50ZiAnJXNcbicgIiRjb21tYW5kX291dHB1dCIKfQoKX2Z1Y2tfcmVxdWVzdF93b3JrZXJfbW9kZWwoKSB7CiAgICBsb2NhbCBwcm9tcHQ9IiQxIgogICAgbG9jYWwgc3lzaW5mbz0iJDIiCiAgICBsb2NhbCBjdXJsX3RpbWVvdXQ9IiQzIgogICAgbG9jYWwgc3Bpbm5lcl9sYWJlbD0iJHs0Oi19IgoKICAgIGxvY2FsIGFkbWluX2tleT0iJHtGVUNLX0FETUlOX0tFWTotfSIKICAgIGxvY2FsIGFkbWluX3NlZ21lbnQ9IiIKICAgIGlmIFsgLW4gIiRhZG1pbl9rZXkiIF07IHRoZW4KICAgICAgICBhZG1pbl9zZWdtZW50PSQocHJpbnRmICcsICJhZG1pbktleSI6ICIlcyInICIkKCBfZnVja19qc29uX2VzY2FwZSAiJGFkbWluX2tleSIgKSIpCiAgICBmaQoKICAgIGxvY2FsIHBheWxvYWQKICAgIHBheWxvYWQ9JChwcmludGYgJ3sgInN5c2luZm8iOiAiJXMiLCAicHJvbXB0IjogIiVzIiVzIH0nIFwKICAgICAgICAiJCggX2Z1Y2tfanNvbl9lc2NhcGUgIiRzeXNpbmZvIiApIiBcCiAgICAgICAgIiQoIF9mdWNrX2pzb25fZXNjYXBlICIkcHJvbXB0IiApIiBcCiAgICAgICAgIiRhZG1pbl9zZWdtZW50IikKCiAgICBsb2NhbCBhcGlfdXJsPSIke0ZVQ0tfQVBJX0VORFBPSU5UOi0kREVGQVVMVF9BUElfRU5EUE9JTlR9IgoKICAgIF9mdWNrX2RlYnVnICJBUEkgVVJMOiAkYXBpX3VybCIKICAgIF9mdWNrX2RlYnVnICJQYXlsb2FkOiAkcGF5bG9hZCIKICAgIF9mdWNrX2RlYnVnICJUaW1lb3V0OiAkY3VybF90aW1lb3V0IgoKICAgIGxvY2FsIHRtcF9yZXNwb25zZSB0bXBfc3RhdHVzCiAgICB0bXBfcmVzcG9uc2U9JChta3RlbXApCiAgICB0bXBfc3RhdHVzPSQobWt0ZW1wKQoKICAgICgKICAgICAgICBjdXJsIC1zUyAtLW1heC10aW1lICIkY3VybF90aW1lb3V0IiAtWCBQT1NUICIkYXBpX3VybCIgXAogICAgICAgICAgICAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiBcCiAgICAgICAgICAgIC1kICIkcGF5bG9hZCIgLW8gIiR0bXBfcmVzcG9uc2UiIC13ICIle2h0dHBfY29kZX0iID4gIiR0bXBfc3RhdHVzIgogICAgKSAmCiAgICBsb2NhbCBwaWQ9JCEKCiAgICBpZiBbIC10IDIgXTsgdGhlbgogICAgICAgIF9mdWNrX3NwaW5uZXIgIiRwaWQiICIkc3Bpbm5lcl9sYWJlbCIgPiYyCiAgICBmaQoKICAgIGxvY2FsIGN1cmxfZXhpdD0wCiAgICBpZiAhIHdhaXQgIiRwaWQiOyB0aGVuCiAgICAgICAgY3VybF9leGl0PSQ/CiAgICBmaQoKICAgIGxvY2FsIGh0dHBfc3RhdHVzPSIiCiAgICBpZiBbIC1mICIkdG1wX3N0YXR1cyIgXTsgdGhlbgogICAgICAgIGh0dHBfc3RhdHVzPSQodHIgLWQgJ1xyXG4nIDwgIiR0bXBfc3RhdHVzIikKICAgICAgICBybSAtZiAiJHRtcF9zdGF0dXMiCiAgICBmaQoKICAgIGxvY2FsIHJlc3BvbnNlPSIiCiAgICBpZiBbIC1mICIkdG1wX3Jlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgcmVzcG9uc2U9JChjYXQgIiR0bXBfcmVzcG9uc2UiKQogICAgICAgIHJtIC1mICIkdG1wX3Jlc3BvbnNlIgogICAgZmkKCiAgICBpZiBbICRjdXJsX2V4aXQgLW5lIDAgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9RmFpbGVkIHRvIHJlYWNoIHRoZSBzaGFyZWQgV29ya2VyLiR7Q19SRVNFVH0iID4mMgogICAgICAgIGlmIFsgLW4gIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgICAgICBlY2hvIC1lICIke0NfRElNfSRyZXNwb25zZSR7Q19SRVNFVH0iID4mMgogICAgICAgIGZpCiAgICAgICAgcmV0dXJuICRjdXJsX2V4aXQKICAgIGZpCgogICAgaWYgWyAteiAiJGh0dHBfc3RhdHVzIiBdOyB0aGVuCiAgICAgICAgaHR0cF9zdGF0dXM9MAogICAgZmkKCiAgICBpZiBbICIkaHR0cF9zdGF0dXMiIC1lcSA0MjkgXSAmJiBwcmludGYgJyVzJyAiJHJlc3BvbnNlIiB8IGdyZXAgLXEgJ0RFTU9fTElNSVRfRVhDRUVERUQnOyB0aGVuCiAgICAgICAgbG9jYWwgbGltaXQKICAgICAgICBsaW1pdD0kKHByaW50ZiAnJXMnICIkcmVzcG9uc2UiIHwgc2VkIC1uICdzLy4qImxpbWl0IjpbWzpzcGFjZTpdXSpcKFswLTldXCtcKS4qL1wxL3AnIHwgaGVhZCAtbjEpCiAgICAgICAgbG9jYWwgcmVtYWluaW5nCiAgICAgICAgcmVtYWluaW5nPSQocHJpbnRmICclcycgIiRyZXNwb25zZSIgfCBzZWQgLW4gJ3MvLioicmVtYWluaW5nIjpbWzpzcGFjZTpdXSpcKFswLTldXCtcKS4qL1wxL3AnIHwgaGVhZCAtbjEpCiAgICAgICAgWyAteiAiJGxpbWl0IiBdICYmIGxpbWl0PTEwCiAgICAgICAgX2Z1Y2tfbm90aWZ5X2RlbW9fbGltaXQgIiRsaW1pdCIgIiRyZW1haW5pbmciCiAgICAgICAgcmV0dXJuIDIKICAgIGZpCgogICAgaWYgWyAiJGh0dHBfc3RhdHVzIiAtZ2UgNDAwIF0gfHwgWyAteiAiJHJlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1TaGFyZWQgV29ya2VyIHJldHVybmVkIEhUVFAgJGh0dHBfc3RhdHVzLiR7Q19SRVNFVH0iID4mMgogICAgICAgIGlmIFsgLW4gIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgICAgICBlY2hvIC1lICIke0NfRElNfSRyZXNwb25zZSR7Q19SRVNFVH0iID4mMgogICAgICAgIGZpCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgcHJpbnRmICclc1xuJyAiJHJlc3BvbnNlIgp9CgpfZnVja19ub3RpZnlfZGVtb19saW1pdCgpIHsKICAgIGxvY2FsIGRhaWx5X2xpbWl0PSIkezE6LTEwfSIKICAgIGxvY2FsIHJlbWFpbmluZz0iJHsyOi0wfSIKCiAgICBlY2hvIC1lICIkRlVDSyAke0NfWUVMTE9XfVNoYXJlZCBkZW1vIHF1b3RhIGV4aGF1c3RlZCAoJHtkYWlseV9saW1pdH0gY2FsbHMgcGVyIGRheSkuJHtDX1JFU0VUfSIgPiYyCiAgICBjYXNlICIkcmVtYWluaW5nIiBpbgogICAgICAgICcnfCpbITAtOV0qKSA7OwogICAgICAgICopCiAgICAgICAgICAgIGlmIFsgIiRyZW1haW5pbmciIC1ndCAwIF07IHRoZW4KICAgICAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19ESU19JHJlbWFpbmluZyBjYWxscyBsZWZ0IGZvciB0b2RheS4ke0NfUkVTRVR9IiA+JjIKICAgICAgICAgICAgZmkKICAgICAgICAgICAgOzsKICAgIGVzYWMKCiAgICBfZnVja19lbnN1cmVfY29uZmlnX2V4aXN0cwogICAgX2Z1Y2tfc2VjdXJlX2NvbmZpZ19maWxlCgogICAgZWNobyAtZSAiJHtDX0NZQU59U3dpdGNoIHRvIHlvdXIgb3duIGtleToke0NfUkVTRVR9IHJ1biAke0NfR1JFRU59ZnVjayBjb25maWcke0NfUkVTRVR9IGFuZCBzZXQgJHtDX0JPTER9RlVDS19PUEVOQUlfQVBJX0tFWSR7Q19SRVNFVH0gKHBsdXMgb3B0aW9uYWwgJHtDX0JPTER9RlVDS19PUEVOQUlfTU9ERUwke0NfUkVTRVR9LyR7Q19CT0xEfUZVQ0tfT1BFTkFJX0FQSV9CQVNFJHtDX1JFU0VUfSkuIiA+JjIKICAgIGVjaG8gLWUgIiR7Q19DWUFOfVRydXN0ZWQgbWFpbnRhaW5lciBvdmVycmlkZToke0NfUkVTRVR9IHNldCAke0NfQk9MRH1GVUNLX0FETUlOX0tFWSR7Q19SRVNFVH0gaWYgeW91IHdlcmUgaXNzdWVkIHRoZSB3b3JrZXIncyBBRE1JTl9BQ0NFU1NfS0VZIHRvIGJ5cGFzcyB0aGUgc2hhcmVkIHF1b3RhLiIgPiYyCiAgICBlY2hvIC1lICIke0NfQ1lBTn1Db25maWcgcGF0aDoke0NfUkVTRVR9ICR7Q19HUkVFTn0kQ09ORklHX0ZJTEUke0NfUkVTRVR9IiA+JjIKICAgIGlmIFsgLW4gIiR7RURJVE9SOi19IiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31IaW50OiR7Q19SRVNFVH0gJHtFRElUT1J9IFwiJENPTkZJR19GSUxFXCIiID4mMgogICAgZmkKICAgIGVjaG8gLWUgIiR7Q19ESU19U2VjdXJpdHk6JHtDX1JFU0VUfSB0aGUgZmlsZSBwZXJtaXNzaW9ucyBhcmUgbG9ja2VkIHRvIDYwMCBzbyB0aGUga2V5IHN0YXlzIGxvY2FsLiIgPiYyCn0KCiMgU2ltcGxlIGhlbHBlciB0byBwYXJzZSBib29sZWFuLWxpa2UgdmFsdWVzCl9mdWNrX3RydXRoeSgpIHsKICAgIGxvY2FsIHZhbHVlPSIkezE6LX0iCiAgICBsb2NhbCBub3JtYWxpemVkCiAgICBub3JtYWxpemVkPSQocHJpbnRmICclcycgIiR2YWx1ZSIgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKICAgIGNhc2UgIiRub3JtYWxpemVkIiBpbgogICAgICAgIDF8dHJ1ZXx5ZXN8eXxvbikKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgOzsKICAgICAgICAqKQogICAgICAgICAgICByZXR1cm4gMQogICAgICAgICAgICA7OwogICAgZXNhYwp9CgojIERlYnVnIGhlbHBlcgpfZnVja19kZWJ1ZygpIHsKICAgIGlmIF9mdWNrX3RydXRoeSAiJHtGVUNLX0RFQlVHOi0wfSI7IHRoZW4KICAgICAgICBlY2hvIC1lICIke0NfRElNfVtkZWJ1Z10gJCoke0NfUkVTRVR9IiA+JjIKICAgIGZpCn0KCiMgU3Bpbm5lciBhbmltYXRpb24KX2Z1Y2tfc3Bpbm5lcigpIHsKICAgIGxvY2FsIHBpZD0kMQogICAgbG9jYWwgcHJlZml4PSIkezI6LX0iCiAgICBsb2NhbCBkZWxheT0wLjEKICAgIGxvY2FsIC1hIGZyYW1lcz0oInwiICIvIiAiLSIgIlxcIikKICAgIGxvY2FsIGZyYW1lX2NvdW50PSR7I2ZyYW1lc1tAXX0KICAgIGxvY2FsIGZyYW1lX2lkeD0wCiAgICBsb2NhbCBoYXNfcHJlZml4PTAKICAgIGlmIFsgLW4gIiRwcmVmaXgiIF07IHRoZW4KICAgICAgICBoYXNfcHJlZml4PTEKICAgIGZpCiAgICAKICAgIHRwdXQgY2l2aXMgMj4vZGV2L251bGwgfHwgcHJpbnRmICJcMDMzWz8yNWwiCgogICAgd2hpbGUga2lsbCAtMCAiJHBpZCIgMj4vZGV2L251bGw7IGRvCiAgICAgICAgaWYgWyAiJGhhc19wcmVmaXgiIC1lcSAxIF07IHRoZW4KICAgICAgICAgICAgcHJpbnRmICJcciVzJXMiICIkcHJlZml4IiAiJHtmcmFtZXNbJGZyYW1lX2lkeF19IgogICAgICAgIGVsc2UKICAgICAgICAgICAgcHJpbnRmICIgJXMgIiAiJHtmcmFtZXNbJGZyYW1lX2lkeF19IgogICAgICAgICAgICBwcmludGYgIlxiXGJcYiIKICAgICAgICBmaQogICAgICAgIGZyYW1lX2lkeD0kKCggKGZyYW1lX2lkeCArIDEpICUgZnJhbWVfY291bnQgKSkKICAgICAgICBzbGVlcCAiJGRlbGF5IgogICAgZG9uZQoKICAgIGlmIFsgIiRoYXNfcHJlZml4IiAtZXEgMSBdOyB0aGVuCiAgICAgICAgcHJpbnRmICJcciVzIiAiJHByZWZpeCIKICAgICAgICB0cHV0IGVsIDI+L2Rldi9udWxsIHx8IHByaW50ZiAiXDAzM1tLIgogICAgZWxzZQogICAgICAgIHByaW50ZiAiICAgXGJcYlxiIgogICAgZmkKICAgIAogICAgdHB1dCBjbm9ybSAyPi9kZXYvbnVsbCB8fCBwcmludGYgIlwwMzNbPzI1aCIKfQoKIyBEZXRlY3RzIHBvdGVudGlhbGx5IGRhbmdlcm91cyBjb21tYW5kcyBhbmQgcHJpbnRzIGEgd2FybmluZwojIC0tLSBTZWN1cml0eSBEZXRlY3Rpb24gRW5naW5lIChQaGFzZSAyKSAtLS0KCiMgQmxvY2stbGV2ZWwgc2VjdXJpdHkgcnVsZXMgKGhpZ2hlc3Qgc2V2ZXJpdHkgLSBleGVjdXRpb24gZGVuaWVkKQojIEZvcm1hdDogJ3BhdHRlcm58fHxyZWFzb24nCiMgTm90ZTogTm90IHVzaW5nICdyZWFkb25seScgdG8gZW5zdXJlIGNvbXBhdGliaWxpdHkgd2l0aCBmdW5jdGlvbi1zY29wZWQgc291cmNpbmcKaWYgWyAteiAiJHtfRlVDS19TRUNVUklUWV9CTE9DS19SVUxFUyt4fSIgXSB8fCBbWyAkeyNfRlVDS19TRUNVUklUWV9CTE9DS19SVUxFU1tAXX0gLWVxIDAgXV0gMj4vZGV2L251bGw7IHRoZW4KICAgIF9GVUNLX1NFQ1VSSVRZX0JMT0NLX1JVTEVTPSgKICAgICAgICAnKF58WzsmfFs6c3BhY2U6XV0pcm1bWzpzcGFjZTpdXSstcmZbWzpzcGFjZTpdXSsvKFtbOnNwYWNlOl1dfCQpfHx8UmVjdXJzaXZlIGRlbGV0ZSB0YXJnZXRpbmcgcm9vdCBmaWxlc3lzdGVtJwogICAgICAgICdybVtbOnNwYWNlOl1dKy1yZltbOnNwYWNlOl1dKy9cKnx8fFJlY3Vyc2l2ZSBkZWxldGUgdXNpbmcgLyogdW5kZXIgcm9vdCcKICAgICAgICAncm1bWzpzcGFjZTpdXSstcmZbWzpzcGFjZTpdXSstLW5vLXByZXNlcnZlLXJvb3R8fHxybSAtLW5vLXByZXNlcnZlLXJvb3QgYWdhaW5zdCAvJwogICAgICAgICdybVtbOnNwYWNlOl1dKy1yZltbOnNwYWNlOl1dK1wuXCp8fHxSZWN1cnNpdmUgZGVsZXRlIHRhcmdldGluZyBoaWRkZW4vc3lzdGVtIGZpbGVzJwogICAgICAgICdcYmRkXGJbXiNcbl0qXGIob2Z8aWYpPS9kZXYvfHx8UmF3IGRpc2sgd3JpdGUgdmlhIGRkIHRhcmdldGluZyAvZGV2IGRldmljZXMnCiAgICAgICAgJ1xibWtmcyhcLlx3Kyk/XGJ8fHxGaWxlc3lzdGVtIGZvcm1hdCBjb21tYW5kIGRldGVjdGVkJwogICAgICAgICdcYmZkaXNrXGJ8XGJwYXJ0ZWRcYnxcYmZvcm1hdFxifFxid2lwZWZzXGJ8XGJzaHJlZFxifHx8UGFydGl0aW9uIG9yIGRpc2sgd2lwZSBjb21tYW5kIGRldGVjdGVkJwogICAgICAgICc6XChcKVtbOnNwYWNlOl1dKlx7W1s6c3BhY2U6XV0qOltbOnNwYWNlOl1dKlx8W1s6c3BhY2U6XV0qOltbOnNwYWNlOl1dKiZbWzpzcGFjZTpdXSpcfVtbOnNwYWNlOl1dKjtbWzpzcGFjZTpdXSo6fHx8Rm9yayBib21iIGZ1bmN0aW9uIGRldGVjdGVkJwogICAgKQpmaQoKIyBDaGFsbGVuZ2UtbGV2ZWwgc2VjdXJpdHkgcnVsZXMgKHJlcXVpcmVzIGV4cGxpY2l0IHVzZXIgY29uZmlybWF0aW9uKQojIEZvcm1hdDogJ3BhdHRlcm58fHxyZWFzb24nCiMgTm90ZTogTm90IHVzaW5nICdyZWFkb25seScgdG8gZW5zdXJlIGNvbXBhdGliaWxpdHkgd2l0aCBmdW5jdGlvbi1zY29wZWQgc291cmNpbmcKaWYgWyAteiAiJHtfRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfUlVMRVMreH0iIF0gfHwgW1sgJHsjX0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1JVTEVTW0BdfSAtZXEgMCBdXSAyPi9kZXYvbnVsbDsgdGhlbgogICAgX0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1JVTEVTPSgKICAgICAgICAnY3VybFtefF0qXHxccyooYmFzaHxzaCl8fHxSZW1vdGUgc2NyaXB0IGV4ZWN1dGlvbiB2aWEgY3VybCBwaXBlbGluZScKICAgICAgICAnd2dldFtefF0qXHxccyooYmFzaHxzaCl8fHxSZW1vdGUgc2NyaXB0IGV4ZWN1dGlvbiB2aWEgd2dldCBwaXBlbGluZScKICAgICAgICAnXGJzb3VyY2VccytodHRwcz86Ly98fHxTb3VyY2luZyBhIHJlbW90ZSBmaWxlIG92ZXIgSFRUUChTKScKICAgICAgICAnXGJldmFsXGJ8XGJleGVjXGJ8fHxFeHBsaWNpdCBldmFsL2V4ZWMgdXNhZ2UnCiAgICAgICAgJ1wkXChbXildKlwpfHx8Q29tbWFuZCBzdWJzdGl0dXRpb24gdXNpbmcgJCgpJwogICAgICAgICdgW15gXSpgfHx8Q29tbWFuZCBzdWJzdGl0dXRpb24gdXNpbmcgYmFja3RpY2tzJwogICAgICAgICdcYihzaHxiYXNofGVudilccystY1xifHx8TmVzdGVkIHNoZWxsIGludm9jYXRpb24gdGhyb3VnaCAtYycKICAgICAgICAnXGJweXRob25bMC05Ll0qXHMrLWNcYnx8fElubGluZSBpbnRlcnByZXRlciBleGVjdXRpb24gdmlhIC1jJwogICAgICAgICcoXnxbOyZ8WzpzcGFjZTpdXSkoY3B8bXZ8cm18Y2htb2R8Y2hvd258c2VkfHRlZXxjYXQpW147JnxdKi8oZXRjfGJvb3R8c3lzfHByb2N8ZGV2KVxifHx8T3BlcmF0aW9uIHRvdWNoZXMgY3JpdGljYWwgc3lzdGVtIHBhdGhzJwogICAgICAgICdcYnBlcmxccystZVxifHx8SW5saW5lIFBlcmwgZXhlY3V0aW9uIHZpYSAtZScKICAgICAgICAnXGJydWJ5XHMrLWVcYnx8fElubGluZSBSdWJ5IGV4ZWN1dGlvbiB2aWEgLWUnCiAgICAgICAgJ1xibm9kZVxzKy1lXGJ8fHxJbmxpbmUgTm9kZS5qcyBleGVjdXRpb24gdmlhIC1lJwogICAgICAgICdcYnBocFxzKy1yXGJ8fHxJbmxpbmUgUEhQIGV4ZWN1dGlvbiB2aWEgLXInCiAgICAgICAgJ2Jhc2U2NFtefF0qXHxccyooYmFzaHxzaHxldmFsKXx8fEJhc2U2NCBlbmNvZGVkIGNvbW1hbmQgZXhlY3V0aW9uJwogICAgICAgICdcYnhhcmdzXGIuKigtSXwtaXx7fSkuKlxiKHNofGJhc2h8cm18Y2htb2QpXGJ8fHxDb21tYW5kIGV4ZWN1dGlvbiB2aWEgeGFyZ3MnCiAgICAgICAgJ1xiZmluZFxiW158O10qLWV4ZWNcYnx8fENvbW1hbmQgZXhlY3V0aW9uIHZpYSBmaW5kIC1leGVjJwogICAgICAgICdcYihhd2t8Z2F3a3xuYXdrfG1hd2spXGJbXnw7XSpzeXN0ZW1ccypcKHx8fEluZGlyZWN0IGNvbW1hbmQgZXhlY3V0aW9uIHZpYSBhd2sgc3lzdGVtKCknCiAgICAgICAgJ1xicHJpbnRmXGIuKlxcXFx4WzAtOWEtZkEtRl18fHxQb3RlbnRpYWwgaGV4LWVuY29kZWQgY29tbWFuZCBpbmplY3Rpb24nCiAgICAgICAgJ1wkXHtbXn1dKiNcfXx8fFBhcmFtZXRlciBleHBhbnNpb24gdGhhdCBtYXkgYWx0ZXIgY29tbWFuZCcKICAgICAgICAnZWNob1xzK1tefF0qXHxccyooYmFzaHxzaHxldmFsKXx8fEVjaG8gcGlwZWxpbmUgdG8gc2hlbGwgZXhlY3V0aW9uJwogICAgKQpmaQoKIyBXYXJuLWxldmVsIHNlY3VyaXR5IHJ1bGVzICh3YXJuaW5nIG9ubHksIHVzZXIgY2FuIHByb2NlZWQpCiMgRm9ybWF0OiAncGF0dGVybnx8fHJlYXNvbicKIyBOb3RlOiBOb3QgdXNpbmcgJ3JlYWRvbmx5JyB0byBlbnN1cmUgY29tcGF0aWJpbGl0eSB3aXRoIGZ1bmN0aW9uLXNjb3BlZCBzb3VyY2luZwppZiBbIC16ICIke19GVUNLX1NFQ1VSSVRZX1dBUk5fUlVMRVMreH0iIF0gfHwgW1sgJHsjX0ZVQ0tfU0VDVVJJVFlfV0FSTl9SVUxFU1tAXX0gLWVxIDAgXV0gMj4vZGV2L251bGw7IHRoZW4KICAgIF9GVUNLX1NFQ1VSSVRZX1dBUk5fUlVMRVM9KAogICAgICAgICdzdWRvW1s6c3BhY2U6XV0rW147JnxdKnJtW1s6c3BhY2U6XV0rLXJmfHx8c3VkbyBybSAtcmYgZGV0ZWN0ZWQnCiAgICAgICAgJ3JtW1s6c3BhY2U6XV0rLXJmXGJ8fHxSZWN1cnNpdmUgZGVsZXRlIHJlcXVlc3QgZGV0ZWN0ZWQnCiAgICAgICAgJ2NobW9kW1s6c3BhY2U6XV0rLio3NzdcYnx8fFdvcmxkLXdyaXRhYmxlIHBlcm1pc3Npb24gY2hhbmdlIGRldGVjdGVkJwogICAgICAgICc+W1s6c3BhY2U6XV0qLyhldGMvKHBhc3N3ZHxzaGFkb3d8c3Vkb2Vycyl8ZGV2L3NkW2Etel0rKXx8fE91dHB1dCByZWRpcmVjdGlvbiBpbnRvIHNlbnNpdGl2ZSBzeXN0ZW0gZmlsZXMnCiAgICApCmZpCgojIEdldHMgdGhlIGN1cnJlbnQgc2VjdXJpdHkgbW9kZSBmcm9tIGNvbmZpZ3VyYXRpb24KIyBPdXRwdXRzOiAic3RyaWN0IiwgImJhbGFuY2VkIiwgb3IgIm9mZiIKX2Z1Y2tfc2VjdXJpdHlfbW9kZSgpIHsKICAgIGxvY2FsIG1vZGU9IiR7RlVDS19TRUNVUklUWV9NT0RFOi1iYWxhbmNlZH0iCiAgICBtb2RlPSQocHJpbnRmICclcycgIiRtb2RlIiB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQoKICAgIGNhc2UgIiRtb2RlIiBpbgogICAgICAgIHN0cmljdCkgcHJpbnRmICdzdHJpY3RcbicgOzsKICAgICAgICBvZmZ8ZGlzYWJsZWR8bm9uZSkgcHJpbnRmICdvZmZcbicgOzsKICAgICAgICBiYWxhbmNlZHxkZWZhdWx0fCIiKSBwcmludGYgJ2JhbGFuY2VkXG4nIDs7CiAgICAgICAgKikgcHJpbnRmICdiYWxhbmNlZFxuJyA7OwogICAgZXNhYwp9CgojIEdldHMgdGhlIGRlZmF1bHQgY2hhbGxlbmdlIHRleHQgZm9yIHNlY3VyaXR5IGNvbmZpcm1hdGlvbnMKIyBPdXRwdXRzOiBEZWZhdWx0IGNoYWxsZW5nZSBwaHJhc2UKX2Z1Y2tfc2VjdXJpdHlfZGVmYXVsdF9jaGFsbGVuZ2VfdGV4dCgpIHsKICAgIHByaW50ZiAnSSBhY2NlcHQgdGhlIHJpc2snCn0KCiMgQ2hlY2tzIGlmIGEgY29tbWFuZCBtYXRjaGVzIHRoZSBzZWN1cml0eSB3aGl0ZWxpc3QKIyBBcmd1bWVudHM6ICQxIC0gY29tbWFuZCB0byBjaGVjawojIFJldHVybnM6IDAgaWYgd2hpdGVsaXN0ZWQsIDEgb3RoZXJ3aXNlCl9mdWNrX3NlY3VyaXR5X2lzX3doaXRlbGlzdGVkKCkgewogICAgbG9jYWwgY29tbWFuZD0iJDEiCiAgICBsb2NhbCB3aGl0ZWxpc3Q9IiR7RlVDS19TRUNVUklUWV9XSElURUxJU1Q6LX0iCgogICAgaWYgWyAteiAiJHdoaXRlbGlzdCIgXTsgdGhlbgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIG5vcm1hbGl6ZWQgZW50cnkKICAgIG5vcm1hbGl6ZWQ9JChwcmludGYgJyVzJyAiJHdoaXRlbGlzdCIgfCB0ciAnLCcgJ1xuJykKCiAgICB3aGlsZSBJRlM9IHJlYWQgLXIgZW50cnk7IGRvCiAgICAgICAgZW50cnk9JChwcmludGYgJyVzJyAiJGVudHJ5IiB8IHNlZCAtZSAncy9eW1s6c3BhY2U6XV0qLy8nIC1lICdzL1tbOnNwYWNlOl1dKiQvLycpCiAgICAgICAgWyAteiAiJGVudHJ5IiBdICYmIGNvbnRpbnVlCgogICAgICAgIGlmIHByaW50ZiAnJXMnICIkY29tbWFuZCIgfCBncmVwIC1GcSAiJGVudHJ5IjsgdGhlbgogICAgICAgICAgICByZXR1cm4gMAogICAgICAgIGZpCiAgICBkb25lIDw8PCAiJG5vcm1hbGl6ZWQiCgogICAgcmV0dXJuIDEKfQoKIyBDb252ZXJ0cyBzZWN1cml0eSBsZXZlbCB0byBudW1lcmljIHZhbHVlIGZvciBjb21wYXJpc29uCiMgQXJndW1lbnRzOiAkMSAtIHNlY3VyaXR5IGxldmVsIChibG9jay9jaGFsbGVuZ2Uvd2Fybi9vaykKIyBPdXRwdXRzOiBOdW1lcmljIHZhbHVlICgzLzIvMS8wKQpfZnVja19zZWN1cml0eV9sZXZlbF92YWx1ZSgpIHsKICAgIGNhc2UgIiQxIiBpbgogICAgICAgIGJsb2NrKSBwcmludGYgJzNcbicgOzsKICAgICAgICBjaGFsbGVuZ2UpIHByaW50ZiAnMlxuJyA7OwogICAgICAgIHdhcm4pIHByaW50ZiAnMVxuJyA7OwogICAgICAgICopIHByaW50ZiAnMFxuJyA7OwogICAgZXNhYwp9CgojIFByb21vdGVzIHNlY3VyaXR5IGxldmVsIGlmIGNhbmRpZGF0ZSBpcyBtb3JlIHNldmVyZQojIEFyZ3VtZW50czogJDEgLSBjdXJyZW50IGxldmVsLCAkMiAtIGNhbmRpZGF0ZSBsZXZlbAojIE91dHB1dHM6IFRoZSBtb3JlIHNldmVyZSBsZXZlbApfZnVja19zZWN1cml0eV9wcm9tb3RlKCkgewogICAgbG9jYWwgY3VycmVudD0iJDEiCiAgICBsb2NhbCBjYW5kaWRhdGU9IiQyIgogICAgbG9jYWwgY3VycmVudF92YWwgY2FuZGlkYXRlX3ZhbAoKICAgIGN1cnJlbnRfdmFsPSQoX2Z1Y2tfc2VjdXJpdHlfbGV2ZWxfdmFsdWUgIiRjdXJyZW50IikKICAgIGNhbmRpZGF0ZV92YWw9JChfZnVja19zZWN1cml0eV9sZXZlbF92YWx1ZSAiJGNhbmRpZGF0ZSIpCgogICAgaWYgWyAiJGNhbmRpZGF0ZV92YWwiIC1ndCAiJGN1cnJlbnRfdmFsIiBdOyB0aGVuCiAgICAgICAgcHJpbnRmICclc1xuJyAiJGNhbmRpZGF0ZSIKICAgIGVsc2UKICAgICAgICBwcmludGYgJyVzXG4nICIkY3VycmVudCIKICAgIGZpCn0KCiMgQXBwbGllcyBzZWN1cml0eSBtb2RlIGFkanVzdG1lbnRzIHRvIHNldmVyaXR5IGxldmVsCiMgQXJndW1lbnRzOiAkMSAtIG1vZGUgKHN0cmljdC9iYWxhbmNlZC9vZmYpLCAkMiAtIHNldmVyaXR5IGxldmVsCiMgT3V0cHV0czogQWRqdXN0ZWQgc2V2ZXJpdHkgbGV2ZWwKX2Z1Y2tfc2VjdXJpdHlfYXBwbHlfbW9kZSgpIHsKICAgIGxvY2FsIG1vZGU9IiQxIgogICAgbG9jYWwgc2V2ZXJpdHk9IiQyIgoKICAgIGNhc2UgIiRtb2RlIiBpbgogICAgICAgIHN0cmljdCkKICAgICAgICAgICAgY2FzZSAiJHNldmVyaXR5IiBpbgogICAgICAgICAgICAgICAgd2Fybikgc2V2ZXJpdHk9ImNoYWxsZW5nZSIgOzsKICAgICAgICAgICAgICAgIGNoYWxsZW5nZSkgc2V2ZXJpdHk9ImJsb2NrIiA7OwogICAgICAgICAgICBlc2FjCiAgICAgICAgICAgIDs7CiAgICBlc2FjCgogICAgcHJpbnRmICclc1xuJyAiJHNldmVyaXR5Igp9CgojIE1hdGNoZXMgY29tbWFuZCBhZ2FpbnN0IGEgc2VjdXJpdHkgcnVsZSB0YWJsZQojIEFyZ3VtZW50czogJDEgLSBjb21tYW5kLCAkMiAtIHJ1bGUgdGFibGUgbmFtZQojIE91dHB1dHM6IFJlYXNvbiBzdHJpbmcgaWYgbWF0Y2hlZAojIFJldHVybnM6IDAgaWYgbWF0Y2hlZCwgMSBvdGhlcndpc2UKX2Z1Y2tfc2VjdXJpdHlfbWF0Y2hfcnVsZSgpIHsKICAgIGxvY2FsIGNvbW1hbmQ9IiQxIgogICAgbG9jYWwgdGFibGU9IiQyIgogICAgbG9jYWwgLWEgcnVsZXM9KCkKCiAgICBldmFsICJydWxlcz0oXCJcJHske3RhYmxlfVtAXX1cIikiCgogICAgbG9jYWwgcnVsZSBwYXR0ZXJuIHJlYXNvbgogICAgZm9yIHJ1bGUgaW4gIiR7cnVsZXNbQF19IjsgZG8KICAgICAgICBwYXR0ZXJuPSR7cnVsZSUlfHx8Kn0KICAgICAgICByZWFzb249JHtydWxlIyp8fHx9CiAgICAgICAgWyAteiAiJHBhdHRlcm4iIF0gJiYgY29udGludWUKCiAgICAgICAgaWYgcHJpbnRmICclcycgIiRjb21tYW5kIiB8IGdyZXAgLUVpcSAtLSAiJHBhdHRlcm4iOyB0aGVuCiAgICAgICAgICAgIHByaW50ZiAnJXNcbicgIiRyZWFzb24iCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgZmkKICAgIGRvbmUKCiAgICByZXR1cm4gMQp9CgojIERpc3BsYXlzIHdhcm5pbmcgbWVzc2FnZSBmb3IgcG90ZW50aWFsbHkgZGFuZ2Vyb3VzIGNvbW1hbmRzCiMgQXJndW1lbnRzOiAkMSAtIHJlYXNvbiBmb3Igd2FybmluZwpfZnVja19zZWN1cml0eV93YXJuX21lc3NhZ2UoKSB7CiAgICBsb2NhbCByZWFzb249IiQxIgogICAgZWNobyAtZSAiJHtDX1JFRF9CT0xEfeKaoO+4jyAgU0VDVVJJVFkgV0FSTklORzoke0NfUkVTRVR9ICR7cmVhc29ufSIgPiYyCiAgICBlY2hvIC1lICIke0NfWUVMTE9XfVJldmlldyB0aGUgY29tbWFuZCBtYW51YWxseSBvciBhZGQgYSB3aGl0ZWxpc3QgZW50cnkgaWYgeW91IGZ1bGx5IHRydXN0IGl0LiR7Q19SRVNFVH0iID4mMgp9CgojIERpc3BsYXlzIGJsb2NrIG1lc3NhZ2UgZm9yIHByb2hpYml0ZWQgY29tbWFuZHMKIyBBcmd1bWVudHM6ICQxIC0gcmVhc29uIGZvciBibG9ja2luZwpfZnVja19zZWN1cml0eV9ibG9ja19tZXNzYWdlKCkgewogICAgbG9jYWwgcmVhc29uPSIkMSIKICAgIGVjaG8gLWUgIiR7Q19SRURfQk9MRH3im5QgU0VDVVJJVFkgQkxPQ0s6JHtDX1JFU0VUfSAke3JlYXNvbn0iID4mMgogICAgZWNobyAtZSAiJHtDX1JFRH1FeGVjdXRpb24gZGVuaWVkLiBBZGp1c3QgRlVDS19TRUNVUklUWV9NT0RFIG9yIHdoaXRlbGlzdCB0aGUgY29tbWFuZCBpZiBhYnNvbHV0ZWx5IG5lY2Vzc2FyeS4ke0NfUkVTRVR9IiA+JjIKfQoKIyBEaXNwbGF5cyBjaGFsbGVuZ2UgbWVzc2FnZSBmb3IgaGlnaC1yaXNrIGNvbW1hbmRzCiMgQXJndW1lbnRzOiAkMSAtIHJlYXNvbiBmb3IgY2hhbGxlbmdlLCAkMiAtIHJlcXVpcmVkIHBocmFzZQpfZnVja19zZWN1cml0eV9jaGFsbGVuZ2VfbWVzc2FnZSgpIHsKICAgIGxvY2FsIHJlYXNvbj0iJDEiCiAgICBsb2NhbCBwaHJhc2U9IiQyIgogICAgZWNobyAtZSAiJHtDX1JFRF9CT0xEfeKaoO+4jyAgU0VDVVJJVFkgQ0hBTExFTkdFOiR7Q19SRVNFVH0gJHtyZWFzb259IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19DWUFOfVR5cGUgdGhlIGZvbGxvd2luZyBwaHJhc2UgdG8gY29udGludWU6JHtDX1JFU0VUfSIgPiYyCiAgICBlY2hvIC1lICIke0NfQk9MRH0ke3BocmFzZX0ke0NfUkVTRVR9IiA+JjIKfQoKIyBQcm9tcHRzIHVzZXIgdG8gZW50ZXIgdGhlIHJlcXVpcmVkIHBocmFzZSBmb3Igc2VjdXJpdHkgY2hhbGxlbmdlCiMgQXJndW1lbnRzOiAkMSAtIHJlcXVpcmVkIHBocmFzZQojIFJldHVybnM6IDAgaWYgcGhyYXNlIG1hdGNoZXMsIDEgb3RoZXJ3aXNlCl9mdWNrX3NlY3VyaXR5X3Byb21wdF9waHJhc2UoKSB7CiAgICBsb2NhbCBwaHJhc2U9IiQxIgogICAgbG9jYWwgaW5wdXQ9IiIKCiAgICBwcmludGYgIiViPiAlYiIgIiRDX0JPTEQiICIkQ19SRVNFVCIgPiYyCgogICAgaWYgWyAtciAvZGV2L3R0eSBdOyB0aGVuCiAgICAgICAgaWYgISBJRlM9IHJlYWQgLXIgaW5wdXQgPCAvZGV2L3R0eTsgdGhlbgogICAgICAgICAgICBwcmludGYgIlxuIiA+JjIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICBmaQogICAgZWxzZQogICAgICAgIGlmICEgSUZTPSByZWFkIC1yIGlucHV0OyB0aGVuCiAgICAgICAgICAgIHByaW50ZiAiXG4iID4mMgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgIGZpCiAgICBmaQoKICAgIHByaW50ZiAiXG4iID4mMgogICAgWyAiJGlucHV0IiA9ICIkcGhyYXNlIiBdCn0KCiMgSGFuZGxlcyBzZWN1cml0eSBkZWNpc2lvbiBiYXNlZCBvbiBzZXZlcml0eSBsZXZlbAojIEFyZ3VtZW50czogJDEgLSBzZXZlcml0eSBsZXZlbCwgJDIgLSByZWFzb24sICQzIC0gY29tbWFuZAojIFJldHVybnM6IDAgdG8gYWxsb3cgZXhlY3V0aW9uLCAxIHRvIGRlbnkKX2Z1Y2tfc2VjdXJpdHlfaGFuZGxlX2RlY2lzaW9uKCkgewogICAgbG9jYWwgc2V2ZXJpdHk9IiQxIgogICAgbG9jYWwgcmVhc29uPSIkMiIKICAgIGxvY2FsIGNvbW1hbmQ9IiQzIgoKICAgIGNhc2UgIiRzZXZlcml0eSIgaW4KICAgICAgICAiInxva3xvZmYpCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIDs7CiAgICAgICAgd2FybikKICAgICAgICAgICAgX2Z1Y2tfc2VjdXJpdHlfd2Fybl9tZXNzYWdlICIke3JlYXNvbjotUG90ZW50aWFsbHkgZGFuZ2Vyb3VzIGNvbW1hbmQgZGV0ZWN0ZWR9IgogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgICAgIGNoYWxsZW5nZSkKICAgICAgICAgICAgbG9jYWwgcGhyYXNlPSIke0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1RFWFQ6LSQoX2Z1Y2tfc2VjdXJpdHlfZGVmYXVsdF9jaGFsbGVuZ2VfdGV4dCl9IgogICAgICAgICAgICBfZnVja19zZWN1cml0eV9jaGFsbGVuZ2VfbWVzc2FnZSAiJHtyZWFzb246LUhpZ2gtcmlzayBjb21tYW5kIGRldGVjdGVkfSIgIiRwaHJhc2UiCgogICAgICAgICAgICBpZiBfZnVja19zZWN1cml0eV9wcm9tcHRfcGhyYXNlICIkcGhyYXNlIjsgdGhlbgogICAgICAgICAgICAgICAgZWNobyAtZSAiJHtDX0dSRUVOfVNlY3VyaXR5IGNoYWxsZW5nZSBhY2tub3dsZWRnZWQuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICBmaQoKICAgICAgICAgICAgZWNobyAtZSAiJHtDX1JFRH1TZWN1cml0eSBjaGFsbGVuZ2UgZmFpbGVkLiBDb21tYW5kIGFib3J0ZWQuJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgICAgIDs7CiAgICAgICAgYmxvY2spCiAgICAgICAgICAgIF9mdWNrX3NlY3VyaXR5X2Jsb2NrX21lc3NhZ2UgIiR7cmVhc29uOi1Db21tYW5kIGJsb2NrZWQgYnkgcG9saWN5fSIKICAgICAgICAgICAgcmV0dXJuIDEKICAgICAgICAgICAgOzsKICAgICAgICAqKQogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgZXNhYwp9CgojIEV2YWx1YXRlcyBjb21tYW5kIHNlY3VyaXR5IGFuZCByZXR1cm5zIHNldmVyaXR5IGxldmVsIHdpdGggcmVhc29uCiMgQXJndW1lbnRzOiAkMSAtIGNvbW1hbmQgdG8gZXZhbHVhdGUKIyBPdXRwdXRzOiAic2V2ZXJpdHl8cmVhc29uIiBzdHJpbmcKIyBSZXR1cm5zOiAwIGFsd2F5cyAocmVzdWx0IGlzIGluIG91dHB1dCkKX2Z1Y2tfc2VjdXJpdHlfZXZhbHVhdGVfY29tbWFuZCgpIHsKICAgIGxvY2FsIGNvbW1hbmQ9IiQxIgogICAgbG9jYWwgbW9kZSBzZXZlcml0eSByZWFzb24gbWF0Y2ggcHJvbW90ZWQgc3RydWN0dXJhbF9yZWFzb24KCiAgICBtb2RlPSQoX2Z1Y2tfc2VjdXJpdHlfbW9kZSkKCiAgICAjIFNlY3VyaXR5IGVuZ2luZSBkaXNhYmxlZAogICAgaWYgWyAiJG1vZGUiID0gIm9mZiIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnb2ZmfFNlY3VyaXR5IGVuZ2luZSBkaXNhYmxlZFxuJwogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgICMgQ2hlY2sgd2hpdGVsaXN0CiAgICBpZiBfZnVja19zZWN1cml0eV9pc193aGl0ZWxpc3RlZCAiJGNvbW1hbmQiOyB0aGVuCiAgICAgICAgcHJpbnRmICdva3xDb21tYW5kIG1hdGNoZWQgd2hpdGVsaXN0XG4nCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgc2V2ZXJpdHk9Im9rIgogICAgcmVhc29uPSIiCiAgICBtYXRjaD0iIgoKICAgICMgQ2hlY2sgYmxvY2sgcnVsZXMgKGhpZ2hlc3QgcHJpb3JpdHkpCiAgICBpZiBtYXRjaD0kKF9mdWNrX3NlY3VyaXR5X21hdGNoX3J1bGUgIiRjb21tYW5kIiAiX0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJibG9jayIKICAgICAgICByZWFzb249IiRtYXRjaCIKICAgIGZpCgogICAgIyBDaGVjayBjaGFsbGVuZ2UgcnVsZXMgKG1lZGl1bSBwcmlvcml0eSkKICAgIGlmIFsgIiRzZXZlcml0eSIgIT0gImJsb2NrIiBdICYmIG1hdGNoPSQoX2Z1Y2tfc2VjdXJpdHlfbWF0Y2hfcnVsZSAiJGNvbW1hbmQiICJfRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJjaGFsbGVuZ2UiCiAgICAgICAgcmVhc29uPSIkbWF0Y2giCiAgICBmaQoKICAgICMgQ2hlY2sgd2FybiBydWxlcyAobG93IHByaW9yaXR5KQogICAgaWYgWyAiJHNldmVyaXR5IiA9ICJvayIgXSAmJiBtYXRjaD0kKF9mdWNrX3NlY3VyaXR5X21hdGNoX3J1bGUgIiRjb21tYW5kIiAiX0ZVQ0tfU0VDVVJJVFlfV0FSTl9SVUxFUyIpOyB0aGVuCiAgICAgICAgc2V2ZXJpdHk9Indhcm4iCiAgICAgICAgcmVhc29uPSIkbWF0Y2giCiAgICBmaQoKICAgICMgQ2hlY2sgZm9yIGNvbW1hbmQgY2hhaW5pbmcvcGlwaW5nIChzdHJ1Y3R1cmFsIGFuYWx5c2lzKQogICAgaWYgcHJpbnRmICclcycgIiRjb21tYW5kIiB8IGdyZXAgLUVpcSAnKCYmfFx8XHx8O3xcfCknOyB0aGVuCiAgICAgICAgc3RydWN0dXJhbF9yZWFzb249IkNvbW1hbmQgY2hhaW5pbmcgb3IgcGlwaW5nIGRldGVjdGVkIgogICAgICAgIHByb21vdGVkPSQoX2Z1Y2tfc2VjdXJpdHlfcHJvbW90ZSAiJHNldmVyaXR5IiAid2FybiIpCgogICAgICAgIGlmIFsgIiRwcm9tb3RlZCIgIT0gIiRzZXZlcml0eSIgXTsgdGhlbgogICAgICAgICAgICBzZXZlcml0eT0iJHByb21vdGVkIgogICAgICAgICAgICByZWFzb249IiRzdHJ1Y3R1cmFsX3JlYXNvbiIKICAgICAgICBlbGlmIFsgLXogIiRyZWFzb24iIF07IHRoZW4KICAgICAgICAgICAgcmVhc29uPSIkc3RydWN0dXJhbF9yZWFzb24iCiAgICAgICAgZmkKICAgIGZpCgogICAgIyBBcHBseSBzZWN1cml0eSBtb2RlIGFkanVzdG1lbnRzCiAgICBzZXZlcml0eT0kKF9mdWNrX3NlY3VyaXR5X2FwcGx5X21vZGUgIiRtb2RlIiAiJHNldmVyaXR5IikKCiAgICBwcmludGYgJyVzfCVzXG4nICIkc2V2ZXJpdHkiICIke3JlYXNvbjotU2FmZSBleGVjdXRpb259Igp9CgojIExlZ2FjeSBmdW5jdGlvbiBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eQojIEFyZ3VtZW50czogJDEgLSBjb21tYW5kIHRvIGNoZWNrCiMgT3V0cHV0czogInNldmVyaXR5fHJlYXNvbiIgc3RyaW5nCl9mdWNrX2RldGVjdF9kYW5nZXJvdXNfY29tbWFuZCgpIHsKICAgIF9mdWNrX3NlY3VyaXR5X2V2YWx1YXRlX2NvbW1hbmQgIiQxIgp9CgoKIyBFbnN1cmUgYSBjb25maWcgZmlsZSBleGlzdHMgdG8gaGVscCB1c2VycyB0d2VhayB0aGUgYmVoYXZpb3VyCl9mdWNrX3NlY3VyZV9jb25maWdfZmlsZSgpIHsKICAgIGlmIFsgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNobW9kIDYwMCAiJENPTkZJR19GSUxFIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICBmaQp9CgpfZnVja19hcHBlbmRfY29uZmlnX2hpbnQoKSB7CiAgICBsb2NhbCBrZXk9IiQxIgogICAgbG9jYWwgY29tbWVudD0iJDIiCiAgICBsb2NhbCBzYW1wbGU9IiQzIgogICAgbG9jYWwgcXVvdGVkPSIkezQ6LTF9IgogICAgWyAtZiAiJENPTkZJR19GSUxFIiBdIHx8IHJldHVybgogICAgaWYgZ3JlcCAtRXEgIl5cXHMqIz9cXHMqZXhwb3J0XFxzKyRrZXkiICIkQ09ORklHX0ZJTEUiOyB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIGxvY2FsIGFzc2lnbm1lbnQKICAgIGlmIFsgIiRxdW90ZWQiID0gIjEiIF07IHRoZW4KICAgICAgICBhc3NpZ25tZW50PSIjIGV4cG9ydCAka2V5PVwiJHNhbXBsZVwiIgogICAgZWxzZQogICAgICAgIGFzc2lnbm1lbnQ9IiMgZXhwb3J0ICRrZXk9JHNhbXBsZSIKICAgIGZpCgogICAgewogICAgICAgIHByaW50ZiAnXG4nCiAgICAgICAgcHJpbnRmICcjICVzXG4nICIkY29tbWVudCIKICAgICAgICBwcmludGYgJyVzXG4nICIkYXNzaWdubWVudCIKICAgIH0gPj4gIiRDT05GSUdfRklMRSIKfQoKX2Z1Y2tfc2VlZF9jb25maWdfcGxhY2Vob2xkZXJzKCkgewogICAgWyAtZiAiJENPTkZJR19GSUxFIiBdIHx8IHJldHVybgogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX09QRU5BSV9BUElfS0VZIiAiTG9jYWwgT3BlbkFJLWNvbXBhdGlibGUgQVBJIGtleSAocmVjb21tZW5kZWQpIiAnc2stLi4uJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FETUlOX0tFWSIgIk9wdGlvbmFsOiBhZG1pbiBieXBhc3Mga2V5IGZvciB0cnVzdGVkIG1haW50YWluZXJzIiAnYWRtLS4uLicKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19PUEVOQUlfTU9ERUwiICJPcHRpb25hbDogb3ZlcnJpZGUgbW9kZWwgd2hlbiB1c2luZyB5b3VyIG93biBrZXkiICdncHQtNG8tbWluaScKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19PUEVOQUlfQVBJX0JBU0UiICJPcHRpb25hbDogb3ZlcnJpZGUgQVBJIGJhc2UiICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FMSUFTIiAiQWRkIGFuIGV4dHJhIGFsaWFzIGJlc2lkZXMgdGhlIGRlZmF1bHQgJ2Z1Y2snIiAncGxzJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FVVE9fRVhFQyIgIlNraXAgY29uZmlybWF0aW9uIHByb21wdHMgKHVzZSB3aXRoIGNhdXRpb24hKSIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfVElNRU9VVCIgIk92ZXJyaWRlIGN1cmwgdGltZW91dCAoc2Vjb25kcykiICczMCcgMAogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0RFQlVHIiAiRW5hYmxlIHZlcmJvc2UgZGVidWcgbG9ncyIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTIiAiRGlzYWJsZSB0aGUgYnVpbHQtaW4gJ2Z1Y2snIGFsaWFzIiAnZmFsc2UnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9NT0RFIiAiU2VjdXJpdHkgZW5naW5lIG1vZGU6IHN0cmljdHxiYWxhbmNlZHxvZmYiICdiYWxhbmNlZCcKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9XSElURUxJU1QiICJDb21tYS9uZXdsaW5lIHNlcGFyYXRlZCBjb21tYW5kIHBhdHRlcm5zIHRvIGJ5cGFzcyBzZWN1cml0eSBjaGVja3MiICcnCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1RFWFQiICJQaHJhc2UgcmVxdWlyZWQgZm9yIGhpZ2gtcmlzayBjb21tYW5kIGNvbmZpcm1hdGlvbiIgJ0kgYWNjZXB0IHRoZSByaXNrJwp9CgpfZnVja19lbnN1cmVfY29uZmlnX2V4aXN0cygpIHsKICAgIGlmIFsgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIF9mdWNrX3NlZWRfY29uZmlnX3BsYWNlaG9sZGVycwogICAgICAgIF9mdWNrX3NlY3VyZV9jb25maWdfZmlsZQogICAgICAgIHJldHVybgogICAgZmkKCiAgICBta2RpciAtcCAiJChkaXJuYW1lICIkQ09ORklHX0ZJTEUiKSIKICAgIGNhdCA8PCdDRkcnID4gIiRDT05GSUdfRklMRSIKIyBmdWNraXRzIGNvbmZpZ3VyYXRpb24KIyBUb2dnbGUgdGhlIGV4cG9ydHMgYmVsb3cgdG8gY3VzdG9taXNlIHlvdXIgZXhwZXJpZW5jZS4KCiMgQ3VzdG9tIEFQSSBlbmRwb2ludCB0aGF0IHBvaW50cyB0byB5b3VyIHNlbGYtaG9zdGVkIHdvcmtlcgojIGV4cG9ydCBGVUNLX0FQSV9FTkRQT0lOVD0iaHR0cHM6Ly95b3VyLWRvbWFpbi53b3JrZXJzLmRldi8iCgojIExvY2FsIE9wZW5BSS1jb21wYXRpYmxlIEFQSSBrZXkgKHJlY29tbWVuZGVkKQojIGV4cG9ydCBGVUNLX09QRU5BSV9BUElfS0VZPSJzay0uLi4iCgojIE9wdGlvbmFsOiBhZG1pbiBieXBhc3Mga2V5IGZvciB0cnVzdGVkIG1haW50YWluZXJzCiMgZXhwb3J0IEZVQ0tfQURNSU5fS0VZPSJhZG0tLi4uIgoKIyBPcHRpb25hbDogb3ZlcnJpZGUgbW9kZWwvYmFzZSB3aGVuIHVzaW5nIHlvdXIgb3duIGtleQojIGV4cG9ydCBGVUNLX09QRU5BSV9NT0RFTD0iZ3B0LTRvLW1pbmkiCiMgZXhwb3J0IEZVQ0tfT1BFTkFJX0FQSV9CQVNFPSJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxIgoKIyBBZGQgYW4gZXh0cmEgYWxpYXMgYmVzaWRlcyB0aGUgZGVmYXVsdCAnZnVjaycKIyBleHBvcnQgRlVDS19BTElBUz0icGxzIgoKIyBTa2lwIGNvbmZpcm1hdGlvbiBwcm9tcHRzICh1c2Ugd2l0aCBjYXV0aW9uISkKIyBleHBvcnQgRlVDS19BVVRPX0VYRUM9ZmFsc2UKCiMgT3ZlcnJpZGUgY3VybCB0aW1lb3V0IChzZWNvbmRzKQojIGV4cG9ydCBGVUNLX1RJTUVPVVQ9MzAKCiMgRW5hYmxlIHZlcmJvc2UgZGVidWcgbG9ncwojIGV4cG9ydCBGVUNLX0RFQlVHPWZhbHNlCgojIERpc2FibGUgdGhlIGJ1aWx0LWluICdmdWNrJyBhbGlhcwojIGV4cG9ydCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUz1mYWxzZQpDRkcKCiAgICBfZnVja19zZWVkX2NvbmZpZ19wbGFjZWhvbGRlcnMKICAgIF9mdWNrX3NlY3VyZV9jb25maWdfZmlsZQp9CgpfZnVja19zaG93X2NvbmZpZ19oZWxwKCkgewogICAgX2Z1Y2tfZW5zdXJlX2NvbmZpZ19leGlzdHMKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d9Q29uZmlndXJhdGlvbiBmaWxlOiR7Q19SRVNFVH0gJHtDX0NZQU59JENPTkZJR19GSUxFJHtDX1JFU0VUfSIKICAgIGlmIFsgLW4gIiR7RURJVE9SOi19IiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31FZGl0IHdpdGg6JHtDX1JFU0VUfSAke0NfQ1lBTn0ke0VESVRPUn0gXCIkQ09ORklHX0ZJTEVcIiR7Q19SRVNFVH0iCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31PcGVuIHRoaXMgZmlsZSBpbiB5b3VyIGZhdm91cml0ZSBlZGl0b3IgdG8gY3VzdG9taXNlIGZ1Y2tpdHMuJHtDX1JFU0VUfSIKICAgIGZpCiAgICBlY2hvIC1lICIke0NfQ1lBTn1BdmFpbGFibGUgdG9nZ2xlczoke0NfUkVTRVR9IEZVQ0tfQVBJX0VORFBPSU5ULCBGVUNLX09QRU5BSV9BUElfS0VZLCBGVUNLX0FETUlOX0tFWSwgRlVDS19PUEVOQUlfTU9ERUwsIEZVQ0tfT1BFTkFJX0FQSV9CQVNFLCBGVUNLX0FMSUFTLCBGVUNLX0FVVE9fRVhFQywgRlVDS19USU1FT1VULCBGVUNLX0RFQlVHLCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUyIKICAgIGVjaG8gLWUgIiR7Q19ESU19UHJvIHRpcDoke0NfUkVTRVR9IHdlIGxvY2sgJHtDT05GSUdfRklMRX0gdG8gY2htb2QgNjAwIHNvIHlvdXIgQVBJIGtleSBzdGF5cyBsb2NhbC4iCn0KCiMgVW5pbnN0YWxscyB0aGUgc2NyaXB0Cl91bmluc3RhbGxfc2NyaXB0KCkgewogICAgZWNobyAtZSAiJEZVQ0sgJHtDX1lFTExPV31TbyB5b3UncmUga2lja2luZyBtZSBvdXQ/IEZpbmUuJHtDX1JFU0VUfSIKCiAgICAjIEZpbmQgdGhlIHByb2ZpbGUgZmlsZQogICAgbG9jYWwgcHJvZmlsZV9maWxlCiAgICBwcm9maWxlX2ZpbGU9JChfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKQogICAgbG9jYWwgc291cmNlX2xpbmU9InNvdXJjZSAkTUFJTl9TSCIKCiAgICBpZiBbICIkcHJvZmlsZV9maWxlIiAhPSAidW5rbm93bl9wcm9maWxlIiBdICYmIFsgLWYgIiRwcm9maWxlX2ZpbGUiIF07IHRoZW4KICAgICAgICBpZiBncmVwIC1xRiAiJHNvdXJjZV9saW5lIiAiJHByb2ZpbGVfZmlsZSI7IHRoZW4KICAgICAgICAgICAgIyBVc2Ugc2VkIHRvIHJlbW92ZSB0aGUgbGluZXMuIENyZWF0ZSBhIGJhY2t1cC4KICAgICAgICAgICAgaWYgc2VkIC0tdmVyc2lvbiA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICAgICAgICAgICMgR05VIHNlZCAoTGludXgpCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICJcfCRzb3VyY2VfbGluZVx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICJcfCMgQWRkZWQgYnkgZnVja2l0cyBpbnN0YWxsZXJcfGQiICIkcHJvZmlsZV9maWxlIgogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAjIEJTRC9tYWNPUyBzZWQgcmVxdWlyZXMgYXJndW1lbnQgbGV0dGVyIGFmdGVyIC1pCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICIiIC1lICJcfCRzb3VyY2VfbGluZVx8ZCIgIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgICAgICAgICBzZWQgLWkuYmFrICIiIC1lICJcfCMgQWRkZWQgYnkgZnVja2l0cyBpbnN0YWxsZXJcfGQiICIkcHJvZmlsZV9maWxlIgogICAgICAgICAgICBmaQogICAgICAgIGZpCiAgICBlbHNlCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV31Db3VsZCBub3QgZmluZCBhIHNoZWxsIHByb2ZpbGUgZmlsZSB0byBtb2RpZnkuIFlvdXIgcHJvYmxlbSBub3cuJHtDX1JFU0VUfSIKICAgIGZpCgogICAgaWYgWyAtZCAiJElOU1RBTExfRElSIiBdOyB0aGVuCiAgICAgICAgcm0gLXJmICIkSU5TVEFMTF9ESVIiCiAgICBmaQoKICAgIGVjaG8gLWUgIiRGVUNLICR7Q19HUkVFTn1JJ20gZ29uZS4gRG9uJ3QgY29tZSBjcnlpbmcgYmFjay4ke0NfUkVTRVR9IgogICAgZWNobyAtZSAiJHtDX0NZQU59Tm93IHJlc3RhcnQgeW91ciBkYW1uIHNoZWxsLiR7Q19SRVNFVH0iCn0KCiMgVGhlIG1haW4gZnVuY3Rpb24gdGhhdCBjb250YWN0cyB0aGUgQVBJCiMgVGFrZXMgPjAgYXJndW1lbnRzIGFzIHRoZSBwcm9tcHQKX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQoKSB7CiAgICAjIElmIHRoZSB1c2VyIHR5cGVzICpvbmx5KiAiZnVjayB1bmluc3RhbGwiCiAgICBpZiBbICIkMSIgPSAidW5pbnN0YWxsIiBdICYmIFsgIiQjIiAtZXEgMSBdOyB0aGVuCiAgICAgICAgX3VuaW5zdGFsbF9zY3JpcHQKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICAjIElmIHRoZSB1c2VyIHR5cGVzICJmdWNrIGNvbmZpZyIKICAgIGlmIFsgIiQxIiA9ICJjb25maWciIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfZnVja19zaG93X2NvbmZpZ19oZWxwCiAgICAgICAgcmV0dXJuIDAKICAgIGZpCgogICAgaWYgISBjb21tYW5kIC12IGN1cmwgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH0nZnVjaycgY29tbWFuZCBuZWVkcyAnY3VybCcuIFBsZWFzZSBpbnN0YWxsIGl0LiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGlmIFsgIiQjIiAtZXEgMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1Zb3UgZm9yZ290IHRvIGFzayBtZSB3aGF0IHRvIGRvLiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIHByb21wdD0iJCoiCiAgICBsb2NhbCBhdXRvX21vZGU9IiR7RlVDS19BVVRPX0VYRUM6LTB9IgogICAgbG9jYWwgY3VybF90aW1lb3V0PSIke0ZVQ0tfVElNRU9VVDotMzB9IgogICAgbG9jYWwgc3lzaW5mb19zdHJpbmcKICAgIHN5c2luZm9fc3RyaW5nPSQoX2Z1Y2tfY29sbGVjdF9zeXNpbmZvX3N0cmluZykKCiAgICBsb2NhbCByZXNwb25zZT0iIgogICAgbG9jYWwgZXhpdF9jb2RlPTAKICAgIGlmIF9mdWNrX3Nob3VsZF91c2VfbG9jYWxfYXBpOyB0aGVuCiAgICAgICAgZWNobyAtbmUgIiR7Q19ZRUxMT1d9VXNpbmcgeW91ciBsb2NhbCBBUEkga2V5Li4uJHtDX1JFU0VUfSAiCiAgICAgICAgcmVzcG9uc2U9JChfZnVja19yZXF1ZXN0X2xvY2FsX21vZGVsICIkcHJvbXB0IiAiJHN5c2luZm9fc3RyaW5nIiAiJGN1cmxfdGltZW91dCIpCiAgICAgICAgZXhpdF9jb2RlPSQ/CiAgICBlbHNlCiAgICAgICAgbG9jYWwgc3Bpbm5lcl9sYWJlbD0iVGhpbmtpbmcuLi4gIgogICAgICAgIHByaW50ZiAnJXMnICIkc3Bpbm5lcl9sYWJlbCIKICAgICAgICByZXNwb25zZT0kKF9mdWNrX3JlcXVlc3Rfd29ya2VyX21vZGVsICIkcHJvbXB0IiAiJHN5c2luZm9fc3RyaW5nIiAiJGN1cmxfdGltZW91dCIgIiRzcGlubmVyX2xhYmVsIikKICAgICAgICBleGl0X2NvZGU9JD8KICAgIGZpCgogICAgZWNobyAiIgoKICAgIGlmIFsgJGV4aXRfY29kZSAtbmUgMCBdIHx8IFsgLXogIiRyZXNwb25zZSIgXTsgdGhlbgogICAgICAgIHJldHVybiAkZXhpdF9jb2RlCiAgICBmaQoKICAgIGVjaG8gLWUgIiR7Q19DWUFOfUhlcmUgaXMgd2hhdCBJIGNhbWUgdXAgd2l0aDoke0NfUkVTRVR9IgogICAgZWNobyAtZSAiJHtDX0RJTX0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJHtDX1JFU0VUfSIKICAgIHByaW50ZiAnJXNcbicgIiRyZXNwb25zZSIKICAgIGVjaG8gLWUgIiR7Q19ESU19LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSR7Q19SRVNFVH0iCgogICAgIyBTZWN1cml0eSBjaGVjayBmb3IgZGFuZ2Vyb3VzIGNvbW1hbmRzCiAgICBsb2NhbCBzZWN1cml0eV9yZXN1bHQgc2VjdXJpdHlfbGV2ZWwgc2VjdXJpdHlfcmVhc29uCiAgICBzZWN1cml0eV9yZXN1bHQ9JChfZnVja19kZXRlY3RfZGFuZ2Vyb3VzX2NvbW1hbmQgIiRyZXNwb25zZSIpCiAgICBzZWN1cml0eV9sZXZlbD0ke3NlY3VyaXR5X3Jlc3VsdCUlfCp9CiAgICBzZWN1cml0eV9yZWFzb249JHtzZWN1cml0eV9yZXN1bHQjKnx9CgogICAgIyBIYW5kbGUgc2VjdXJpdHkgZGVjaXNpb24gYmFzZWQgb24gc2V2ZXJpdHkKICAgIGlmICEgX2Z1Y2tfc2VjdXJpdHlfaGFuZGxlX2RlY2lzaW9uICIkc2VjdXJpdHlfbGV2ZWwiICIkc2VjdXJpdHlfcmVhc29uIiAiJHJlc3BvbnNlIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19SRUR94p2MIENvbW1hbmQgYWJvcnRlZCBkdWUgdG8gc2VjdXJpdHkgcG9saWN5LiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIHNob3VsZF9leGVjPWZhbHNlCgogICAgaWYgX2Z1Y2tfdHJ1dGh5ICIkYXV0b19tb2RlIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d94pqhIEF1dG8tZXhlYyBlbmFibGVkLiBSdW5uaW5nLi4uJHtDX1JFU0VUfSIKICAgICAgICBzaG91bGRfZXhlYz10cnVlCiAgICBlbHNlCiAgICAgICAgIyBJbnRlcmFjdGl2ZSBjb25maXJtYXRpb24KICAgICAgICB3aGlsZSB0cnVlOyBkbwogICAgICAgICAgICBwcmludGYgIiR7Q19CT0xEfUV4ZWN1dGU/IFtZL25dICR7Q19SRVNFVH0iCiAgICAgICAgICAgIGxvY2FsIGNvbmZpcm1hdGlvbiBub3JtYWxpemVkCiAgICAgICAgICAgIGlmIFsgLXIgL2Rldi90dHkgXTsgdGhlbgogICAgICAgICAgICAgICAgSUZTPSByZWFkIC1yIGNvbmZpcm1hdGlvbiA8IC9kZXYvdHR5CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICMgRmFsbGJhY2sgZm9yIG5vIFRUWQogICAgICAgICAgICAgICAgSUZTPSByZWFkIC1yIGNvbmZpcm1hdGlvbgogICAgICAgICAgICBmaQoKICAgICAgICAgICAgY29uZmlybWF0aW9uPSQocHJpbnRmICclcycgIiR7Y29uZmlybWF0aW9uOi19IiB8IHRyIC1kICcgXHRccicpCiAgICAgICAgICAgIG5vcm1hbGl6ZWQ9JChwcmludGYgJyVzJyAiJGNvbmZpcm1hdGlvbiIgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKCiAgICAgICAgICAgIGNhc2UgIiRub3JtYWxpemVkIiBpbgogICAgICAgICAgICAgICAgIiJ8InkifCJ5ZXMiKQogICAgICAgICAgICAgICAgICAgIHNob3VsZF9leGVjPXRydWUKICAgICAgICAgICAgICAgICAgICBlY2hvIC1lICIke0NfR1JFRU594pyFIEV4ZWN1dGluZy4uLiR7Q19SRVNFVH0iCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgIm4ifCJubyIpCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkX2V4ZWM9ZmFsc2UKICAgICAgICAgICAgICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfeKdjCBBYm9ydGVkLiR7Q19SRVNFVH0iID4mMgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICopCiAgICAgICAgICAgICAgICAgICAgIyBMb29wIGFnYWluCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgZXNhYwogICAgICAgIGRvbmUKICAgIGZpCgogICAgaWYgWyAiJHNob3VsZF9leGVjIiA9ICJ0cnVlIiBdOyB0aGVuCiAgICAgICAgZXZhbCAiJHJlc3BvbnNlIgogICAgICAgIGxvY2FsIGV4aXRfY29kZT0kPwogICAgICAgIGlmIFsgJGV4aXRfY29kZSAtbmUgMCBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9Q29tbWFuZCBmYWlsZWQgd2l0aCBleGl0IGNvZGUgJGV4aXRfY29kZS4ke0NfUkVTRVR9IiA+JjIKICAgICAgICBmaQogICAgICAgIHJldHVybiAkZXhpdF9jb2RlCiAgICBlbHNlCiAgICAgICAgIyBUaGUgJ0Fib3J0ZWQuJyBtZXNzYWdlIGlzIG5vdyBwcmludGVkIHdpdGhpbiB0aGUgbG9vcCwKICAgICAgICAjIHNvIHdlIGp1c3QgcmV0dXJuIDEgaGVyZSBpZiBzaG91bGRfZXhlYyBpcyBmYWxzZS4KICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyBEZWZpbmUgdGhlIGFsaWFzIGZvciBpbnRlcmFjdGl2ZSB1c2UgKHN1cHBvcnRzIGN1c3RvbSBhbGlhc2VzKQpfZnVja19kZWZpbmVfYWxpYXNlcygpIHsKICAgIGxvY2FsIGRlZmF1bHRfYWxpYXM9ImZ1Y2siCgogICAgaWYgISBfZnVja190cnV0aHkgIiR7RlVDS19ESVNBQkxFX0RFRkFVTFRfQUxJQVM6LTB9IjsgdGhlbgogICAgICAgIGFsaWFzICIkZGVmYXVsdF9hbGlhcyI9J19mdWNrX2V4ZWN1dGVfcHJvbXB0JwogICAgZmkKCiAgICBpZiBbIC1uICIke0ZVQ0tfQUxJQVM6LX0iIF0gJiYgWyAiJEZVQ0tfQUxJQVMiICE9ICIkZGVmYXVsdF9hbGlhcyIgXTsgdGhlbgogICAgICAgIGFsaWFzICIkRlVDS19BTElBUyI9J19mdWNrX2V4ZWN1dGVfcHJvbXB0JwogICAgZmkKfQoKX2Z1Y2tfZGVmaW5lX2FsaWFzZXMKCiMgLS0tIEVuZCBDb3JlIExvZ2ljIC0tLQpFT0YKCiMgLS0tIEVuZCBvZiBDb3JlIExvZ2ljIEhlcmVkb2MgLS0tCgojIEhlbHBlciB0byBtYXRlcmlhbGl6ZSB0aGUgZW1iZWRkZWQgY29yZSBsb2dpYyBpbnRvIGEgZmlsZSAodXNlZCBmb3IgaW5zdGFsbC90ZW1wIGV4ZWN1dGlvbikKX2Z1Y2tfd3JpdGVfY29yZSgpIHsKICAgIGxvY2FsIHRhcmdldD0iJDEiCiAgICBwcmludGYgJyVzXG4nICIkQ09SRV9MT0dJQyIgPiAiJHRhcmdldCIKfQoKIyBIZWxwZXIgdG8gc291cmNlIHRoZSBjb3JlIGxvZ2ljIGludG8gdGhlIGN1cnJlbnQgc2hlbGwKX2Z1Y2tfc291cmNlX2NvcmUoKSB7CiAgIGxvY2FsIHRtcF9jb3JlCiAgIHRtcF9jb3JlPSQobWt0ZW1wKQogICBfZnVja193cml0ZV9jb3JlICIkdG1wX2NvcmUiCiAgICMgc2hlbGxjaGVjayBkaXNhYmxlPVNDMTA5MAogICBzb3VyY2UgIiR0bXBfY29yZSIKICAgcm0gLWYgIiR0bXBfY29yZSIKfQoKCiMgLS0tIEluc3RhbGxlciBGdW5jdGlvbnMgKFJ1biBieSB0aGUgb3V0ZXIgc2NyaXB0KSAtLS0KCiMgSGVscGVyIHRvIGZpbmQgdGhlIHVzZXIncyBzaGVsbCBwcm9maWxlIGZpbGUKX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSgpIHsKICAgIGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgInpzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uenNocmMiCiAgICBlbGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgImJhc2giOyB0aGVuCiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnByb2ZpbGUiIF07IHRoZW4KICAgICAgICAjIEZhbGxiYWNrIGZvciBzaCwga3NoLCBldGMuCiAgICAgICAgZWNobyAiJEhPTUUvLnByb2ZpbGUiCiAgICBlbGlmIFsgLWYgIiRIT01FLy56c2hyYyIgXTsgdGhlbgogICAgICAgICMgRmFsbGJhY2sgaWYgU0hFTEwgdmFyIGlzbid0IHNldAogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLmJhc2hyYyIgXTsgdGhlbgogICAgICAgICMgRmFsbGJhY2sgaWYgU0hFTEwgdmFyIGlzbid0IHNldAogICAgICAgIGVjaG8gIiRIT01FLy5iYXNocmMiCiAgICBlbHNlCiAgICAgICAgZWNobyAidW5rbm93bl9wcm9maWxlIgogICAgZmkKfQoKIyBNYWluIGluc3RhbGxhdGlvbiBmdW5jdGlvbgpfaW5zdGFsbGVyX3NlY3VyZV9jb25maWdfZmlsZSgpIHsKICAgICAgICBpZiBbIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBjaG1vZCA2MDAgIiRDT05GSUdfRklMRSIgMj4vZGV2L251bGwgfHwgdHJ1ZQogICAgZmkKfQoKX2luc3RhbGxfc2NyaXB0KCkgewogICAgZWNobyAtZSAiJEZDS04gJHtDX0JPTER9QWxyaWdodCwgbGV0J3MgZ2V0IHRoaXMgc2hpdCBpbnN0YWxsZWQuLi4ke0NfUkVTRVR9IgogICAgbWtkaXIgLXAgIiRJTlNUQUxMX0RJUiIKICAgIAogICAgIyBXcml0ZSB0aGUgZW1iZWRkZWQgY29yZSBsb2dpYyB0byB0aGUgbWFpbi5zaCBmaWxlCiAgICBfZnVja193cml0ZV9jb3JlICIkTUFJTl9TSCIKICAgIAogICAgaWYgWyAkPyAtbmUgMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1DYW4ndCB3cml0ZSB0byB0aGUgZmlsZS4gQ2hlY2sgeW91ciBkYW1uIHBlcm1pc3Npb25zLiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgICMgQ3JlYXRlIGEgZGVmYXVsdCBjb25maWcgZmlsZSBpZiBpdCBkb2Vzbid0IGV4aXN0CiAgICBpZiBbICEgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNhdCA8PCdDRkcnID4gIiRDT05GSUdfRklMRSIKIyBmdWNraXRzIGNvbmZpZ3VyYXRpb24KIyBUb2dnbGUgdGhlIGV4cG9ydHMgYmVsb3cgdG8gY3VzdG9taXNlIHlvdXIgZXhwZXJpZW5jZS4KCiMgQ3VzdG9tIEFQSSBlbmRwb2ludCB0aGF0IHBvaW50cyB0byB5b3VyIHNlbGYtaG9zdGVkIHdvcmtlcgojIGV4cG9ydCBGVUNLX0FQSV9FTkRQT0lOVD0iaHR0cHM6Ly95b3VyLWRvbWFpbi53b3JrZXJzLmRldi8iCgojIExvY2FsIE9wZW5BSS1jb21wYXRpYmxlIEFQSSBrZXkgKHJlY29tbWVuZGVkKQojIGV4cG9ydCBGVUNLX09QRU5BSV9BUElfS0VZPSJzay0uLi4iCgojIE9wdGlvbmFsOiBvdmVycmlkZSBtb2RlbC9iYXNlIHdoZW4gdXNpbmcgeW91ciBvd24ga2V5CiMgZXhwb3J0IEZVQ0tfT1BFTkFJX01PREVMPSJncHQtNG8tbWluaSIKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0JBU0U9Imh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEiCgojIEFkZCBhbiBleHRyYSBhbGlhcyBiZXNpZGVzIHRoZSBkZWZhdWx0ICdmdWNrJwojIGV4cG9ydCBGVUNLX0FMSUFTPSJwbHMiCgojIFNraXAgY29uZmlybWF0aW9uIHByb21wdHMgKHVzZSB3aXRoIGNhdXRpb24hKQojIGV4cG9ydCBGVUNLX0FVVE9fRVhFQz1mYWxzZQoKIyBPdmVycmlkZSBjdXJsIHRpbWVvdXQgKHNlY29uZHMpCiMgZXhwb3J0IEZVQ0tfVElNRU9VVD0zMAoKIyBFbmFibGUgdmVyYm9zZSBkZWJ1ZyBsb2dzCiMgZXhwb3J0IEZVQ0tfREVCVUc9ZmFsc2UKCiMgRGlzYWJsZSB0aGUgYnVpbHQtaW4gJ2Z1Y2snIGFsaWFzCiMgZXhwb3J0IEZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTPWZhbHNlCkNGRwogICAgICAgIF9pbnN0YWxsZXJfc2VjdXJlX2NvbmZpZ19maWxlCiAgICBmaQoKICAgICMgQWRkIHNvdXJjZSBsaW5lIHRvIHNoZWxsIHByb2ZpbGUKICAgIGxvY2FsIHByb2ZpbGVfZmlsZQogICAgcHJvZmlsZV9maWxlPSQoX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSkKICAgIAogICAgaWYgWyAiJHByb2ZpbGVfZmlsZSIgPSAidW5rbm93bl9wcm9maWxlIiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH1JIGNhbid0IGZpbmQgLmJhc2hyYywgLnpzaHJjLCBvciAucHJvZmlsZS4gWW91J3JlIG9uIHlvdXIgb3duLiR7Q19SRVNFVH0iID4mMgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d9TWFudWFsbHkgYWRkIHRoaXMgbGluZSB0byB3aGF0ZXZlciBzdGFydHVwIGZpbGUgeW91IHVzZToke0NfUkVTRVR9IiA+JjIKICAgICAgICBlY2hvIC1lICJcbiAgJHtDX0NZQU59c291cmNlICRNQUlOX1NIJHtDX1JFU0VUfVxuIiA+JjIKICAgICAgICByZXR1cm4KICAgIGZpCiAgICAKICAgIGxvY2FsIHNvdXJjZV9saW5lPSJzb3VyY2UgJE1BSU5fU0giCiAgICBpZiAhIGdyZXAgLXFGICIkc291cmNlX2xpbmUiICIkcHJvZmlsZV9maWxlIjsgdGhlbgogICAgICAgICMgRW5zdXJlIHRoZSBmaWxlIGVuZHMgd2l0aCBhIG5ld2xpbmUgYmVmb3JlIHdlIGFkZCBvdXIgbGluZXMKICAgICAgICBpZiBbIC1uICIkKHRhaWwgLWMxICIkcHJvZmlsZV9maWxlIikiIF07IHRoZW4KICAgICAgICAgICAgZWNobyAiIiA+PiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICBmaQogICAgICAgIGVjaG8gIiMgQWRkZWQgYnkgZnVja2l0cyBpbnN0YWxsZXIiID4+ICIkcHJvZmlsZV9maWxlIgogICAgICAgIGVjaG8gIiRzb3VyY2VfbGluZSIgPj4gIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX0dSRUVOfUl0J3MgaW5zdGFsbGVkLiBOb3cgZ2V0IHRvIHdvcmsuJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfVJlc3RhcnQgeW91ciBzaGVsbCwgb3IgcnVuICR7Q19CT0xEfXNvdXJjZSAkcHJvZmlsZV9maWxlJHtDX1lFTExPV30gdG8gc3RhcnQuJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICJcbiR7Q19CT0xEfS0tLSBIT1cgVE8gVVNFIC0tLSR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiSnVzdCB0eXBlICR7Q19SRURfQk9MRH1mdWNrJHtDX1JFU0VUfSBmb2xsb3dlZCBieSB3aGF0IHlvdSB3YW50IHRvIGRvLiIKICAgICAgICBlY2hvIC1lICJFeGFtcGxlczoiCiAgICAgICAgZWNobyAtZSAiICAke0NfQ1lBTn1mdWNrIGluc3RhbGwgZ2l0JHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19DWUFOfWZ1Y2sgdW5pbnN0YWxsIGdpdCR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiICAke0NfQ1lBTn1mdWNrIGZpbmQgYWxsIGZpbGVzIGxhcmdlciB0aGFuIDEwTUIgaW4gdGhlIGN1cnJlbnQgZGlyZWN0b3J5JHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19SRURfQk9MRH1mdWNrIHVuaW5zdGFsbCR7Q19SRVNFVH0gJHtDX0dSRUVOfSMgVW5pbnN0YWxscyAke0NfUkVTRVR9JHtDX1JFRH1mdWNrJHtDX1JFU0VUfSR7Q19HUkVFTn0gaXRzZWxmJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19SRURfQk9MRH1mdWNrIGNvbmZpZyR7Q19SRVNFVH0gJHtDX0dSRUVOfSMgU2hvdyBjb25maWd1cmF0aW9uIGhlbHAke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIlxuJHtDX1lFTExPV31SZW1lbWJlciB0byByZXN0YXJ0IHlvdXIgc2hlbGwgdG8gYmVnaW4hJHtDX1JFU0VUfSIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfWUVMTE9XfUl0J3MgYWxyZWFkeSBpbnN0YWxsZWQsIGdlbml1cy4gSnVzdCB1cGRhdGVkIHRoZSBzY3JpcHQgZm9yIHlvdS4ke0NfUkVTRVR9IgogICAgZmkKfQoKCiMgLS0tIE1haW4gU2NyaXB0IEVudHJ5cG9pbnQgLS0tCgojIElmIGJlaW5nIHNvdXJjZWQgZm9yIHRlc3RpbmcsIGxvYWQgY29yZSBsb2dpYyBhbmQgc2tpcCBlbnRyeXBvaW50CmlmIFsgLW4gIiR7QkFUU19URVNUX0RJUk5BTUU6LX0iIF0gfHwgWyAtbiAiJHtCQVRTX1RFU1RfRklMRU5BTUU6LX0iIF07IHRoZW4KICAgICMgTG9hZCBjb3JlIGxvZ2ljIGZ1bmN0aW9ucyBmb3IgdGVzdGluZwogICAgX2Z1Y2tfc291cmNlX2NvcmUKICAgIHJldHVybiAwCmZpCgojIElmIGFyZ3VtZW50cyBhcmUgcGFzc2VkIChlLmcuLCAiYmFzaCAtcyAuLi4iKQppZiBbICIkIyIgLWd0IDAgXTsgdGhlbgogICAgaWYgWyAiJDEiID0gImluc3RhbGwiIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfaW5zdGFsbF9zY3JpcHQKICAgICAgICBleGl0IDAKICAgIGZpCgogICAgX2Z1Y2tfc291cmNlX2NvcmUKICAgIF9mdWNrX2V4ZWN1dGVfcHJvbXB0ICIkQCIKZWxzZQogICAgX2luc3RhbGxfc2NyaXB0CmZpCg==`);
const INSTALLER_SCRIPT_ZH = b64_to_utf8(`IyEvYmluL2Jhc2gKIwojIOi/meaYryBmdWNraXRzIOeahOWuieijheWSjOS4tOaXtui/kOihjOiEmuacrAojIOasoui/juS9v+eUqAojCiMgLS0tIOWuieWFqOS9v+eUqOaWueazlSAtLS0KIwojIDEuIOS4i+i9vToKIyAgICBjdXJsIC1vIGZ1Y2tpdHMgaHR0cHM6Ly9mdWNraXRzLjI1NTAwNTUyLnh5ei96aAojCiMgMi4g5p+l55yL5Luj56CBOgojICAgIGxlc3MgZnVja2l0cwojCiMgMy4g6L+Q6KGMICjlronoo4UpOgojICAgIGJhc2ggZnVja2l0cwojCiMgNC4g6L+Q6KGMICjkuLTml7bkvb/nlKgpOgojICAgIGJhc2ggZnVja2l0cyAi5L2g55qE5ZG95LukIgojCgpzZXQgLWV1byBwaXBlZmFpbAoKIyAtLS0g6aKc6Imy5a6a5LmJIC0tLQpyZWFkb25seSBDX1JFU0VUPSdcMDMzWzBtJwpyZWFkb25seSBDX1JFRF9CT0xEPSdcMDMzWzE7MzFtJwpyZWFkb25seSBDX1JFRD0nXDAzM1swOzMxbScKcmVhZG9ubHkgQ19HUkVFTj0nXDAzM1swOzMybScKcmVhZG9ubHkgQ19ZRUxMT1c9J1wwMzNbMDszM20nCnJlYWRvbmx5IENfQ1lBTj0nXDAzM1swOzM2bScKcmVhZG9ubHkgQ19CT0xEPSdcMDMzWzFtJwpyZWFkb25seSBDX0RJTT0nXDAzM1sybScKCnJlYWRvbmx5IEZVQ0tJVFNfTE9DQUxFPSJ6aCIKCiMgLS0tIOaPkOekuuespiAtLS0KcmVhZG9ubHkgRlVDSz0iJHtDX1JFRF9CT0xEfVshXSR7Q19SRVNFVH0iCnJlYWRvbmx5IEZDS049IiR7Q19SRUR9W+aPkOekul0ke0NfUkVTRVR9IgoKCiMgLS0tIOmFjee9riAtLS0KaWYgWyAteiAiJHtIT01FOi19IiBdOyB0aGVuCiAgICBlY2hvIC1lICJcMDMzWzE7MzFt6ZSZ6K+vIVwwMzNbMG0gXDAzM1swOzMxbeaCqOeahCBIT01FIOeOr+Wig+WPmOmHj+acquiuvue9ru+8jOaXoOazleehruWumuWuieijheS9jee9ru+8jOivt+WFiOiuvue9ruivpeWPmOmHj+OAgiAo5L6L5aaCOiBleHBvcnQgSE9NRT0vcm9vdClcMDMzWzBtIiA+JjIKICAgIGV4aXQgMQpmaQpyZWFkb25seSBJTlNUQUxMX0RJUj0iJEhPTUUvLmZ1Y2siCnJlYWRvbmx5IE1BSU5fU0g9IiRJTlNUQUxMX0RJUi9tYWluLnNoIgpyZWFkb25seSBDT05GSUdfRklMRT0iJElOU1RBTExfRElSL2NvbmZpZy5zaCIKCgojIC0tLSDmoLjlv4PpgLvovpEgKOWhnui/m+S4gOS4quWtl+espuS4sumHjCkgLS0tCnJlYWQgLXIgLWQgJycgQ09SRV9MT0dJQyA8PCdFT0YnIHx8IHRydWUKCiMgLS0tIGZ1Y2tpdHMg5qC45b+D6YC76L6R5byA5aeLIC0tLQoKIyAtLS0g6K+t6KiA6K6+572uIC0tLQojIOS4reaWh+eJiOiEmuacrO+8jOW8uuWItuiuvue9ruivreiogOeOr+WigwppZiBbIC16ICIke0ZVQ0tJVFNfTE9DQUxFOi19IiBdOyB0aGVuCiAgICByZWFkb25seSBGVUNLSVRTX0xPQ0FMRT0iemgiCmZpCgojIC0tLSDpopzoibLlrprkuYkgLS0tCiMg5Y+q5pyJ5Zyo5rKh5a6a5LmJ6L+H6aKc6Imy55qE5oOF5Ya15LiL5omN5a6a5LmJICjkuLTml7bmqKHlvI/nlKgpCmlmIFsgLXogIiR7Q19SRVNFVDotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgQ19SRVNFVD0nXDAzM1swbScKICAgIHJlYWRvbmx5IENfUkVEX0JPTEQ9J1wwMzNbMTszMW0nCiAgICByZWFkb25seSBDX1JFRD0nXDAzM1swOzMxbScKICAgIHJlYWRvbmx5IENfR1JFRU49J1wwMzNbMDszMm0nCiAgICByZWFkb25seSBDX1lFTExPVz0nXDAzM1swOzMzbScKICAgIHJlYWRvbmx5IENfQ1lBTj0nXDAzM1swOzM2bScKICAgIHJlYWRvbmx5IENfQk9MRD0nXDAzM1sxbScKICAgIHJlYWRvbmx5IENfRElNPSdcMDMzWzJtJwoKICAgICMgLS0tIOaPkOekuuespiAtLS0KICAgIHJlYWRvbmx5IEZVQ0s9IiR7Q19SRURfQk9MRH1bIV0ke0NfUkVTRVR9IgogICAgcmVhZG9ubHkgRkNLTj0iJHtDX1JFRH1b5o+Q56S6XSR7Q19SRVNFVH0iCgpmaQoKaWYgWyAteiAiJHtJTlNUQUxMX0RJUit4fSIgXSB8fCBbIC16ICIke01BSU5fU0greH0iIF0gfHwgWyAteiAiJHtDT05GSUdfRklMRSt4fSIgXTsgdGhlbgogICAgaWYgWyAteiAiJHtIT01FOi19IiBdOyB0aGVuCiAgICAgICAgcmVhZG9ubHkgSU5TVEFMTF9ESVI9Ii90bXAvLmZ1Y2siCiAgICAgICAgcmVhZG9ubHkgTUFJTl9TSD0iL3RtcC8uZnVjay9tYWluLnNoIgogICAgICAgIHJlYWRvbmx5IENPTkZJR19GSUxFPSIvdG1wLy5mdWNrL2NvbmZpZy5zaCIKICAgIGVsc2UKICAgICAgICByZWFkb25seSBJTlNUQUxMX0RJUj0iJEhPTUUvLmZ1Y2siCiAgICAgICAgcmVhZG9ubHkgTUFJTl9TSD0iJElOU1RBTExfRElSL21haW4uc2giCiAgICAgICAgcmVhZG9ubHkgQ09ORklHX0ZJTEU9IiRJTlNUQUxMX0RJUi9jb25maWcuc2giCiAgICBmaQpmaQoKIyDms6jmhI/vvJrphY3nva7mlofku7bliqDovb3lnKjpqozor4Hlh73mlbDlrprkuYnkuYvlkI7ov5vooYzvvIjop4HkuIvmlrnvvIkKCiMgLS0tIOWuieWFqOmFjee9rumqjOivgSAtLS0KIyDlnKggc291cmNlIOmFjee9ruaWh+S7tuWJjemqjOivgeWFtuWGheWuue+8jOmYsuatouS7o+eggeazqOWFpQojIOWPguaVsO+8miQxIC0g6KaB6aqM6K+B55qE5paH5Lu26Lev5b6ECiMg6L+U5Zue77yaMCDlpoLmnpzlronlhajvvIwxIOWmguaenOS4jeWuieWFqOaIluWHuumUmQpfZnVja192YWxpZGF0ZV9jb25maWdfZmlsZSgpIHsKICAgIGxvY2FsIGZpbGU9IiQxIgoKICAgICMg5paH5Lu25b+F6aG75a2Y5Zyo5LiU5Y+v6K+7CiAgICBpZiBbICEgLWYgIiRmaWxlIiBdIHx8IFsgISAtciAiJGZpbGUiIF07IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIOajgOafpeaWh+S7tuadg+mZkCAtIOW/hemhu+eUseW9k+WJjeeUqOaIt+aLpeaciQogICAgaWYgWyAiJChzdGF0IC1jICcldScgIiRmaWxlIiAyPi9kZXYvbnVsbCB8fCBzdGF0IC1mICcldScgIiRmaWxlIiAyPi9kZXYvbnVsbCkiICE9ICIkKGlkIC11KSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5bGe5LqO5b2T5YmN55So5oi377yM5ouS57ud5Yqg6L2944CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgbGluZV9udW09MAogICAgbG9jYWwgbGluZQoKICAgICMg6aKE5a6a5LmJ5q2j5YiZ6KGo6L6+5byP5Y+Y6YeP77yIenNoIOWFvOWuueaAp++8muWPmOmHj+W9ouW8j+mBv+WFjeeJueauiuWtl+espuino+aekOmXrumimO+8iQogICAgbG9jYWwgcmVfY21kX3N1Yj0nXCRcKCcKICAgIGxvY2FsIHJlX2JhY2t0aWNrPSdgJwogICAgbG9jYWwgcmVfYXJpdGg9J1wkXChcKCcKICAgIGxvY2FsIHJlX3NlbWk9JzsnCiAgICBsb2NhbCByZV9hbmQ9JyYmJwogICAgbG9jYWwgcmVfb3I9J1x8XHwnCiAgICBsb2NhbCByZV9waXBlPSdcfCcKICAgIGxvY2FsIHJlX2d0PSc+JwogICAgbG9jYWwgcmVfbHQ9JzwnCiAgICBsb2NhbCByZV9hbXA9JyYnCiAgICBsb2NhbCByZV9lc2M9J1xcXCQnCgogICAgd2hpbGUgSUZTPSByZWFkIC1yIGxpbmUgfHwgWyAtbiAiJGxpbmUiIF07IGRvCiAgICAgICAgbGluZV9udW09JCgobGluZV9udW0gKyAxKSkKCiAgICAgICAgIyDot7Pov4fnqbrooYwKICAgICAgICBpZiBbIC16ICIkbGluZSIgXSB8fCBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSokIF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyDot7Pov4fms6jph4rooYzvvIjku6UgIyDlvIDlpLTvvIzlj6/mnInliY3lr7znqbrnmb3vvIkKICAgICAgICBpZiBbWyAiJGxpbmUiID1+IF5bWzpzcGFjZTpdXSojIF1dOyB0aGVuCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZmkKCiAgICAgICAgIyDmo4Dmn6XljbHpmannmoQgc2hlbGwg5YWD5a2X56ym5ZKM5ZG95Luk5pu/5o2iCiAgICAgICAgIyDmi5Lnu53vvJokKCksIGBgLCAkKCgpLCA7LCAmJiwgfHwsIHwgKOeuoemBkyksID4sIDwsICYsIOaNouihjOi9rOS5iQogICAgICAgIGlmIFtbICIkbGluZSIgPX4gJHJlX2NtZF9zdWIgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2JhY2t0aWNrIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hcml0aCBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfc2VtaSBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfYW5kIF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9vciBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfcGlwZSBdXSB8fCBcCiAgICAgICAgICAgW1sgIiRsaW5lIiA9fiAkcmVfZ3QgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2x0IF1dIHx8IFwKICAgICAgICAgICBbWyAiJGxpbmUiID1+ICRyZV9hbXAgXV0gfHwgXAogICAgICAgICAgIFtbICIkbGluZSIgPX4gJHJlX2VzYyBdXTsgdGhlbgogICAgICAgICAgICBfZnVja19kZWJ1ZyAi6YWN572u6aqM6K+B5aSx6LSl77yM56ysICRsaW5lX251bSDooYzvvJrmo4DmtYvliLDljbHpmanlhYPlrZfnrKYiCiAgICAgICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5a6J5YWo77ya56ysICRsaW5lX251bSDooYzljIXlkKvljbHpmannmoQgc2hlbGwg5YWD5a2X56ymJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKCiAgICAgICAgIyDlj6rlhYHorrjvvJpleHBvcnQgRlVDS18qPS4uLiDmiJYgRlVDS18qPS4uLu+8iOWPr+acieWJjeWvvOepuueZve+8iQogICAgICAgICMg5Lmf5YWB6K6477yaZXhwb3J0IEZVQ0tJVFNfTE9DQUxFPS4uLgogICAgICAgIGlmIFtbICIkbGluZSIgPX4gXltbOnNwYWNlOl1dKihleHBvcnRbWzpzcGFjZTpdXSspPyhGVUNLX1tBLVpfXSt8RlVDS0lUU19MT0NBTEUpPSBdXTsgdGhlbgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZpCgogICAgICAgICMg5ouS57ud5YW25LuW5Lu75L2V5YaF5a65CiAgICAgICAgX2Z1Y2tfZGVidWcgIumFjee9rumqjOivgeWksei0pe+8jOesrCAkbGluZV9udW0g6KGM77ya5peg5rOV6K+G5Yir55qE5qih5byPIgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR96YWN572u5paH5Lu25LiN5a6J5YWo77ya56ysICRsaW5lX251bSDooYzljIXlkKvml6Dms5Xor4bliKvnmoTlhoXlrrkke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZG9uZSA8ICIkZmlsZSIKCiAgICByZXR1cm4gMAp9CgojIOmqjOivgeWQjuWuieWFqOWcsOWKoOi9vemFjee9ruaWh+S7tgojIOWPguaVsO+8miQxIC0g6KaB5Yqg6L2955qE5paH5Lu26Lev5b6ECiMg6L+U5Zue77yaMCDlpoLmnpzmiJDlip/liqDovb3vvIwxIOWmguaenOmqjOivgeWksei0peaIluaWh+S7tuS4jeWtmOWcqApfZnVja19zYWZlX3NvdXJjZV9jb25maWcoKSB7CiAgICBsb2NhbCBmaWxlPSIkMSIKCiAgICBpZiBbICEgLWYgIiRmaWxlIiBdOyB0aGVuCiAgICAgICAgcmV0dXJuIDAgICMg5rKh5pyJ5paH5Lu25Lmf5rKh5YWz57O7CiAgICBmaQoKICAgIGlmIF9mdWNrX3ZhbGlkYXRlX2NvbmZpZ19maWxlICIkZmlsZSI7IHRoZW4KICAgICAgICAjIHNoZWxsY2hlY2sgZGlzYWJsZT1TQzEwOTAKICAgICAgICBzb3VyY2UgIiRmaWxlIgogICAgICAgIHJldHVybiAkPwogICAgZWxzZQogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d96YWN572u5paH5Lu26aqM6K+B5aSx6LSl77yM5bey6Lez6L+H5Yqg6L2977yaJGZpbGUke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyAtLS0g5Yqg6L2955So5oi36YWN572u77yI5bim6aqM6K+B77yJLS0tCiMg6aqM6K+B5Ye95pWw5bey5a6a5LmJ77yM546w5Zyo5Y+v5Lul5a6J5YWo5Zyw5Yqg6L296YWN572uCl9mdWNrX3NhZmVfc291cmNlX2NvbmZpZyAiJENPTkZJR19GSUxFIgoKaWYgWyAteiAiJHtERUZBVUxUX0FQSV9FTkRQT0lOVCt4fSIgXTsgdGhlbgogICAgcmVhZG9ubHkgREVGQVVMVF9BUElfRU5EUE9JTlQ9Imh0dHBzOi8vZnVja2l0cy4yNTUwMDU1Mi54eXovemgiCmZpCgojIOaJvueUqOaItyBzaGVsbCDphY3nva7mlofku7bnmoTovoXliqnlh73mlbAKX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSgpIHsKICAgIGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgInpzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uenNocmMiCiAgICBlbGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgImJhc2giOyB0aGVuCiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnByb2ZpbGUiIF07IHRoZW4KICAgICAgICAjIOWFvOWuuSBzaCwga3NoIOetiQogICAgICAgIGVjaG8gIiRIT01FLy5wcm9maWxlIgogICAgZWxpZiBbIC1mICIkSE9NRS8uenNocmMiIF07IHRoZW4KICAgICAgICAjIFNIRUxMIOWPmOmHj+ayoeiuvue9ruaXtueahOWkh+eUqOaWueahiAogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLmJhc2hyYyIgXTsgdGhlbgogICAgICAgICMgU0hFTEwg5Y+Y6YeP5rKh6K6+572u5pe255qE5aSH55So5pa55qGICiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsc2UKICAgICAgICBlY2hvICJ1bmtub3duX3Byb2ZpbGUiCiAgICBmaQp9CgojIC0tLSDns7vnu5/kv6Hmga/mlLbpm4bmqKHlnZcgLS0tCiMg6Z2Z5oCB57O757uf5L+h5oGv57yT5a2Y5paH5Lu277yI6Leo6L+Q6KGM5oyB5LmF5YyW77yJCiMg5LuF5Zyo5pyq5a6a5LmJ5pe26K6+572u77yI6Ziy5q2iIHJlYWQtb25seSDlj5jph4/plJnor6/vvIkKaWYgWyAteiAiJHtGVUNLX1NZU0lORk9fQ0FDSEVfRklMRTotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEU9IiRJTlNUQUxMX0RJUi8uc3lzaW5mby5jYWNoZSIKZmkKIyDnvJPlrZjnirbmgIHot5/ouKrlj5jph48KX0ZVQ0tfU1RBVElDX0NBQ0hFX0xPQURFRD0wCl9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWT0wCgojIOS7jue8k+WtmOaWh+S7tuWKoOi9vemdmeaAgeezu+e7n+S/oeaBrwojIOWFqOWxgOWPmOmHjzogX0ZVQ0tfU1RBVElDX0NBQ0hFX0xPQURFRCwgRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUKX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUoKSB7CiAgICAjIOWmguaenOe8k+WtmOW3suWKoOi9veWImeebtOaOpei/lOWbngogICAgaWYgWyAiJHtfRlVDS19TVEFUSUNfQ0FDSEVfTE9BREVEOi0wfSIgLWVxIDEgXTsgdGhlbgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIF9GVUNLX1NUQVRJQ19DQUNIRV9MT0FERUQ9MQoKICAgICMg5aaC5p6c57yT5a2Y5paH5Lu25a2Y5Zyo5YiZ5Yqg6L29CiAgICBpZiBbIC1mICIkRlVDS19TWVNJTkZPX0NBQ0hFX0ZJTEUiIF07IHRoZW4KICAgICAgICAjIHNoZWxsY2hlY2sgZGlzYWJsZT1TQzEwOTAKICAgICAgICBzb3VyY2UgIiRGVUNLX1NZU0lORk9fQ0FDSEVfRklMRSIgfHwgdHJ1ZQogICAgZmkKfQoKIyDmoIforrDpnZnmgIHnvJPlrZjkuLrohI/vvIjpnIDopoHmjIHkuYXljJbvvIkKIyDlhajlsYDlj5jph486IF9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWQpfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eSgpIHsKICAgIF9GVUNLX1NUQVRJQ19DQUNIRV9ESVJUWT0xCn0KCiMg5bCG6Z2Z5oCB57O757uf5L+h5oGv5oyB5LmF5YyW5Yiw57yT5a2Y5paH5Lu2CiMg5YWo5bGA5Y+Y6YePOiBfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFksIEZVQ0tfU1lTSU5GT19DQUNIRV9GSUxFCiMg6L+U5Zue5YC8OiDmiJDlip/ov5Tlm54gMO+8jOWksei0pei/lOWbniAxCl9mdWNrX3BlcnNpc3Rfc3RhdGljX2NhY2hlKCkgewogICAgIyDku4XlnKjnvJPlrZjohI/ml7bmiY3mjIHkuYXljJYKICAgIGlmIFsgIiR7X0ZVQ0tfU1RBVElDX0NBQ0hFX0RJUlRZOi0wfSIgLW5lIDEgXTsgdGhlbgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgICMg56Gu5L+d57yT5a2Y55uu5b2V5a2Y5ZyoCiAgICBsb2NhbCBjYWNoZV9kaXIKICAgIGNhY2hlX2Rpcj0kKGRpcm5hbWUgIiRGVUNLX1NZU0lORk9fQ0FDSEVfRklMRSIpCiAgICBpZiAhIG1rZGlyIC1wICIkY2FjaGVfZGlyIiAyPi9kZXYvbnVsbDsgdGhlbgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgICMg5Yib5bu65Li05pe25paH5Lu26L+b6KGM5Y6f5a2Q5YaZ5YWlCiAgICBsb2NhbCB0bXBfZmlsZQogICAgdG1wX2ZpbGU9JChta3RlbXApIHx8IHJldHVybiAxCgogICAgIyDlsIbnvJPlrZjlj5jph4/lhpnlhaXkuLTml7bmlofku7YKICAgIHsKICAgICAgICBwcmludGYgJ19GVUNLX0NBQ0hFRF9ESVNUUk89JXFcXG4nICIke19GVUNLX0NBQ0hFRF9ESVNUUk86LX0iCiAgICAgICAgcHJpbnRmICdfRlVDS19DQUNIRURfS0VSTkVMPSVxXFxuJyAiJHtfRlVDS19DQUNIRURfS0VSTkVMOi19IgogICAgICAgIHByaW50ZiAnX0ZVQ0tfQ0FDSEVEX0FSQ0g9JXFcXG4nICIke19GVUNLX0NBQ0hFRF9BUkNIOi19IgogICAgICAgIHByaW50ZiAnX0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSPSVxXFxuJyAiJHtfRlVDS19DQUNIRURfUEtHX01BTkFHRVI6LX0iCiAgICB9ID4gIiR0bXBfZmlsZSIKCiAgICAjIOWOn+WtkOenu+WKqOWIsOacgOe7iOS9jee9rgogICAgaWYgbXYgIiR0bXBfZmlsZSIgIiRGVUNLX1NZU0lORk9fQ0FDSEVfRklMRSIgMj4vZGV2L251bGw7IHRoZW4KICAgICAgICBfRlVDS19TVEFUSUNfQ0FDSEVfRElSVFk9MAogICAgICAgIHJldHVybiAwCiAgICBlbHNlCiAgICAgICAgIyDlpLHotKXml7bmuIXnkIbkuLTml7bmlofku7YKICAgICAgICBybSAtZiAiJHRtcF9maWxlIgogICAgICAgIHJldHVybiAxCiAgICBmaQp9CgojIOajgOa1i+WPkeihjOeJiC/ns7vnu5/lrrbml4/vvIjmlK/mjIHnvJPlrZjvvIkKIyDovpPlh7o6IOWPkeihjOeJiOWtl+espuS4su+8iOWmgu+8miJEZWJpYW4g57O7IDEyLjA0IChVYnVudHUgMjQuMDQgTFRTKSLvvIkKX2Z1Y2tfZGV0ZWN0X2Rpc3RybygpIHsKICAgIF9mdWNrX2xvYWRfc3RhdGljX2NhY2hlCgogICAgIyDlpoLmnpzmnInnvJPlrZjlgLzliJnnm7TmjqXov5Tlm54KICAgIGlmIFsgLW4gIiR7X0ZVQ0tfQ0FDSEVEX0RJU1RSTzotfSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRfRlVDS19DQUNIRURfRElTVFJPIgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGxvY2FsIGtlcm5lbF9uYW1lIGRpc3RybyBpZCB2ZXJzaW9uIHByZXR0eSBmYW1pbHkKICAgIGtlcm5lbF9uYW1lPSQodW5hbWUgLXMgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGRpc3Rybz0idW5rbm93biIKCiAgICAjIG1hY09TIOajgOa1iwogICAgaWYgWyAiJGtlcm5lbF9uYW1lIiA9ICJEYXJ3aW4iIF07IHRoZW4KICAgICAgICBsb2NhbCBwcm9kdWN0IHZlcnNpb24KICAgICAgICBwcm9kdWN0PSQoc3dfdmVycyAtcHJvZHVjdE5hbWUgMj4vZGV2L251bGwgfHwgcHJpbnRmICdtYWNPUycpCiAgICAgICAgcHJvZHVjdD0kKHByaW50ZiAnJXMnICIkcHJvZHVjdCIgfCB0ciAtZCAnXHJcbicpCiAgICAgICAgdmVyc2lvbj0kKHN3X3ZlcnMgLXByb2R1Y3RWZXJzaW9uIDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICAgICAgdmVyc2lvbj0kKHByaW50ZiAnJXMnICIkdmVyc2lvbiIgfCB0ciAtZCAnXHJcbicpCiAgICAgICAgZGlzdHJvPSIkcHJvZHVjdCAkdmVyc2lvbiIKICAgICMgTGludXgg5L2/55SoIC9ldGMvb3MtcmVsZWFzZSDmo4DmtYsKICAgIGVsaWYgWyAtciAvZXRjL29zLXJlbGVhc2UgXTsgdGhlbgogICAgICAgIGlkPSQoZ3JlcCAtRSAnXklEPScgL2V0Yy9vcy1yZWxlYXNlIHwgaGVhZCAtbjEgfCBjdXQgLWQ9IC1mMiB8IHRyIC1kICciJyB8IHRyICdbOnVwcGVyOl0nICdbOmxvd2VyOl0nKQogICAgICAgIHZlcnNpb249JChncmVwIC1FICdeVkVSU0lPTl9JRD0nIC9ldGMvb3MtcmVsZWFzZSB8IGhlYWQgLW4xIHwgY3V0IC1kPSAtZjIgfCB0ciAtZCAnIicpCiAgICAgICAgcHJldHR5PSQoZ3JlcCAtRSAnXlBSRVRUWV9OQU1FPScgL2V0Yy9vcy1yZWxlYXNlIHwgaGVhZCAtbjEgfCBjdXQgLWQ9IC1mMi0gfCB0ciAtZCAnIicpCgogICAgICAgICMg56Gu5a6a57O757uf5a625peP5Lul5L6/5pu05aW95Zyw5YiG57G7CiAgICAgICAgZmFtaWx5PSIiCiAgICAgICAgY2FzZSAiJGlkIiBpbgogICAgICAgICAgICB1YnVudHV8ZGViaWFuKQogICAgICAgICAgICAgICAgZmFtaWx5PSJEZWJpYW4g57O7IgogICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgY2VudG9zfHJoZWx8cm9ja3l8YWxtYWxpbnV4fGZlZG9yYSkKICAgICAgICAgICAgICAgIGZhbWlseT0iUkhFTCDns7siCiAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBhcmNofG1hbmphcm98ZW5kZWF2b3Vyb3MpCiAgICAgICAgICAgICAgICBmYW1pbHk9IkFyY2gg57O7IgogICAgICAgICAgICAgICAgOzsKICAgICAgICBlc2FjCgogICAgICAgICMg5qC85byP5YyW5Y+R6KGM54mI5a2X56ym5Liy77yM5YyF5ZCr5a625peP5ZKM54mI5pys5L+h5oGvCiAgICAgICAgaWYgWyAtbiAiJGZhbWlseSIgXTsgdGhlbgogICAgICAgICAgICBkaXN0cm89IiRmYW1pbHkgJHt2ZXJzaW9uOi19IgogICAgICAgICAgICBpZiBbIC1uICIkcHJldHR5IiBdOyB0aGVuCiAgICAgICAgICAgICAgICBkaXN0cm89IiRkaXN0cm8gKCR7cHJldHR5fSkiCiAgICAgICAgICAgIGZpCiAgICAgICAgZWxzZQogICAgICAgICAgICBkaXN0cm89IiR7cHJldHR5Oi1MaW51eCAkdmVyc2lvbn0iCiAgICAgICAgZmkKICAgIGVsc2UKICAgICAgICBkaXN0cm89IiRrZXJuZWxfbmFtZSIKICAgIGZpCgogICAgIyDnvJPlrZjlubbov5Tlm57nu5PmnpwKICAgIF9GVUNLX0NBQ0hFRF9ESVNUUk89IiRkaXN0cm8iCiAgICBfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eQogICAgcHJpbnRmICclc1xuJyAiJGRpc3RybyIKfQoKIyDojrflj5blhoXmoLjniYjmnKzkv6Hmga/vvIjmlK/mjIHnvJPlrZjvvIkKIyDovpPlh7o6IOWGheaguOeJiOacrOWtl+espuS4su+8iOWmgu+8miJMaW51eCA2LjguMC0zMS1nZW5lcmljIu+8iQpfZnVja19nZXRfa2VybmVsX3ZlcnNpb24oKSB7CiAgICBfZnVja19sb2FkX3N0YXRpY19jYWNoZQoKICAgICMg5aaC5p6c5pyJ57yT5a2Y5YC85YiZ55u05o6l6L+U5ZueCiAgICBpZiBbIC1uICIke19GVUNLX0NBQ0hFRF9LRVJORUw6LX0iIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkX0ZVQ0tfQ0FDSEVEX0tFUk5FTCIKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBsb2NhbCBrZXJuZWwKICAgIGtlcm5lbD0kKHVuYW1lIC1zciAyPi9kZXYvbnVsbCB8fCB1bmFtZSAtcyAyPi9kZXYvbnVsbCB8fCBwcmludGYgJ3Vua25vd24nKQogICAga2VybmVsPSQocHJpbnRmICclcycgIiRrZXJuZWwiIHwgdHIgLWQgJ1xyXG4nKQoKICAgICMg57yT5a2Y5bm26L+U5Zue57uT5p6cCiAgICBfRlVDS19DQUNIRURfS0VSTkVMPSIka2VybmVsIgogICAgX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkKICAgIHByaW50ZiAnJXNcbicgIiRrZXJuZWwiCn0KCiMg6I635Y+W57O757uf5p625p6E77yI5pSv5oyB57yT5a2Y77yJCiMg6L6T5Ye6OiDmnrbmnoTlrZfnrKbkuLLvvIjlpoLvvJoieDg2XzY0IiwgImFybTY0Iu+8iQpfZnVja19nZXRfYXJjaGl0ZWN0dXJlKCkgewogICAgX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUKCiAgICAjIOWmguaenOaciee8k+WtmOWAvOWImeebtOaOpei/lOWbngogICAgaWYgWyAtbiAiJHtfRlVDS19DQUNIRURfQVJDSDotfSIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnJXNcbicgIiRfRlVDS19DQUNIRURfQVJDSCIKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBsb2NhbCBhcmNoCiAgICBhcmNoPSQodW5hbWUgLW0gMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGFyY2g9JChwcmludGYgJyVzJyAiJGFyY2giIHwgdHIgLWQgJ1xyXG4nKQoKICAgICMg57yT5a2Y5bm26L+U5Zue57uT5p6cCiAgICBfRlVDS19DQUNIRURfQVJDSD0iJGFyY2giCiAgICBfZnVja19tYXJrX3N0YXRpY19jYWNoZV9kaXJ0eQogICAgcHJpbnRmICclc1xuJyAiJGFyY2giCn0KCiMg5pS26ZuG55So5oi35L+h5oGv5YyF5ous5p2D6ZmQ57qn5YirCiMg6L6T5Ye6OiDnlKjmiLfkv6Hmga/lrZfnrKbkuLLvvIjlpoLvvJoiVXNlcj1qb2huIHVpZD0xMDAwIGxldmVsPXN1ZG9lciBHcm91cHM9am9obiBhZG0gc3VkbyLvvIkKX2Z1Y2tfY29sbGVjdF91c2VyX2luZm8oKSB7CiAgICBsb2NhbCBjdXJyZW50X3VzZXIgdWlkIGdyb3VwcyBsZXZlbAogICAgY3VycmVudF91c2VyPSIke1VTRVI6LX0iCgogICAgIyDlpoLmnpwgVVNFUiDmnKrorr7nva7liJnkvb/nlKjlpIfnlKjmlrnms5UKICAgIGlmIFsgLXogIiRjdXJyZW50X3VzZXIiIF07IHRoZW4KICAgICAgICBjdXJyZW50X3VzZXI9JCh3aG9hbWkgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGZpCgogICAgIyDlpoLmnpwgaWQg5ZG95Luk5Y+v55So5YiZ6I635Y+WIFVJRCDlkoznlKjmiLfnu4QKICAgIHVpZD0idW5rbm93biIKICAgIGdyb3Vwcz0idW5rbm93biIKICAgIGlmIGNvbW1hbmQgLXYgaWQgPi9kZXYvbnVsbCAyPiYxOyB0aGVuCiAgICAgICAgdWlkPSQoaWQgLXUgIiRjdXJyZW50X3VzZXIiIDI+L2Rldi9udWxsIHx8IGlkIC11IDI+L2Rldi9udWxsIHx8IHByaW50ZiAndW5rbm93bicpCiAgICAgICAgZ3JvdXBzPSQoaWQgLUduICIkY3VycmVudF91c2VyIiAyPi9kZXYvbnVsbCB8fCBpZCAtR24gMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKICAgIGZpCgogICAgIyDnoa7lrprmnYPpmZDnuqfliKsKICAgIGxldmVsPSJ1c2VyIgogICAgaWYgWyAiJHVpZCIgPSAiMCIgXTsgdGhlbgogICAgICAgIGxldmVsPSJyb290IgogICAgZWxpZiBwcmludGYgJyVzJyAiJGdyb3VwcyIgfCBncmVwIC1FcSAnKF58W1s6c3BhY2U6XV0pKHN1ZG98d2hlZWx8YWRtaW4pKFtbOnNwYWNlOl1dfCQpJzsgdGhlbgogICAgICAgIGxldmVsPSJzdWRvZXIiCiAgICBmaQoKICAgIHByaW50ZiAnVXNlcj0lcyB1aWQ9JXMgbGV2ZWw9JXMgR3JvdXBzPSVzJyAiJGN1cnJlbnRfdXNlciIgIiR1aWQiICIkbGV2ZWwiICIkZ3JvdXBzIgp9CgojIOaUtumbhuW4uOeUqOW8gOWPkeW3peWFt+eahOeJiOacrOS/oeaBrwojIOi+k+WHujog5bel5YW354mI5pys5a2X56ym5Liy77yI5aaC77yaImdpdDpnaXQgdmVyc2lvbiAyLjM0LjE7IGRvY2tlcjpEb2NrZXIgdmVyc2lvbiAyNC4wLjY7IC4uLiLvvIkKX2Z1Y2tfY29sbGVjdF90b29sX3ZlcnNpb25zKCkgewogICAgbG9jYWwgdG9vbHMgdG9vbCB2ZXJzaW9uIHJlc3VsdAogICAgdG9vbHM9ImdpdCBkb2NrZXIgbnBtIGt1YmVjdGwgY3VybCB3Z2V0IgogICAgcmVzdWx0PSIiCgogICAgZm9yIHRvb2wgaW4gJHRvb2xzOyBkbwogICAgICAgIHZlcnNpb249Im5vdC1pbnN0YWxsZWQiCgogICAgICAgIGlmIGNvbW1hbmQgLXYgIiR0b29sIiA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICAgICAgY2FzZSAiJHRvb2wiIGluCiAgICAgICAgICAgICAgICBnaXR8ZG9ja2VyfGN1cmx8d2dldCkKICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPSQoIiR0b29sIiAtLXZlcnNpb24gMj4vZGV2L251bGwgfCBoZWFkIC1uMSkKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgbnBtKQogICAgICAgICAgICAgICAgICAgIHZlcnNpb249JCgiJHRvb2wiIC0tdmVyc2lvbiAyPi9kZXYvbnVsbCB8IGhlYWQgLW4xKQogICAgICAgICAgICAgICAgICAgIFsgLW4gIiR2ZXJzaW9uIiBdICYmIHZlcnNpb249Im5wbSAkdmVyc2lvbiIKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAga3ViZWN0bCkKICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uPSQoIiR0b29sIiB2ZXJzaW9uIC0tY2xpZW50IC0tc2hvcnQgMj4vZGV2L251bGwgfCBoZWFkIC1uMSkKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBlc2FjCiAgICAgICAgZmkKCiAgICAgICAgIyDmuIXnkIbniYjmnKzlrZfnrKbkuLIKICAgICAgICB2ZXJzaW9uPSQocHJpbnRmICclcycgIiR7dmVyc2lvbjotdW5rbm93bn0iIHwgdHIgJ1xyXG4nICcgICcgfCB0ciAtcyAnICcgfCBzZWQgLWUgJ3MvXiAqLy8nIC1lICdzLyAqJC8vJykKICAgICAgICBbIC16ICIkdmVyc2lvbiIgXSAmJiB2ZXJzaW9uPSJ1bmtub3duIgoKICAgICAgICByZXN1bHQ9IiRyZXN1bHQkdG9vbDokdmVyc2lvbjsgIgogICAgZG9uZQoKICAgICMg56e76Zmk5pyr5bC+55qE5YiG5Y+35ZKM56m65qC8CiAgICByZXN1bHQ9IiR7cmVzdWx0JTsgfSIKICAgIHByaW50ZiAnJXMnICIkcmVzdWx0Igp9CgojIOajgOa1i+WMheeuoeeQhuWZqO+8iOaUr+aMgee8k+WtmO+8iQojIOi+k+WHujog5YyF566h55CG5Zmo5ZCN56ew77yIYXB0LCB5dW0sIGRuZiwgcGFjbWFuLCB6eXBwZXIsIGJyZXcsIHVua25vd27vvIkKX2Z1Y2tfZGV0ZWN0X3BrZ19tYW5hZ2VyKCkgewogICAgX2Z1Y2tfbG9hZF9zdGF0aWNfY2FjaGUKCiAgICAjIOWmguaenOaciee8k+WtmOWAvOWImeebtOaOpei/lOWbngogICAgaWYgWyAtbiAiJHtfRlVDS19DQUNIRURfUEtHX01BTkFHRVI6LX0iIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkX0ZVQ0tfQ0FDSEVEX1BLR19NQU5BR0VSIgogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGxvY2FsIG1hbmFnZXI9InVua25vd24iCgogICAgIyDmjInkvJjlhYjnuqfmo4DmtYvljIXnrqHnkIblmagKICAgIGlmIGNvbW1hbmQgLXYgYXB0LWdldCAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJhcHQiCiAgICBlbGlmIGNvbW1hbmQgLXYgeXVtICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9Inl1bSIKICAgIGVsaWYgY29tbWFuZCAtdiBkbmYgJj4gL2Rldi9udWxsOyB0aGVuCiAgICAgICAgbWFuYWdlcj0iZG5mIgogICAgZWxpZiBjb21tYW5kIC12IHBhY21hbiAmPiAvZGV2L251bGw7IHRoZW4KICAgICAgICBtYW5hZ2VyPSJwYWNtYW4iCiAgICBlbGlmIGNvbW1hbmQgLXYgenlwcGVyICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9Inp5cHBlciIKICAgIGVsaWYgY29tbWFuZCAtdiBicmV3ICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIG1hbmFnZXI9ImJyZXciCiAgICBmaQoKICAgICMg57yT5a2Y5bm26L+U5Zue57uT5p6cCiAgICBfRlVDS19DQUNIRURfUEtHX01BTkFHRVI9IiRtYW5hZ2VyIgogICAgX2Z1Y2tfbWFya19zdGF0aWNfY2FjaGVfZGlydHkKICAgIHByaW50ZiAnJXNcbicgIiRtYW5hZ2VyIgp9CgojIOaUtumbhueugOWMlueahOezu+e7n+S/oeaBr+W5tuagvOW8j+WMluS4uue7k+aehOWMluWtl+espuS4sgojIOi+k+WHujog55So5LqOIEFJIOWkhOeQhueahOezu+e7n+S/oeaBr+Wtl+espuS4sgpfZnVja19jb2xsZWN0X3N5c2luZm9fc3RyaW5nKCkgewogICAgbG9jYWwgb3NfdHlwZSBrZXJuZWxfbmFtZSBwa2dfbWFuYWdlciBzdW1tYXJ5CgogICAgIyDmo4DmtYvmk43kvZzns7vnu5/nsbvlnosKICAgIGtlcm5lbF9uYW1lPSQodW5hbWUgLXMgMj4vZGV2L251bGwgfHwgcHJpbnRmICd1bmtub3duJykKCiAgICBjYXNlICIka2VybmVsX25hbWUiIGluCiAgICAgICAgRGFyd2luKQogICAgICAgICAgICBvc190eXBlPSJtYWNPUyIKICAgICAgICAgICAgcGtnX21hbmFnZXI9ImJyZXciCiAgICAgICAgICAgIDs7CiAgICAgICAgTGludXgpCiAgICAgICAgICAgIGlmIFsgLXIgL2V0Yy9vcy1yZWxlYXNlIF07IHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIGlkCiAgICAgICAgICAgICAgICBpZD0kKGdyZXAgLUUgJ15JRD0nIC9ldGMvb3MtcmVsZWFzZSB8IGhlYWQgLW4xIHwgY3V0IC1kPSAtZjIgfCB0ciAtZCAnIicgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKICAgICAgICAgICAgICAgIGNhc2UgIiRpZCIgaW4KICAgICAgICAgICAgICAgICAgICB1YnVudHV8ZGViaWFuKQogICAgICAgICAgICAgICAgICAgICAgICBvc190eXBlPSJEZWJpYW4iCiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJhcHQiCiAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgY2VudG9zfHJoZWx8cm9ja3l8YWxtYWxpbnV4fGZlZG9yYSkKICAgICAgICAgICAgICAgICAgICAgICAgb3NfdHlwZT0iUkhFTCIKICAgICAgICAgICAgICAgICAgICAgICAgcGtnX21hbmFnZXI9Inl1bSIKICAgICAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICAgICBhcmNofG1hbmphcm8pCiAgICAgICAgICAgICAgICAgICAgICAgIG9zX3R5cGU9IkFyY2giCiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJwYWNtYW4iCiAgICAgICAgICAgICAgICAgICAgICAgIDs7CiAgICAgICAgICAgICAgICAgICAgKikKICAgICAgICAgICAgICAgICAgICAgICAgb3NfdHlwZT0iTGludXgiCiAgICAgICAgICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ1bmtub3duIgogICAgICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgZXNhYwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBvc190eXBlPSJMaW51eCIKICAgICAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ1bmtub3duIgogICAgICAgICAgICBmaQogICAgICAgICAgICA7OwogICAgICAgIE1JTkdXKnxNU1lTKnxDWUdXSU4qKQogICAgICAgICAgICBvc190eXBlPSJXaW5kb3dzIgogICAgICAgICAgICBwa2dfbWFuYWdlcj0idW5rbm93biIKICAgICAgICAgICAgOzsKICAgICAgICAqKQogICAgICAgICAgICBvc190eXBlPSIka2VybmVsX25hbWUiCiAgICAgICAgICAgIHBrZ19tYW5hZ2VyPSJ1bmtub3duIgogICAgICAgICAgICA7OwogICAgZXNhYwoKICAgICMg5qC85byP5YyW5Li6566A5Y2V55qE57uT5p6E5YyW5a2X56ym5LiyCiAgICBwcmludGYgLXYgc3VtbWFyeSAnT1M9JXM7IFBrZ01ncj0lcycgIiRvc190eXBlIiAiJHBrZ19tYW5hZ2VyIgogICAgcHJpbnRmICclc1xuJyAiJHN1bW1hcnkiCn0KCl9mdWNrX2pzb25fZXNjYXBlKCkgewogICAgbG9jYWwgaW5wdXQ9IiQxIgogICAgIyDkvb/nlKggcHJpbnRmIOato+ehruWkhOeQhuaOp+WItuWtl+espgogICAgcHJpbnRmICclcycgIiRpbnB1dCIgfCBzZWQgLWUgJwogICAgICAgICMg6aaW5YWI6L2s5LmJ5Y+N5pac5p2g77yI5b+F6aG75piv56ys5LiA5Liq77yJCiAgICAgICAgcy9cXC9cXFxcL2cKICAgICAgICAjIOi9rOS5ieWPjOW8leWPtwogICAgICAgIHMvIi9cXCIvZwogICAgICAgICMg6L2s5LmJ5o6n5Yi25a2X56ym77yIQVNDSUkgMC0zMe+8iQogICAgICAgIHMvXHgwMC9cXHUwMDAwL2cKICAgICAgICBzL1x4MDEvXFx1MDAwMS9nCiAgICAgICAgcy9ceDAyL1xcdTAwMDIvZwogICAgICAgIHMvXHgwMy9cXHUwMDAzL2cKICAgICAgICBzL1x4MDQvXFx1MDAwNC9nCiAgICAgICAgcy9ceDA1L1xcdTAwMDUvZwogICAgICAgIHMvXHgwNi9cXHUwMDA2L2cKICAgICAgICBzL1x4MDcvXFx1MDAwNy9nCiAgICAgICAgcy9ceDA4L1xcYi9nCiAgICAgICAgcy9ceDA5L1xcdC9nCiAgICAgICAgcy9ceDBBL1xcbi9nCiAgICAgICAgcy9ceDBCL1xcdTAwMEIvZwogICAgICAgIHMvXHgwQy9cXGYvZwogICAgICAgIHMvXHgwRC9cXHIvZwogICAgICAgIHMvXHgwRS9cXHUwMDBFL2cKICAgICAgICBzL1x4MEYvXFx1MDAwRi9nCiAgICAgICAgcy9ceDEwL1xcdTAwMTAvZwogICAgICAgIHMvXHgxMS9cXHUwMDExL2cKICAgICAgICBzL1x4MTIvXFx1MDAxMi9nCiAgICAgICAgcy9ceDEzL1xcdTAwMTMvZwogICAgICAgIHMvXHgxNC9cXHUwMDE0L2cKICAgICAgICBzL1x4MTUvXFx1MDAxNS9nCiAgICAgICAgcy9ceDE2L1xcdTAwMTYvZwogICAgICAgIHMvXHgxNy9cXHUwMDE3L2cKICAgICAgICBzL1x4MTgvXFx1MDAxOC9nCiAgICAgICAgcy9ceDE5L1xcdTAwMTkvZwogICAgICAgIHMvXHgxQS9cXHUwMDFBL2cKICAgICAgICBzL1x4MUIvXFx1MDAxQi9nCiAgICAgICAgcy9ceDFDL1xcdTAwMUMvZwogICAgICAgIHMvXHgxRC9cXHUwMDFEL2cKICAgICAgICBzL1x4MUUvXFx1MDAxRS9nCiAgICAgICAgcy9ceDFGL1xcdTAwMUYvZwogICAgJwp9CgpfZnVja19zaG91bGRfdXNlX2xvY2FsX2FwaSgpIHsKICAgIGlmIFsgLW4gIiR7RlVDS19PUEVOQUlfQVBJX0tFWTotfSIgXTsgdGhlbgogICAgICAgIHJldHVybiAwCiAgICBmaQogICAgcmV0dXJuIDEKfQoKX2Z1Y2tfbG9jYWxfc3lzdGVtX3Byb21wdCgpIHsKICAgIGxvY2FsIHN5c2luZm89IiQxIgogICAgaWYgWyAiJEZVQ0tJVFNfTE9DQUxFIiA9ICJ6aCIgXTsgdGhlbgogICAgICAgIHByaW50ZiAn5L2g5piv5LiA5Liq5LiT5Lia55qEIHNoZWxsIOWRveS7pOeUn+aIkOWZqOOAgueUqOaIt+S8mueUqOiHqueEtuivreiogOaPj+i/sOS7luS7rOaDs+imgeWujOaIkOeahOS7u+WKoeOAguS9oOeahOS7u+WKoeaYr+eUn+aIkOebtOaOpeWPr+aJp+ihjOeahCBzaGVsbCDlkb3ku6TmnaXlrozmiJDnlKjmiLfnmoTnm67moIfjgIIKCumHjeimgeinhOWIme+8mgoxLiDnlKjmiLfovpPlhaXmmK/oh6rnhLbor63oqIDmj4/ov7DmhI/lm77vvIzkuI3mmK/lkb3ku6Tlj4LmlbDjgILkvovlpoIi5YiX5Ye655uu5b2VIuaEj+aAneaYr+aJp+ihjCBscyDlkb3ku6TvvIzogIzkuI3mmK8gbHMgIuWIl+WHuuebruW9lSIKMi4g55Sf5oiQ55u05o6l5Y+v5omn6KGM55qE5ZG95Luk77yM5LiN6KaB55Sf5oiQ5bim5Y+C5pWw5Yik5pat55qE6ISa5pys5qih5p2/77yI5aaCIGlmIFsgJCMgLWVxIDAgXe+8iQozLiDlr7nkuo7nroDljZXku7vliqHnm7TmjqXov5Tlm57ljZXmnaHlkb3ku6TvvIzlpI3mnYLku7vliqHlj6/ku6XmmK/lpJrooYzohJrmnKwKNC4g5LiN6KaB5o+Q5L6b5Lu75L2V6Kej6YeK44CB5rOo6YeK44CBbWFya2Rvd24g5qC85byP77yI5q+U5aaCIGBgYGJhc2jvvInmiJYgc2hlYmFuZ++8iOS+i+WmgiAjIS9iaW4vYmFzaO+8iQoK56S65L6L77yaCi0g55So5oi36K+0IuWIl+WHuuebruW9lSIg4oaSIOi+k+WHujogbHMKLSDnlKjmiLfor7Qi5pi+56S66K+m57uG5paH5Lu25YiX6KGoIiDihpIg6L6T5Ye6OiBscyAtbGEKLSDnlKjmiLfor7Qi5p+l5om+5aSn5LqOMTBNQueahOaWh+S7tiIg4oaSIOi+k+WHujogZmluZCAuIC10eXBlIGYgLXNpemUgKzEwTQoK55So5oi355qE57O757uf5L+h5oGv5piv77yaJXMnICIkc3lzaW5mbyIKICAgIGVsc2UKICAgICAgICBwcmludGYgJ1lvdSBhcmUgYW4gZXhwZXJ0IHNoZWxsIGNvbW1hbmQgZ2VuZXJhdG9yLiBVc2VycyBkZXNjcmliZSB0YXNrcyBpbiBuYXR1cmFsIGxhbmd1YWdlLiBZb3VyIHRhc2sgaXMgdG8gZ2VuZXJhdGUgZGlyZWN0bHkgZXhlY3V0YWJsZSBzaGVsbCBjb21tYW5kcyB0byBhY2NvbXBsaXNoIHRoZWlyIGdvYWxzLgoKSW1wb3J0YW50IHJ1bGVzOgoxLiBVc2VyIGlucHV0IGlzIG5hdHVyYWwgbGFuZ3VhZ2UgaW50ZW50LCBOT1QgY29tbWFuZCBhcmd1bWVudHMuIEZvciBleGFtcGxlLCAibGlzdCBkaXJlY3RvcnkiIG1lYW5zIHJ1biBscywgbm90IGxzICJsaXN0IGRpcmVjdG9yeSIKMi4gR2VuZXJhdGUgZGlyZWN0bHkgZXhlY3V0YWJsZSBjb21tYW5kcywgbm90IHNjcmlwdCB0ZW1wbGF0ZXMgd2l0aCBwYXJhbWV0ZXIgaGFuZGxpbmcgKGxpa2UgaWYgWyAkIyAtZXEgMCBdKQozLiBGb3Igc2ltcGxlIHRhc2tzIHJldHVybiBzaW5nbGUgY29tbWFuZHMsIGNvbXBsZXggdGFza3MgY2FuIGJlIG11bHRpLWxpbmUgc2NyaXB0cwo0LiBEbyBub3QgcHJvdmlkZSBhbnkgZXhwbGFuYXRpb24sIGNvbW1lbnRzLCBtYXJrZG93biBmb3JtYXR0aW5nIChsaWtlIGBgYGJhc2gpLCBvciBhIHNoZWJhbmcgKGUuZy4sICMhL2Jpbi9iYXNoKQoKRXhhbXBsZXM6Ci0gVXNlciBzYXlzICJsaXN0IGRpcmVjdG9yeSIg4oaSIE91dHB1dDogbHMKLSBVc2VyIHNheXMgInNob3cgZGV0YWlsZWQgZmlsZSBsaXN0IiDihpIgT3V0cHV0OiBscyAtbGEKLSBVc2VyIHNheXMgImZpbmQgZmlsZXMgbGFyZ2VyIHRoYW4gMTBNQiIg4oaSIE91dHB1dDogZmluZCAuIC10eXBlIGYgLXNpemUgKzEwTQoKVGhlIHVzZXInIiciJ3Mgc3lzdGVtIGluZm8gaXM6ICVzJyAiJHN5c2luZm8iCiAgICBmaQp9CgpfZnVja19leHRyYWN0X2NvbW1hbmRfZnJvbV9qc29uKCkgewogICAgbG9jYWwganNvbl9maWxlPSIkMSIKICAgIGlmIGNvbW1hbmQgLXYgcHl0aG9uMyA+L2Rldi9udWxsIDI+JjE7IHRoZW4KICAgICAgICBweXRob24zIC0gIiRqc29uX2ZpbGUiIDw8J1BZMicKaW1wb3J0IGpzb24sIHN5cwpwYXRoID0gc3lzLmFyZ3ZbMV0Kd2l0aCBvcGVuKHBhdGgsICdyJywgZW5jb2Rpbmc9J3V0Zi04JykgYXMgZjoKICAgIGRhdGEgPSBqc29uLmxvYWQoZikKY2hvaWNlcyA9IGRhdGEuZ2V0KCdjaG9pY2VzJykgb3IgW10KaWYgbm90IGNob2ljZXM6CiAgICBzeXMuZXhpdCgxKQptZXNzYWdlID0gY2hvaWNlc1swXS5nZXQoJ21lc3NhZ2UnKSBvciB7fQpjb250ZW50ID0gKG1lc3NhZ2UuZ2V0KCdjb250ZW50Jykgb3IgJycpLnN0cmlwKCkKaWYgbm90IGNvbnRlbnQ6CiAgICBzeXMuZXhpdCgxKQpwcmludChjb250ZW50KQpQWTIKICAgICAgICByZXR1cm4KICAgIGZpCgogICAgaWYgY29tbWFuZCAtdiBub2RlID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgIG5vZGUgLSAiJGpzb25fZmlsZSIgPDwnSlMyJwpjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7CmNvbnN0IHBhdGggPSBwcm9jZXNzLmFyZ3ZbMV07CmNvbnN0IGRhdGEgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYXRoLCAndXRmOCcpKTsKY29uc3QgY2hvaWNlID0gKGRhdGEuY2hvaWNlcyAmJiBkYXRhLmNob2ljZXNbMF0pIHx8IHt9Owpjb25zdCBtZXNzYWdlID0gY2hvaWNlLm1lc3NhZ2UgfHwge307CmNvbnN0IGNvbnRlbnQgPSAobWVzc2FnZS5jb250ZW50IHx8ICcnKS50cmltKCk7CmlmICghY29udGVudCkgewogIHByb2Nlc3MuZXhpdCgxKTsKfQpjb25zb2xlLmxvZyhjb250ZW50KTsKSlMyCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR95peg5rOV6Kej5p6Q5qih5Z6L6L+U5Zue55qE5pWw5o2u77yM6K+35a6J6KOFIHB5dGhvbjMg5oiWIG5vZGXjgIIke0NfUkVTRVR9IiA+JjIKICAgIHJldHVybiAxCn0KCl9mdWNrX3JlcXVlc3RfbG9jYWxfbW9kZWwoKSB7CiAgICBsb2NhbCBwcm9tcHQ9IiQxIgogICAgbG9jYWwgc3lzaW5mbz0iJDIiCiAgICBsb2NhbCBjdXJsX3RpbWVvdXQ9IiQzIgoKICAgIGxvY2FsIGFwaV9rZXk9IiR7RlVDS19PUEVOQUlfQVBJX0tFWTotfSIKICAgIGlmIFsgLXogIiRhcGlfa2V5IiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH3mnKrphY3nva7mnKzlnLAgQVBJIEtlee+8jOivt+WcqCB+Ly5mdWNrL2NvbmZpZy5zaCDkuK3orr7nva4gRlVDS19PUEVOQUlfQVBJX0tFWeOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIG1vZGVsPSIke0ZVQ0tfT1BFTkFJX01PREVMOi1ncHQtNS1uYW5vfSIKICAgIGxvY2FsIGFwaV9iYXNlPSIke0ZVQ0tfT1BFTkFJX0FQSV9CQVNFOi1odHRwczovL2FwaS5vcGVuYWkuY29tL3YxfSIKICAgIGFwaV9iYXNlPSR7YXBpX2Jhc2UlL30KICAgIGxvY2FsIGFwaV91cmw9IiRhcGlfYmFzZS9jaGF0L2NvbXBsZXRpb25zIgoKICAgIF9mdWNrX2RlYnVnICLmnKzlnLAgQVBJIOWfuuWdgDogJGFwaV9iYXNlIgogICAgX2Z1Y2tfZGVidWcgIuacrOWcsOaooeWeizogJG1vZGVsIgoKICAgIGxvY2FsIHN5c3RlbV9wcm9tcHQKICAgIHN5c3RlbV9wcm9tcHQ9JChfZnVja19sb2NhbF9zeXN0ZW1fcHJvbXB0ICIkc3lzaW5mbyIpCgogICAgbG9jYWwgcGF5bG9hZAogICAgcGF5bG9hZD0kKHByaW50ZiAneyAibW9kZWwiOiAiJXMiLCAibWVzc2FnZXMiOiBbIHsicm9sZSI6InN5c3RlbSIsImNvbnRlbnQiOiIlcyJ9LCB7InJvbGUiOiJ1c2VyIiwiY29udGVudCI6IiVzIn0gXSwgIm1heF90b2tlbnMiOiAxMDI0LCAidGVtcGVyYXR1cmUiOiAwLjIgfScgXAogICAgICAgICIkbW9kZWwiICIkKF9mdWNrX2pzb25fZXNjYXBlICIkc3lzdGVtX3Byb21wdCIpIiAiJChfZnVja19qc29uX2VzY2FwZSAiJHByb21wdCIpIikKCiAgICBsb2NhbCB0bXBfanNvbgogICAgdG1wX2pzb249JChta3RlbXApIHx8IHJldHVybiAxCgogICAgaWYgISBjdXJsIC1mc1MgLS1tYXgtdGltZSAiJGN1cmxfdGltZW91dCIgIiRhcGlfdXJsIiBcCiAgICAgICAgLUggIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiIgXAogICAgICAgIC1IICJBdXRob3JpemF0aW9uOiBCZWFyZXIgJGFwaV9rZXkiIFwKICAgICAgICAtZCAiJHBheWxvYWQiID4gIiR0bXBfanNvbiI7IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeacrOWcsCBBUEkg6K+35rGC5aSx6LSl44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgY2F0ICIkdG1wX2pzb24iID4mMgogICAgICAgIHJtIC1mICIkdG1wX2pzb24iCiAgICAgICAgcmV0dXJuIDEKICAgIGZpCgogICAgbG9jYWwgY29tbWFuZF9vdXRwdXQKICAgIGlmICEgY29tbWFuZF9vdXRwdXQ9JChfZnVja19leHRyYWN0X2NvbW1hbmRfZnJvbV9qc29uICIkdG1wX2pzb24iKTsgdGhlbgogICAgICAgIHJtIC1mICIkdG1wX2pzb24iCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH3ml6Dms5Xop6PmnpDmqKHlnovov5Tlm57lhoXlrrnjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBybSAtZiAiJHRtcF9qc29uIgogICAgcHJpbnRmICclc1xuJyAiJGNvbW1hbmRfb3V0cHV0Igp9CgpfZnVja19yZXF1ZXN0X3dvcmtlcl9tb2RlbCgpIHsKICAgIGxvY2FsIHByb21wdD0iJDEiCiAgICBsb2NhbCBzeXNpbmZvPSIkMiIKICAgIGxvY2FsIGN1cmxfdGltZW91dD0iJDMiCiAgICBsb2NhbCBzcGlubmVyX2xhYmVsPSIkezQ6LX0iCgogICAgbG9jYWwgYWRtaW5fa2V5PSIke0ZVQ0tfQURNSU5fS0VZOi19IgogICAgbG9jYWwgYWRtaW5fc2VnbWVudD0iIgogICAgaWYgWyAtbiAiJGFkbWluX2tleSIgXTsgdGhlbgogICAgICAgIGFkbWluX3NlZ21lbnQ9JChwcmludGYgJywgImFkbWluS2V5IjogIiVzIicgIiQoIF9mdWNrX2pzb25fZXNjYXBlICIkYWRtaW5fa2V5IiApIikKICAgIGZpCgogICAgbG9jYWwgcGF5bG9hZAogICAgcGF5bG9hZD0kKHByaW50ZiAneyAic3lzaW5mbyI6ICIlcyIsICJwcm9tcHQiOiAiJXMiJXMgfScgXAogICAgICAgICIkKCBfZnVja19qc29uX2VzY2FwZSAiJHN5c2luZm8iICkiIFwKICAgICAgICAiJCggX2Z1Y2tfanNvbl9lc2NhcGUgIiRwcm9tcHQiICkiIFwKICAgICAgICAiJGFkbWluX3NlZ21lbnQiKQoKICAgIGxvY2FsIGFwaV91cmw9IiR7RlVDS19BUElfRU5EUE9JTlQ6LSRERUZBVUxUX0FQSV9FTkRQT0lOVH0iCgogICAgX2Z1Y2tfZGVidWcgIkFQSSBVUkw6ICRhcGlfdXJsIgogICAgX2Z1Y2tfZGVidWcgIlBheWxvYWQ6ICRwYXlsb2FkIgogICAgX2Z1Y2tfZGVidWcgIlRpbWVvdXQ6ICRjdXJsX3RpbWVvdXQiCgogICAgbG9jYWwgdG1wX3Jlc3BvbnNlIHRtcF9zdGF0dXMKICAgIHRtcF9yZXNwb25zZT0kKG1rdGVtcCkKICAgIHRtcF9zdGF0dXM9JChta3RlbXApCgogICAgKAogICAgICAgIGN1cmwgLXNTIC0tbWF4LXRpbWUgIiRjdXJsX3RpbWVvdXQiIC1YIFBPU1QgIiRhcGlfdXJsIiBcCiAgICAgICAgICAgIC1IICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24iIFwKICAgICAgICAgICAgLWQgIiRwYXlsb2FkIiAtbyAiJHRtcF9yZXNwb25zZSIgLXcgIiV7aHR0cF9jb2RlfSIgPiAiJHRtcF9zdGF0dXMiCiAgICApICYKICAgIGxvY2FsIHBpZD0kIQoKICAgIGlmIFsgLXQgMiBdOyB0aGVuCiAgICAgICAgX2Z1Y2tfc3Bpbm5lciAiJHBpZCIgIiRzcGlubmVyX2xhYmVsIiA+JjIKICAgIGZpCgogICAgbG9jYWwgY3VybF9leGl0PTAKICAgIGlmICEgd2FpdCAiJHBpZCI7IHRoZW4KICAgICAgICBjdXJsX2V4aXQ9JD8KICAgIGZpCgogICAgbG9jYWwgaHR0cF9zdGF0dXM9IiIKICAgIGlmIFsgLWYgIiR0bXBfc3RhdHVzIiBdOyB0aGVuCiAgICAgICAgaHR0cF9zdGF0dXM9JCh0ciAtZCAnXHJcbicgPCAiJHRtcF9zdGF0dXMiKQogICAgICAgIHJtIC1mICIkdG1wX3N0YXR1cyIKICAgIGZpCgogICAgbG9jYWwgcmVzcG9uc2U9IiIKICAgIGlmIFsgLWYgIiR0bXBfcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICByZXNwb25zZT0kKGNhdCAiJHRtcF9yZXNwb25zZSIpCiAgICAgICAgcm0gLWYgIiR0bXBfcmVzcG9uc2UiCiAgICBmaQoKICAgIGlmIFsgJGN1cmxfZXhpdCAtbmUgMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH3ml6Dms5Xov57mjqXliLDlhbHkuqsgV29ya2Vy44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgaWYgWyAtbiAiJHJlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19ESU19JHJlc3BvbnNlJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZmkKICAgICAgICByZXR1cm4gJGN1cmxfZXhpdAogICAgZmkKCiAgICBpZiBbIC16ICIkaHR0cF9zdGF0dXMiIF07IHRoZW4KICAgICAgICBodHRwX3N0YXR1cz0wCiAgICBmaQoKICAgIGlmIFsgIiRodHRwX3N0YXR1cyIgLWVxIDQyOSBdICYmIHByaW50ZiAnJXMnICIkcmVzcG9uc2UiIHwgZ3JlcCAtcSAnREVNT19MSU1JVF9FWENFRURFRCc7IHRoZW4KICAgICAgICBsb2NhbCBsaW1pdAogICAgICAgIGxpbWl0PSQocHJpbnRmICclcycgIiRyZXNwb25zZSIgfCBzZWQgLW4gJ3MvLioibGltaXQiOltbOnNwYWNlOl1dKlwoWzAtOV1cK1wpLiovXDEvcCcgfCBoZWFkIC1uMSkKICAgICAgICBsb2NhbCByZW1haW5pbmcKICAgICAgICByZW1haW5pbmc9JChwcmludGYgJyVzJyAiJHJlc3BvbnNlIiB8IHNlZCAtbiAncy8uKiJyZW1haW5pbmciOltbOnNwYWNlOl1dKlwoWzAtOV1cK1wpLiovXDEvcCcgfCBoZWFkIC1uMSkKICAgICAgICBbIC16ICIkbGltaXQiIF0gJiYgbGltaXQ9MTAKICAgICAgICBfZnVja19ub3RpZnlfZGVtb19saW1pdCAiJGxpbWl0IiAiJHJlbWFpbmluZyIKICAgICAgICByZXR1cm4gMgogICAgZmkKCiAgICBpZiBbICIkaHR0cF9zdGF0dXMiIC1nZSA0MDAgXSB8fCBbIC16ICIkcmVzcG9uc2UiIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeWFseS6qyBXb3JrZXIg6L+U5ZueIEhUVFAgJGh0dHBfc3RhdHVz44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgaWYgWyAtbiAiJHJlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19ESU19JHJlc3BvbnNlJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZmkKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBwcmludGYgJyVzXG4nICIkcmVzcG9uc2UiCn0KCl9mdWNrX25vdGlmeV9kZW1vX2xpbWl0KCkgewogICAgbG9jYWwgZGFpbHlfbGltaXQ9IiR7MTotMTB9IgogICAgbG9jYWwgcmVtYWluaW5nPSIkezI6LTB9IgoKICAgIGVjaG8gLWUgIiRGVUNLICR7Q19ZRUxMT1d95YWx5Lqr5L2T6aqM6aKd5bqm5bey55So5YWJ77yI5q+P5aSp5pyA5aSaICR7ZGFpbHlfbGltaXR9IOasoe+8ieOAgiR7Q19SRVNFVH0iID4mMgogICAgY2FzZSAiJHJlbWFpbmluZyIgaW4KICAgICAgICAnJ3wqWyEwLTldKikgOzsKICAgICAgICAqKQogICAgICAgICAgICBpZiBbICIkcmVtYWluaW5nIiAtZ3QgMCBdOyB0aGVuCiAgICAgICAgICAgICAgICBlY2hvIC1lICIke0NfRElNfeS7iuaXpeWJqeS9memineW6pu+8miRyZW1haW5pbmcg5qyh44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgIGZpCiAgICAgICAgICAgIDs7CiAgICBlc2FjCgogICAgX2Z1Y2tfZW5zdXJlX2NvbmZpZ19leGlzdHMKICAgIF9mdWNrX3NlY3VyZV9jb25maWdfZmlsZQoKICAgIGVjaG8gLWUgIiR7Q19DWUFOfeino+WGs+aWueahiO+8miR7Q19SRVNFVH3ov5DooYwgJHtDX0dSRUVOfWZ1Y2sgY29uZmlnJHtDX1JFU0VUfe+8jOWcqCAke0NfR1JFRU59JENPTkZJR19GSUxFJHtDX1JFU0VUfSDkuK3orr7nva4gJHtDX0JPTER9RlVDS19PUEVOQUlfQVBJX0tFWSR7Q19SRVNFVH3vvIzlv4XopoHml7blkIzml7bphY3nva4gJHtDX0JPTER9RlVDS19PUEVOQUlfTU9ERUwke0NfUkVTRVR9LyR7Q19CT0xEfUZVQ0tfT1BFTkFJX0FQSV9CQVNFJHtDX1JFU0VUfeOAgiIgPiYyCiAgICBlY2hvIC1lICIke0NfQ1lBTn3oi6XkvaDmjIHmnInnrqHnkIblkZjlhY3pop3lr4bpkqXvvJoke0NfUkVTRVR95ZCM5qC35Zyo6K+l5paH5Lu25Lit6YWN572uICR7Q19CT0xEfUZVQ0tfQURNSU5fS0VZJHtDX1JFU0VUfe+8iOmcgOS4jiBXb3JrZXIg5L6n55qEIEFETUlOX0FDQ0VTU19LRVkg5Yy56YWN77yJ5Y2z5Y+v6Lez6L+H5YWx5Lqr6aKd5bqm6ZmQ5Yi244CCIiA+JjIKICAgIGlmIFsgLW4gIiR7RURJVE9SOi19IiBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33mj5DnpLrvvJoke0NfUkVTRVR9JHtFRElUT1J9IFwiJENPTkZJR19GSUxFXCIiID4mMgogICAgZmkKICAgIGVjaG8gLWUgIiR7Q19ESU195a6J5YWo5o+Q56S677ya6YWN572u5paH5Lu26Ieq5YqoIGNobW9kIDYwMO+8jOS7hemZkOW9k+WJjeeUqOaIt+ivu+WPluOAgiR7Q19SRVNFVH0iID4mMgp9CgoKIyDliKTmlq3mmK/lkKbkuLogdHJ1ZS95ZXMvb24g562JCl9mdWNrX3RydXRoeSgpIHsKICAgIGxvY2FsIHZhbHVlPSIkezE6LX0iCiAgICBsb2NhbCBub3JtYWxpemVkCiAgICBub3JtYWxpemVkPSQocHJpbnRmICclcycgIiR2YWx1ZSIgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKICAgIGNhc2UgIiRub3JtYWxpemVkIiBpbgogICAgICAgIDF8dHJ1ZXx5ZXN8eXxvbnzmmK985byAfOecnykKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgOzsKICAgICAgICAqKQogICAgICAgICAgICByZXR1cm4gMQogICAgICAgICAgICA7OwogICAgZXNhYwp9CgojIOiwg+ivleaXpeW/lwpfZnVja19kZWJ1ZygpIHsKICAgIGlmIF9mdWNrX3RydXRoeSAiJHtGVUNLX0RFQlVHOi0wfSI7IHRoZW4KICAgICAgICBlY2hvIC1lICIke0NfRElNfVvosIPor5VdICQqJHtDX1JFU0VUfSIgPiYyCiAgICBmaQp9CgojIFNwaW5uZXIg5Yqo55S7Cl9mdWNrX3NwaW5uZXIoKSB7CiAgICBsb2NhbCBwaWQ9JDEKICAgIGxvY2FsIHByZWZpeD0iJHsyOi19IgogICAgbG9jYWwgZGVsYXk9MC4xCiAgICBsb2NhbCAtYSBmcmFtZXM9KCJ8IiAiLyIgIi0iICJcXCIpCiAgICBsb2NhbCBmcmFtZV9jb3VudD0keyNmcmFtZXNbQF19CiAgICBsb2NhbCBmcmFtZV9pZHg9MAogICAgbG9jYWwgaGFzX3ByZWZpeD0wCiAgICBpZiBbIC1uICIkcHJlZml4IiBdOyB0aGVuCiAgICAgICAgaGFzX3ByZWZpeD0xCiAgICBmaQogICAgCiAgICAjIOmakOiXj+WFieaghwogICAgdHB1dCBjaXZpcyAyPi9kZXYvbnVsbCB8fCBwcmludGYgIlwwMzNbPzI1bCIKCiAgICB3aGlsZSBraWxsIC0wICIkcGlkIiAyPi9kZXYvbnVsbDsgZG8KICAgICAgICBpZiBbICIkaGFzX3ByZWZpeCIgLWVxIDEgXTsgdGhlbgogICAgICAgICAgICBwcmludGYgIlxyJXMlcyIgIiRwcmVmaXgiICIke2ZyYW1lc1skZnJhbWVfaWR4XX0iCiAgICAgICAgZWxzZQogICAgICAgICAgICBwcmludGYgIiAlcyAiICIke2ZyYW1lc1skZnJhbWVfaWR4XX0iCiAgICAgICAgICAgIHByaW50ZiAiXGJcYlxiIgogICAgICAgIGZpCiAgICAgICAgZnJhbWVfaWR4PSQoKCAoZnJhbWVfaWR4ICsgMSkgJSBmcmFtZV9jb3VudCApKQogICAgICAgIHNsZWVwICIkZGVsYXkiCiAgICBkb25lCgogICAgaWYgWyAiJGhhc19wcmVmaXgiIC1lcSAxIF07IHRoZW4KICAgICAgICBwcmludGYgIlxyJXMiICIkcHJlZml4IgogICAgICAgIHRwdXQgZWwgMj4vZGV2L251bGwgfHwgcHJpbnRmICJcMDMzW0siCiAgICBlbHNlCiAgICAgICAgcHJpbnRmICIgICBcYlxiXGIiCiAgICBmaQogICAgCiAgICAjIOaBouWkjeWFieaghwogICAgdHB1dCBjbm9ybSAyPi9kZXYvbnVsbCB8fCBwcmludGYgIlwwMzNbPzI1aCIKfQoKIyAtLS0g5a6J5YWo5qOA5rWL5byV5pOOIChQaGFzZSAyKSAtLS0KCiMg6Zi75q2i57qn5a6J5YWo6KeE5YiZ77yI5pyA6auY5Lil6YeN5oCnIC0g5ouS57ud5omn6KGM77yJCiMg5qC85byP77yaJ+aooeW8j3x8fOWOn+WboCcKaWYgWyAteiAiJHtfRlVDS19TRUNVUklUWV9CTE9DS19SVUxFUzotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgLWEgX0ZVQ0tfU0VDVVJJVFlfQkxPQ0tfUlVMRVM9KAogICAgICAgICcoXnxbOyZ8WzpzcGFjZTpdXSlybVtbOnNwYWNlOl1dKy1yZltbOnNwYWNlOl1dKy8oW1s6c3BhY2U6XV18JCl8fHzmo4DmtYvliLAgcm0gLXJmIC/vvIzkvJrnm7TmjqXliKDpmaTmoLnnm67lvZUnCiAgICAgICAgJ3JtW1s6c3BhY2U6XV0rLXJmW1s6c3BhY2U6XV0rL1wqfHx85qOA5rWL5YiwIHJtIC1yZiAvKu+8jOWPr+iDvea4heepuuagueebruW9lScKICAgICAgICAncm1bWzpzcGFjZTpdXSstcmZbWzpzcGFjZTpdXSstLW5vLXByZXNlcnZlLXJvb3R8fHzmo4DmtYvliLAgLS1uby1wcmVzZXJ2ZS1yb29077yM6aOO6Zmp5p6B6auYJwogICAgICAgICdybVtbOnNwYWNlOl1dKy1yZltbOnNwYWNlOl1dK1wuXCp8fHzmo4DmtYvliLAgcm0gLXJmIC4q77yM5Y+v6IO95Yig6Zmk5YWo6YOo6ZqQ6JeP5paH5Lu2JwogICAgICAgICdcYmRkXGJbXiNcbl0qXGIob2Z8aWYpPS9kZXYvfHx85qOA5rWL5YiwIGRkIOato+WcqOWGmeWFpSAvZGV2IOiuvuWkhycKICAgICAgICAnXGJta2ZzKFwuXHcrKT9cYnx8fOajgOa1i+WIsCBta2ZzL+agvOW8j+WMluaTjeS9nCcKICAgICAgICAnXGJmZGlza1xifFxicGFydGVkXGJ8XGJmb3JtYXRcYnxcYndpcGVmc1xifFxic2hyZWRcYnx8fOajgOa1i+WIsOWIhuWMuuaIluejgeebmOaTpumZpOWRveS7pCcKICAgICAgICAnOlwoXClccyp7XHMqOlxzKlx8XHMqOjtccyp9XHMqOz9ccyo6fHx85qOA5rWL5YiwIEZvcmsg54K45by55qih5byPJwogICAgKQpmaQoKIyDmjJHmiJjnuqflronlhajop4TliJnvvIjpnIDopoHmmI7noa7nlKjmiLfnoa7orqTvvIkKIyDmoLzlvI/vvJon5qih5byPfHx85Y6f5ZugJwppZiBbIC16ICIke19GVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9SVUxFUzotfSIgXTsgdGhlbgogICAgcmVhZG9ubHkgLWEgX0ZVQ0tfU0VDVVJJVFlfQ0hBTExFTkdFX1JVTEVTPSgKICAgICAgICAnY3VybFtefF0qXHxccyooYmFzaHxzaCl8fHxjdXJsIOeuoemBkyBiYXNoL3No77yM5Y+v6IO96L+c56iL5omn6KGM6ISa5pysJwogICAgICAgICd3Z2V0W158XSpcfFxzKihiYXNofHNoKXx8fHdnZXQg566h6YGTIGJhc2gvc2jvvIzlj6/og73ov5znqIvmiafooYzohJrmnKwnCiAgICAgICAgJ1xic291cmNlXHMraHR0cHM/Oi8vfHx8c291cmNlIOi/nOeoi+iEmuacrCcKICAgICAgICAnXGJldmFsXGJ8XGJleGVjXGJ8fHzkvb/nlKggZXZhbC9leGVjIOWKqOaAgeaJp+ihjCcKICAgICAgICAnXCRcKFteKV0qXCl8fHzmo4DmtYvliLAgJCguLi4pIOWRveS7pOabv+aNoicKICAgICAgICAnYFteYF0qYHx8fOajgOa1i+WIsOWPjeW8leWPt+WRveS7pOabv+aNoicKICAgICAgICAnXGIoc2h8YmFzaHxlbnYpXHMrLWNcYnx8fOajgOa1i+WIsCBzaC9iYXNoIC1jIOWMheijheWRveS7pCcKICAgICAgICAnXGJweXRob25bMC05Ll0qXHMrLWNcYnx8fOajgOa1i+WIsCBweXRob24gLWMg5YaF6IGU6ISa5pysJwogICAgICAgICcoXnxbOyZ8WzpzcGFjZTpdXSkoY3B8bXZ8cm18Y2htb2R8Y2hvd258c2VkfHRlZXxjYXQpW147JnxdKlxiLyhldGN8Ym9vdHxzeXN8cHJvY3xkZXYpXGJ8fHzlkb3ku6Tmk43kvZzlhbPplK7ns7vnu5/ot6/lvoQnCiAgICAgICAgJ1xicGVybFxzKy1lXGJ8fHzmo4DmtYvliLAgcGVybCAtZSDlhoXogZTmiafooYwnCiAgICAgICAgJ1xicnVieVxzKy1lXGJ8fHzmo4DmtYvliLAgcnVieSAtZSDlhoXogZTmiafooYwnCiAgICAgICAgJ1xibm9kZVxzKy1lXGJ8fHzmo4DmtYvliLAgbm9kZSAtZSDlhoXogZTmiafooYwnCiAgICAgICAgJ1xicGhwXHMrLXJcYnx8fOajgOa1i+WIsCBwaHAgLXIg5YaF6IGU5omn6KGMJwogICAgICAgICdiYXNlNjRbXnxdKlx8XHMqKGJhc2h8c2h8ZXZhbCl8fHzmo4DmtYvliLAgYmFzZTY0IOe8lueggeWRveS7pOaJp+ihjCcKICAgICAgICAnXGJ4YXJnc1xiLiooLUl8LWl8e30pLipcYihzaHxiYXNofHJtfGNobW9kKVxifHx85qOA5rWL5Yiw6YCa6L+HIHhhcmdzIOaJp+ihjOWRveS7pCcKICAgICAgICAnXGJmaW5kXGJbXnw7XSotZXhlY1xifHx85qOA5rWL5Yiw6YCa6L+HIGZpbmQgLWV4ZWMg5omn6KGM5ZG95LukJwogICAgICAgICdcYihhd2t8Z2F3a3xuYXdrfG1hd2spXGJbXnw7XSpzeXN0ZW1ccypcKHx8fOajgOa1i+WIsOmAmui/hyBhd2sgc3lzdGVtKCkg6Ze05o6l5omn6KGMJwogICAgICAgICdcYnByaW50ZlxiLipcXFxceFswLTlhLWZBLUZdfHx85qOA5rWL5Yiw5Y+v6IO955qE5Y2B5YWt6L+b5Yi257yW56CB5ZG95Luk5rOo5YWlJwogICAgICAgICdcJFx7W159XSojXH18fHzmo4DmtYvliLDlj6/og73mlLnlj5jlkb3ku6TnmoTlj4LmlbDlsZXlvIAnCiAgICAgICAgJ2VjaG9ccytbXnxdKlx8XHMqKGJhc2h8c2h8ZXZhbCl8fHzmo4DmtYvliLAgZWNobyDnrqHpgZPliLAgc2hlbGwg5omn6KGMJwogICAgKQpmaQoKIyDorablkYrnuqflronlhajop4TliJnvvIjku4XorablkYrvvIznlKjmiLflj6/nu6fnu63vvIkKIyDmoLzlvI/vvJon5qih5byPfHx85Y6f5ZugJwppZiBbIC16ICIke19GVUNLX1NFQ1VSSVRZX1dBUk5fUlVMRVM6LX0iIF07IHRoZW4KICAgIHJlYWRvbmx5IC1hIF9GVUNLX1NFQ1VSSVRZX1dBUk5fUlVMRVM9KAogICAgICAgICdybVtbOnNwYWNlOl1dKy1yZlxifHx85Y+R546wIHJtIC1yZu+8jOaJp+ihjOWJjeivt+WGjeasoeehruiupCcKICAgICAgICAnY2htb2RbWzpzcGFjZTpdXSsuKjc3N1xifHx85qOA5rWL5YiwIGNobW9kIDc3NyDmnYPpmZAnCiAgICAgICAgJ3N1ZG9bWzpzcGFjZTpdXStbXjsmfF0qcm1bWzpzcGFjZTpdXSstcmZ8fHxzdWRvIHJtIC1yZiDpo47pmaknCiAgICAgICAgJz5bWzpzcGFjZTpdXSovKGV0Yy8ocGFzc3dkfHNoYWRvd3xzdWRvZXJzKXxkZXYvc2RbYS16XSspfHx86YeN5a6a5ZCR6L6T5Ye65Yiw5pWP5oSf57O757uf5paH5Lu2JwogICAgKQpmaQoKIyDku47phY3nva7ojrflj5blvZPliY3lronlhajmqKHlvI8KIyDovpPlh7rvvJoic3RyaWN0IuOAgSJiYWxhbmNlZCIg5oiWICJvZmYiCl9mdWNrX3NlY3VyaXR5X21vZGUoKSB7CiAgICBsb2NhbCBtb2RlPSIke0ZVQ0tfU0VDVVJJVFlfTU9ERTotYmFsYW5jZWR9IgogICAgbW9kZT0kKHByaW50ZiAnJXMnICIkbW9kZSIgfCB0ciAnWzp1cHBlcjpdJyAnWzpsb3dlcjpdJykKCiAgICBjYXNlICIkbW9kZSIgaW4KICAgICAgICBzdHJpY3QpIHByaW50ZiAnc3RyaWN0XG4nIDs7CiAgICAgICAgb2ZmfGRpc2FibGVkfG5vbmUpIHByaW50ZiAnb2ZmXG4nIDs7CiAgICAgICAgYmFsYW5jZWR8ZGVmYXVsdHwiIikgcHJpbnRmICdiYWxhbmNlZFxuJyA7OwogICAgICAgICopIHByaW50ZiAnYmFsYW5jZWRcbicgOzsKICAgIGVzYWMKfQoKIyDojrflj5blronlhajnoa7orqTnmoTpu5jorqTmjJHmiJjmlofmnKwKIyDovpPlh7rvvJrpu5jorqTmjJHmiJjnn63or60KX2Z1Y2tfc2VjdXJpdHlfZGVmYXVsdF9jaGFsbGVuZ2VfdGV4dCgpIHsKICAgIHByaW50ZiAn5oiR56Gu6K6k5om/5ouF6aOO6ZmpJwp9CgojIOajgOafpeWRveS7pOaYr+WQpuWMuemFjeWuieWFqOeZveWQjeWNlQojIOWPguaVsO+8miQxIC0g6KaB5qOA5p+l55qE5ZG95LukCiMg6L+U5Zue77yaMCDlpoLmnpzlnKjnmb3lkI3ljZXkuK3vvIwxIOWQpuWImQpfZnVja19zZWN1cml0eV9pc193aGl0ZWxpc3RlZCgpIHsKICAgIGxvY2FsIGNvbW1hbmQ9IiQxIgogICAgbG9jYWwgd2hpdGVsaXN0PSIke0ZVQ0tfU0VDVVJJVFlfV0hJVEVMSVNUOi19IgoKICAgIGlmIFsgLXogIiR3aGl0ZWxpc3QiIF07IHRoZW4KICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBsb2NhbCBub3JtYWxpemVkIGVudHJ5CiAgICBub3JtYWxpemVkPSQocHJpbnRmICclcycgIiR3aGl0ZWxpc3QiIHwgdHIgJywnICdcbicpCgogICAgd2hpbGUgSUZTPSByZWFkIC1yIGVudHJ5OyBkbwogICAgICAgIGVudHJ5PSQocHJpbnRmICclcycgIiRlbnRyeSIgfCBzZWQgLWUgJ3MvXltbOnNwYWNlOl1dKi8vJyAtZSAncy9bWzpzcGFjZTpdXSokLy8nKQogICAgICAgIFsgLXogIiRlbnRyeSIgXSAmJiBjb250aW51ZQoKICAgICAgICBpZiBwcmludGYgJyVzJyAiJGNvbW1hbmQiIHwgZ3JlcCAtRnEgIiRlbnRyeSI7IHRoZW4KICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICBmaQogICAgZG9uZSA8PDwgIiRub3JtYWxpemVkIgoKICAgIHJldHVybiAxCn0KCiMg5bCG5a6J5YWo57qn5Yir6L2s5o2i5Li65pWw5YC85Lul5L6/5q+U6L6DCiMg5Y+C5pWw77yaJDEgLSDlronlhajnuqfliKvvvIhibG9jay9jaGFsbGVuZ2Uvd2Fybi9va++8iQojIOi+k+WHuu+8muaVsOWAvO+8iDMvMi8xLzDvvIkKX2Z1Y2tfc2VjdXJpdHlfbGV2ZWxfdmFsdWUoKSB7CiAgICBjYXNlICIkMSIgaW4KICAgICAgICBibG9jaykgcHJpbnRmICczXG4nIDs7CiAgICAgICAgY2hhbGxlbmdlKSBwcmludGYgJzJcbicgOzsKICAgICAgICB3YXJuKSBwcmludGYgJzFcbicgOzsKICAgICAgICAqKSBwcmludGYgJzBcbicgOzsKICAgIGVzYWMKfQoKIyDlpoLmnpzlgJnpgInnuqfliKvmm7TkuKXph43liJnmj5DljYflronlhajnuqfliKsKIyDlj4LmlbDvvJokMSAtIOW9k+WJjee6p+WIq++8jCQyIC0g5YCZ6YCJ57qn5YirCiMg6L6T5Ye677ya5pu05Lil6YeN55qE57qn5YirCl9mdWNrX3NlY3VyaXR5X3Byb21vdGUoKSB7CiAgICBsb2NhbCBjdXJyZW50PSIkMSIKICAgIGxvY2FsIGNhbmRpZGF0ZT0iJDIiCiAgICBsb2NhbCBjdXJyZW50X3ZhbCBjYW5kaWRhdGVfdmFsCgogICAgY3VycmVudF92YWw9JChfZnVja19zZWN1cml0eV9sZXZlbF92YWx1ZSAiJGN1cnJlbnQiKQogICAgY2FuZGlkYXRlX3ZhbD0kKF9mdWNrX3NlY3VyaXR5X2xldmVsX3ZhbHVlICIkY2FuZGlkYXRlIikKCiAgICBpZiBbICIkY2FuZGlkYXRlX3ZhbCIgLWd0ICIkY3VycmVudF92YWwiIF07IHRoZW4KICAgICAgICBwcmludGYgJyVzXG4nICIkY2FuZGlkYXRlIgogICAgZWxzZQogICAgICAgIHByaW50ZiAnJXNcbicgIiRjdXJyZW50IgogICAgZmkKfQoKIyDmoLnmja7lronlhajmqKHlvI/osIPmlbTkuKXph43mgKfnuqfliKsKIyDlj4LmlbDvvJokMSAtIOaooeW8j++8iHN0cmljdC9iYWxhbmNlZC9vZmbvvInvvIwkMiAtIOS4pemHjeaAp+e6p+WIqwojIOi+k+WHuu+8muiwg+aVtOWQjueahOS4pemHjeaAp+e6p+WIqwpfZnVja19zZWN1cml0eV9hcHBseV9tb2RlKCkgewogICAgbG9jYWwgbW9kZT0iJDEiCiAgICBsb2NhbCBzZXZlcml0eT0iJDIiCgogICAgY2FzZSAiJG1vZGUiIGluCiAgICAgICAgc3RyaWN0KQogICAgICAgICAgICBjYXNlICIkc2V2ZXJpdHkiIGluCiAgICAgICAgICAgICAgICB3YXJuKSBzZXZlcml0eT0iY2hhbGxlbmdlIiA7OwogICAgICAgICAgICAgICAgY2hhbGxlbmdlKSBzZXZlcml0eT0iYmxvY2siIDs7CiAgICAgICAgICAgIGVzYWMKICAgICAgICAgICAgOzsKICAgIGVzYWMKCiAgICBwcmludGYgJyVzXG4nICIkc2V2ZXJpdHkiCn0KCiMg5bCG5ZG95Luk5LiO5a6J5YWo6KeE5YiZ6KGo5Yy56YWNCiMg5Y+C5pWw77yaJDEgLSDlkb3ku6TvvIwkMiAtIOinhOWImeihqOWQjeensAojIOi+k+WHuu+8muWmguaenOWMuemFjeWImei+k+WHuuWOn+WboOWtl+espuS4sgojIOi/lOWbnu+8mjAg5aaC5p6c5Yy56YWN77yMMSDlkKbliJkKX2Z1Y2tfc2VjdXJpdHlfbWF0Y2hfcnVsZSgpIHsKICAgIGxvY2FsIGNvbW1hbmQ9IiQxIgogICAgbG9jYWwgdGFibGU9IiQyIgogICAgbG9jYWwgLWEgcnVsZXM9KCkKCiAgICBldmFsICJydWxlcz0oXCJcJHske3RhYmxlfVtAXX1cIikiCgogICAgbG9jYWwgcnVsZSBwYXR0ZXJuIHJlYXNvbgogICAgZm9yIHJ1bGUgaW4gIiR7cnVsZXNbQF19IjsgZG8KICAgICAgICBwYXR0ZXJuPSR7cnVsZSUlfHx8Kn0KICAgICAgICByZWFzb249JHtydWxlIyp8fHx9CiAgICAgICAgWyAteiAiJHBhdHRlcm4iIF0gJiYgY29udGludWUKCiAgICAgICAgaWYgcHJpbnRmICclcycgIiRjb21tYW5kIiB8IGdyZXAgLUVpcSAtLSAiJHBhdHRlcm4iOyB0aGVuCiAgICAgICAgICAgIHByaW50ZiAnJXNcbicgIiRyZWFzb24iCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgZmkKICAgIGRvbmUKCiAgICByZXR1cm4gMQp9CgojIOaYvuekuua9nOWcqOWNsemZqeWRveS7pOeahOitpuWRiua2iOaBrwojIOWPguaVsO+8miQxIC0g6K2m5ZGK5Y6f5ZugCl9mdWNrX3NlY3VyaXR5X3dhcm5fbWVzc2FnZSgpIHsKICAgIGxvY2FsIHJlYXNvbj0iJDEiCiAgICBlY2hvIC1lICIke0NfUkVEX0JPTER94pqg77iPICDlronlhajorablkYrvvJoke0NfUkVTRVR9JHtyZWFzb259IiA+JjIKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d96K+35LuU57uG5a6h5p+l77yM6Iul56Gu6K6k5Y+v5L+h5Y+v6YWN572uIEZVQ0tfU0VDVVJJVFlfV0hJVEVMSVNU44CCJHtDX1JFU0VUfSIgPiYyCn0KCiMg5pi+56S66KKr56aB5q2i5ZG95Luk55qE6Zi75q2i5raI5oGvCiMg5Y+C5pWw77yaJDEgLSDpmLvmraLljp/lm6AKX2Z1Y2tfc2VjdXJpdHlfYmxvY2tfbWVzc2FnZSgpIHsKICAgIGxvY2FsIHJlYXNvbj0iJDEiCiAgICBlY2hvIC1lICIke0NfUkVEX0JPTER94puUIOW3sumYu+atou+8miR7Q19SRVNFVH0ke3JlYXNvbn0iID4mMgogICAgZWNobyAtZSAiJHtDX1JFRH3miafooYzooqvmi5Lnu53vvIzlj6/osIPmlbQgRlVDS19TRUNVUklUWV9NT0RFIOaIluWKoOWFpeeZveWQjeWNleWQjumHjeivleOAgiR7Q19SRVNFVH0iID4mMgp9CgojIOaYvuekuumrmOmjjumZqeWRveS7pOeahOaMkeaImOa2iOaBrwojIOWPguaVsO+8miQxIC0g5oyR5oiY5Y6f5Zug77yMJDIgLSDpnIDopoHnmoTnn63or60KX2Z1Y2tfc2VjdXJpdHlfY2hhbGxlbmdlX21lc3NhZ2UoKSB7CiAgICBsb2NhbCByZWFzb249IiQxIgogICAgbG9jYWwgcGhyYXNlPSIkMiIKICAgIGVjaG8gLWUgIiR7Q19SRURfQk9MRH3imqDvuI8gIOmrmOWNseaMkeaImO+8miR7Q19SRVNFVH0ke3JlYXNvbn0iID4mMgogICAgZWNobyAtZSAiJHtDX0NZQU595aaC6ZyA57un57ut77yM6K+36L6T5YWl5LiL5pa555+t6K+t77yaJHtDX1JFU0VUfSIgPiYyCiAgICBlY2hvIC1lICIke0NfQk9MRH0ke3BocmFzZX0ke0NfUkVTRVR9IiA+JjIKfQoKIyDmj5DnpLrnlKjmiLfovpPlhaXlronlhajmjJHmiJjmiYDpnIDnmoTnn63or60KIyDlj4LmlbDvvJokMSAtIOmcgOimgeeahOefreivrQojIOi/lOWbnu+8mjAg5aaC5p6c55+t6K+t5Yy56YWN77yMMSDlkKbliJkKX2Z1Y2tfc2VjdXJpdHlfcHJvbXB0X3BocmFzZSgpIHsKICAgIGxvY2FsIHBocmFzZT0iJDEiCiAgICBsb2NhbCBpbnB1dD0iIgoKICAgIHByaW50ZiAiJWI+ICViIiAiJENfQk9MRCIgIiRDX1JFU0VUIiA+JjIKCiAgICBpZiBbIC1yIC9kZXYvdHR5IF07IHRoZW4KICAgICAgICBpZiAhIElGUz0gcmVhZCAtciBpbnB1dCA8IC9kZXYvdHR5OyB0aGVuCiAgICAgICAgICAgIHByaW50ZiAiXG4iID4mMgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgIGZpCiAgICBlbHNlCiAgICAgICAgaWYgISBJRlM9IHJlYWQgLXIgaW5wdXQ7IHRoZW4KICAgICAgICAgICAgcHJpbnRmICJcbiIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgZmkKICAgIGZpCgogICAgcHJpbnRmICJcbiIgPiYyCiAgICBbICIkaW5wdXQiID0gIiRwaHJhc2UiIF0KfQoKIyDmoLnmja7kuKXph43mgKfnuqfliKvlpITnkIblronlhajlhrPnrZYKIyDlj4LmlbDvvJokMSAtIOS4pemHjeaAp+e6p+WIq++8jCQyIC0g5Y6f5Zug77yMJDMgLSDlkb3ku6QKIyDov5Tlm57vvJowIOWFgeiuuOaJp+ihjO+8jDEg5ouS57udCl9mdWNrX3NlY3VyaXR5X2hhbmRsZV9kZWNpc2lvbigpIHsKICAgIGxvY2FsIHNldmVyaXR5PSIkMSIKICAgIGxvY2FsIHJlYXNvbj0iJDIiCiAgICBsb2NhbCBjb21tYW5kPSIkMyIKCiAgICBjYXNlICIkc2V2ZXJpdHkiIGluCiAgICAgICAgIiJ8b2t8b2ZmKQogICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICA7OwogICAgICAgIHdhcm4pCiAgICAgICAgICAgIF9mdWNrX3NlY3VyaXR5X3dhcm5fbWVzc2FnZSAiJHtyZWFzb246LeajgOa1i+WIsOa9nOWcqOmjjumZqX0iCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIDs7CiAgICAgICAgY2hhbGxlbmdlKQogICAgICAgICAgICBsb2NhbCBwaHJhc2U9IiR7RlVDS19TRUNVUklUWV9DSEFMTEVOR0VfVEVYVDotJChfZnVja19zZWN1cml0eV9kZWZhdWx0X2NoYWxsZW5nZV90ZXh0KX0iCiAgICAgICAgICAgIF9mdWNrX3NlY3VyaXR5X2NoYWxsZW5nZV9tZXNzYWdlICIke3JlYXNvbjot6auY5Y2x5ZG95Luk77yM6K+35YaN5qyh56Gu6K6kfSIgIiRwaHJhc2UiCgogICAgICAgICAgICBpZiBfZnVja19zZWN1cml0eV9wcm9tcHRfcGhyYXNlICIkcGhyYXNlIjsgdGhlbgogICAgICAgICAgICAgICAgZWNobyAtZSAiJHtDX0dSRUVOfeW3sumAmui/h+WuieWFqOaMkeaImOOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICAgICAgZmkKCiAgICAgICAgICAgIGVjaG8gLWUgIiR7Q19SRUR95a6J5YWo5oyR5oiY5aSx6LSl77yM5ZG95Luk6KKr5Y+W5raI44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgICAgIDs7CiAgICAgICAgYmxvY2spCiAgICAgICAgICAgIF9mdWNrX3NlY3VyaXR5X2Jsb2NrX21lc3NhZ2UgIiR7cmVhc29uOi3lkb3ku6TooqvlronlhajnrZbnlaXpmLvmraJ9IgogICAgICAgICAgICByZXR1cm4gMQogICAgICAgICAgICA7OwogICAgICAgICopCiAgICAgICAgICAgIHJldHVybiAwCiAgICAgICAgICAgIDs7CiAgICBlc2FjCn0KCiMg6K+E5Lyw5ZG95Luk5a6J5YWo5oCn5bm26L+U5Zue5Lil6YeN5oCn57qn5Yir5ZKM5Y6f5ZugCiMg5Y+C5pWw77yaJDEgLSDopoHor4TkvLDnmoTlkb3ku6QKIyDovpPlh7rvvJoi5Lil6YeN5oCnfOWOn+WboCIg5a2X56ym5LiyCiMg6L+U5Zue77ya5aeL57uI6L+U5ZueIDDvvIjnu5PmnpzlnKjovpPlh7rkuK3vvIkKX2Z1Y2tfc2VjdXJpdHlfZXZhbHVhdGVfY29tbWFuZCgpIHsKICAgIGxvY2FsIGNvbW1hbmQ9IiQxIgogICAgbG9jYWwgbW9kZSBzZXZlcml0eSByZWFzb24gbWF0Y2ggcHJvbW90ZWQgc3RydWN0dXJhbF9yZWFzb24KCiAgICBtb2RlPSQoX2Z1Y2tfc2VjdXJpdHlfbW9kZSkKCiAgICAjIOWuieWFqOW8leaTjuW3suemgeeUqAogICAgaWYgWyAiJG1vZGUiID0gIm9mZiIgXTsgdGhlbgogICAgICAgIHByaW50ZiAnb2ZmfOWuieWFqOW8leaTjuW3suWFs+mXrVxuJwogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgICMg5qOA5p+l55m95ZCN5Y2VCiAgICBpZiBfZnVja19zZWN1cml0eV9pc193aGl0ZWxpc3RlZCAiJGNvbW1hbmQiOyB0aGVuCiAgICAgICAgcHJpbnRmICdva3zlkb3ku6Tlkb3kuK3nmb3lkI3ljZVcbicKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICBzZXZlcml0eT0ib2siCiAgICByZWFzb249IiIKICAgIG1hdGNoPSIiCgogICAgIyDmo4Dmn6XpmLvmraLop4TliJnvvIjmnIDpq5jkvJjlhYjnuqfvvIkKICAgIGlmIG1hdGNoPSQoX2Z1Y2tfc2VjdXJpdHlfbWF0Y2hfcnVsZSAiJGNvbW1hbmQiICJfRlVDS19TRUNVUklUWV9CTE9DS19SVUxFUyIpOyB0aGVuCiAgICAgICAgc2V2ZXJpdHk9ImJsb2NrIgogICAgICAgIHJlYXNvbj0iJG1hdGNoIgogICAgZmkKCiAgICAjIOajgOafpeaMkeaImOinhOWIme+8iOS4reetieS8mOWFiOe6p++8iQogICAgaWYgWyAiJHNldmVyaXR5IiAhPSAiYmxvY2siIF0gJiYgbWF0Y2g9JChfZnVja19zZWN1cml0eV9tYXRjaF9ydWxlICIkY29tbWFuZCIgIl9GVUNLX1NFQ1VSSVRZX0NIQUxMRU5HRV9SVUxFUyIpOyB0aGVuCiAgICAgICAgc2V2ZXJpdHk9ImNoYWxsZW5nZSIKICAgICAgICByZWFzb249IiRtYXRjaCIKICAgIGZpCgogICAgIyDmo4Dmn6XorablkYrop4TliJnvvIjkvY7kvJjlhYjnuqfvvIkKICAgIGlmIFsgIiRzZXZlcml0eSIgPSAib2siIF0gJiYgbWF0Y2g9JChfZnVja19zZWN1cml0eV9tYXRjaF9ydWxlICIkY29tbWFuZCIgIl9GVUNLX1NFQ1VSSVRZX1dBUk5fUlVMRVMiKTsgdGhlbgogICAgICAgIHNldmVyaXR5PSJ3YXJuIgogICAgICAgIHJlYXNvbj0iJG1hdGNoIgogICAgZmkKCiAgICAjIOajgOafpeWRveS7pOmTvuaOpS/nrqHpgZPvvIjnu5PmnoTliIbmnpDvvIkKICAgIGlmIHByaW50ZiAnJXMnICIkY29tbWFuZCIgfCBncmVwIC1FaXEgJygmJnxcfFx8fDt8XHwpJzsgdGhlbgogICAgICAgIHN0cnVjdHVyYWxfcmVhc29uPSLmo4DmtYvliLDlkb3ku6TliIbpmpTnrKYv566h6YGTIgogICAgICAgIHByb21vdGVkPSQoX2Z1Y2tfc2VjdXJpdHlfcHJvbW90ZSAiJHNldmVyaXR5IiAid2FybiIpCgogICAgICAgIGlmIFsgIiRwcm9tb3RlZCIgIT0gIiRzZXZlcml0eSIgXTsgdGhlbgogICAgICAgICAgICBzZXZlcml0eT0iJHByb21vdGVkIgogICAgICAgICAgICByZWFzb249IiRzdHJ1Y3R1cmFsX3JlYXNvbiIKICAgICAgICBlbGlmIFsgLXogIiRyZWFzb24iIF07IHRoZW4KICAgICAgICAgICAgcmVhc29uPSIkc3RydWN0dXJhbF9yZWFzb24iCiAgICAgICAgZmkKICAgIGZpCgogICAgIyDlupTnlKjlronlhajmqKHlvI/osIPmlbQKICAgIHNldmVyaXR5PSQoX2Z1Y2tfc2VjdXJpdHlfYXBwbHlfbW9kZSAiJG1vZGUiICIkc2V2ZXJpdHkiKQoKICAgIHByaW50ZiAnJXN8JXNcbicgIiRzZXZlcml0eSIgIiR7cmVhc29uOi3lvZPliY3lkb3ku6TmnKrlkb3kuK3lronlhajop4TliJl9Igp9CgojIOWQkeWQjuWFvOWuueeahOmBl+eVmeWHveaVsAojIOWPguaVsO+8miQxIC0g6KaB5qOA5p+l55qE5ZG95LukCiMg6L6T5Ye677yaIuS4pemHjeaAp3zljp/lm6AiIOWtl+espuS4sgpfZnVja19kZXRlY3RfZGFuZ2Vyb3VzX2NvbW1hbmQoKSB7CiAgICBfZnVja19zZWN1cml0eV9ldmFsdWF0ZV9jb21tYW5kICIkMSIKfQoKCiMg56Gu5L+d6YWN572u5paH5Lu25a2Y5ZyoCl9mdWNrX3NlY3VyZV9jb25maWdfZmlsZSgpIHsKICAgIGlmIFsgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNobW9kIDYwMCAiJENPTkZJR19GSUxFIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICBmaQp9CgpfZnVja19hcHBlbmRfY29uZmlnX2hpbnQoKSB7CiAgICBsb2NhbCBrZXk9IiQxIgogICAgbG9jYWwgY29tbWVudD0iJDIiCiAgICBsb2NhbCBzYW1wbGU9IiQzIgogICAgbG9jYWwgcXVvdGVkPSIkezQ6LTF9IgogICAgWyAtZiAiJENPTkZJR19GSUxFIiBdIHx8IHJldHVybgogICAgaWYgZ3JlcCAtRXEgIl5cXHMqIz9cXHMqZXhwb3J0XFxzKyRrZXkiICIkQ09ORklHX0ZJTEUiOyB0aGVuCiAgICAgICAgcmV0dXJuCiAgICBmaQoKICAgIGxvY2FsIGFzc2lnbm1lbnQKICAgIGlmIFsgIiRxdW90ZWQiID0gIjEiIF07IHRoZW4KICAgICAgICBhc3NpZ25tZW50PSIjIGV4cG9ydCAka2V5PVwiJHNhbXBsZVwiIgogICAgZWxzZQogICAgICAgIGFzc2lnbm1lbnQ9IiMgZXhwb3J0ICRrZXk9JHNhbXBsZSIKICAgIGZpCgogICAgewogICAgICAgIHByaW50ZiAnXG4nCiAgICAgICAgcHJpbnRmICcjICVzXG4nICIkY29tbWVudCIKICAgICAgICBwcmludGYgJyVzXG4nICIkYXNzaWdubWVudCIKICAgIH0gPj4gIiRDT05GSUdfRklMRSIKfQoKX2Z1Y2tfc2VlZF9jb25maWdfcGxhY2Vob2xkZXJzKCkgewogICAgWyAtZiAiJENPTkZJR19GSUxFIiBdIHx8IHJldHVybgogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX09QRU5BSV9BUElfS0VZIiAi5pys5ZywIE9wZW5BSSDlhbzlrrkgS2V577yI5o6o6I2Q77yJIiAnc2stLi4uJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FETUlOX0tFWSIgIueuoeeQhuWRmOWFjemineW6puWvhumSpe+8iOS7heWIhuS6q+e7meS/oeS7u+eahOS6uu+8iSIgJ2FkbS0uLi4nCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfT1BFTkFJX01PREVMIiAi6KaG55uW6buY6K6k5qih5Z6LIiAnZ3B0LTRvLW1pbmknCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfT1BFTkFJX0FQSV9CQVNFIiAi6Ieq5a6a5LmJIEFQSSDln7rlnYAiICdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX0FMSUFTIiAi6aKd5aSW5Yir5ZCN77yI5LiN5b2x5ZON6buY6K6kIGZ1Y2vvvIkiICfov5DooYwnCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfQVVUT19FWEVDIiAi6Ieq5Yqo5omn6KGM6L+U5Zue5ZG95Luk77yI5Y2x6Zmp5pON5L2c77yJIiAnZmFsc2UnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19USU1FT1VUIiAi6K+35rGC6LaF5pe25pe26Ze077yI56eS77yJIiAnMzAnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19ERUJVRyIgIuaYr+WQpui+k+WHuuiwg+ivleS/oeaBryIgJ2ZhbHNlJyAwCiAgICBfZnVja19hcHBlbmRfY29uZmlnX2hpbnQgIkZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTIiAi56aB55So5YaF572uIGZ1Y2sg5Yir5ZCNIiAnZmFsc2UnIDAKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9NT0RFIiAi5a6J5YWo5byV5pOO5qih5byP77yac3RyaWN0fGJhbGFuY2VkfG9mZiIgJ2JhbGFuY2VkJwogICAgX2Z1Y2tfYXBwZW5kX2NvbmZpZ19oaW50ICJGVUNLX1NFQ1VSSVRZX1dISVRFTElTVCIgIuS7pemAl+WPt+aIluaNouihjOWIhumalOeahOS/oeS7u+WRveS7pOeJh+autSIgJycKICAgIF9mdWNrX2FwcGVuZF9jb25maWdfaGludCAiRlVDS19TRUNVUklUWV9DSEFMTEVOR0VfVEVYVCIgIumrmOWNseWRveS7pOmcgOimgei+k+WFpeeahOehruiupOefreivrSIgJ+aIkeehruiupOaJv+aLhemjjumZqScKfQoKX2Z1Y2tfZW5zdXJlX2NvbmZpZ19leGlzdHMoKSB7CiAgICBpZiBbIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBfZnVja19zZWVkX2NvbmZpZ19wbGFjZWhvbGRlcnMKICAgICAgICBfZnVja19zZWN1cmVfY29uZmlnX2ZpbGUKICAgICAgICByZXR1cm4KICAgIGZpCgogICAgbWtkaXIgLXAgIiQoZGlybmFtZSAiJENPTkZJR19GSUxFIikiCiAgICBjYXQgPDwnQ0ZHJyA+ICIkQ09ORklHX0ZJTEUiCiMgZnVja2l0cyDphY3nva7npLrkvosKIyDljrvmjonooYzpppbnmoQgI++8jOaUueaIkOS9oOiHquW3seeahOWAvOWNs+WPr+OAggoKIyDoh6rlu7ov6Ieq5a6a5LmJIFdvcmtlciDlhaXlj6MKIyBleHBvcnQgRlVDS19BUElfRU5EUE9JTlQ9Imh0dHBzOi8veW91ci1kb21haW4ud29ya2Vycy5kZXYvIgoKIyDmnKzlnLAgT3BlbkFJIOWFvOWuuSBLZXnvvIjlvLrng4jmjqjojZDvvIkKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0tFWT0ic2stLi4uIgoKIyDnrqHnkIblkZjkuJPnlKjlhY3pop3luqblr4bpkqXvvIjku4XliIbkuqvnu5nkv6Hku7vnmoTkurrvvIkKIyBleHBvcnQgRlVDS19BRE1JTl9LRVk9ImFkbS0uLi4iCgojIOimhueblum7mOiupOaooeWei+aIliBBUEkg5Z+65Z2ACiMgZXhwb3J0IEZVQ0tfT1BFTkFJX01PREVMPSJncHQtNG8tbWluaSIKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0JBU0U9Imh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEiCgojIOmineWkluWIq+WQje+8iOS4jeS8muW9seWTjem7mOiupCBmdWNr77yJCiMgZXhwb3J0IEZVQ0tfQUxJQVM9Iui/kOihjCIKCiMg6Ieq5Yqo5omn6KGM6L+U5Zue5ZG95Luk77yI5Y2x6Zmp77yM6LCo5oWO5byA5ZCv77yJCiMgZXhwb3J0IEZVQ0tfQVVUT19FWEVDPWZhbHNlCgojIOivt+axgui2heaXtuaXtumXtO+8iOenku+8iQojIGV4cG9ydCBGVUNLX1RJTUVPVVQ9MzAKCiMg5piv5ZCm6L6T5Ye66LCD6K+V5L+h5oGvCiMgZXhwb3J0IEZVQ0tfREVCVUc9ZmFsc2UKCiMg56aB55So5YaF572uIGZ1Y2sg5Yir5ZCNCiMgZXhwb3J0IEZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTPWZhbHNlCkNGRwoKICAgIF9mdWNrX3NlZWRfY29uZmlnX3BsYWNlaG9sZGVycwogICAgX2Z1Y2tfc2VjdXJlX2NvbmZpZ19maWxlCn0KCiMg5pi+56S66YWN572u5o+Q56S6Cl9mdWNrX3Nob3dfY29uZmlnX2hlbHAoKSB7CiAgICBfZnVja19lbnN1cmVfY29uZmlnX2V4aXN0cwogICAgZWNobyAtZSAiJHtDX1lFTExPV33phY3nva7mlofku7bvvJoke0NfUkVTRVR9ICR7Q19DWUFOfSRDT05GSUdfRklMRSR7Q19SRVNFVH0iCiAgICBpZiBbIC1uICIke0VESVRPUjotfSIgXTsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d95Y+v5Lul5L2/55So77yaJHtDX1JFU0VUfSAke0NfQ1lBTn0ke0VESVRPUn0gJENPTkZJR19GSUxFJHtDX1JFU0VUfSIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9XfeeUqOS7u+aEj+e8lui+keWZqOaJk+W8gOivpeaWh+S7tuWNs+WPr+S/ruaUuemFjee9ruOAgiR7Q19SRVNFVH0iCiAgICBmaQogICAgZWNobyAtZSAiJHtDX0NZQU595Y+v55So6YCJ6aG577yaJHtDX1JFU0VUfUZVQ0tfQVBJX0VORFBPSU5ULCBGVUNLX09QRU5BSV9BUElfS0VZLCBGVUNLX0FETUlOX0tFWSwgRlVDS19PUEVOQUlfTU9ERUwsIEZVQ0tfT1BFTkFJX0FQSV9CQVNFLCBGVUNLX0FMSUFTLCBGVUNLX0FVVE9fRVhFQywgRlVDS19USU1FT1VULCBGVUNLX0RFQlVHLCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUyIKICAgIGVjaG8gLWUgIiR7Q19ESU195a6J5YWo6K+05piO77ya6YWN572u5paH5Lu25Lya6Ieq5YqoIGNobW9kIDYwMO+8jOmYsuatoiBLZXkg5rOE6Zyy44CCJHtDX1JFU0VUfSIKfQoKIyDljbjovb3ohJrmnKwKX3VuaW5zdGFsbF9zY3JpcHQoKSB7CiAgICBlY2hvIC1lICIke0NfUkVEX0JPTER95aW95aW95aW977yBJHtDX1JFU0VUfSR7Q19ZRUxMT1d95oCO5LmI552A77yM6KaB5Y2456Oo5p2A6am05ZWK77yf6KGM5ZWK5L2g5Liq6ICB5YWt77yM5oiR55yf6LCi6LCi5L2g5LqG44CCJHtDX1JFU0VUfSIKCiAgICAjIOaJvumFjee9ruaWh+S7tgogICAgbG9jYWwgcHJvZmlsZV9maWxlCiAgICBwcm9maWxlX2ZpbGU9JChfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKQogICAgbG9jYWwgc291cmNlX2xpbmU9InNvdXJjZSAkTUFJTl9TSCIKCiAgICBpZiBbICIkcHJvZmlsZV9maWxlIiAhPSAidW5rbm93bl9wcm9maWxlIiBdICYmIFsgLWYgIiRwcm9maWxlX2ZpbGUiIF07IHRoZW4KICAgICAgICBpZiBncmVwIC1xRiAiJHNvdXJjZV9saW5lIiAiJHByb2ZpbGVfZmlsZSI7IHRoZW4KICAgICAgICAgICAgIyDnlKggc2VkIOaKiumCo+WHoOihjOWIoOS6hu+8jOmhuuS+v+Wkh+S4quS7vQogICAgICAgICAgICBpZiBzZWQgLS12ZXJzaW9uID4vZGV2L251bGwgMj4mMTsgdGhlbgogICAgICAgICAgICAgICAgc2VkIC1pLmJhayAiXHwkc291cmNlX2xpbmVcfGQiICIkcHJvZmlsZV9maWxlIgogICAgICAgICAgICAgICAgc2VkIC1pLmJhayAiXHwjIEFkZGVkIGJ5IGZ1Y2tpdHMgaW5zdGFsbGVyXHxkIiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgc2VkIC1pLmJhayAiIiAtZSAiXHwkc291cmNlX2xpbmVcfGQiICIkcHJvZmlsZV9maWxlIgogICAgICAgICAgICAgICAgc2VkIC1pLmJhayAiIiAtZSAiXHwjIEFkZGVkIGJ5IGZ1Y2tpdHMgaW5zdGFsbGVyXHxkIiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICAgICAgZmkKICAgICAgICBmaQogICAgZWxzZQogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d95om+5LiN5YiwIHNoZWxsIOmFjee9ruaWh+S7tu+8jOaCqOWPr+S7peaJi+WKqOWIoOmZpOebuOWFs+mFjee9ruOAgiR7Q19SRVNFVH0iCiAgICBmaQoKICAgIGlmIFsgLWQgIiRJTlNUQUxMX0RJUiIgXTsgdGhlbgogICAgICAgIHJtIC1yZiAiJElOU1RBTExfRElSIgogICAgZmkKCiAgICBzbGVlcCAzCiAgICBlY2hvIC1lICIke0NfR1JFRU596KGM77yM5oiR5YWI6LWw5LiA5q2l77yM5ZGK6L6e44CCJHtDX0NZQU596LW257Sn6YeN5ZCv5L2g6YKj57uI56uv5ZCn77yM5LiN54S25Lya5Yir5ZCN5rGh5p+T44CCJHtDX1JFU0VUfSIKICAgIHNsZWVwIDMKICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d95Li05Yir5LmL6ZmF77yM54yu5LiK5LiA6aaW5bCP6K+X77yM56Wd5oKo5YmN56iL5Ly86ZSm77yaJHtDX1JFU0VUfSIKICAgIHNsZWVwIDIKICAgIGVjaG8gLWUgIlxuJHtDX1JFRH3jgIror5fnu4/Ct+W9vOmYs+OAiyR7Q19SRVNFVH0iCiAgICBzbGVlcCAyCiAgICBlY2hvIC1lICIke0NfWUVMTE9XfeW9vOmYs+iLpeiHs++8jOWIneWNh+S4nOabpuOAgiR7Q19SRVNFVH0iCiAgICBzbGVlcCAyCiAgICBlY2hvIC1lICIke0NfWUVMTE9Xfee7r+mbvumjkuiUve+8jOS8vOW5lee7oee7uOOAgiR7Q19SRVNFVH0iCiAgICBzbGVlcCAzCiAgICBlY2hvIC1lICIke0NfWUVMTE9XfeW9vOmYs+evneeip++8jOmbvumcgua2p+a7geOAgiR7Q19SRVNFVH0iCiAgICBzbGVlcCA0CiAgICBlY2hvIC1lICIke0NfWUVMTE9Xfei1pOefs+WGrOa6qu+8jOS8vOeOm+eRmea9reOAgiR7Q19SRVNFVH0iCiAgICBzbGVlcCA0CiAgICBlY2hvIC1lICIke0NfWUVMTE9XfeW9vOmYs+aZmuaEj++8jOaaluaipuS8vOS5kOOAgiR7Q19SRVNFVH0iCiAgICBzbGVlcCAzCiAgICBlY2hvIC1lICIke0NfWUVMTE9XfeWvkOa4uOa1ruaykO+8jOiLpembiemjnuiInuOAgiR7Q19SRVNFVH0iCn0KCiMg6LefIEFQSSDpgJrkv6HnmoTkuLvlh73mlbAKIyDlj4LmlbDlsLHmmK/opoHmiafooYznmoTlkb3ku6QKX2Z1Y2tfZXhlY3V0ZV9wcm9tcHQoKSB7CiAgICAjIOWmguaenOeUqOaIt+WPqui+k+WFpSAiZnVjayB1bmluc3RhbGwiCiAgICBpZiBbICIkMSIgPSAidW5pbnN0YWxsIiBdICYmIFsgIiQjIiAtZXEgMSBdOyB0aGVuCiAgICAgICAgX3VuaW5zdGFsbF9zY3JpcHQKICAgICAgICByZXR1cm4gMAogICAgZmkKCiAgICAjIOWmguaenOeUqOaIt+i+k+WFpSAiZnVjayBjb25maWciCiAgICBpZiBbICIkMSIgPSAiY29uZmlnIiBdICYmIFsgIiQjIiAtZXEgMSBdOyB0aGVuCiAgICAgICAgX2Z1Y2tfc2hvd19jb25maWdfaGVscAogICAgICAgIHJldHVybiAwCiAgICBmaQoKICAgIGlmICEgY29tbWFuZCAtdiBjdXJsICY+IC9kZXYvbnVsbDsgdGhlbgogICAgICAgIGVjaG8gLWUgIiRGVUNLICR7Q19SRUR9J2Z1Y2snIOWRveS7pOmcgOimgSAnY3VybCfvvIzor7flhYjlronoo4UgY3VybOOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGlmIFsgIiQjIiAtZXEgMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH3or7fmj5DkvpvopoHmiafooYznmoTlkb3ku6TjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICBsb2NhbCBwcm9tcHQ9IiQqIgogICAgbG9jYWwgYXV0b19tb2RlPSIke0ZVQ0tfQVVUT19FWEVDOi0wfSIKICAgIGxvY2FsIGN1cmxfdGltZW91dD0iJHtGVUNLX1RJTUVPVVQ6LTMwfSIKICAgIGxvY2FsIHN5c2luZm9fc3RyaW5nCiAgICBzeXNpbmZvX3N0cmluZz0kKF9mdWNrX2NvbGxlY3Rfc3lzaW5mb19zdHJpbmcpCgogICAgbG9jYWwgcmVzcG9uc2U9IiIKICAgIGxvY2FsIGV4aXRfY29kZT0wCiAgICBpZiBfZnVja19zaG91bGRfdXNlX2xvY2FsX2FwaTsgdGhlbgogICAgICAgIHByaW50ZiAiJHtDX1lFTExPV33kvb/nlKjmnKzlnLAgQVBJIEtleS4uLiAke0NfUkVTRVR9IgogICAgICAgIHJlc3BvbnNlPSQoX2Z1Y2tfcmVxdWVzdF9sb2NhbF9tb2RlbCAiJHByb21wdCIgIiRzeXNpbmZvX3N0cmluZyIgIiRjdXJsX3RpbWVvdXQiKQogICAgICAgIGV4aXRfY29kZT0kPwogICAgZWxzZQogICAgICAgIGxvY2FsIHNwaW5uZXJfbGFiZWw9IuaAneiAg+S4rfCfkq0gIgogICAgICAgIHByaW50ZiAnJXMnICIkc3Bpbm5lcl9sYWJlbCIKICAgICAgICByZXNwb25zZT0kKF9mdWNrX3JlcXVlc3Rfd29ya2VyX21vZGVsICIkcHJvbXB0IiAiJHN5c2luZm9fc3RyaW5nIiAiJGN1cmxfdGltZW91dCIgIiRzcGlubmVyX2xhYmVsIikKICAgICAgICBleGl0X2NvZGU9JD8KICAgIGZpCgogICAgcHJpbnRmICJcciIgIyBDbGVhciB0aGUgbGluZSBiZWZvcmUgcHJpbnRpbmcgYSBuZXdsaW5lCiAgICBlY2hvICIiCgogICAgaWYgWyAkZXhpdF9jb2RlIC1uZSAwIF0gfHwgWyAteiAiJHJlc3BvbnNlIiBdOyB0aGVuCiAgICAgICAgcmV0dXJuICRleGl0X2NvZGUKICAgIGZpCgogICAgZWNobyAtZSAiJHtDX0NZQU595Li65oKo55Sf5oiQ5LqG5Lul5LiL5ZG95Luk77yaJHtDX1JFU0VUfSIKICAgIGVjaG8gLWUgIiR7Q19ESU19LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSR7Q19SRVNFVH0iCiAgICBwcmludGYgJyVzXG4nICIkcmVzcG9uc2UiCiAgICBlY2hvIC1lICIke0NfRElNfS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0ke0NfUkVTRVR9IgoKICAgICMg5a6J5YWo5qOA5p+l5Y2x6Zmp5ZG95LukCiAgICBsb2NhbCBzZWN1cml0eV9yZXN1bHQgc2VjdXJpdHlfbGV2ZWwgc2VjdXJpdHlfcmVhc29uCiAgICBzZWN1cml0eV9yZXN1bHQ9JChfZnVja19kZXRlY3RfZGFuZ2Vyb3VzX2NvbW1hbmQgIiRyZXNwb25zZSIpCiAgICBzZWN1cml0eV9sZXZlbD0ke3NlY3VyaXR5X3Jlc3VsdCUlfCp9CiAgICBzZWN1cml0eV9yZWFzb249JHtzZWN1cml0eV9yZXN1bHQjKnx9CgogICAgIyDmoLnmja7kuKXph43mgKfnuqfliKvlpITnkIblronlhajlhrPnrZYKICAgIGlmICEgX2Z1Y2tfc2VjdXJpdHlfaGFuZGxlX2RlY2lzaW9uICIkc2VjdXJpdHlfbGV2ZWwiICIkc2VjdXJpdHlfcmVhc29uIiAiJHJlc3BvbnNlIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19SRUR94p2MIOWRveS7pOWboOWuieWFqOetlueVpeiiq+S4reatouOAgiR7Q19SRVNFVH0iID4mMgogICAgICAgIHJldHVybiAxCiAgICBmaQoKICAgIGxvY2FsIHNob3VsZF9leGVjPWZhbHNlCgogICAgaWYgX2Z1Y2tfdHJ1dGh5ICIkYXV0b19tb2RlIjsgdGhlbgogICAgICAgIGVjaG8gLWUgIiR7Q19ZRUxMT1d94pqhIOW3suW8gOWQr+iHquWKqOaJp+ihjOaooeW8j++8jOeri+WNs+i/kOihjC4uLiR7Q19SRVNFVH0iCiAgICAgICAgc2hvdWxkX2V4ZWM9dHJ1ZQogICAgZWxzZQogICAgICAgIHdoaWxlIHRydWU7IGRvCiAgICAgICAgICAgIHByaW50ZiAiJHtDX0JPTER95piv5ZCm5omn6KGM77yfW1kvbl0gJHtDX1JFU0VUfSIKICAgICAgICAgICAgbG9jYWwgY29uZmlybWF0aW9uIG5vcm1hbGl6ZWQKICAgICAgICAgICAgaWYgWyAtciAvZGV2L3R0eSBdOyB0aGVuCiAgICAgICAgICAgICAgICBJRlM9IHJlYWQgLXIgY29uZmlybWF0aW9uIDwgL2Rldi90dHkKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgcmVhZCAtciBjb25maXJtYXRpb24KICAgICAgICAgICAgZmkKCiAgICAgICAgICAgIGNvbmZpcm1hdGlvbj0kKHByaW50ZiAnJXMnICIke2NvbmZpcm1hdGlvbjotfSIgfCB0ciAtZCAnIFx0XHInKQogICAgICAgICAgICBub3JtYWxpemVkPSQocHJpbnRmICclcycgIiRjb25maXJtYXRpb24iIHwgdHIgJ1s6dXBwZXI6XScgJ1s6bG93ZXI6XScpCgogICAgICAgICAgICBjYXNlICIkbm9ybWFsaXplZCIgaW4KICAgICAgICAgICAgICAgICIifCJ5InwieWVzInwi5pivIikKICAgICAgICAgICAgICAgICAgICBzaG91bGRfZXhlYz10cnVlCiAgICAgICAgICAgICAgICAgICAgZWNobyAtZSAiJHtDX0dSRUVOfeKchSDmiafooYzkuK0uLi4ke0NfUkVTRVR9IgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgOzsKICAgICAgICAgICAgICAgICJuInwibm8ifCLlkKYiKQogICAgICAgICAgICAgICAgICAgIHNob3VsZF9leGVjPWZhbHNlCiAgICAgICAgICAgICAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33inYwg5bey5Y+W5raI44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICAgICAgKikKICAgICAgICAgICAgICAgICAgICAjIExvb3AKICAgICAgICAgICAgICAgICAgICA7OwogICAgICAgICAgICBlc2FjCiAgICAgICAgZG9uZQogICAgZmkKCiAgICBpZiBbICIkc2hvdWxkX2V4ZWMiID0gInRydWUiIF07IHRoZW4KICAgICAgICBldmFsICIkcmVzcG9uc2UiCiAgICAgICAgbG9jYWwgZXhpdF9jb2RlPSQ/CiAgICAgICAgaWYgWyAkZXhpdF9jb2RlIC1uZSAwIF07IHRoZW4KICAgICAgICAgICAgZWNobyAtZSAiJHtDX1JFRF9CT0xEfemUmeivr++8gSR7Q19SRUR95ZG95Luk5omn6KGM5aSx6LSl77yM6YCA5Ye656CBICRleGl0X2NvZGXjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICBmaQogICAgICAgIHJldHVybiAkZXhpdF9jb2RlCiAgICBlbHNlCiAgICAgICAgIyAi5bey5Y+W5raI44CCIiDmtojmga/njrDlnKjlnKjlvqrnjq/lhoXmiZPljbDvvIwKICAgICAgICAjIOaJgOS7peWmguaenCBzaG91bGRfZXhlYyDkuLogZmFsc2XvvIznm7TmjqXov5Tlm54gMSDljbPlj6/jgIIKICAgICAgICByZXR1cm4gMQogICAgZmkKfQoKIyDlrprkuYnliKvlkI3vvIjmlK/mjIHoh6rlrprkuYnliKvlkI3vvIkKX2Z1Y2tfZGVmaW5lX2FsaWFzZXMoKSB7CiAgICBsb2NhbCBkZWZhdWx0X2FsaWFzPSJmdWNrIgoKICAgIGlmICEgX2Z1Y2tfdHJ1dGh5ICIke0ZVQ0tfRElTQUJMRV9ERUZBVUxUX0FMSUFTOi0wfSI7IHRoZW4KICAgICAgICBhbGlhcyAiJGRlZmF1bHRfYWxpYXMiPSdfZnVja19leGVjdXRlX3Byb21wdCcKICAgIGZpCgogICAgaWYgWyAtbiAiJHtGVUNLX0FMSUFTOi19IiBdICYmIFsgIiRGVUNLX0FMSUFTIiAhPSAiJGRlZmF1bHRfYWxpYXMiIF07IHRoZW4KICAgICAgICBhbGlhcyAiJEZVQ0tfQUxJQVMiPSdfZnVja19leGVjdXRlX3Byb21wdCcKICAgIGZpCn0KCl9mdWNrX2RlZmluZV9hbGlhc2VzCgojIC0tLSDmoLjlv4PpgLvovpHnu5PmnZ8gLS0tCkVPRgoKIyAtLS0g5qC45b+D6YC76L6RIEhlcmVkb2Mg57uT5p2fIC0tLQoKIyDlsIblhoXltYzmoLjlv4PpgLvovpHlhpnliLDmlofku7bkuK3vvIjlronoo4Uv5Li05pe25qih5byP6YO95Lya55So5Yiw77yJCl9mdWNrX3dyaXRlX2NvcmUoKSB7CiAgICBsb2NhbCB0YXJnZXQ9IiQxIgogICAgcHJpbnRmICclc1xuJyAiJENPUkVfTE9HSUMiID4gIiR0YXJnZXQiCn0KCiMg5bCG5qC45b+D6YC76L6R6L295YWl5b2T5YmNIHNoZWxsCl9mdWNrX3NvdXJjZV9jb3JlKCkgewogICAgbG9jYWwgdG1wX2NvcmUKICAgIHRtcF9jb3JlPSQobWt0ZW1wKQogICAgX2Z1Y2tfd3JpdGVfY29yZSAiJHRtcF9jb3JlIgogICAgIyBzaGVsbGNoZWNrIGRpc2FibGU9U0MxMDkwCiAgICBzb3VyY2UgIiR0bXBfY29yZSIKICAgIHJtIC1mICIkdG1wX2NvcmUiCn0KCiMg5bCG5YaF5bWM5qC45b+D6YC76L6R5YaZ5YWl5oyH5a6a5paH5Lu277yI5a6J6KOF5LiO5Li05pe25omn6KGM5Lya55So5Yiw77yJCl9mdWNrX3dyaXRlX2NvcmUoKSB7CiAgICBsb2NhbCB0YXJnZXQ9IiQxIgogICAgcHJpbnRmICclc1xuJyAiJENPUkVfTE9HSUMiID4gIiR0YXJnZXQiCn0KCgojIC0tLSDlronoo4Xlh73mlbAgKOeUseWklumDqOiEmuacrOi/kOihjCkgLS0tCgojIOaJvueUqOaItyBzaGVsbCDphY3nva7mlofku7bnmoTovoXliqnlh73mlbAKX2luc3RhbGxlcl9kZXRlY3RfcHJvZmlsZSgpIHsKICAgIGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgInpzaCI7IHRoZW4KICAgICAgICBlY2hvICIkSE9NRS8uenNocmMiCiAgICBlbGlmIFsgLW4gIiR7U0hFTEw6LX0iIF0gJiYgZWNobyAiJFNIRUxMIiB8IGdyZXAgLXEgImJhc2giOyB0aGVuCiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLnByb2ZpbGUiIF07IHRoZW4KICAgICAgICAjIOWFvOWuuSBzaCwga3NoIOetiQogICAgICAgIGVjaG8gIiRIT01FLy5wcm9maWxlIgogICAgZWxpZiBbIC1mICIkSE9NRS8uenNocmMiIF07IHRoZW4KICAgICAgICAjIFNIRUxMIOWPmOmHj+ayoeiuvue9ruaXtueahOWkh+eUqOaWueahiAogICAgICAgIGVjaG8gIiRIT01FLy56c2hyYyIKICAgIGVsaWYgWyAtZiAiJEhPTUUvLmJhc2hyYyIgXTsgdGhlbgogICAgICAgICMgU0hFTEwg5Y+Y6YeP5rKh6K6+572u5pe255qE5aSH55So5pa55qGICiAgICAgICAgZWNobyAiJEhPTUUvLmJhc2hyYyIKICAgIGVsc2UKICAgICAgICBlY2hvICJ1bmtub3duX3Byb2ZpbGUiCiAgICBmaQp9CgojIOS4u+WuieijheWHveaVsApfaW5zdGFsbGVyX3NlY3VyZV9jb25maWdfZmlsZSgpIHsKICAgIGlmIFsgLWYgIiRDT05GSUdfRklMRSIgXTsgdGhlbgogICAgICAgIGNobW9kIDYwMCAiJENPTkZJR19GSUxFIiAyPi9kZXYvbnVsbCB8fCB0cnVlCiAgICBmaQp9CgpfaW5zdGFsbF9zY3JpcHQoKSB7CiAgICBlY2hvIC1lICIke0NfQk9MRH3lvIDlp4vlronoo4UgZnVja2l0cy4uLiR7Q19SRVNFVH0iCiAgICBta2RpciAtcCAiJElOU1RBTExfRElSIgogICAgCiAgICAjIOaKiuaguOW/g+mAu+i+keWGmei/myBtYWluLnNoCiAgICBfZnVja193cml0ZV9jb3JlICIkTUFJTl9TSCIKICAgIAogICAgaWYgWyAkPyAtbmUgMCBdOyB0aGVuCiAgICAgICAgZWNobyAtZSAiJEZVQ0sgJHtDX1JFRH3ml6Dms5XlhpnlhaXmlofku7bvvIzor7fmo4Dmn6Xnm67lvZXmnYPpmZDjgIIke0NfUkVTRVR9IiA+JjIKICAgICAgICByZXR1cm4gMQogICAgZmkKCiAgICAjIOWmguaenOayoeaciemFjee9ruaWh+S7tuWImeeUn+aIkOS4gOS4quekuuS+iwogICAgaWYgWyAhIC1mICIkQ09ORklHX0ZJTEUiIF07IHRoZW4KICAgICAgICBjYXQgPDwnQ0ZHJyA+ICIkQ09ORklHX0ZJTEUiCiMgZnVja2l0cyDphY3nva7npLrkvosKIyDljrvmjonooYzpppbnmoQgI++8jOaUueaIkOS9oOiHquW3seeahOWAvOWNs+WPr+OAggoKIyDoh6rlu7ov6Ieq5a6a5LmJIFdvcmtlciDlhaXlj6MKIyBleHBvcnQgRlVDS19BUElfRU5EUE9JTlQ9Imh0dHBzOi8veW91ci1kb21haW4ud29ya2Vycy5kZXYvIgoKIyDmnKzlnLAgT3BlbkFJIOWFvOWuuSBLZXnvvIjlvLrng4jmjqjojZDvvIkKIyBleHBvcnQgRlVDS19PUEVOQUlfQVBJX0tFWT0ic2stLi4uIgoKIyDopobnm5bpu5jorqTmqKHlnovmiJYgQVBJIOWfuuWdgAojIGV4cG9ydCBGVUNLX09QRU5BSV9NT0RFTD0iZ3B0LTRvLW1pbmkiCiMgZXhwb3J0IEZVQ0tfT1BFTkFJX0FQSV9CQVNFPSJodHRwczovL2FwaS5vcGVuYWkuY29tL3YxIgoKIyDpop3lpJbliKvlkI3vvIjkuI3kvJrlvbHlk43pu5jorqQgZnVja++8iQojIGV4cG9ydCBGVUNLX0FMSUFTPSLov5DooYwiCgojIOiHquWKqOaJp+ihjOi/lOWbnueahOWRveS7pO+8iOWNsemZqe+8jOiwqOaFjuW8gOWQr++8iQojIGV4cG9ydCBGVUNLX0FVVE9fRVhFQz1mYWxzZQoKIyDor7fmsYLotoXml7bml7bpl7TvvIjnp5LvvIkKIyBleHBvcnQgRlVDS19USU1FT1VUPTMwCgojIOaYr+WQpui+k+WHuuiwg+ivleS/oeaBrwojIGV4cG9ydCBGVUNLX0RFQlVHPWZhbHNlCgojIOemgeeUqOWGhee9riBmdWNrIOWIq+WQjQojIGV4cG9ydCBGVUNLX0RJU0FCTEVfREVGQVVMVF9BTElBUz1mYWxzZQpDRkcKICAgICAgICBfaW5zdGFsbGVyX3NlY3VyZV9jb25maWdfZmlsZQogICAgZmkKCiAgICAjIOaKiiBzb3VyY2Ug6YKj6KGM5Yqg5YiwIHNoZWxsIOmFjee9ruaWh+S7tumHjAogICAgbG9jYWwgcHJvZmlsZV9maWxlCiAgICBwcm9maWxlX2ZpbGU9JChfaW5zdGFsbGVyX2RldGVjdF9wcm9maWxlKQogICAgCiAgICBpZiBbICIkcHJvZmlsZV9maWxlIiA9ICJ1bmtub3duX3Byb2ZpbGUiIF07IHRoZW4KICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfUkVEfeaJvuS4jeWIsCAuYmFzaHJjLCAuenNocmMg5oiWIC5wcm9maWxl77yM5peg5rOV6Ieq5Yqo6YWN572u44CCJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZWNobyAtZSAiJHtDX1lFTExPV33or7fmiYvliqjlsIbku6XkuIvlhoXlrrnmt7vliqDliLDmgqjnmoQgc2hlbGwg6YWN572u5paH5Lu25Lit77yaJHtDX1JFU0VUfSIgPiYyCiAgICAgICAgZWNobyAtZSAiXG4gICR7Q19DWUFOfXNvdXJjZSAkTUFJTl9TSCR7Q19SRVNFVH1cbiIgPiYyCiAgICAgICAgcmV0dXJuCiAgICBmaQogICAgCiAgICBsb2NhbCBzb3VyY2VfbGluZT0ic291cmNlICRNQUlOX1NIIgogICAgaWYgISBncmVwIC1xRiAiJHNvdXJjZV9saW5lIiAiJHByb2ZpbGVfZmlsZSI7IHRoZW4KICAgICAgICAjIOS/neivgeaWh+S7tuacgOWQjuacieaNouihjAogICAgICAgIGlmIFsgLW4gIiQodGFpbCAtYzEgIiRwcm9maWxlX2ZpbGUiKSIgXTsgdGhlbgogICAgICAgICAgICBlY2hvICIiID4+ICIkcHJvZmlsZV9maWxlIgogICAgICAgIGZpCiAgICAgICAgZWNobyAiIyBBZGRlZCBieSBmdWNraXRzIGluc3RhbGxlciIgPj4gIiRwcm9maWxlX2ZpbGUiCiAgICAgICAgZWNobyAiJHNvdXJjZV9saW5lIiA+PiAiJHByb2ZpbGVfZmlsZSIKICAgICAgICBlY2hvIC1lICIke0NfR1JFRU595a6J6KOF5a6M5oiQ77yBJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIke0NfWUVMTE9Xfeivt+mHjeWQr+e7iOerr+aIluaJp+ihjCAke0NfQk9MRH1zb3VyY2UgJHByb2ZpbGVfZmlsZSR7Q19ZRUxMT1d9IOS7peS9v+abtOaUueeUn+aViOOAgiR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiXG4ke0NfQk9MRH0tLS0g5L2/55So5pa55rOVIC0tLSR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAi5L2/55SoICR7Q19SRURfQk9MRH1mdWNrJHtDX1JFU0VUfSDlkb3ku6TlkI7ot5/mgqjmg7PmiafooYznmoTmk43kvZzljbPlj6/jgIIiCiAgICAgICAgZWNobyAtZSAi56S65L6LOiIKICAgICAgICBlY2hvIC1lICIgICR7Q19DWUFOfWZ1Y2sgaW5zdGFsbCBnaXQke0NfUkVTRVR9IgogICAgICAgIGVjaG8gLWUgIiAgJHtDX0NZQU59ZnVjayB1bmluc3RhbGwgZ2l0JHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19DWUFOfWZ1Y2sg5om+5Ye65b2T5YmN55uu5b2V5omA5pyJ5aSn5LqOMTBNQueahOaWh+S7tiR7Q19SRVNFVH0iCiAgICAgICAgZWNobyAtZSAiICAke0NfUkVEX0JPTER9ZnVjayB1bmluc3RhbGwke0NfUkVTRVR9ICR7Q19HUkVFTn0jIOWNuOi9vSBmdWNraXRzJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICIgICR7Q19SRURfQk9MRH1mdWNrIGNvbmZpZyR7Q19SRVNFVH0gJHtDX0dSRUVOfSMg5pi+56S66YWN572u5biu5YqpJHtDX1JFU0VUfSIKICAgICAgICBlY2hvIC1lICJcbiR7Q19ZRUxMT1d96K6w5b6X6YeN5ZCv57uI56uv5Lul5L2/55So5paw5ZG95Luk77yBJHtDX1JFU0VUfSIKICAgIGVsc2UKICAgICAgICBlY2hvIC1lICIkRlVDSyAke0NfWUVMTE9XfeajgOa1i+WIsOW3suWuieijhe+8jOW3suS4uuaCqOabtOaWsOiEmuacrOOAgiR7Q19SRVNFVH0iCiAgICBmaQp9CgoKIyAtLS0g5Li76ISa5pys5YWl5Y+jIC0tLQoKIyDlpoLmnpzmnInlj4LmlbDkvKDov5vmnaUgKOavlOWmgiAiYmFzaCAtcyAuLi4iKQppZiBbICIkIyIgLWd0IDAgXTsgdGhlbgogICAgaWYgWyAiJDEiID0gImluc3RhbGwiIF0gJiYgWyAiJCMiIC1lcSAxIF07IHRoZW4KICAgICAgICBfaW5zdGFsbF9zY3JpcHQKICAgICAgICBleGl0IDAKICAgIGZpCgogICAgX2Z1Y2tfc291cmNlX2NvcmUKICAgIF9mdWNrX2V4ZWN1dGVfcHJvbXB0ICIkQCIKZWxzZQogICAgX2luc3RhbGxfc2NyaXB0CmZpCg==`);

const README_URL_EN = 'https://github.com/Silentely/fuckits/blob/main/README.en.md';
const README_URL_ZH = 'https://github.com/Silentely/fuckits';
const INSTALLER_FILENAME_EN = 'fuckits.sh';
const INSTALLER_FILENAME_ZH = 'fuckits-zh.sh';
const SHARED_DEFAULT_LIMIT = 10;
const SECONDS_IN_DAY = 24 * 60 * 60;

let lastQuotaDate = null;
const sharedUsage = new Map();

function resolveSharedLimit(env) {
  const raw = Number(env?.SHARED_DAILY_LIMIT ?? env?.SHARED_DEFAULT_LIMIT);
  if (Number.isFinite(raw) && raw > 0) {
    return Math.floor(raw);
  }
  return SHARED_DEFAULT_LIMIT;
}

/**
 * 
 * @param {string} a 
 * @param {string} b 
 * @returns {boolean} 
 */
function timingSafeEqual(a, b) {
  if (typeof a !== 'string' || typeof b !== 'string') {
    return false;
  }

  // 
  const lenA = a.length;
  const lenB = b.length;

  // 
  const maxLen = Math.max(lenA, lenB);

  let result = lenA ^ lenB; // 

  for (let i = 0; i < maxLen; i++) {
    // 
    const charA = a.charCodeAt(i % lenA) || 0;
    const charB = b.charCodeAt(i % lenB) || 0;
    result |= charA ^ charB;
  }

  return result === 0;
}

function resolveQuotaStore(env) {
  if (env?.QUOTA_KV && typeof env.QUOTA_KV.get === 'function') {
    return env.QUOTA_KV;
  }

  const alias = env?.QUOTA_KV_BINDING;
  if (alias && env?.[alias] && typeof env[alias].get === 'function') {
    return env[alias];
  }

  if (env?.fuckits && typeof env.fuckits.get === 'function') {
    return env.fuckits;
  }

  return null;
}

async function checkSharedQuota(ip, limit, env) {
  const quotaStore = resolveQuotaStore(env);
  if (quotaStore) {
    return checkSharedQuotaKV(quotaStore, ip, limit);
  }
  return checkSharedQuotaInMemory(ip, limit);
}

function checkSharedQuotaInMemory(ip, limit) {
  const today = new Date().toISOString().slice(0, 10);
  if (lastQuotaDate !== today) {
    sharedUsage.clear();
    lastQuotaDate = today;
  }
  const key = ip || 'anonymous';
  const current = (sharedUsage.get(key) || 0) + 1;
  sharedUsage.set(key, current);
  return {
    allowed: current <= limit,
    remaining: Math.max(limit - current, 0),
    count: current,
  };
}

async function checkSharedQuotaKV(kv, ip, limit) {
  const today = new Date().toISOString().slice(0, 10);
  const key = `quota:${today}:${ip || 'anonymous'}`;
  const ttl = secondsUntilNextUtcMidnight();

  try {
    const raw = await kv.get(key);
    let count = Number(raw) || 0;
    count += 1;
    await kv.put(key, String(count), { expirationTtl: ttl > 0 ? ttl : SECONDS_IN_DAY });
    return {
      allowed: count <= limit,
      remaining: Math.max(limit - count, 0),
      count,
    };
  } catch (error) {
    console.error('Failed to persist quota counter, falling back to in-memory map', error);
    return checkSharedQuotaInMemory(ip, limit);
  }
}

function secondsUntilNextUtcMidnight() {
  const now = new Date();
  const midnight = Date.UTC(now.getUTCFullYear(), now.getUTCMonth(), now.getUTCDate() + 1);
  return Math.ceil((midnight - now.getTime()) / 1000);
}

function isBrowserRequest(userAgent = '') {
  return /Mozilla|Chrome|Safari|Firefox|Edg/.test(userAgent);
}

function resolveLocale(url, headers) {
  const pathname = url.pathname.toLowerCase();
  if (pathname === '/zh' || pathname.startsWith('/zh/')) {
    return 'zh';
  }

  const langParam = (url.searchParams.get('lang') || '').toLowerCase();
  if (langParam) {
    //  lang  URL 
    if (langParam.startsWith('zh')) {
      return 'zh';
    }
    if (langParam.startsWith('en')) {
      return 'en';
    }
  }

  const acceptLanguage = (headers.get('Accept-Language') || '').toLowerCase();
  if (acceptLanguage.split(',').some((token) => token.trim().startsWith('zh'))) {
    return 'zh';
  }

  return 'en';
}


export default {
  async fetch(request, env, ctx) {
    const url = new URL(request.url);

    if (request.method === 'OPTIONS') {
      return addCorsHeaders(handleOptionsRequest());
    }

    if (request.method === 'GET' && url.pathname === '/health') {
      return addCorsHeaders(handleHealthCheck(env));
    }

    if (request.method === 'GET') {
      return addCorsHeaders(await handleGetRequest(request));
    } else if (request.method === 'POST') {
      return addCorsHeaders(await handlePostRequest(request, env));
    } else {
      return addCorsHeaders(new Response('Expected GET or POST', { status: 405 }));
    }
  },
};

function handleOptionsRequest() {
  return new Response(null, {
    status: 204,
    headers: {
      'Access-Control-Allow-Origin': '*',
      'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type',
    },
  });
}

function addCorsHeaders(response) {
  const newHeaders = new Headers(response.headers);
  newHeaders.set('Access-Control-Allow-Origin', '*');
  return new Response(response.body, {
    status: response.status,
    statusText: response.statusText,
    headers: newHeaders,
  });
}

function handleHealthCheck(env) {
  const payload = {
    status: 'ok',
    timestamp: new Date().toISOString(),
    hasApiKey: Boolean(env?.OPENAI_API_KEY),
  };

  return new Response(JSON.stringify(payload), {
    status: 200,
    headers: { 'Content-Type': 'application/json; charset=utf-8' },
  });
}

/**
 * Handles GET requests to serve the installer script or redirect browsers to GitHub.
 * @param {Request} request The incoming request.
 * @returns {Response} A response with the shell script or a redirect.
 */
function handleGetRequest(request) {
  const userAgent = request.headers.get('User-Agent') || '';
  console.log('[DEBUG] User-Agent received:', userAgent);
  console.log('[DEBUG] User-Agent type:', typeof userAgent);

  const url = new URL(request.url);
  const locale = resolveLocale(url, request.headers);
  const isBrowser = isBrowserRequest(userAgent);
  console.log('[DEBUG] isBrowser result:', isBrowser);

  // If the request comes from a browser, redirect to the appropriate README.
  if (isBrowser) {
    console.log('[DEBUG] Taking redirect branch');
    const docsUrl = locale === 'zh' ? README_URL_ZH : README_URL_EN;
    console.log('[DEBUG] Redirecting to:', docsUrl);
    return Response.redirect(docsUrl, 302);
  }

  console.log('[DEBUG] Taking script serving branch');
  // Otherwise, serve the installer script based on the resolved locale.
  const script = locale === 'zh' ? INSTALLER_SCRIPT_ZH : INSTALLER_SCRIPT;
  const filename = locale === 'zh' ? INSTALLER_FILENAME_ZH : INSTALLER_FILENAME_EN;

  return new Response(script, {
    headers: {
      'Content-Type': 'text/plain; charset=utf-8',
      'Content-Disposition': `attachment; filename="${filename}"`,
    },
  });
}

/**
 * Handles POST requests by forwarding the prompt to an AI model.
 * @param {Request} request The incoming request.
 * @param {object} env The environment variables.
 * @returns {Promise<Response>} A promise that resolves to the AI's response.
 */
async function handlePostRequest(request, env) {
  try {
    const { sysinfo, prompt, adminKey } = await request.json();

    //  sysinfo
    if (!sysinfo || sysinfo.trim() === '') {
      return new Response(
        JSON.stringify({ error: 'Missing or empty "sysinfo" in request body' }),
        {
          status: 400,
          headers: { 'Content-Type': 'application/json' }
        }
      );
    }

    //  prompt
    if (!prompt || prompt.trim() === '') {
      return new Response(
        JSON.stringify({ error: 'Missing or empty "prompt" in request body' }),
        {
          status: 400,
          headers: { 'Content-Type': 'application/json' }
        }
      );
    }
    if (!env.OPENAI_API_KEY) {
      return new Response('Missing OPENAI_API_KEY secret', { status: 500 });
    }

    const normalizedAdminKey = typeof adminKey === 'string' ? adminKey.trim() : '';
    const hasAdminBypass = Boolean(
      normalizedAdminKey && env?.ADMIN_ACCESS_KEY && timingSafeEqual(normalizedAdminKey, env.ADMIN_ACCESS_KEY),
    );

    const clientIp = request.headers.get('CF-Connecting-IP') ||
      request.headers.get('X-Forwarded-For') ||
      'anonymous';
    if (!hasAdminBypass) {
      const sharedLimit = resolveSharedLimit(env);
      const quota = await checkSharedQuota(clientIp, sharedLimit, env);
      if (!quota.allowed) {
        const message = {
          error: 'DEMO_LIMIT_EXCEEDED',
          message: `Shared demo quota exceeded (max ${sharedLimit} calls per day).`,
          hint: 'Configure FUCK_OPENAI_API_KEY in ~/.fuck/config.sh to use your own key.',
          remaining: quota.remaining,
          limit: sharedLimit,
        };
        return new Response(JSON.stringify(message), {
          status: 429,
          headers: { 'Content-Type': 'application/json', 'Cache-Control': 'no-store' },
        });
      }
    }

    const model = env.OPENAI_API_MODEL || 'gpt-5-nano';
    const apiBase = (env.OPENAI_API_BASE || 'https://api.openai.com/v1').replace(/\/$/, '');
    const apiUrl = `${apiBase}/chat/completions`;

    const url = new URL(request.url);
    const locale = resolveLocale(url, request.headers);
    const isChinese = locale === 'zh';

    const system_prompt = isChinese
      ? ` shell  shell 


1. "" ls  ls ""
2.  if [ $# -eq 0 ]
3. 
4. markdown  \`\`\`bash shebang #!/bin/bash


- ""  : ls
- ""  : ls -la
- "10MB"  : find . -type f -size +10M

${sysinfo}`
      : `You are an expert shell command generator. Users describe tasks in natural language. Your task is to generate directly executable shell commands to accomplish their goals.

Important rules:
1. User input is natural language intent, NOT command arguments. For example, "list directory" means run ls, not ls "list directory"
2. Generate directly executable commands, not script templates with parameter handling (like if [ $# -eq 0 ])
3. For simple tasks return single commands, complex tasks can be multi-line scripts
4. Do not provide any explanation, comments, markdown formatting (like \`\`\`bash), or a shebang (e.g., #!/bin/bash)

Examples:
- User says "list directory"  Output: ls
- User says "show detailed file list"  Output: ls -la
- User says "find files larger than 10MB"  Output: find . -type f -size +10M

The user's system info is: ${sysinfo}`;

    const aiRequestPayload = {
      model: model,
      messages: [
        {
          role: 'system',
          content: system_prompt,
        },
        {
          role: 'user',
          content: prompt,
        },
      ],
      max_tokens: 1024,
      temperature: 0.2,
    };

    const aiResponse = await fetch(apiUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${env.OPENAI_API_KEY}`,
      },
      body: JSON.stringify(aiRequestPayload),
    });

    if (!aiResponse.ok) {
      const errorText = await aiResponse.text();
      return new Response(`AI API Error: ${errorText}`, { status: aiResponse.status });
    }

    const aiJson = await aiResponse.json();
    const command = aiJson.choices[0]?.message?.content.trim();

    if (!command) {
      return new Response('The AI returned an empty command.', { status: 500 });
    }

    return new Response(command, {
      headers: { 'Content-Type': 'text/plain' },
    });
  } catch (error) {
    return new Response(`Error: ${error.message}`, { status: 500 });
  }
}
